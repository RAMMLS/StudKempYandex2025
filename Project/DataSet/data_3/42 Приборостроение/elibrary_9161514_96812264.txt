ISSN 0868–5886                                           НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2005, том 15, № 3, c. 77–82

 ОРИГИНАЛЬНЫЕ СТАТЬИ

УДК 004.932: 512.81: 621.318.4

 М. Я. Марусина, Н. Д. Скалецкая, А. О. Казначеева

КОРРЕКЦИЯ  ПРОСТРАНСТВЕННЫХ  ИСКАЖЕНИЙ
В  ТОМОГРАФИИ

Рассмотрены вопросы коррекции пространственных искажений томографических изображений. Для коррекции
искажений применен аппарат теории групп Ли. Преобразование изображений выполнено с помощью аффинной
и проективной групп, а также с помощью импримитивной группы № 19. Проанализирована проблема точного и
однозначного определения координат реперных точек на произвольных изображениях.

ВВЕДЕНИЕ ГРУППЫ ЛИ НА ПЛОСКОСТИ

Основная проблема при совмещении изображе- Группы Ли на плоскости делятся на два класса:
ний объектов в томографии заключается в том, что примитивные и импримитивные (С. Ли привел 38
разные изображения одного и того же объекта могут основных типов групп, В.С. Файн [2] — их конеч-
существенно отличаться друг от друга. Причинами ные уравнения). К примитивным группам Ли от-
этих отличий являются искажения, связанные с тех- носятся следующие.
ническими погрешностями системы получения и пе- — Аффинная группа:
редачи изображения, яркостные искажения, вызван-
ные изменением освещенности распознаваемого x = a1x + a2 y + b1,
объекта, и пространственные искажения, связанные                             (1)

y = a3x + a4 y + b2 ,
с изменением взаимного положения в пространст-
ве исследуемого объекта и устройства получения где x, y, x, y  — исходные и преобразованные аф-
изображения. финной группой координаты точки изображения,

В силу того что пространственные искаже- a1,…,a4 ,b1,b2  — параметры аффинной группы.
ния изображений меняются плавно, их можно
описать некоторыми непрерывными групповы- При преобразовании аффинной группой сохраня-
ми преобразованиями [1, 2, 3]. Покажем, что ется параллельность прямых.
группы Ли являются эффективным математиче- — Аффинная унимодулярная группа: конеч-
ским аппаратом при решении задач обработки изо- ные уравнения те же, что и у аффинной группы,
бражений исследуемых объектов, полученных но с условием a1a4 − a2a3 =1, которое обеспе-
с помощью магнитно-резонансных (МРТ), пози- чивает сохранение площади изображения при та-
тронно-эмиссионных (ПЭТ) и рентгеновских ком- ком преобразовании.
пьютерных томографов (РКТ). — Проективная группа:

Анализ групп преобразований и возможных
изменений их параметров позволяет выделить  1 2 1

x = a x + a y + b
следующие подходы к решению задачи коррек- ,

 a
ции пространственных искажений [4]: разложе- 5x + a6 y +1

                          (2)
ние полной группы преобразования на подгруппы y = a3x + a4 y + b2 ,
и их последовательная компенсация; нахождение  a5x + a6 y +1
параметров полной группы преобразований по ко-
ординатам характерных (реперных) точек на изо- где a1,…,a6 ,b1,b2  — параметры проективной
бражении исследуемого объекта. группы. При преобразовании данной группой не-

Проблема выбора реперных точек изображений прерывная линия на плоскости остается непре-
является актуальной, потому как общий способ их рывной, однако параллельность линий не сохра-
определения на произвольных изображениях неиз- няется.
вестен. Зная эти точки, можно не только преобра- Основной особенностью импримитивных
зовывать и совмещать изображения, полученные групп является то, что одна координата меняется
в процессе определенного томографического ис- по линейному закону, а вторая — по нелинейному.
следования, но и совмещать изображения, полу- Из 20 импримитивных групп Ли на плоскости
ченные различными томографическими методами. наибольшее распространение для целей опи-

77



78 М. Я. МАРУСИНА, Н. Д. СКАЛЕЦКАЯ

сания искажений в силу своей универсальности ПРЕОБРАЗОВАНИЕ ИЗОБРАЖЕНИЯ
получили группы № 13 и № 19 по классификации ПРОЕКТИВНОЙ ГРУППОЙ
Ли—Файна [2].

— Импримитивная группа № 13: Преобразование плоскости проективной
группой задается системой дробно-линейных

x = a1x + b1, уравнений (2). Число параметров проективной

 2 3 2
y = a2 y + b2 + a группы равно восьми, следовательно, для на-

3x + a4 x + a5x +…+ a n
n x − , хождения этих параметров требуется знать по-

где n — число параметров группы. ложения до и после преобразования четырех
— Импримитивная группа № 19: точек на изображении: 1-1', 2-2', 3-3', 4-4'. Со-

ставив для каждой пары точек по два уравне-
 ния относительно параметров проективной

2 1
x = a x + b ,
 1− a группы, получим восемь уравнений вида

1x
 2 3         (3)
 

3 2 4 5 x = a xi + a yi + b
y = a y + b + a x + a x +…+ a n

n x −
1 2 1

n ,
 (1− a x) −3  i ,

 a xi + a yi +1
1 5 6


где n — число параметров группы.  3 +

y = a xi a4 y i+b2

Кроме основных групп, на плоскости могут i ,
 a5xi + a6 yi +1

действовать группы, сопряженные с перечис-
ленными [3, 5, 6]. где i = 1,2,3,4. Решение системы из восьми

уравнений позволяет найти параметры про-
ективной группы. Выразив x и у через

ПРЕОБРАЗОВАНИЕ ИЗОБРАЖЕНИЯ x, y,a1,...,a6 ,b1,b2 , найдем обратное преобразова-
АФФИННОЙ ГРУППОЙ ние g–1, восстанавливающее положение всех

Аффинное преобразование плоскости зада- точек на изображении:
ется системой линейных уравнений (1). Если 
значения параметров a1,...,a4 ,b1,b2  элемента g аф- x (b1 − x)(ya6 − a4 ) − (b2 − y)(xa6 − a2 )

 = ,
финной группы G ( g∈G ) известны, то восстанов-  (xa5 − a1)(ya6 − a4 ) − (ya5 − a3 )(xa6 − a2 )


ление изображения не вызывает проблем. Доста-  − − − − −

y = (b1 x)(ya5 a3 ) (b2 y)(xa5 a1) .
точно применить аффинное преобразование  (xa6 − a2 )(ya5 − a3 ) − (ya6 − a4 )(xa5 − a1)
X ′ = g * X  последовательно ко всем точкам Х: (х,
у) восстанавливаемого изображения [1].

Если известны координаты трех соответствен- ОШИБКА ОПРЕДЕЛЕНИЯ КООРДИНАТ
ных точек на двух изображениях, то, сравнивая их РЕПЕРНЫХ ТОЧЕК
координаты на искаженном изображении с коорди-
натами на исходном изображении, можно составить При работе с томографическими изображе-
для каждой пары точек по два уравнения вида ниями координаты реперных точек, как прави-

ло, определяются с ошибкой, которая приводит
x к ошибке при определении параметров группо-

i = a1xi + a2 yi + b1,
 вого преобразования и, как следствие, к ошиб-
yi = a3xi + a4 yi + b2 , ке коррекции координат всех точек изо-

где i = 1,2,3, из которых вычисляются все шесть бражения [4, 7]. Зависимость ошибки коррек-
параметров аффинной группы, после чего ис- ции пространственных искажений точек изо-
каженное изображение подвергается преобразова- бражения (∆l) от величины ошибки определе-
нию элементом g–1: ния координат реперов (∆r) носит прямо про-

порциональный характер, причем коэффициент
пропорциональности зависит от вида группо-

x = a4 (x − b1) + a2 (b2 − y) вого преобразования.
 ,
 a Необходимо отметить, что в случае одина-

1a4 − a2a3
 ковой величины ∆r для всех реперов при аф-
y = −a3 (x − b1) − a1(b2 − y) , финном преобразовании все точки изображе-
 a1a4 − a2a3 ния имеют одинаковую ошибку коррекции ∆l,

а при проективном  величина ошибки зависит
что позволяет нейтрализовать действие аффин- от положения точки на плоскости. На практике
ной группы и восстановить исходное изобра- ∆r, как правило, отличаются для каждого репе-
жение. ра, но характер прямой пропорциональной за-

НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2005, том 15, № 3



КОРРЕКЦИЯ  ПРОСТРАНСТВЕННЫХ  ИСКАЖЕНИЙ  В   ТОМОГРАФИИ 79

висимости между ∆r и ∆l для точек плоскости проверим, соответствует ли преобразованное изо-
сохраняется. бражение снимку, полученному в процессе иссле-

Методы коррекции пространственных иска- дования. Погрешность определения координат
жений изображений, основанные на вы- точек ∆ = ±1 пикс. = = ±0.6 мм.
числении параметров обратного преобразова-
ния по координатам характерных точек, позво-
ляют скомпенсировать искажения, описывае-
мые полной аффинной и проективной группа-
ми. Избыточность реперных точек позволяет
значительно повысить точность вычисления
параметров преобразования

КОРРЕКЦИЯ ИСКАЖЕНИЙ
С ИСПОЛЬЗОВАНИЕМ РЕПЕРНЫХ ТОЧЕК а
Для описания методики коррекции пространст-

венных искажений воспользуемся МРТ-снимками
фантома, полученными на МР-томографе GE
Signa Infinity 1.5 Тл (рис. 1). Фантом представляет
собой шесть шприцев, заполненных водой и жест-
ко скрепленных между собой.

Выберем на изображениях реперные точки
и относительно них найдем параметры группового
преобразования. Вычисленные параметры приме- б
ним к центральным точкам элементов фантома и

а

в

б

Рис. 2. Эталонное (а) и искаженное (б) изо-
Рис. 1. Эталонное (а) и искаженное (б) изо- бражения фантома. T, U, V, O, T', U', V', O' —
бражения фантома. A, B, C, D, E, F — центры реперные точки. в — положение точек фан-
элементов фантома на эталонном изображе- тома на плоскости после аффинного преобра-
нии; A', B', C', D', E', F' — на искаженном изо- зования
бражении

НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2005, том 15, № 3



80 М. Я. МАРУСИНА, Н. Д. СКАЛЕЦКАЯ

Вычисление параметров аффинного Параметры аффинного преобразования:
преобразования a1 =1.035 , a2 = 0.045 , a3 = −0.065 , a4 =1.045 ,

1. Предположим, что точки T, U, V эталонного b1 = −11.596 , b2 = 3.604 .
изображения соответствуют точкам T', U', V' ис- Рис. 2, в иллюстрирует положение центров
каженного изображения (рис. 2). Выберем эти элементов фантома на плоскости для эта-
точки в качестве реперных и относительно них лонного, искаженного и преобразованного изо-
найдем параметры аффинного преобразования. бражений.

2. Предположим, что точки M, N, O эталонного
изображения соответствуют точкам M', N', O' ис-
каженного изображения (рис. 3). Выберем эти
точки в качестве реперных и относительно них
найдем параметры аффинного преобразования.

Параметры аффинной группы: a1 =1.157 ,
a2 = −0.025 , a3 = 0 , a4 =1.179 , b1 = −15.46 ,

а b2 = −32.071.
Рис. 3, в иллюстрирует положение центров

элементов фантома на плоскости для эта-
лонного, искаженного и преобразованного изо-
бражений.

б

а

в

б

Рис. 3. Эталонное (а) и искаженное (б) изобра-
жения фантома. M, N, O, M', N', O' — реперные
точки. в — положение точек фантома на плос- Рис. 4. Положение точек фантома на плоско-
кости после аффинного преобразования сти после проективного преобразования

НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2005, том 15, № 3



КОРРЕКЦИЯ  ПРОСТРАНСТВЕННЫХ  ИСКАЖЕНИЙ  В   ТОМОГРАФИИ 81

Вычисление параметров проективного Параметры проективного преобразования:
преобразования a1 = 0.481, a = 7

2 2.484×10− , a3 = −0.142 ,
1. Предположим, что точки T, U, V эталонного a4 = 0.76 , a5 = −0.002 , a =1.188×10−9

6 ,
изображения соответствуют точкам T', U', V' ис- b
каженного изображения (рис. 2). Тогда точка O, 1= 27.433 , b2 = 3.582 .
являющаяся центром треугольника TUV, будет Рис. 4, б иллюстрирует положение центров
соответствовать точке O' — центру треугольника элементов фантома на плоскости для эта-
T'U'V'. Выберем эти четыре точки в качестве ре- лонного, искаженного и преобразованного изо-
перных и относительно них найдем параметры бражений.
проективного преобразования.

Параметры проективной группы: a1 =1.68 , Вычисление параметров импримитивной
группы № 19

a2 = 0.463 , a3 = 0.04 , a4 = 2.118 , a5 = 0.0008 ,
a6 = 0.003 , b 1= −88.947 , b2 = −89.384 . Преобразование плоскости импримитивной

группой №19 задается системой уравнений (3).
Рис. 4, а иллюстрирует положение центров Предположим, что точки T, U, V эталонного изо-

элементов фантома на плоскости для эта- бражения соответствуют точкам T', U', V' иска-
лонного, искаженного и преобразованного изо- женного изображения (рис. 2). Выберем эти точки
бражений. в качестве реперных и относительно них найдем

2. Предположим, что точки Q, R, S, T эталон- параметры группового преобразования.
ного изображения соответствуют точкам Q', R', S', Параметры импримитивной группы № 19:
T' искаженного изображения (рис. 5). Выберем эти
четыре точки в качестве реперных и относительно a 3

1 = −3.278×10− , a2 =1.859 , a3 =1.523,
них найдем параметры проективного преобразо- a4 = 0.413 , b1 = −54.871, b2 = −66.298 .
вания. Рис. 6 иллюстрирует положение центров

элементов фантома на плоскости для эталон-
ного, искаженного и преобразованного изобра-
жений.

Различие преобразованного и эталонного изо-
бражений обусловлено, во-первых, тем, что коор-
динаты реперных точек найдены с ошибкой из-за
невозможности их однозначного определения на

а произвольном изображении; во-вторых, на резуль-
таты оказывает влияние ошибка "размытия" иска-
женного изображения.

б

Рис. 5. Эталонное (а) и искаженное (б) Рис. 6. Положение точек фантома на плоскости
изображения фантома. Q, R, S, T, Q', R', S', после преобразования импримитивной группой
T' — реперные точки № 19

НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2005, том 15, № 3



82 М. Я. МАРУСИНА, Н. Д. СКАЛЕЦКАЯ

ВЫВОДЫ 4. Ерош И.Л. Элементы теории дискретных
групп: Учебное пособие. СПб.: СПбГУАП,

Наилучшие результаты были получены после 1998.  40 с.
преобразования изображения импримитивной 5. Иванов В.А., Марусина М.Я. Применение тео-
группой № 19, т. к. соответствующие четыре точ- рии групп при решении задач реализации из-
ки (A, D, E, F) на двух изображениях совмести- мерительных преобразований // Изв. вузов.
лись. Несовпадение двух точек (B, C) обусловлено Приборостроение. 2000. Т. 43, № 6.  С. 36–39.
сильным "размытием" искаженного изображения. 6. Иванов В.А., Марусина М.Я., Липиньски А.Г.
Поэтому наиболее достоверные данные могут Групповые свойства измерительных преобра-
быть получены при комбинации различных груп- зований // Авиакосмическое приборостроение.
повых преобразований. 2003. № 5.  С. 32–35.

7. Иванов В.А., Марусина М.Я., Флегонтов А.В.
СПИСОК ЛИТЕРАТУРЫ Инвариантные аппроксимации и их примене-

ние в МР-томографии // Научное приборо-
1. Зайцев В.Ф. Введение в современный группо- строение.  2003. Т. 13,  № 2.  С. 22–26.

вой анализ. 2 ч. Уравнения первого порядка и
допускаемые ими точечные группы: Учебное
пособие. СПб.: РГПУ им. А.И. Герцена, 1996. Санкт-Петербургский государственный
83 с. университет  информационных технологий,

2. Файн В.С. Опознавание изображений: Основы механики и оптики
непрерывно-групповой теории и ее при-
менение.   М.: Наука, 1970.  296 с.

3. Чеботарев И.Г. Теория групп Ли. М.: ГИТТЛ, Материал поступил в редакцию 21.03.2005.
1940.  396 с.

SPATIAL  DISTORTION  CORRECTION  IN  TOMOGRAPHY

M. Ya. Marusina, N. D. Skaletskaya, A. O. Kaznacheeva
Saint-Petersburg State University of Information Technologies, Mechanics and Optics

The questions of tomography image distortion correction are considered. The Lee group theory tools are used for
image correction. Image transformation is done with the help of affine and projective groups and imprimitive group
No. 19. The problem of precise and unequivocal definition of fiducial points coordinates on arbitrary images is
analyzed.

НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2005, том 15, № 3