ISSN 0868–5886                                       НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2007, том 17, № 1, c. 115–120

 ОБРАБОТКА И АНАЛИЗ СИГНАЛОВ

УДК 621.384.8

 И. В. Заруцкий, В. В. Манойлов

ПРЕДВАРИТЕЛЬНАЯ  ОЧИСТКА  МАСС-СПЕКТРОМЕТРИЧЕСКИХ
СИГНАЛОВ  ОТ  ШУМОВ  С  ПОМОЩЬЮ  ВЕЙВЛЕТ-ФИЛЬТРОВ

Рассмотрены возможности прямого и обратного вейвлет-преобразований для очистки масс-спектро-
метрических сигналов от шумов. Использовано многоуровневое преобразование исходного сигнала с целью
установления оптимальной полосы низкочастотного фильтра при сохранении разрешения. Критерием опти-
мальности выбран уровень энтропии, который быстро уменьшается на первых этапах аппроксимации и де-
тализации, а затем его уменьшение сильно замедляется. Приведены примеры фильтрации реального масс-
спектрометрического сигнала предлагаемым методом.

ПОСТАНОВА ЗАДАЧИ лет-преобразования. На рис. 1 представлено раз-
деление исходного сигнала на части с помощью

Одной из причин, затрудняющих анализ любо- высокочастотного и низкочастотного фильтров.
го сигнала, является наличие шумов. Существует
несколько общепринятых методов удаления помех
из исходного сигнала: применение оконного Фу-
рье-преобразования [1, 2], полиномиальное сгла-
живание и относительно недавно появившийся
метод, основанный на использовании вейвлет-
преобразования. По сравнению с другими метода- Сигнал
ми вейвлет-очистка сигналов имеет ряд преиму-
ществ, заключающихся, в первую очередь, в опти-
мальной частотно-временнóй локализации, что по-
зволяет удалять помеху вблизи некоторой точки t, Фильтры
не искажая при этом самого сигнала. Строгое мате- Низких частот Высоких частот
матическое обоснование метода очистки сигнала от
шумов с помощью вейвлетов и сравнение его
с другими методами было рассмотрено в работе [3]. A D

Основная идея очистки сигнала от шума за-
ключается в разложении сигнала на вейвлеты,
идентификации компонент шума и восстановле-
нии сигнала без этих компонент. Рис. 1.  Разделение исходного сигнала на две части

ФИЛЬТРАЦИЯ МАСС-СПЕКТРОМЕТРИЧЕСКИХ
СИГНАЛОВ МЕТОДОМ ПРЯМОГО cD (высокие частоты)

И ОБРАТНОГО ДИСКРЕТНОГО ВЕЙВЛЕТ-
ПРЕОБРАЗОВАНИЙ

S ~500 DWT-коэффициентов
Первый этап фильтрации: аппроксимация и

дeтализация. Для  большинства масс-спектро-
метрических сигналов низкочастотная состав- 1000 точек сигнала cA (низкие частоты)
ляющая анализируемого  сигнала является наибо-
лее важной. Это то, что дает возможность иденти-
фицировать сигнал. Высокочастотная составляю-
щая  — это шум. В вейвлет-анализе говорят об ап- ~500 DWT-коэффициентов
проксимации и деталях.  Аппроксимация является
высокой шкалой — низкочастотной составляющей Рис. 2. Получение из 1000 точек исходного сигнала
сигнала. Детализация — это низкая шкала, высо- двух частей из 500 точек для низкочастотной и высо-
кочастотная составляющая. Рассмотрим основные кочастотной составляющих при дискретном вейвлет-
черты фильтрации с помощью двух частей вейв- преобразовании (DWT)

115



116 И. В. ЗАРУЦКИЙ, В. В. МАНОЙЛОВ

S

cA1 cD1

cA2 cD2

Рис. 4. Реконструкция сигнала из вейвлет коэффи-
cA3 cD циентов после декомпозиции.

3
  — означает увеличение количества точек за
счет добавления в выборку дополнительных нулей;

Рис. 3. Вейвлет-декомпозиционное дерево H' и L' — соответственно реконструкционные
фильтры верхних и нижних частот

Пусть исходный сигнал содержит 1000 точек. Вейвлет-анализ (декомпозиция) производит
Такой сигнал  проходит через два дополнительных фильтрацию и уменьшает количество точек в каж-
фильтра, и появляются два сигнала. При дискрет- дой из отфильтрованных частей (downsampling).
ном вейвлет-преобразовании из 1000 точек в каж- Процесс вейвлет-реконструкции (синтеза) состоит
дой части появляется 500 точек соответственно из процедуры увеличения количества точек (up-
cA и cD (рис. 2). sampling) и фильтрации.  Синтез исходного сигна-

ла осуществляется из вейвлет-коэффициентов, по-
МНОГОУРОВНЕВОЕ лученных по результатам анализа. Upsampling —

ВЕЙВЛЕТ-ПРЕОБРАЗОВАНИЕ это процесс увеличения количества точек сигнала
путем введения нулей между отсчетами.

Процесс представления исходного сигнала с
помощью вейвлет-коэффициентов  при разделении РЕКОНСТРУКЦИОННЫЕ ФИЛЬТРЫ
на низкочастотную и высокочастотную части  на-
зывают декомпозицией. Процесс декомпозиции Правильный выбор реконструкционного филь-
может быть итеративным. Такой процесс называ- тра является  решающим моментом  в  достижении
ют вейвлет-декомпозиционным деревом (рис. 3). наименьшей разности между исходным и синтези-

руемым сигналами [4]. Низкочастотный и высоко-
ВЕЙВЛЕТ-РЕКОНСТРУКЦИЯ частотные декомпозиционные фильтры (L и H),

а также связанные с ними реконструкционные
Выше был рассмотрен процесс использования фильтры (L' и H') образуют систему, которая на-

дискретного вейвлет-преобразования для анализа зывается квадратурными зеркальными фильтрами
или декомпозиции сигнала.  Другая составляющая (рис. 5).
обработки сигнала состоит в том, как полученные
при декомпозиции составляющие сигнала могут ВЫБОР ОПТИМАЛЬНОГО КОЛИЧЕСТВА
быть обратно соединены вместе для получения УРОВНЕЙ ДЕКОМПОЗИЦИИ
исходного сигнала без потери информации. Этот
процесс называется реконструкцией или синтезом. Выбор оптимального количества уровней де-
Комплекс математических операций, который вы- композиции основан на свойствах данного орто-
полняет процесс синтеза, называется обратным гонального вейвлета,  с помощью которого было
дискретным вейвлет-преобразованием (рис. 4). произведено разложение исходного сигнала.

НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2007, том 17, № 1



ПРЕДВАРИТЕЛЬНАЯ  ОЧИСТКА  МАСС-СПЕКТРОМЕТРИЧЕСКИХ СИГНАЛОВ... 117

2 тип. Концентрация по норме p при  p< 1 (в
данной работе p = 0.5):

E2(si ) = s p
i                                    (4)

и поэтому
cD cD

S S E2(S) =∑ s p = s p .                   (5)
i i p

cA cA 3 тип. Логарифм "энергии" энтропии:
E3(si ) = log(s 2

i )                             (6)

     Декомпозиция           Реконструкция и поэтому
E3(S) =∑ log(s 2 )                         (7)

i i
Рис. 5. Квадратурные зеркальные фильтры

при соглашении для 0 — log(0) = 0.
4 тип. Пороговая энтропия:

Исходный сигнал длиной  N = 2L может быть E4(s
α -"растянут" различными путями (где α — коли- i ) =1,  если si > ε ;
чество бинарных ярусов полного бинарного дере- E4(S) =K,
ва глубиной L). В результате α ≤ 2N 2  [6]. Это чис-
ло может быть очень большим, и поэтому конеч- где K — количество раз превышения коэффициен-
ное количество вычислений может быть неуправ- тами вейвлет-разложения порогового уровняε .
ляемым. В связи с этим важным является устано- Произведем оценку количества уровней деком-
вить критерий эффективности алгоритма при ус- позиции для  масс-спектра, представленного на
тановлении оптимального количества уровней де- рис. 6. Количество отсчетов этого сигнала N =
композиции. Обычно ищется минимум функцио- = 6000. В работе [2] описан алгоритм фильтрации
нала. Для решения данной задачи хорошо подхо- того же сигнала, который представлен на рис. 6.
дят классические критерии, основанные на мини- Тот алгоритм основан на фильтре нижних частот
муме энтропии. Энтропия является общей концеп- Чебышева, поэтому возможно сравнение методов.
цией во многих областях знаний, главным образом Результаты вычисления энтропии для различ-
в обработке сигналов [7]. В соответствии с опи- ных уровней декомпозиции сведены в таблицу.
санными в  [5] свойствами энтропии для сигналов, В качестве материнских вейвлет-функций ис-
представляемых в виде ортогональных разложе- пользовались функции Добеши [3]. Приведем
ний, справедливо следующее выражение для эн- примеры различных уровней вейвлет-де-
тропии сигнала  S : композиции для исходного сигнала (рис. 6).

E(S) =∑ E(s ) ,                             (1)
i i

где si — коэффициенты разложения сигнала S
в ортонормированном базисе.

В [5] приведен список из четырех типов энтро-
пии для коэффициентов разложения сигнала по
ортонормированному базису.

1 тип. Ненормированная энтропия по Шенно-
ну:

E1(s 2 2
i ) = −si log(s i )                     (2)

и поэтому
E1(S) =∑ s 2 log(s2

i )                  (3)
i i

при соглашении для 0 — log(0) = 0.
Рис. 6. Исходный сигнал в нормализованном виде

НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2007, том 17, № 1



118 И. В. ЗАРУЦКИЙ, В. В. МАНОЙЛОВ

Значения различных типов энтропии при декомпозиции масс-спектра (рис. 6)
Уровень декомпо- Энтропия типа 1 Энтропия типа 2 Энтропия типа 3
зиции (Шеннон) (концентрация по (логарифм

норме, p = 0.5) "энергии")
Нулевой (исходный
сигнал) 73.12 92 –4.8е4
Первый 36.63 47 –2.38е4
Второй 16.85 23 –1.27е4
Третий 7.14 12 –7.99е3
Четвертый 3.58 7 –4.06е3
Пятый 1.64 4 –2.06е3
Шестой 1.50 4 –1.04е3
Седьмой 1.05 2 –559

Рис. 7. Первый уровень DWT сигнала в нормализо- Рис. 8. Второй уровень DWT сигнала в нормализован-
ванном виде (образовано N/2 точек) ном виде (образовано N/4 точек и повысилось отноше-

ние сигнал/шум)

Рис. 9. Третий уровень DWT сигнала в нормализован- Рис. 10. Четвертый уровень DWT сигнала в нормали-
ном виде (образовано N/8 точек и повысилось отноше- зованном виде (образовано N/16 точек и повысилось
ние сигнал/шум) отношение сигнал/шум)

НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2007, том 17, № 1



ПРЕДВАРИТЕЛЬНАЯ  ОЧИСТКА  МАСС-СПЕКТРОМЕТРИЧЕСКИХ СИГНАЛОВ... 119

Рис. 11. Пятый уровень DWT сигнала в нормализован- Рис. 12. Шестой уровень DWT сигнала в нормализо-
ном виде (образовано N/32 точек и повысилось отно- ванном виде (образовано N/64 точек, повысилось от-
шение сигнал/шум, ухудшилось разрешение) ношение сигнал/шум, но и сильно ухудшилось разре-

шение)

Рис. 13. Седьмой уровень DWT сигнала в нормализо-
ванном виде (образовано N/128 точек, повысилось от- Рис. 14. Уменьшение энтропии по Шеннону в  зависи-
ношение сигнал/шум, но и очень  сильно ухудшилось мости от уровня вейвлет-декомпозиции
разрешение)

Иначе говоря, представим вейвлет-декомпози- ты [2] дает основание сделать заключение, пред-
ционное дерево. На рис. 7–13 представлены ап- ставленное ниже.
проксимирующие части различных уровней вейв-
лет-декомпозиции.

Как видно из рис. 10 и 11, наиболее приемле- ЗАКЛЮЧЕНИЕ
мыми уровнями вейвлет-декомпозиции являются
уровни 4 и 5, т. к они дают максимальное отноше- На основе  минимизации  уровня  энтропии
ние сигнал/шум и не искажают разрешающую предложен алгоритм  выбора оптимального коли-
способность. Этот  же вывод можно сделать из ха- чества уровней декомпозиции  ортогонального
рактера уменьшения энтропии, представленного в вейвлет-преобразования. Оптимальный уровень
таблице  и на рис. 14. Исходя из этих данных, вид- декомпозиции  дает максимальное отношение
но, что после 5-го уровня энтропия падает значи- сигнал/шум, и  в обрабатываемом сигнале не ис-
тельно медленнее, чем в промежутке от 1-го до кажается разрешающая способность. Сравнение
5-го уровня. качества фильтрации  масс-спектрометрических

Сравнение результатов данной работы и рабо- сигналов с помощью фильтров Чебышева и  с по-
мощью вейвлет-декомпозиции  показывает, что

НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2007, том 17, № 1



120 И. В. ЗАРУЦКИЙ, В. В. МАНОЙЛОВ

оба метода фильтрации дают примерно равные ре- ская динамика", 2001. 464 с.
зультаты в смысле отношения сигнал/шум. Пре- 4. Strang, G., Nguyen T.  Wavelets and filter banks.
имуществом вейвлет-декомпозиции  при установ- Wellesley-Cambridge Press., 1996. 240 p.
лении с помощью минимума энтропии уровня де- 5. Coifman R.R., Wickerhauser M.V. Entropy-
композиции является минимизация количества basedalgorithms for best basis selection // IEEE
вычислений по сравнению с количеством вычис- Trans. on Inform. Theory. 1992. V. 38, N 2.
лений, требуемых для реализации фильтров Че- P. 713–718.
бышева применительно ко всему массиву данных. 6. Mallat S. A wavelet tour of signal processing.

Academic Press, 2000. 637 р.
СПИСОК ЛИТЕРАТУРЫ 7. Dohodo D. // IEEE Trans. on Inform. Theory.

1995. V 41. P. 613–627.
1. Макс Ж. Теория и техника обработки сигналов

при физических измерениях. Т. 1. М.: Мир, 1983.
280 с.

2. Заруцкий И.В., .Манойлов В.В.  Аппаратно-
программный комплекс транспортабельного Институт аналитического приборостроения РАН,
хромато-масс-спектрометра  ТХМС // Научное Санкт-Петербург
приборостроение. 2003. Т. 13, № 4. С. 47–54.

3. Добеши  И. Десять  лекций по вейвлетам  (пер. Материал поступил в редакцию 18.10.2006.
с англ.). Ижевск: НИЦ "Регулярная и хаотиче-

PRELIMINARY  ELIMINATION  OF  NOISE  FROM  MASS  SPECTRA
BY  WAVELET  FILTERS

I. V. Zarutsky, V. V. Manoilov
Institute for Analytical Instrumentation RAS, Saint-Petersburg

The paper analyzes applicability of the direct and inverse transformations to the problem of removing noises
from mass spectra. To find the low-frequency filter band that ensure optimal results while the resolution remains
constant, a multilevel conversion of initial signal is used. As the optimality criterion, an entropy level was taken,
which quickly decreases on the early stages of approximation and detailing and decreases much slower on the
later stages.    The paper presents the cases of filtering an actual mass spectrum by the method suggested.

НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2007, том 17, № 1