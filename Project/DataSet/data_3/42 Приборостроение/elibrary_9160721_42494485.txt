ISSN 0868–5886                                             НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2006, том 16, № 1, c. 3–15

 ОБЗОРЫ

УДК 621. 391. 26

 Л. В. Новиков

МОДИФИЦИРОВАННЫЕ  ВЕЙВЛЕТЫ  В  ОБРАБОТКЕ  ДАННЫХ
АНАЛИТИЧЕСКИХ  ПРИБОРОВ.

I. ОСНОВЫ ТЕОРИИ
Рассматриваются теоретические и прикладные вопросы обработки экспериментальных данных с использо-
ванием вейвлетных преобразований. Приведено определение кратномасштабного анализа как спектрального
анализа сигналов с расширяющейся полосой. Построены блоки фильтров, реализующие быстрые вычисли-
тельные алгоритмы. Исследован класс нестационарных вейвлетов, полученных модификацией известных
ортонормированных вейвлетов аппаратной функцией прибора.

ВВЕДЕНИЕ метод подавления шума для случая аддитивной
смеси сигнала с шумом (искажения, вызванные

При решении ряда прикладных задач в научных приборной функцией не учитываются), основанный
исследованиях, медицине, криминалистике и др. на вычислении коэффициентов c j (k )  и d j (k )областях с использованием аналитических прибо-
ров полезную  информацию  приходится извлекать вейвлет-разложения наблюдаемого сигнала y (t )
путем  достаточно сложной предварительной об- с последующей пороговой обработкой. Было пока-
работки многокомпонентных сигналов. зано, что эта обработка доставляет близкую

Существующие подходы решения этих задач к минимаксной оценку полезного сигнала x(t )  в
включают применение различных методов сгла-
живания (с помощью фильтров Савицкого—Го- широком диапазоне гладкости сигнала.
лэя, Калмана, Винера, Фурье и др.), дифференци- Предположим, что прибор является линейной
рующих фильтров и методов деконволюции [1]. В стационарной системой с импульсным откликом
последнее десятилетие в практику обработки дан- H (t ),  называемым часто приборной или аппарат-
ных аналитических приборов стали внедряться ной функцией (см. рис. 1). Вид этой функции оп-
подходы, основанные на время-масштабном пре- ределяется не только физическим трактом прибора
образовании сигнала в вейвлетном базисе [2], (энергоанализатором, хроматографической колон-
включающем масштабирующие ϕ ( ) кой и т. п.), но также свойствами детектора и  из-

j ,k t  и вейвлет-
мерительного тракта. В приборе, кроме того, дей-

ные функции ψ j ,k (t )  ( j∈Z  определяет масштаб ствуют шумы различного происхождения, кото-
(ширину), а k∈N  — смещение этих функций). рые предполагаются аддитивными и гауссовски-

Уже опубликовано более 370 статей по приме- ми. Поэтому наблюдаемый сигнал y (t )  можно
нению вейвлет-преобразования (ВП) в аналитиче- представить в виде
ской химии, химической физике и др. сходных об-
ластях. ВП применяется для  сжатия данных, y
сглаживания и удаления шума (denoising), коррек- (t ) = ∫H (t −τ ) x(τ )dτ + u (t ). (1а)
ции базовой линии и фона, разрешения наложив-
шихся пиков (деконволюции) и др. Существенные (Здесь и в дальнейшем для простоты бесконечные
положительные результаты применения ВП дос- пределы в интеграле опускаются).
тигнуты в проточном инжекционном анализе Если прибор безынерционный, то H (t ) = δ(t ) ,
(FIA), высокоэффективном капиллярном электро- где δ(t )  — дельта-функция, и имеет место обыч-
форезе (CE), высокоэффективной жидкостной
хроматографии (HPLC), инфракрасной спектро- ная смесь сигнала с шумом
скопии (IR), масс-спектрометрии (MC), спектро- y (t ) = x(t )+ u (t ). (1б)
метрах ядерного магнитного резонанса (NMR),
электроаналитической химии и др.  [3]. В выражениях (1а, 1б) приборная функция

В борьбе с шумами применяются вейвлетные
подходы подавления шума, основанные на работах H (t ) , спектр частот и дисперсия шума σ  предпо-
Donoho D.L. и Johnstone I.M. [4]. Они предложили лагаются известными.

3



4 Л. В. НОВИКОВ

рождает семейство биортогональных нестацио-
нарных вейвлетных базисов, ориентированных на
решение определенной задачи, связанных со спе-
цификой каждого прибора. При соответствующем
выборе функции G (t )  в одном алгоритме обра-
ботки удается совместить решение задач деконво-
люции, дифференцирования или интегрирования
с эффективным вейвлетным подавлением шума.

1. КРАТНОМАСШТАБНЫЙ АНАЛИЗ
Рис. 1. Информационная модель прибора: И БЛОКИ ФИЛЬТРОВ
x(t )— полезный сигнал; H (t )  — импульсный от-
клик стационарной, инвариантной во времени сис- Так как изложение материала работы основано
темы (приборная функция); u (t )  — стационарный на теории кратномасштабного (мультиразрешаю-
в широком смысле шум; y (t )  — наблюдаемый щего) анализа (КМА) сигналов, поясним основные
сигнал ее положения, применив понятный инженерам

спектральный подход к анализу сигналов. Пусть
некоторое множество сигналов, имеющих частот-
ный спектр в диапазоне от 0  до 2J Ω , где Ω  —

Развиваемый в настоящей работе вейвлетный некоторая круговая частота (рад/с), образуют под-
подход направлен на решение задачи оценки сиг- пространство пространства L2 , которое мы обо-
нала, его производных или текущего значения ин- значим как VJ  (см. рис. 2). Пусть другое множест-
теграла, когда имеет место искажение полезного
сигнала прибором вследствие его инерционности во сигналов имеет частотный спектр (0,2J −1Ω) ,
и шумом, т. е. для модели (1а).

Решение будем искать в области линейных которое обозначим как VJ −1 , т. е. при J = 0 V0  —
преобразований, а именно будем считать, что пер- (0,20Ω) , V −

−1  — (0,2 1Ω) , V−2  — (0,2−2Ω)  и т. д.
вичная обработка наблюдаемого сигнала y (t )  за- Очевидно, что все сигналы, которые принадле-
ключается в получении оценки полезного сигнала жат VJ −1 , также принадлежат и VJ , т. к. спектр
x (t )  с помощью некоторого фильтра с импульс- сигналов из VJ −1  полностью входит в спектраль-
ным откликом G (t ) , формирующего эту оценку ный диапазон сигналов из VJ . Условно это запи-

сывается как VJ −1 ⊂VJ (говорят, VJ −1  вложено в
x (t ) = (G ∗ y)(t ) , (2а) VJ ). То же можно сказать и о подпространстве V0 ,

или в образах Фурье т. е. V0 ⊂V1 , и о других подпространствах VJ .
x (ω ) =G (ω ) y (ω ) . (2б) В результате подпространства, сконструирован-

ные приведенным выше способом, образуют це-
Одной из задач, решаемых при применении почку вложенных друг в друга подпространств

вейвлетов в обработке данных, является адаптив-
ный выбор вейвлетного базиса, зависящего от сиг- ...⊂V−2 ⊂V−1 ⊂V0 ⊂V1 ⊂V2 ⊂ .... (3)
нала. Для этой цели используют метод перебора
базисов, минимизируя некоторую функцию стои- Однако разбиение всей шкалы частот можно
мости, характеризующую степень концентрации выполнить более рациональным способом, напри-
вейвлет-разложения сигнала в минимальном числе мер нижние частоты сигнала сохранить в диапазо-
коэффициентов [5]. не частот (0,2−2Ω)  и затем путем расширения

В отличие от традиционного подхода в настоя-
щей работе предложен метод модификации из- спектрального диапазона добавлением частотных
вестных ортонормированных вейвлетных базисов полос (2−2Ω,2−1Ω) , (2−1Ω,20Ω) , (20Ω,21Ω)  и т. д.
(названных вейвлетами-"прародителями") с по- добиться необходимой для данного сигнала общей
мощью функции G (t ) , выбираемой или синтези- ширины полосы 2J Ω  (см. рис. 2). Множества сиг-
руемой с учетом аппаратной функции H (t )  и/или налов, входящих в эти спектральные полосы, обра-
импульсных откликов дифференцирующих и ин- зуют подпространства вейвлетов и обозначаются
тегрирующих фильтров. Такая модификация по- как  W−2 ,W−1,W0 ,W1  и  т. д.  Тогда  подпространство,

НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2006, том 16, № 1



МОДИФИЦИРОВАННЫЕ  ВЕЙВЛЕТЫ... 5

занимают широкий спектр частот, сигналы боль-
шей продолжительности, например в два раза,
имеют спектр, ровно в два раза меньший. Это оз-
начает, что анализ реальных сигналов необходимо
выполнять техническими средствами (анализато-
рами), имеющими различную разрешающую спо-
собность в зависимости от полосы частот, т. к. они
наиболее удачно согласуются с продолжительно-
стью (размером, масштабом) этих сигналов. В за-
рубежной литературе такой анализ получил назва-
ние "анализ с множественным разрешением", или
"мультиразрешающий анализ" (multiresolution
analysis), в отечественной, особенно в математиче-
ских публикациях, — "кратномасштабный анализ"

Рис. 2. Разбиение спектра сигнала y (ω )  на час- (КМА).  Дадим строгое определение КМА.
тотные поддиапазоны, каждый из которых связан с Определение: Последовательность вложенных
соответствующим подпространством друг в друга замкнутых подпространств (час-

тотных поддиапазонов) (3)
...⊂V−2 ⊂V−1 ⊂V0 ⊂V1 ⊂V2 ⊂ ....

например, V2  может быть представлено как сумма называется КМА, если удовлетворяются следую-
V щие условия:

2 =V1 ⊕W1 =V0 ⊕W0 ⊕W1 = а) их  объединение включает все сигналы из L2 :
= =V−2 ⊕W−2 ⊕W−1 ⊕W0 ⊕W1.

Или в общем виде ∪Vj = L2 ,  или V∞ = L2 ;
j∈Z

VJ =VJ −1 ⊕WJ −1 =Vj ⊕W
0 j ⊕W

0 j0 −1 ⊕ ⊕ б) пересечение образует пустое множество
⊕Wj ⊕…⊕WJ −2 ⊕WJ −1, (4) ∩Vj ={0}  или V−∞ ={0} ;

где J  называют самым тонким, а j j∈Z
0  — самым

грубым значениями масштаба. Подпространство в) справедливо соотношение масштабируемо-
W сти

j−1  называют ортогональным дополнением под-
пространства Vj−1  до Vj . Это означает, что f (t )∈Vj ⇔ f (2t )∈Vj+1 ;

Vj  ⊥ Wj  при всех j∈Z . г) найдется такая функция ϕ ∈V0 , которую
называют масштабирующей функцией (scaling

Из выражения (4) следует, что любой сигнал из function), что множество ее сдвигов ϕ (t − k )  об-
VJ , например порожденный каким-либо изобра-
жением, можно рассматривать по частям: сначала разует базис Рисса или ортонормированный базис
его общий вид, содержащийся в низкочастотной подпространства V0 .
части спектра Vj , затем — добавив крупные дета- Поясним некоторые положения этого опреде-

0

ли, содержащиеся в Wj , затем — все более мел- ления. Свойства а) и б) означают, что для любой
0

кие детали по мере расширения спектра добавле- функции x∈L2  найдется такое подпространство
нием деталей, содержащихся в Wj . Именно по- VJ , что ее проекция на это подпространство обра-
этому такой анализ сигнала получил название "ма- зует сколь угодно малую ошибку приближения.
тематического микроскопа". Свойство в), по мнению И. Добеши [7], считается

Заметим, что двукратное разбиение спектраль- основной причиной, позволившей ввести термин
ных поддиапазонов — не единственный способ кратномасштабность: оно означает (совместно
построения цепочки (3), хотя и весьма удобный со свойством (3)), что если x(t )∈Vj , то одновре-
для формирования теории и создания простых вы- менно x(t )∈Vj+1 , но в Vj+1  входит еще и масшта-
числительных алгоритмов [6]. В отличие от пре-
образования Фурье неравномерное разбиение час- бируемая версия x(t ) , а именно x(2t )∈Vj+1 , что
тотной шкалы имеет определенный физический порождает масштабирующее уравнение, рассмат-
смысл: сигналы небольшой продолжительности риваемое ниже. Свойство г) совместно с в) означа-

НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2006, том 16, № 1



6 Л. В. НОВИКОВ

ет, что для любого Vj  существует ортонормиро- штабирующую функцию ϕ (t ),  т. к. ее Фурье-
ванный базис образ можно получить из выражения (6а) последо-

вательной подстановкой в эту формулу выраже-
ϕ (t ) 2 2 t 2− j

j  − 
, = k 

 j k ϕ   .
 2− j ний для ϕ ω  ω 
    ϕ

  , 
  4  , ϕ ω    .

2   и т  
 8  д. [7].


Причем для подпространства V0  этот базис будет Учитывая, что  ϕ j ,k (t )∈Vj ⊂Vj+1 , масштаби-
иметь вид рующее уравнение (5) для произвольного значения

масштаба можно представить в виде
ϕ0,k (t ) =ϕ (t − k ) .

В дальнейшем будем пользоваться также обозна- ϕ (2 j t − k ) =∑h(n) 2ϕ (2(2 j t − k )−n) =
n

чениями
=∑h(n) 2ϕ (2 j+1t − (2k + n)),

ϕ ( ) = 2
j , t 2 j ϕ (2 j

k t − k ) =ϕ j ( t − 2− j k ) . n

которое после замены переменных 2k + n = m  ста-
Масштабирующее уравнение. Из определения новится

КМА следует, что простым масштабированием
и сдвигами одной функции ϕ (t )  можно построить ϕ (2 j t − k ) =∑h(m − 2k ) 2ϕ (2 j+1t −m) ,

m
базисы для всех подпространств Vj . Однако КМА или
накладывает на сами функции ϕ (t )  определенные ϕ
и достаточно жесткие требования:  поскольку j ,k (t ) =∑h(m − 2k )ϕ j+1,m (t ) . (7а)

m
ϕ ∈V0   и V0 ⊂V1 , то функция ϕ (t )  является ли- Выполнив преобразование Фурье, получим
нейной комбинацией функций ϕ1,n (t ) :

ϕ ( ) = (2 j 1
j ω h − − ω )ϕ j+1 (ω ) , (7б)

ϕ (t ) =∑h(n )ϕ1,n (t ) =∑h(n) 2ϕ (2t − n) , (5)
n∈Z n∈Z где

которая называется масштабирующим уравнением ϕ
(scaling equation, two-scale equation, refinement j (ω ) = 2− j 2ϕ (2− jω) .
equation). Этому уравнению должны удовлетво- Отметим, что
рять все масштабирующие функции КМА. Коэф-
фициенты h(n)  называются масштабирующими. ( ) = ( ) iω 2 j

ϕ k
j ,k ω ϕ j ω e− −

. (7в)
Они используются в качестве импульсных откли-
ков  в блоках (банках) фильтров, реализующих Из (7а), умножив слева и справа скалярно на
быстрые вычислительные алгоритмы дискретных функцию ϕ j ,n ( t ) , получим
вейвлетных преобразований (digital wavelet trans-
form, DWT) — ДВП. h(n − 2k ) = 2 j 2ϕ (2 j t − k ),ϕ (2 j+1t − n) =

В образах Фурье уравнение (5) имеет вид:
= 2ϕ (t ),ϕ (2t − (n − 2k )) .   (8)

ϕ (ω ) = 1 ∑h −i n 2  
2 n e ω ϕ ω

n  2  = Вейвлетные функции. Базисом для подпро-
странства вейвлетов Wj  являются сдвиги и мас-

= m ω 
 ϕ ω 

0    а
  , (6 )

2 2  штабирование одной вейвлетной функции ψ (t )
где

  − j

ψ , (t ) = 2 j 2ψ t − 2 k 
j k  − j ,

m (ω ) = 1 ∑h e−i n ω
0 2 n =   2 

n j∈Z , k∈N.
= 1 h (ω ).

2 (6б) В дальнейшем будем пользоваться также обозна-
чениями

Функция m0 (ω )  полностью определяет мас- ψ ( ) 2
j , t = 2 j ψ (2 j

k t − k ) =ψ j ( t − 2− j k ) .

НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2006, том 16, № 1



МОДИФИЦИРОВАННЫЕ  ВЕЙВЛЕТЫ... 7

Так как W0 ∈V1 , то функция ψ (t )  может быть ψ j ,k (t ) =∑ g (m − 2k )ϕ j+1,m (t ) . (10а)
представлена в виде взвешенной суммы масшта- m

бирующих функций ϕ (2t ) Выполнив преобразование Фурье, получим

ψ (t ) =∑ g (n)ϕ (2t − n ) , (9) ψ ( ) = (2 j 1
j ω g − − ω )ϕ j+1 (ω ) , (10б)

n
где

где
ψ

g = (−1)1−n
n h(1− n) , j (ω ) = 2− j 2ψ (2− jω) .

или в образах Фурье Отметим, что

( ) = ( )e iω 2− j
ψ k

j ,k ω ψ −
j ω . (10в)

ψ (ω) = 1 ∑ g (n)e−i nω 2ϕ ω = m ω ϕ ω 
2  ,

n  2  1  2   2  Из (10а), умножив слева и справа скалярно на
где функцию 2 j 2ϕ (2 j+1 t − n) , получим

m1 (ω ) =
1 ∑ g (n)e−i nω = 1 g (ω ) = g (n − 2k ) = 2 j 2ψ (2 j t − k ),ϕ (2 j+1t − n) =
2 n 2

= eiω 2 m = ψ ϕ − − k   (11)
0 (ω +π ). 2 (t ), (2t (n 2 )) .

Учитывая, что ψ j ,k (t )∈Wj ⊂Vj+1 , выражение Анализ сигнала. Из (4) следует, что для любой
(9) для произвольного значения масштаба можно
представить в виде функции x(t )∈VJ

J
ψ (2 j t − k ) =∑ g (m − 2k ) 2ϕ (2 j+1t −m) , x(t ) =∑c j (k )ϕ j ,k (t ) + ∑∑d j (k )ψ j ,k (t ) ,

n 0 0
k j= j0 k

или где  c j (k )   и  d j (k )  — коэффициенты разложения

h(−n) h(−n) h(−n)
y(n) cJ −1 cJ −2 c c h(−n)

J −3 j0 +1 c j0

g (−n) g (−n) g (−n) g(−n)
dJ −1 dJ −2 dJ −3 d

а j0

h(n) h(n) h(n) h(n)
cJ −1 c cJ −3 c j c

J −2 0 +1 j0

g (n) g (n) g (n) cJ −1

б
d d dJ −3 d

J −1 J −2 j0

Рис. 3. Схемы 4-ступенчатых анализирующего (а) и синтезирующего (б) блоков фильтров.
h  и g  — коэффициенты низкочастотного и высокочастотного фильтров вейвлетов

НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2006, том 16, № 1



8 Л. В. НОВИКОВ

сигнала по базисным функциям ϕ j ,k (t )  и ψ обычного цифрового фильтра, дополненного еще
j ,k (t )

соответственно одним устройством, называемым дециматором,
или прореживателем (down-sampling). Напомним,

c что цифровой фильтр (как и любой линейный
j (k ) = x,ϕ j ,k , фильтр) осуществляет свертку входной последова-

d j (k ) = x,ψ j ,k . тельности x(n)  с импульсным откликом фильтра
Умножив выражение (7а) скалярно слева и (обозначим его как h (n) )

справа на x(t ) , получим: N−1
y (k ) =∑ h (k − n)x(n) . (14)

c n=0
j (k ) =∑h(m − 2k )c j+1 (k ) . (12а)

m Для того чтобы этот фильтр осуществлял тре-
Аналогично, умножив выражение (10а) скаляр- буемую в соответствии с (12) свертку, необходимо

но слева и справа на x(t ) , получим: инвертировать порядок коэффициентов h(n) , т. е.
положить h (k ) = h(−k ) . Тогда будем иметь под

d j (k ) =∑ g (m − 2k )c j+1 (k ) . (12б)
m знаком суммы в (14) h (k − n) = h(n − k ) , что тре-

Формулы (12) являются рекурсивными алго- буется на первом этапе вычислений. Далее в соот-
ритмами анализа сигнала "от тонкого к грубому ветствии с формулами (12) необходимо убрать из
разрешению", т. к. каждые последующие коэффи- выходной последовательности фильтра те отсче-
циенты вычисляются из предыдущих с бóльшим ты, которые имеют нечетные индексы, сохранив
масштабным индексом, характеризующим более только четные, осуществив, таким образом, с по-
широкополосный процесс [7]. Вычислительная мощью устройства, называемого дециматором,
схема алгоритма приведена на рис. 3, а. Она реа- операцию понижения числа отсчетов вдвое (down-
лизуется с помощью многокаскадного блока по- sampling). В результате получим, что для реализа-
следовательно соединенных фильтров, обеспечи- ции алгоритмов (12) необходим блок фильтров,
вающих быстрые вычисления ДВП.  Начальные, содержащий высокочастотный и низкочастотный
значения коэффициентов c j (k )  вычисляются при каналы, как показано на рис. 4. Чтобы осущест-

вить многомасштабный (мультиразрешающий)
таком значении масштаба J , когда в пределах анализ необходимо применить многокаскадный
спектрального диапазона сигнала x (ω )  функция блок фильтров, построенный по схеме рис. 3, а.
ϕ J (ω )  остается практически постоянной (базис- Синтез (восстановление сигнала по коэффици-
ная функция по отношению к x(t )  имеет вид ентам вейвлет-разложения). Получим далее ре-

курсивные формулы для восстановления функции
δ-функции ). При этом значении масштаба  коэф-
фициенты cJ (k )  можно положить равными отсче-
там функции

x(t ) x( J
− J = k2− ) = c (k . (13)

t=k 2 J )
Действительно,

cJ (k ) = ∫ x(t )ϕ J ,k (t )dt =
1 x (ω )ϕ ( ) −i 2− J

= k
J ω e ω dω ≈

2π ∫ Рис. 4. Однокаскадный блок фильтров анализа,
ϕ J (0) x ( ) реализующий рекурсивную процедуру вычис-

e−iω 2− J
≈ ∫ ω k dω = const ⋅ x(k 2−J ),

2π ления вейвлет-коэффициентов сигнала.
h(−n)  и g (−n)  — низкочастотный и высоко-

что при соответствующей нормировке обеспечи- частотный фильтры с обратной последователь-
вает выполнение равенства (13). ностью коэффициентов масштабирующих

На практике вычисление c j (k )  и d j (k )  по уравнений для ϕ  и ψ ;  2 — дециматор, уда-
формулам (12а, 12б) осуществляется с помощью ляющий  вейвлет-коэффициенты с нечетными

индексами на выходах фильтров

НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2006, том 16, № 1



МОДИФИЦИРОВАННЫЕ  ВЕЙВЛЕТЫ... 9

x(t )  (точнее, ее отсчетов  x(n) ) по коэффициен-
там вейвлет-разложения c j (k )  и d j (k ) . Учиты-
вая, что Vj+1 =Vj ⊕Wj  базисную функцию
ϕ j+1,k (t )∈Vj+1  можно представить как

ϕ j+1,m (t ) =∑ ϕ j+1,m ,ϕ j ,k ϕ j ,k (t )+
k

+∑ ϕ j+1,m ,ψ j ,k ψ j ,k (t ).
k

С учетом формул для скалярных произведений
под знаком суммы (8) и (11) получим Рис. 5. Однокаскадный блок фильтров синтеза,

реализующий рекурсивную процедуру вычисления
ϕ j+1,m (t ) =∑h(m − 2k )ϕ j ,k (t )+

вейвлет-коэффициентов сигнала.
2 — интерполятор, прореживающий вейвлет-ко-

k эффициенты нулями на входах фильтров
+∑ g (m − 2k )ψ j ,k (t ). (15)

k

Умножив далее выражение (15) скалярно слева
и справа на x(t ) , получим рекурсивное соотноше- 3. СИНТЕЗ МОДИФИЦИРОВАННЫХ

ВЕЙВЛЕТОВ
ние для вычисления коэффициентов вейвлет-раз-
ложения "тонкого" масштаба j +1 как взвешенной Чтобы построить КМА для решения задач
суммы c j (k )  и d j (k )  более "грубого" масштаба j : оценки сигнала, искаженного аппаратной функци-

ей и шумом,  и/или его линейных преобразований,
c j+1 (m) =∑h(m − 2k )c j (k )+

необходимо синтезировать базисные функции со-
ответствующих подпространств, ориентировав их

k на решение требуемой задачи. Теоретически этот
+∑ g (m − 2k )c j (k ). (16) синтез выполняется путем модификации извест-

k ных вейвлетов, имеющих компактный носитель в
Вычислительная схема восстановления перво- частотной области, в частности вейвлетов Мейера,

начальных отсчетов сигнала по коэффициентам с помощью вещественной функции G (t )∈L2 , дос-
его вейвлет-разложения показана на рис. 3, б. Что-
бы выполнить вычисления по формуле (16) с по- таточно быстро затухающей при  t →∞ . Практи-
мощью цифровых фильтров, осуществляющих чески в качестве вейвлетов-"прародителей" могут
свертку коэффициентов h  и g  с отсчетами c j (k ) , быть выбраны вейвлеты Добеши высоких поряд-

ков, характеризующиеся плоской частотной ха-
необходимо эти фильтры  дополнить еще одним рактеристикой в области пропускания и хорошей
устройством, называемым интерполятором. Он крутизной фронтов в области затухания.
осуществляет повышение числа отсчетов вдвое
(up-sampling) путем прореживания их нулями: все Свертка функции G (t )  с наблюдаемым сигна-
отсчеты с нечетными индексами на выходе интер- лом y (t )  дает требуемую оценку
полятора оказываются равными нулю. Тогда
свертка коэффициентов фильтров h  и g  благода- x (t ) = ∫G (t −τ ) y (τ ) dτ , (17а)
ря двойному сдвигу 2k  в формуле (16) будет осу-
ществляться со всеми значащими отсчетами c j (k ) или в образах Фурье

и d j (k ) . Схема одного каскада блока фильтров x (ω ) =G (ω ) y(ω ) . (17б)
для восстановления (синтеза) сигнала по его ко- Представим выражение (1а) в образах Фурье:
эффициентам разложения показана на рис. 5. Что-
бы осуществить полное восстановление отсчетов y (ω ) = H (ω )x (ω )+ u (ω ) .
сигнала, необходимо применить многокаскадный
блок фильтров, построенный по схеме рис. 3, б. Подставляя это равенство в (17б), получим

Многокаскадные блоки фильтров являются по
существу техническими средствами, реализую- x (ω ) =G (ω )H (ω )x (ω )+G (ω )u (ω ) .
щими разбиение сигнала на компоненты соответ-
ствующих подпространств. В частности, если выбрано G (ω ) ≡ H −1 (ω ) , имеем

НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2006, том 16, № 1



10 Л. В. НОВИКОВ

оценку полезного сигнала в виде η k (ω) =G−1
j , (ω)ψ j ,k (ω) =

x (ω ) = x (ω )+ H −1 (ω )u (ω ) . =G−1 (ω)ψ (ω)2−iω 2− j k
j , (19б)

При отсутствии шума решение дает точное и выполним обратное преобразование Фурье
восстановление сигнала, искаженного аппаратной
функцией. При наличии шума имеет место его y (ω ) , получим
бесконечное усиление, в особенности на тех час- ∞
тотах, где H (ω ) ≈ 0 , что и приводит к необходи- y (t ) = ∑ c j (k )θ ( )

0 j0 ,k t +
мости исследования вейвлетных подходов для по- k=−∞

давления шума. J ∞
+ ∑ ∑ d j (k )η j , k (t ). (20)

Решение задачи получения оценки полезного
j= j0 k=−∞

сигнала x(t )  с использованием вейвлетных пре-
образований ищем в виде: Предположим, что существуют двойственные

функции θ j ,k (t )  и η j ,k (t )  такие, что
x (t ) =∑c j (k )ϕ (t )+

0 j0 ,k
k θ j ,k (ω) =G (ω)ϕ j ,k (ω) =J

+ ∑∑d j (k )ψ j ,k (t ), (18) G ( ) ( iω 2− j
= ω ϕ k

j ω)e− (21а)
j= j0 k

где ϕ j ( )
0 , t , ψ j , (t )  — модифицируемые вейвле- и

k k

ты; c j (k)  и d j (k)  — коэффициенты вейвлет-раз- η j ,k (ω) =G (ω)ψ j ,k (ω) =0

ложения сигнала y (t ) . − −
=G (ω)ψ j (ω)2 iω 2 j k. (21б)

Для того чтобы найти оценку x (t ),  необходи-
мо определить коэффициенты c j (k)  и d

0 j (k)  по Легко проверить, что функции  θ j ,k (t )  и θ j ,k (t )
биортогональны по отношению к собственным

наблюдаемому сигналу y (t ). сдвигам, а функции η
Выполним преобразование Фурье (18): j ,k (t )  и η j ,k (t )  биортого-

нальны по отношению к сдвигам и масштабу.
∞ Кроме того,  биортогональными являются  функ-

x (ω) =ϕ j (ω) c ( ) exp( 2 j0
0 ∑ j k −iω − k

0 )+ ции θ j ,k (t )  и η j ,k (t ) , а также θ j ,k (t )  и η j ,k (t ) .
k=−∞

J ∞ Для того чтобы равенство (20) было справедли-
+ ∑ ψ j (ω)∑ d j (k ) exp(−iω2− j k ), вым, необходимо, чтобы функции θ  и η , а также

j= j0 k=−∞ θ  и η  являлись базисом соответствующих под-
где пространств КМА. Заметим, что преобразования

j
− 0 − j

ϕ j (ω ) = 2 2 ϕ
0 (2− j0ω)  и  ψ j (ω ) = 2 2ψ (2− jω) (19а, 19б) и (21а, 21б) осуществляют линейное

. отображение подпространств КМА Vj  и Wj  в но-
Умножим последнее выражение слева и справа вые подпространства, как показано ниже:

на функцию G−1 (ω ) , получим V G−1
j → U j ,

∞
y (ω) =G−1 (ω)ϕ j (ω)∑ c j (k ) exp(−iωk )+ V G

j → U j ,
0 0

k=−∞
J ∞ W G−1

+ ∑G−1 (ω)ψ j (ω)∑ d j (k ) exp(−iωk ). j → M j ,
j= j0 k=−∞

W G
j → M j .

Введем функции θ j ,k (t ) =θ j (t − 2− j k )  и
η j ,k (t ) =η j (t − 2− j k )  ( j,k∈Ζ)  такие, что Следовательно, функции θ  и θ  являются образами

масштабирующей функции ϕ  в подпространствах
θ ( ) 1

j ,k ω =G− (ω)ϕ j ,k (ω) = U j  и  U , а функции η  и η  — образами  вейвлет-
j

−1 ( ) ( ) i ω 2− j
=G ω ϕ k

j ω e− , (19а) ной  функции  ψ  в  подпространствах M j  и  M j .

НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2006, том 16, № 1



МОДИФИЦИРОВАННЫЕ  ВЕЙВЛЕТЫ... 11

                               а                                                                             г

                             б                                                                                 д

                             в                                                                                   е
Рис. 6. Синтез модифицированных вейвлетов при двух значениях масштаба j = 0  (а, б, в) и j = −4  (г, д, е):
1 и 4 — g (ω ),  2 — G (ω),  3 — h (ω)

НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2006, том 16, № 1



12 Л. В. НОВИКОВ

Согласно  требованию г) определения КМА, сдвиги ϕ
этих функций должны образовывать базис Рисса (t ) = 2 j 2 (2 j

j ϕ t ) . Несмотря на это, как будет по-
в соответствующих  подпространствах. Следуя ра- казано ниже, анализ сигналов с использованием
боте [8], можно показать, что функции θ  формиру- модифицированных вейвлетов может осуществ-
ют базис Рисса подпространства U ляться с помощью быстрых вычислительных алго-

j , функции θ  — ритмов.
базис Рисса подпространства U j , функции η  — Для "всепропускающих" фильтров G (ω) = const
базис Рисса подпространства M j  и функции η  — функции θ ,θ ,η  и η  вырождаются в соответст-
базис Рисса подпространства M j . Более того, вующие функции-"прародители" ϕ  и ψ .
функции η  и η  порождают две цепочки КМА:

⊂U−2 ⊂U−1 ⊂U0 ⊂U1 ⊂U 4. МАСШТАБИРУЮЩИЕ УРАВНЕНИЯ
2 ⊂ МОДИФИЦИРОВАННЫХ ВЕЙВЛЕТОВ

и
⊂U−2 ⊂U−1 ⊂U0 ⊂U1 ⊂U2 ⊂ , Чтобы определить коэффициенты c j (k )  и

которые в свою очередь порождают вейвлетные d j (k ),  умножим скалярно слева и справа выраже-
подпространства  {M j}  и {M j } . При этом спра- ние (20) на двойственные базисные функции
ведливы следующие соотношения биортогональ- θ j ,k (t ) , η j ,k (t )  и с учетом биортогональности
ности (22а) получим:
U j ⊥U j ; U j ⊥ M j ; U j ⊥ M j ; M j ⊥ M j (22а) c j (k ) = ∫ y (t )θ j k (t ) t

0 0 , d , (23а)
и вложенности d j (k ) = ∫ y (t )η j ,k (t )dt . (23б)

Vj−1 ⊂U j ⊂Vj+1 ; Vj−1 ⊂U j ⊂Vj+1 . (22б)
Так же как и в случае традиционного КМА, бы-

В результате имеет место соотношение стрые вычислительные алгоритмы синтезируются
L2 (R) =U j ⊕ M

0 j ⊕ M на основе масштабирующих уравнений, которые
0 j +1 ⊕ ...⊕ M j ⊕ ...⊕ M

0 J , и
равенство (20) оказывается справедливым. будут получены ниже.

На рис. 6 показан пример построения модифи- Так как подпространства {U j}  формируют
цированных вейвлетов для некоторой типовой КМА и θ
функции G (ω )  при двух значениях масштабов j+1 ∈U j+1 =U j ⊕ M j , то базисные функ-

j = 0  и j = −4 . Как следует из рис. 6, д, е, уже при ции θ j  и η j  аналогично масштабирующим урав-
значении масштаба  j = −4  форма масштабирую- нениям (7а) и (10а) могут быть выражены в виде
щей и вейвлетной функций близки к соответст- линейной комбинации θ j+1 . Для функции θ j  име-
вующим функциям-"прародителям". ем

Таким образом, вейвлеты, модифицированные
импульсным откликом линейной системы: θ j ,k (t ) =∑ θ j ,k ,θ j+1,n θ j+1,n (t ) .

– образуют биортогональную систему базис- n

ных функций, формирующих кратномасштабный Определим скалярное произведение под знаком
анализ сигналов в L2 (R) ; суммы:

– позволяют получить линейную оценку полез-
ного сигнала;

– нестационарны по отношению к масштабу. θ θ θ ( − j )θ ( − j−1
j ,k , j+1,n = ∫ j t − 2 k j+1 t − 2 n)dt =

Последнее вытекает из (19а, 19б) и (21а, 21б), т. к.
i − j k i − j

в зависимости от j  изменяется носитель функций- −
= 1

∫θ (ω)e− ω 2 θ (ω)e ω 2 1 n
j j+1 dω =

"прародителей" ϕ j (ω )  и ψ j (ω )  и соответственно 2π
1 j i − j−

интервал охватываемого ими частотного поддиа- = ∫ ϕ (2− ω)ϕ (ω)e ω 2 1(n−2k )
j+1 dω =

пазона функции G (ω ) . Следовательно, при каж- 2π
1 1 i ω n k

дом значении масштаба функция, например θ j (t ), = ϕ (ω)ϕ ω  ( −2 )
∫  e 2 dω =

2π 2 2
уже не является результатом растяжения/сжатия од- 
ной функции, как в случае традиционного КМА — = ∫ϕ (t ) 2ϕ (2t − (n − 2k ))dt = h(n − 2k ).

НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2006, том 16, № 1



МОДИФИЦИРОВАННЫЕ  ВЕЙВЛЕТЫ... 13

Следовательно, Аналогично для функции η j ,k (t ) :
θ j ,k (t ) =∑h(n − 2k )θ j+1,n (t ) , (24а) η

n j ,k (t ) =∑ g (n − 2k )θ j+1,n (t ) , (28а)
n

или или
θ j (ω ) = h (2− j−1ω)θ j+1 (ω ) , (24б) η j (ω ) = g (2− j−1ω)θ j+1 (ω ) . (28б)

где θ j (ω )  определяется из (21а). Из (28а), умножив скалярно слева и справа на
Аналогично для функции θ j ,k (t )  получим: функцию θ j+1,m (t ) , с учетом биортогональности

получим
θ j ,k (t ) =∑h(n − 2k )θ j+1,n (t ) , (25а)

n g (m − 2k ) = θ j+1,m ,η j ,k . (29)
или Справедливость уравнений (24а, 24б), (25а, 25б),

θ (27а, 27б) и (28а, 28б) легко проверить, подставив
j (ω ) = h (2− j−1ω)θ j+1 (ω ) , (25б)

в них вместо функций θ ,θ ,η  и η  их выражения
где θ j (ω )  определяется из (19а). из (19а, 19б) и (21а, 21б) и сравнив результаты со-

ответственно с (7а) и (10а).
Из (25а), умножив скалярно слева и справа на В соответствии с соотношением (22б) для

функцию θ j+1,m (t )  с учетом биортогональности, функций θ  и η  можно получить масштабирую-
получим щие уравнения несколько иного вида, которые по-

требуются в дальнейшем. Так как
h(m − 2k ) = θ j+1,m ,θ j ,k . (26) U j ⊂Vj+1, θ j ∈U j  и ϕ j+1 ∈Vj+1 , то существует та-

Далее построим масштабирующее уравнение, кая 2 j+1 2π -периодическая функция α j+1 (ω ) , что
которому должна удовлетворять вейвлетная функ-
ция  η j ,k (t ) θ j (ω ) =α j+1 (ω )ϕ j+1 (ω ) . (30)

η j ,k (t ) =∑ η j ,k ,θ j+1,n θ j+1,n (t ) . Выполним обратное преобразование Фурье вы-
n ражения (30). Так как

Определим скалярное произведение под знаком j+1
суммы: ( ) = ( ) −i 2− j−1

θ ω  α n n −
∑ j e ω  2 2 ϕ (2− j−1

j  +1 )
  ω ,

η , , 1 n 
( ) −iω 2− j k ( ) iω 2− j−1 n

j k θ j+1,n = η
π j ω e θ j 1 ω e dω

2 ∫ + = имеем
− j+1 − j−1 j+1

1 ( ) ( ) iω 2− j−1
= ψ ω ϕ ω (n−2k )

j j 1 e dω
2π ∫ + = θ (t ) = α 1 (n)2 2 ϕ (2− j−1 )ei 2 ω (2 t−n

j ∑ j+ ∫ ω ) dω.
n

После замены переменной ω 1
1 = 2− j−

1 1 ω
( − j ) ( − −

= ψ ω ϕ 2− j−1ω)eiω 2 j 1
2 (n−2k ) dω

2π ∫ 2 j+1 1

(t ) = 1 (n) 2 2 ( ) iω j+

θ ∑α ϕ 1 (2 t−n)
j j+ ∫ ω1 e dω1 =

= 1 1
∫ ( ) i (n 2k )

ϕ ω  ω −
ψ ω  e 2 dω = n

2π 2 2  j+1
=∑α j 1 (n)2 2 ϕ (2 j+1

= ∫ψ (t ) 2ϕ (2t − (n − 2k ))dt = g (n − 2k ) + t − n
. )

n

Следовательно, и окончательно:

θ (t ) =∑α ( ϕ ( − j−1
η j ,k (t ) =∑ g (n − 2k )θ j+1,n (t ) , (27а) j j+1 n) j+1 t − 2 n) =

n
n

или =∑α j+1 (n)ϕ j+1,n (t ) . (31)
n

η j (ω ) = g (2− j−1ω)θ j+1 (ω ) . (27б) Для произвольного значения сдвига k  формула
(31) имеет вид

НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2006, том 16, № 1



14 Л. В. НОВИКОВ

j+1 ЗАКЛЮЧЕНИЕ
θ j ,k (t ) =∑α j+1 (n)2 2 ϕ (2 j+1t − 2k − n) ,

n Показано, что вейвлеты с компактным носите-
а после замены переменных m = 2k + n  становится лем в частотной области могут быть модифициро-

ваны с помощью некоторой непрерывной функции
θ j ,k (t ) =∑α j+1 (m − 2k )ϕ j+1,m (t ) . (32) G (t ) . Порожденные этой модификацией новые

m масштабирующие и вейвлетные функции биорто-
Получим формулу для вычисления α гональны и формируют КМА из двух цепочек

j+1 (n) . подпространств. Получены два вида масштаби-
Имеем в соответствии с (21а, 21б) с учетом (7б): рующих  уравнений и выражения для вычисления

масштабирующих и вейвлетных коэффициентов
θ ( ) ( ) (2 j 1

j ω =G ω h − − ω )ϕ j+1 (ω ) , этих уравнений. Новые вейвлеты нестационарны
по отношению к масштабу, т. е. они не являются

где произведение первых двух членов образует результатом сдвига и масштабирования одной
2 j+1 2π -периодическую функцию. Следовательно, масштабирующей и вейвлетной функций, тем не

менее, как будет показано в дальнейшем, такие
α ( ) ( ) ( 1

1 ω ω 2 j
j =G h − −
+ ω ) (33а) вейвлеты могут эффективно применяться в обра-

и ботке сигналов.

α j+1 (n) = СПИСОК ЛИТЕРАТУРЫ
1 2 j+1π

− − −

1 G (ω )h ( j−1ω)ei 2 j 1
= ω n

j+ ∫ 2 dω. (33б) 1. Barclay V.J., Bonner R.F. Application of wavelet
2 2π −2 j+1π transforms to experimental spectra: smoothing,

denoising, and data set compression //Anal. Chem.
Аналогично (30) для функции η j (t )  будем 1994. V. 69. P. 78–90.

иметь 2. Меркушева А.В. Классы преобразований не-
стационарного сигнала в информационно-

η измерительных системах. III. Время-
j (ω ) = β j+1 (ω )ϕ j+1 (ω ) (34)

масштабные (вейвлет-) преобразования для
и, следовательно, спектрально-временного анализа // Научное

приборостроение. 2002. Т. 12, № 3. С. 68–81.
η (t ) = β j

j+1 (n)ϕ j (t 2− −1
j ∑ +1 − n) = 3. Shao X.-G., Leung A.K.-M., Chau F.-T. Wavelet: a

n new trend in chemistry // Accounts of Chemical
=∑β Research. 2003. V. 36, N 4. P. 276–283.

j+1 (n)ϕ j+1,n (t ) . (35)
n 4. Donoho D., Johnstoune I. Ideal spatial adaptation

Аналогично (32) имеем via wavelet shrinkage // Biometrika. 1994. V. 81.
P. 425–455.

η 5. Mallat S. A wavelet tour of signal processing.
j ,k (t ) =∑β j+1 (m − 2k )ϕ j+1,m (t ) . (36) Academic Press, 2000. 637 p.

m 6. Burrus C.S., Gopinath R.A., Haitao Guo. Intro-
Получим формулу для вычисления β j+1 (n) . duction to wavelets and wavelet transform. Pren-

Имеем в соответствии с (21б) с учетом (10б) tice Hall, 1997. 268 p.
7. Добеши И. Десять лекций по вейвлетам. М.:

η ω = = 2− j−1
j ( ) G (ω )ψ j (ω ) G (ω )g ( ω )ϕ РХД, 2002. 464 c.

j+1 (ω ) ,
8. Zhang J., Walter G. A wavelet-based KL-like ex-

где произведение первых двух членов образует pansion for wide-sense stationary random proc-
2 j+1 2π -периодическую функцию. Следовательно, esses // IEEE Transaction on Signal Processing.

1994. V. 42, N 7. P. 1737–1745.
β ( ) ( ) ( 1

1 ω ω 2 j
j =G g − −
+ ω ) (37а)

и
β j+1 (n) =

Институт аналитического приборостроения РАН,
Санкт-Петербург

1 2 j+1π
− − −

1 G (ω )g
2 ( j−1ω)ei 2 j 1

= ω n
j 2 dω.

2 + π ∫ (37б) Материал поступил в редакцию 7.07.2005.
−2 j+1π

НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2006, том 16, № 1



МОДИФИЦИРОВАННЫЕ  ВЕЙВЛЕТЫ... 15

MODIFIED  WAVELETS  IN  DATA  PROCESSING
FOR  ANALYTICAL  INSTRUMENTS.

I. BASIC  THEORY
L. V. Novikov

Institute for Analytical Instrumentation RAS, Saint-Petersburg

The theory and practice of wavelet transform based experimental data processing are considered. The mul-
tiscale analysis is treated here as broadening band signal spectral analysis. Filter banks implementing fast com-
putational algorithms are constructed, and a class of non-stationary wavelets obtained by modification of known
orthonormal wavelets by the instrument apparatus function is studied.

НАУЧНОЕ ПРИБОРОСТРОЕНИЕ, 2006, том 16, № 1