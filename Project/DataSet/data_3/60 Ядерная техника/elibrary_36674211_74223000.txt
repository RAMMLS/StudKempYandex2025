И з в е с т и я в у з о в • Я д е р н а я э н е р г е т и к а • № 1 • 2 0 1 8

УДК 621.039.31.17                                                                               DOI 10.26583/npe.2018.1.05

РОКОКО – СИСТЕМА
КОНСТАНТНОГО ОБЕСПЕЧЕНИЯ
РАСЧЕТА РЕАКТОРОВ МЕТОДОМ
МОНТЕ-КАРЛО
Г.М. Жердев, Т.С. Кислицина, М.Н. Николаев
АО «ГНЦ РФФЭИ им. А.И. Лейпунского»
249033 Россия, Калужская обл., г. Обнинск, пл. Бондаренко, 1

Система РОКОКО [1] предназначена для константного обеспечения рас
четов методом МонтеКарло как нейтронных полей, так и порождаемых
ими полей гаммаизлучения. Исходной базой ядерных данных, исполь
зуемых в системе, является российская национальная библиотека оце
ненных нейтронных данных РОСФОНД10 [2 – 4]. Особенность системы
состоит в том, что расчетчику предоставляется возможность оптимизи
ровать степень детальности описания энергетических зависимостей
нейтронных сечений: сечения основных топливных, конструкционных
материалов и теплоносителя могут быть описаны так детально, как это
предусмотрено оцененными данными; сечения второстепенных нукли
дов (минорных актинидов, продуктов деления и т.п.) могут описываться
в 299групповом приближении БНАБ [5] с учетом резонансной самоэк
ранировки методом подгрупп или вовсе без учета самоэкранировки.
Энергетическая зависимость гаммаизлучения описывается в 127груп
повом P5приближении [6]. Оптимизация степени детальности позво
ляет существенно сократить время счета без скольнибудь значимого
влияния на результат и его погрешность. При расчете энерговыделения
в нейтронных реакциях и в матрицах образования гаммаквантов при
желании могут быть учтены вклады от распада образующихся в этих
реакциях радионуклидов (с периодом полураспада менее трех лет).
Энергетическая зависимость анизотропии упругого рассеяния описы
вается детально и при групповом или подгрупповом описании сечений
путем задания 33х границ 32х равновероятных интервалов по коси
нусу угла рассеяния. Эффекты термализации при расчете нейтронных
полей учитываются либо в приближении идеального газа, либо с помо
щью 72групповых термализационных матриц, построенных на основе
термализационных файлов, включенных в библиотеку РОСФОНД (в слу
чаях, когда таковые файлы в ней содержатся).
В системе содержатся описания детальных зависимостей сечений и уг
ловых распределений упругого рассеяния на всех многоизотопных
элементах; связь между углом рассеяния и потерей энергии в этом
случае устанавливается с помощью зависящего от энергии эффектив
ного атомного веса. Программные коды написаны на языке ФОРТРАН.
Система легко встраивается в расчетные программы, реализующие
метод МонтеКарло.

Ключевые слова: ядерные данные, расчет полей излучений методом МонтеКарло,
комбинации детального и группового описания энергетической зависимости сечений.

© Г.М. Жердев, Т.С. Кислицина, М.Н. Николаев, 2018
41



ФИЗИКАИТЕХНИКАЯДЕРНЫХРЕАКТОРОВ

ОБЩЕЕ ОПИСАНИЕ
Система РОКОКО (Расчет и Организация КОмбинированных КОнстант) предназначе

на для константного обеспечения расчетов методом МонтеКарло нейтронных и порож
даемых ими фотонных полей в ядерных реакторах. Предусмотрена возможность деталь
ного описания энергетических зависимостей нейтронных сечений (как это делается в
известной программе MCNP [7]). Однако сечения нуклидов, входящих в состав реакто
ра в низкой концентрации, могут описываться и не столь детально – в мультигруппо
вом приближении с учетом резонансной самоэкранировки методом подгрупп или вов
се без учета самоэкранировки. Это, естественно, повышает скорость вычислений, что
существенно при выполнении многовариантных инженерных расчетов. Таким образом,
РОКОКО позволяет пользователю самому определять степень детальности описания
энергетических зависимостей сечений.

Программы комплекса РОКОКО написаны на языке ФОРТРАН. Работоспособность
комплекса проверена при использовании разных версий компиляторов (GNU, LAHEY,
INTEL и др.). Комплекс состоит из трех частей.

Первая часть – комплекс программ COMBINE предназначен для формирования би
нарной библиотеки исходных констант на основе файлов оцененных данных в формате
ENDF6 [4] и групповых констант в формате БНАБ [5]. Пользователями этой части ком
плекса являются разработчики системы. В частности, авторами с помощью комплекса
COMBINE на основе файлов библиотеки РОСФОНД [2 – 4] и групповых констант БНАБ
РФ [6] сформирована версия бинарной библиотеки BIBIN2016. Имеется и версия BIBIN
B7, созданная на основе библиотеки ENDF/BVII. В будущем по мере необходимости могут
быть сформированы и другие версии бинарной библиотеки. Комплекс COMBINE описан
достаточно подробно, так что новые версии могут создаваться и без участия авторов.

Вторая часть используется непосредственно в расчете. Процедурами этого блока
считывается расчетное задание и на его основе формируется оперативная библиотека
для требуемого состава материалов и в формате, удобном для моделирования. В част
ности, матрицы неупругого рассеяния, термализационные, спектров деления представ
ляются в виде накопленных вероятностей процессов. Здесь же формируются подгруп
повые параметры резонансных изотопов для заданных температур и составов, а кон
станты с детальным слежением за энергией нейтрона пересчитываются под заданные
температуры сред. Все эти данные формируются только для изотопов, присутствующих
в среде, и записываются в специальный независящий от вычислительной платформы
обменный файл (имеется в виду бинарный либо текстовый файл универсального фор
мата, одинаково читаемый различными компиляторами и в разных операционных сис
темах, что дает возможность пользователю подготовить библиотеку, например, на офис
ном компьютере, а выполнить вычисления на суперкомпьютере). Процедуры этого бло
ка объединены в автономный исполняемый модульпрограмму COLIBRY [8].

Третья часть предназначена для непосредственного использования в программах
моделирования, реализующих метод МонтеКарло, и состоит из нескольких процедур.
Главная процедура COLIBRY вызывается при выполнении расчета лишь единожды. Она
обращается к обменной библиотеке, подготовленной второй частью комплекса, и раз
мещает их в соответствующих общих массивах, которые доступны всем оперативным
процедурам.

Ниже перечисляются оперативные процедуры. Первая из них – GEFIS имеет параметры
INUC, NGFIS, ig, E и ves (здесь и далее параметры процедур выделяются подчеркивани
ем). Очевидно, что спектр деления определяется тем, при делении какого нуклида INUC
рожден нейтрон и какой энергетической группе NGFIS принадлежал нейтрон, вызвав
ший деление. Процедура на основе этих параметров определяет группу ig и энергию E
нейтрона деления. Параметр ves по умолчанию равен единице. Предусмотрена возмож

42



И з в е с т и я в у з о в • Я д е р н а я э н е р г е т и к а • № 1 • 2 0 1 8

ность искусственно повысить выход нейтронов высоких энергий, и в этом случае пара
метр ves служит для компенсации искажения спектра деления. В первом поколении, когда
INUC и NGFIS еще не определились, принимается, что нейтрон образовался при деле
нии первого нейтрона из списка (заведомо делящегося) под действием нейтронов 50
й группы (в которой все делящиеся изотопы имеют отличные от нуля сечения деления).
Отметим, что имеется расширенная версия этой процедуры, названная GEFISBETA, кото
рая кроме функций, выполняемых процедурой GEFIS, формирует массив vesD, восемь
элементов которого представляют собой вероятности того, что испущенный нейтрон
деления (группы ig c энергией Е) образован в результате распада предшественника
соответствующей группы запаздывающих нейтронов. Процедура GEFISBETA предназна
чена для использования в расчетах эффективных долей запаздывающих нейтронов.

Процедура SIGMA имеет параметры SIGMAC, SABS, SFNU, KERM, E, NG, m. Для нейтро
на с энергией Е, лежащей в группе NG в физической зоне m, она определяет макроско
пическое полное сечение  SIGMAC, SABS – макроскопическое сечение поглощения, «се
чение образования нейтронов деления» SFNU = ν⋅Σf и KERM – значение керма. Энергия
и номер группы передаются между оперативными процедурами автоматически. Для
определения этих величин процедура SIGMA вычисляет сначала микроскопические кон
станты всех изотопов, входящих в состав зоны m для энергии рассматриваемого нейт
рона. Если нейтрон образовался в рассматриваемой зоне, то для энергии этого нейтро
на определяются сечения всех входящих в ее состав нуклидов. Если нейтрон попал в
зону после пересечения ее границы, микроконстанты определяются только для тех нук
лидов, для которых они не были определены в предыдущих зонах на пути пролета ней
трона. Микроконстанты заносятся в общие массивы для дальнейшего использования в
процедуре COLLY и, если потребуется, в процедурах регистрации (не входящих в систе
му РOKOKO). Процедура SIGMA обрабатывает и данные для гаммаквантов, которым при
писываются группы с номерами от 301 до 427 (если расчетным заданием предусмотре
но прослеживание траекторий гаммаквантов, порожденных нейтронами: число гамма
групп указано равным 127).

Процедура COLLY имеет параметры m, NG, E, r, n, etha, NG1, E1, mulab, yi, ngam, ygam.
Для столкновения нейтрона, происшедшего в зоне m, при энергии Е, лежащей в группе
NG, она определяет тип столкновения: r = 1 – упругое рассеяние; r = 2 – неупругое рас
сеяние; r = 3 – поглощение. Определяется также n – номер нуклида, с которым произош
ло столкновение; среднее число вторичных нейтронов деления, образующихся при этом
поглощении, E1 и NG1 – энергия и номер группы рассеянного нейтрона; mulab – коси
нус угла рассеяния в лабораторной системе координат; yi – множественность рассеян
ных нейтронов (превышает единицу при наличии вклада реакций (n, xn) в неупругое
рассеяние); ngam – номер группы гаммакванта, испущенного при неупругом рассеянии
или захвате; ygam – число этих квантов (301 Ј ngam Ј 427).

Таким образом, для подключения системы РОКОКО к программе расчета реакторов
методом МонтеКарло достаточно, чтобы перед решением конкретной задачи в ней вы
зывалась подпрограмма COLIBRY (на вход которой подается лишь файл обменной биб
лиотеки). Затем в начале каждой разыгрываемой траектории должна вызываться про
цедура GEFIS (определяющая энергию и группу нейтрона деления). Процедура SIGMA
вызывается перед прослеживанием трека нейтрона (или фотона), лежащего в пределах
той зоны, в которой рассматриваемый нейтрон или фотон родился в результате того или
иного процесса, или зоны, в которую он попал при пересечении границы. Процедура
COLLY вызывается при рассмотрении каждого столкновения.

Таким образом, процедуры предоставляют вызывающей программе всю информацию,
необходимую для прослеживания нейтронной траектории, а если требуется, то и траек
тории гаммакванта, порожденного в нейтронной реакции. Предоставляются также вели

43



ФИЗИКАИТЕХНИКАЯДЕРНЫХРЕАКТОРОВ

чины, необходимые для оценки коэффициента размножения и энерговыделения по
длинам пробега, по столкновениям и поглощениям. Поскольку для каждого участка
трека нейтрона, лежащего в пределах физической зоны, процедура SIGMA для всех
входящих в ее состав нуклидов определяет микроконстанты, программа, обращающа
яся к РОКОКО, может включить в себя регистрационные процедуры, оценивающие та
кие функционалы, как скорости реакций на изотопах, блокированные мультигруппо
вые константы и пр.

В файле исходных данных для процедур второго блока, входящих в модуль COLIBRY,
указываются

• MZONE – число физических зон (т.е. зон, различающихся составом или температу
рой);

• NIS – полное число нуклидов, входящих в состав хотя бы одной зоны;
• число нейтронных групп БНАБ MGRN ≤ 299 – в группах с номерами, большими 227

(т.е. при энергиях, меньших 4.64 эВ), при расчетах учитывается тепловое движение ато
мов; для отказа от такого учета следует задать меньшее число групп (например, 298);

• число гаммагрупп MGRG, равное либо нулю, либо 127 (как указывалось выше, гамма
квантам приписываются номера групп от 301 до 427);

• NUCLIST – перечень из NIS нуклидов: четырехсимвольные наименования изотопов
и двухсимвольные наименования многоизотопных элементов;

• ID – массив из NIS признаков детальности описания структуры сечений каждого
нуклида: ID = 2 при детальном описании структуры сечений; ID = 1 при использовании
299группового приближения с учетом внутригрупповой структуры сечений методом
подгрупп; ID = 0 – 299групповое приближение без учета резонансной самоэкраниров
ки;

• THERM – массив номеров термализационных матриц системы констант БНАБ (если
этот номер положен равным нулю, то учет термализации будет выполнен в приближе
нии свободного газа);

• TZONE – массив температур физических зон (MZONE значений) (нуклиды с ID = 1
или 2, содержащиеся в зонах с разными температурами, при расчете будут рассматри
ваться как разные нуклиды);

• RO – двумерный массив ядерных концентраций: для каждой зоны должны быть
указаны концентрации всех нуклидов.

Следует отметить, что перечисленные выше ключевые слова параметров задания
могут быть заменены аналогами, принятыми в системе константного обеспечения
CONSYST [9].

ОПИСАНИЕ АЛГОРИТМОВ
При расчетах сечения «детальных» нуклидов вне резонансной области описывают

ся столь детально, насколько они представлены в файлах оцененных данных. В облас
ти разрешенных резонансов используются детальные энергетические зависимости се
чений, рассчитанные для температуры 300 K с помощью модулей RECONR и BROADER
комплекса NJOY [7, 8]. Для зон с температурами выше комнатной детальные сечения
пересчитываются с помощью процедуры DOPPLER, реализующей алгоритм, подобный
используемому в модуле BROADER [8]. В области неразрешенных резонансов структу
ра сечений описывается методом подгрупп. Подгрупповые параметры вычисляются в
программе COLIBRY на основе таблиц факторов резонансной самоэкранировки систе
мы констант БНАБРФ [6]. Энергоугловые распределения нейтронов, испытавших неуп
ругое рассеяние или образовавшихся в результате реакций (n, xn), описываются в 299
групповом приближении с использованием матриц вероятностей и средних косинусов
межгрупповых переходов из системы констант БНАБРФ. Опыт сравнения 299группо

44



И з в е с т и я в у з о в • Я д е р н а я э н е р г е т и к а • № 1 • 2 0 1 8

вых расчетов с расчетами с детальным описанием процессов неупругих взаимодействий
показал, что погрешности не только в коэффициенте размножения, но и в групповых
потоках оказываются меньшими, чем погрешности, обусловленные неточным знанием
сечений этих процессов. Что касается упругого рассеяния, то в расчетах используются
угловые распределения, представленные в форме 33х границ 32x равновероятных
интервалов по косинусу угла рассеяния в системе центра инерции, вычисляемых на
основе исходных файлов с той детальностью по энергии, с которой эти распределения
в них представлены. Для всех изотопов эти угловые распределения были сформирова
ны с помощью модуля ACER [11] комплекса NJOY.

Сечения «подгрупповых» (ID = 1) и групповых (ID = 0) нуклидов описываются в
299групповом приближении БНАБ. При этом для «подгрупповых» нуклидов резо
нансная структура сечений в области как неразрешенных, так и разрешенных резо
нансов описывается с использованием подгрупповых параметров, полученных на ос
нове таблиц факторов самоэкранировки, проинтерполированных к температуре рас
сматриваемой зоны. В области неразрешенных резонансов, где для описания струк
туры сечений, как правило, достаточно двух подгрупп, определение подгрупповых
параметров выполняется по упрощенному алгоритму. В области разрешенных резо
нансов, где двух подгрупп зачастую недостаточно, используется включенная в
COLIBRY универсальная процедура получения подгрупповых параметров на основе
факторов самоэкранировки [12]. Что касается упругого рассеяния, то вне зависи
мости от значения ID используется детальное описание энергетических зависимос
тей границ равновероятных интервалов.

Энергоугловые распределения нейтронов в области термализации описываются либо
в мультигрупповом приближении с использованием термализационных матриц БНАБ
РФ, либо по модели свободного газа с использованием алгоритма, описанного в работе
[13]. Как говорилось, температурная зависимость детальных сечений учитывается с
помощью процедуры DOPPLER, приводящей содержащиеся в BIBIN детальные сечения,
соответствующие комнатной температуре, к температурам, указанным в расчетном за
дании.

Энерговыделение при упругом, неупругом рассеянии, при захвате и при делении рас
считывается с использованием 299групповых констант БНАБ. Детальность энергети
ческой зависимости энерговыделения в пределах каждой группы такая же, как деталь
ность описания сечений. Если в расчетном задании предусмотрен расчет распростра
нения гаммаквантов, образующихся в нейтронных реакциях (MGRG = 127), то исполь
зуются таблицы локального энерговыделения, в противном случае – таблицы полного
энерговыделения, т.е. учитывающие и энергию, уносимую гаммаквантами. И в том, и в
другом случаях в данных по энерговыделению учитывается вклад от распада продук
тов нейтронных реакций (с периодом полураспада до трех лет).

Образование гаммаквантов учитывается для реакций захвата, неупругого рассеяния
и деления. Используются 299127групповые матрицы выходов гаммаквантов из БНАБ
РФ [6]. В этих матрицах учтен и выход гаммаквантов при распаде продуктов соответ
ствующих реакций. Расчет переноса гаммаквантов осуществляется в 127групповом
приближении с использованием макроскопических констант. Анизотропия как когерен
тного, так и некогерентного рассеяния учитывается путем задания для каждого межгруп
пового перехода вероятностей рассеяния на каждый из трех заданных углов. Вероят
ности и углы определены из условия сохранения пяти угловых моментов.

Отметим особенность описания взаимодействия нейтронов с ядрами природных мно
гоизотопных элементов. Формат библиотек файлов оцененных данных предусматрива
ет возможность представления данных для природных смесей многоизотопных элемен
тов, однако реально эта возможность используется для описания сечений лишь несколь

45



ФИЗИКАИТЕХНИКАЯДЕРНЫХРЕАКТОРОВ

ких малоупотребительных в инженерной практике материалов (например, таких как
платина). В системе РОКОКО предусмотрена возможность детального описания струк
туры сечений всех природных многоизотопных элементов. Сечения всех изотопов при
водятся к единой энергетической сетке, которая прореживается путем отбрасывания
энергетических узлов, в которых сечения элементов могут быть восстановлены линей
ной интерполяцией из соседних узлов с заданной точностью (обычно 0.1%). Энергети
ческие зависимости сечений элементов определяются сложением сечений изотопов
сечений с весом их концентраций. Угловые распределения нейтронов, упруго рассеян
ных на изотопах, представленные в форме разложений по полиномам Лежандра, берут
ся непосредственно из файлов оцененных данных. Коэффициенты разложения для всех
изотопов приводятся к единой энергетической сетке и затем усредняются с весом кон
центраций и сечений упругого рассеяния. В каждой точке энергетической сетки восста
навливается детальная зависимость вероятности рассеяния от угла рассеяния в систе
ме центра инерции, после чего определяются 33 границы 32х равновероятных интер
валов по углу рассеяния. Вычисляется и хранится параллельно с сечениями энергети
ческая зависимость эффективной массы элемента, определенная таким образом, чтобы
сохранить среднюю потерю энергии при рассеянии. Энергоугловые распределения не
упругого рассеяния, как и для отдельных элементов, описывается в многогрупповом
приближении БНАБРФ. Использование энергетических зависимостей сечений для при
родных элементов существенно сокращает число нуклидов, входящих в состав среды, и
благодаря этому снижает затраты машинного времени на проведение расчета. Смеще
ние результатов при использовании этого приближения практически несущественно.

ТЕСТИРОВАНИЕ
Для проверки работоспособности системы РОКОКО была написана программа рас

чета критичности бесконечной среды – kinfin. В ней были предусмотрены оценки коэф
фициентов размножения  по поглощениям kinf,0 и по столкновениям kinf,1. Оценка по
длинам пробега не проводилась, так как в бесконечной гомогенной среде летящий ней
трон заведомо испытает в этой среде столкновение, и оценки по столкновениям и по
длинам пробега будут отличаться лишь тем, что в последнем случае погрешность будет
несколько выше (к погрешности оценки по столкновениям добавится погрешность вы
борочной оценки средней длины пробега). Размножение нейтронов за счет реакций
(n, xn) учитывалось путем умножения веса нейтрона на среднюю множественность ней
тронов, испускаемых в результате процессов неупругого рассеяния. Траектории рассчи
тывались при аналоговом рассмотрении поглощений. Оценки, полученные в нескольких
первых поколениях, при усреднении результатов по всем поколениям не учитывались
– в этих поколениях устанавливался стационарный спектр нейтронов деления. После
розыгрыша всех поколений результаты, полученные во всех поколениях (кроме несколь
ких отброшенных), усреднялись, вычислялись дисперсии каждой из оценок (D0 и D1) и
коэффициент корреляции между ними (ρ). После этого на основе метода наименьших
квадратов вычислялась комбинированная оценка коэффициента размножения (kinf) и
ее дисперсия (D):

comb = (1 – C)⋅kinf,0 + C⋅kinf,1,

D = C2(k 2
inf,0) + C ⋅(1− C) ⋅ρ ⋅kinf,0 ⋅k n + − 2 ⋅ 2

i f,1 (1 C) (kinf,1) ,
где

D −ρ ⋅ D0 ⋅D1
C = .

D0+ D1−2ρ D0 ⋅D1
Программа kinfin предназначалась для выполнения верификационных расчетов.

Верификация проводилась путем сравнения результатов расчета с данными, получен

46



И з в е с т и я в у з о в • Я д е р н а я э н е р г е т и к а • № 1 • 2 0 1 8

ными с помощью программы MCNP5 [7], «привязанной» к библиотеке РОСФОНД. Для
того, чтобы можно было судить о значимости расхождений в результатах, для сравне
ния выбирались среды, для которых были известны результаты экспериментального
определения kinf (с определенными погрешностями). Другой мерой значимости расхож
дений служило различие между результатами расчетов по MCNP5, выполненных с ис
пользованием библиотек РОСФОНД и ENDF/B7. Расчеты по MCNP5 проводились так же,
как расчеты по kinfin, с аналоговым рассмотрением поглощений. Далее будут приведе
ны результаты расчета kinf для четырех сред.

Первой из них являлась среда из урана с обогащением 5.56% – SCHERZO5.56 [14].
То, что обогащение 5.56% обеспечивает равенство kinf единице (с точностью 0.25%),
было выявлено в результате расчетного анализа серии экспериментов, выполнявшихся
на критических сборках SNEAK, ERMINE и HARMONIE. Расчетные результаты были полу
чены на одном и том же одноядерном персональном компьютере. В каждом расчете
разыгрывалось 1020 поколений по 2000 траекторий в каждом. Двадцать первых поко
лений являлись предварительными, следующие 1000 – активными; в них и производи
лась оценка рассчитываемых величин. Результаты таковы:

kinfin:        kinf = 0.99750 ± 0.00041 (время счета 107 с),
MCNP(RF): kinf = 0.99778 ± 0.00043 (время счета 174 с),
MCNP(B7): kinf = 0.99288 ± 0.00043 (время счета 140 с).

Таким образом, отличие результатов расчета по kinfin и по MCNP, составляющее
0.028%, намного ниже статистической погрешности этой разности, равной ±0.56%. Вре
мя счета по kinfin для этой задачи оказалось в полтора раза ниже, чем по MCNP (оче
видно, в основном, за счет преимущества многогроуппового описания спектров вторич
ных нейтронов неупругого рассеяния и реакций (n, xn)).

Результаты расчетов на основе библиотеки РОСФОНД согласуются с эксперименталь
но оцененной величиной 1.0000 ± 0.0025 в пределах погрешности последней.

Результат расчета на основе библиотеки ENDF/B7 ниже экспериментального значе
ния на 0.5%, что вдвое превышает экспериментальную погрешность.

Для другого тестового расчета была выбрана среда из нержавеющей стали с неболь
шой добавкой высокообогащенного урана, которая исследовалась на стенде КОБРА в
ГНЦ РФФЭИ (сборка КБР9). Условия проведения эксперимента и методы введения
расчетных поправок на гетерогенность и конечный размер исследовавшейся зоны (про
шедшие международную экспертизу) подробно описаны в работе [15]. Содержание
урана 90%го обогащения составляло 90.2% по числу ядер. Остальными компонентами
являлись железо, никель и хром с небольшими примесями углерода, кислорода, крем
ния, титана и марганца (табл. 1).

Таблица 1
Состав среды КБР9 (приведены числа ядер в объеме барн⋅см)

Экспериментальная оценка kinf для этой среды 1.108 ± 0.009. Как и в случае SCHERZO
5.56 в расчетах разыгрывалось 1020 поколений по 2000 траекторий; данные первых
двадцати траекторий отбрасывались. Результаты таковы:

kinfin:             kinf =1.10807 ± 0.00051 (время счета   83 мин),
kinfin (элем)   kinf =1.10840 ± 0.00041 (время счета   64 мин),
MCNP(RF):        kinf =1.10841 ± 0.00041 (время счета 103 мин),
MCNP(B7):        kinf =1.11139 ± 0.00050 (время счета 102 мин).

Результат, полученный по kinfin с поизотопным розыгрышем траекторий, совпал с

47



ФИЗИКАИТЕХНИКАЯДЕРНЫХРЕАКТОРОВ

результатом, полученным по MCNP на основе той же библиотеки РОСФОНД. Эти результа
ты совпадают и с экспериментальным значением. Практически такой же результат полу
чен и при поэлементном задании состава конструкционных материалов, что дает замет
ное снижение времени счета. Расчет по MCNP с использованием библиотеки ENDF/B7
приводит к небольшому завышению kinf.

Аналогичные результаты были получены и при расчетах, исследовавшихся на стен
де КОБРА сред с kinf » 1, содержащих в качестве основного материала никель (КБР7),
молибден (КБР10), хром (КБР15) и цирконий (КБР16). Результаты расчетов с деталь
ным слежением за энергией нейтрона совпали с таковыми, полученными по MCNPРОС
ФОНД, в пределах статистических погрешностей, но требовали на 20% меньшего време
ни. При элементном описании состава сред выигрыш во времени возрастал до 30 – 40%.

Были рассмотрены еще две тестовые задачи. В первой из них рассматривалась бес
конечная среда того же состава, что и невыгоревшая активная зона быстрого реактора
СВБР. Она содержала 23 нуклида (в том числе пять делящихся). Полученные результа
ты таковы:

kinfin:  kinf = 1.2465 ± 0.0005 (время счета 20 мин),
MCNP:   kinf = 1.2459 ± 0.0005 (время счета 21 мин).

При поэлементном описании состава зоны время счета сокращается до 17 мин.
В следующей задаче рассматривалась среда того же состава, что и выгоревшая (до

11% тяжелых атомов) активная зона СВБР, содержавшая 169 нуклидов. В расчетах по
kinfin детально описывались 52 нуклида, концентрации которых превышали 0.5%. Ос
тальные описывались в подгрупповом приближении. Результаты таковы:

kinfin:   kinf = 1.1436 ± 0.0003 (время счета  52 мин),
MCNP:    kinf = 1.1437 ± 0.0003 (время счета 209 мин).

Полученные данные наглядно показывают преимущество группового описания нук
лидов, содержащихся в мизерных концентрациях. Это и естественно, поскольку искать
сечения, соответствующие получившейся в процессе розыгрыша энергии, приходится для
всех нуклидов вне зависимости от их концентрации.

Наконец, рассчитывались водные растворы высокообогащенного уранилнитрата и
плутония. Характеристики растворов и результаты расчета keff  приведены в табл. 2.

Таблица 2
Результаты расчетов критичности водных растворов плутония и высокообо
гащенного урана с использованием разных программ и библиотек констант

Значимых расхождений в спектрах нейтронов не обнаружено (лишь при энерги
ях < 10–3 эВ потоки нейтронов, рассчитанные по MCNP5, оказались на 2 – 5% ниже
рассчитанных по kinfin).

ЗАКЛЮЧЕНИЕ
Тестирование показало, что РОКОКО обеспечивает возможность получения тех же

результатов, что и MCNP, с меньшими затратами времени за счет группового описания
индикатрис неупругого рассеяния, возможностью группового или подгруппового опи
сания сечений нуклидов с низкой концентрацией и детального описания сечений эле
ментов (для которых нет файлов оцененных данных).

48



И з в е с т и я в у з о в • Я д е р н а я э н е р г е т и к а • № 1 • 2 0 1 8

Включение РОКОКО в программу MMКФК [16], выполненное В.Б. Полевым, позволи
ло выявить и устранить ряд недостатков. Разумеется, недостатки еще остались и по мере
их выявления будут устраняться. Надо полагать, что включение РОКОКО в другие про
граммы также не приведет к серьезным трудностям.

Представляется целесообразным использовать систему РОКОКО в программах пре
цизионных инженерных расчетов энергетических реакторов, в которых повышение бы
стродействия позволит решать задачи, более сложные, чем задачи на критичность (ре
шение пространственновременных задач, оценка локальных функционалов и пр.), по
высить качество расчетов и расширить область применения [17, 18].

Авторы выражают глубокую признательность В.Н. Кощееву, Г.Б. Ломакову, В.В. Ко
робейникову за помощь, оказанную ими в работе; В.Б. Полевому, продемонстрировав
шему возможность подключения системы РОКОКО к инженерным программам, и Е.В.
Жемчугову, разработавшему и предоставившему одну из ключевых подпрограмм сис
темы – подпрограмму SUBGROUPS.

Литература
1. Кислицина Т.С., Николаев М. Н. ROCOCO. Свидетельство о государственной регистрации
программы для ЭВМ № 2016612400 от 26.02.2016 г.
2. Николаев М. Н. РОСФОНД – российская национальная библиотека оцененных нейтрон
ных данных // В мире науки. – 2006. – № 9. – С. 7881.
3. Забродская С.В., Игнатюк А.В., Кощеев В.Н., Манохин В.Н., Николаев М.Н., Проняев В.Г.
РОСФОНД – российская национальная библиотека оцененных нейтронных данных //
ВАНТ. Серия: Ядерные константы. – 2007. – № 12. – С. 321.
4. РОСФОНД – РОСсийская библиотека Файлов Оцененных Нейтронных Данных. / Под ред.
Николева М.Н. Электронный ресурс: https://www.ippe.ru/reactors/reactorconstants
datacenter/rosfondneutrondatabase (дата обращения 20.12.2017).
5. Мантуров Г.Н., Николаев М.Н., Цибуля А.М. Система групповых констант БНАБ93.
Часть 1. Ядерные константы для расчета нейтронных и фотонных полей излучения //
ВАНТ. Серия: Ядерные константы. – 1996. – № 1. – С. 59.
6. Кощеев В.Н., Мантуров Г.Н., Николаев М.Н., Цибуля А.М. Библиотека групповых кон
стант БНАБРФ для расчетов реакторов и защиты // Известия вузов. Ядерная энергетика.
– 2014. – № 3. – С. 93101.
7. Z#5 Monte#Carlo Team (Forrest Brown – team leader and 20 coworkers). MCNP – A General
MonteCarlo NParticle Transport Code, Ver. 5, Overview and Theory, LAUR031987, Vol. I
III. – LANL, 2003.
8. Кислицина Т.С., Николаев М. Н. COLIBRY. Свидетельство о государственной регистрации
базы данных № 2016620322 от 11.03.2016 г.
9. Мантуров Г.Н., Николаев М.Н., Поляков А.Ю., Цибуля А.М. Аннотация программы
CONSYST // ВАНТ. Серия: Ядерные константы. – 1999. – № 2. – С. 148.
10. NJOY99.0 Code System for Producing Pointwise and Multigroup Neutron and Photon Cross
Sections from ENDF/B Data. RSICC Peripheral Shielding Routine Collection. Oak Ridge National
Laboratory. Documentation for PSR480/NJOY99.0 Code Package (March 2000).
11. MacFarlane R.E., Kahler A.C. Method for Processing ENDF/BVII with NJOY. // Nuclear
Data Sheets. – 2010. – Vol. 111. – No. 12. – PP. 27392890.
12. Жемчугов Е.В. Программа SUBGROUPS.
Электронный ресурс: http://jinizh.org/subgroups/subgroups.html (дата обращения:
20.07.2017).
13. Eriksson J.R. A Slow Neutron Scattering Routine from the Gas Model. // Nucl. Sci. Eng. –
1970. – Vol. 41. – PP. 307309.
14. Chaudat J.P., Darrouzet M., Fisher E.A. Experiment in Pure Uranium Lattices with Unit K”.
Assemblies: SNEAK818Z, UK1 and UK5 in ERMINE and HARMONIE. KFK1865 (CEAR4552).
1974.
15. NEA Nucl. Sci. Committee. International Handbook of Evaluated Criticality Safety

49



ФИЗИКАИТЕХНИКАЯДЕРНЫХРЕАКТОРОВ

Benchmark Experiments. Vol. II, HCI005. kinfinity Experiments in Intermediate Neutron
Spectra for Vаriuse Structural Materials.
16. Франк#Каменецкий А.Д. Моделирование траекторий нейтронов при расчете реакто
ров методом МонтеКарло. – М.: Атомиздат, 1978. – 96 c.
17. Осецкая М.М., Украинцев В.Ф., Галковская В.Е. Управление топливной составляющей
(начальной и заключительной стадий ЯТЦ) себестоимости электроэнергии при формиро
вании производственной программы на АЭС России. // Экономика и предприниматель
ство. – 2017. – № 42 (812). – С. 590599.
18. Осецкая М.М., Жердев Г.М., Алленых М.А. Оценка влияния расходов на топливо на про
изводственную программу электроэнергетических предприятий России. // Фундамен
тальные исследования. – 2017. – № 102. – С. 381386.

Поступила в редакцию 13.04.2017 г.
Авторы
Жердев Геннадий Михайлович, ведущий научный сотрудник, канд. физ.мат. наук
Email: jerdev@ippe.ru, zherdev@ippe.ru
Кислицына Тамара Семеновна, старший инженер
Email: abbn@ippe.ru, bnab@ippe.ru
Николаев Марк Николаевич, главный научный сотрудник, др физ.мат. наук
Email: mnikolaev@ippe.ru

UDC 621.039.31.17

ROCOCO – A SYSTEM OF PROVIDING NUCLEAR DATA
FOR MONTE CARLO REACTOR CALCULATIONS
Jerdev G.M., Kislitsyna T.S., Nikolaev M.N.
JSC «SSC RFIPPE n.a. A.I. Leypunsky»
1, Bondarenko sq., Obnnsk, Kaluga reg., 249033 Russia

ABSTRACT
The ROCOCO [1] system is designed to provide Monte Carlo calculations of neutron

fields and gamma fields generated by them. The initial database of nuclear data used
in the system is the Russian national library of evaluated neutron data (ROSFOND)
[2 – 4]. The specific feature of the system is that the estimator is provided with
the opportunity to optimize the levels of descriptions of neutron crosssection
energy dependences. The crosssections of the main fuel and structural materials
as well as those of the coolant can be described in such detail as provided for by
the evaluated data; the crosssections of the secondary nuclides (minor actinides,
fission products, etc.) can be described in the 299group ABBB approximation [5]
with allowance for resonance selfshielding by the subgroup method or without
regard for selfshielding at all. The energy dependence of gamma rays is described
in the 127group P5 approximation [6]. Optimizing the level of detail makes it
possible to significantly reduce the counting time without any significant impact
on the result and its error. If desired, when calculating the energy release in neutron
reactions or in gammaquanta formation matrices, contributions from the decay of
radionuclides formed in these reactions (with a halflife of less than three years)
can be taken into account. The energy dependence of elastic scattering anisotropy
is detalized in the case of a group or subgroup description of the crosssections

50



И з в е с т и я в у з о в • Я д е р н а я э н е р г е т и к а • № 1 • 2 0 1 8

by specifying 33 boundaries of 32 equiprobable cosine intervals of the scattering
angle. The thermalization effects in calculations of neutron fields are taken into
account either in the ideal gas approximation or with the help of 72group
thermalization matrices built on the basis of thermalization files included in the
ROSFOND library (in cases where such files are contained therein).

It should be noted that the system contains descriptions of detailed dependences
of elastic scattering crosssections and angular distributions on all multiisotope
elements; the relationship between the scattering angle and the energy loss in this
case is established with the help of an energydependent effective atomic weight.

The programs of the system are written in FORTRAN. The system is easily
integrated into the calculation programs implementing the Monte Carlo method.

Key words: nuclear data, radiation field calculation using the Monte Carlo method,
combination of detailed and group descriptions of crosssection energy dependences.

REFERENCES
1. Kislitsyna T.S., Nikolaev M.N. ROCOCO. Certificate of state registration of the computer
program No. 2016612400 of February 26, 2016 (in Russian).
2. Nikolaev M.N. RUSFOND – Russian national library of evaluated neutron data. V mire nauki.
2006, no. 9, pp. 7881 (in Russian).
3. Zabrodskaya S.V., Ignatyuk A.V., Koshcheev V.N., Manochin V.N., Nikolaev M.N., Pronyaev
V.G. RUSFOND – Russian national library of evaluated neutron data. VANT. Ser.: Yadernye
konstanty. 2007, no. 12, pp. 321 (in Russian).
4. RUSFOND – Russian file library of evaluated neutron data.
Available at: https://www.ippe.ru/reactors/reactorconstantsdatacenter/rosfond
neutrondatabase (accessed: 20.12.2017) (in Russian).
5. Manturov G.N., Nikolaev M.N., Tsiboulya A.M. The group constants system ABBN93. Part 1.
Nuclear constants for neutron and photon radiation fields calculation. VANT. Ser.: Yadernye
konstanty. 1996, no. 1, p. 59 (in Russian).
6. Koshheev V.N., Manturov G.N., Nikolaev M.N., Tsiboulya A.M. ABBNRF group constants
library for nuclear reactor and shielding calculations. Izvestiya vuzov. Yadernaya energetika.
2014, no. 3, pp. 93101 (in Russian).
7. Z5 MonteCarlo Team (Forrest Brown – team leader and 20 coworkers). MCNP – A General
Monte Carlo NParticle Transport Code, Ver. 5, Overview and Theory, LAUR031987, Volumes
IIII. LANL (2003).
8. Kislitsyna T.S., Nikolaev M. N. COLIBRY. Certificate of state registration of the database No.
2016620322 of March 11, 2016 (in Russian).
9. Manturov G.N., Nikolaev M.N., Polyakov A.Ju., Tsiboulya A.M. CONSYST Program
description. VANT. Ser.: Yadernye konstanty. 1999, no. 2, p. 148 (in Russian).
10. NJOY99.0 Code System for Producing Pointwise and Multigroup Neutron and Photon Cross
Sections from ENDF/B Data. RSICC Peripheral Shielding Routine Collection. Oak Ridge
National Laboratory. Documentation for PSR480/NJOY99.0 Code Package (March 2000).
11. MacFarlane R.E., Kahler A.C. (2010) Method for Processing ENDF/BVII with NJOY. Nuclear
Data Sheets. 2010, v. 111, no. 12, pp. 27392890.
12. Zhemchugov E.V. SUBGROUPS program. Available at: http://jinizh.org/subgroups/
subgroups.html (accessed: 20.12.2017) (in Russian).
13. Eriksson J.R. A Slow Neutron Scattering Routine from the Gas Model. Nucl. Sci. Eng. 1970,
v. 41, pp. 307309.
14. Chaudat J.P., Darrouzet M., Fisher E.A. Experiment in Pure Uranium Lattices with Unit K”.
Assemblies: SNEAK818Z, UK1 and UK5 in ERMINE and HARMONIE. KFK1865 (CEAR4552).
1974.

51



ФИЗИКАИТЕХНИКАЯДЕРНЫХРЕАКТОРОВ

15. NEA Nucl. Sci. Committee. International Handbook of Evaluated Criticality Safety
Benchmark Experiments. Vol. II, HCI005. kinfinity Experiments in Intermediate Neutron
Spectra for Variuse Structural Materials.
16. FrankKameneckij A.D. The neutrons trajectories modeling in the reactors calculation by
Monte Carlo. Moscow. Atomizdat Publ., 1978, 96 p. (in Russian).
17. Osetskaya M.M., Ukraintsev V.F., Galkovskaya V.Ye. Management of the initial and final
stages of the nuclear fuel cycle in order to form a fuel cost’s component of electricity of the
production program at Russian nuclear power plants. Ekonomika i predprinimatel’stvo. 2017,
no. 42 (812), pp. 590599 (in Russian).
18. Osetskaya M.M., Zherdev G.M., Allenykh M.A. Estimation of fuel cost impact on energy
enterprises production program in Russia. Fundamental’nye issledovaniya. 2017, no. 102,
pp. 381386 (in Russian).
Autors
Jerdev Gennady Mikhailovich, Leading Resercher, Cand.Sci. (Phys.Math.)
Email: jerdev@ippe.ru, zherdev@ippe.ru
Kislitsyna Tamara Semenovna, Senior Engeneer
Email: bnab@ippe.ru, bnab@ippe.ru
Nikolaev Mark Nikolaevich, Senior Resercher, Dr. Sci. (Phys.Math.)
Email: mnikolaev@ippe.ru

52