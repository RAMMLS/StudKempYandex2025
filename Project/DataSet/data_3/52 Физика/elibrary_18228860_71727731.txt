130 вычислительные методы и программирование. 2012. Т. 13

УДК 532.7+532.516.5+532.593

ТРЕХМЕРНОЕ МОДЕЛИРОВАНИЕ ДВУХФАЗНЫХ СИСТЕМ
ТИПА ЖИДКОСТЬ–ПАР МЕТОДОМ РЕШЕТОЧНЫХ

УРАВНЕНИЙ БОЛЬЦМАНА НА GPU

А. Л. Куперштох1

Сравнительно новый метод решеточных уравнений Больцмана (Lattice Boltzmann Equation,
LBE) представляет собой дискретную модель сплошной среды. В настоящее время метод LBE
вполне может конкурировать с традиционными методами вычислительной гидродинамики, а
в некоторых областях (многофазные и многокомпонентные течения) он имеет значительные
преимущества. При моделировании фазовых переходов метод LBE представляет собой метод
сквозного счета границ раздела фаз. Алгоритм LBE хорошо распараллеливается на большое
количество потоковых процессоров в современных графических картах (Graphics Processing
Unit, GPU). Приведены примеры трехмерного моделирования спинодальной декомпозиции,
разрыва тонких пленок жидкости за счет термокапиллярного эффекта и процесса разрушения
тонкостенного жидкого пузыря. Ускорение расчетов достигает 70–90 раз. Работа выполнена в
рамках Федеральной целевой программы “Исследования и разработки по приоритетным на-
правлениям развития научно-технологического комплекса России на 2007–2013 годы” (проект
№ 07.514.11.4106).

Ключевые слова: метод решеточных уравнений Больцмана, фазовые переходы, динамика много-
фазных сред, компьютерное моделирование, параллельные вычисления, графические процессоры.

Введение. В настоящее время широко применяется компьютерное моделирование течений среды
методом решеточных уравнений Больцмана (Lattice Boltzmann Equation, LBE). Метод LBE широко ис-
пользуется для компьютерного моделирования течений жидкости, включая многофазные и многокомпо-
нентные [1–4].

Решеточные методы являются сравнительно новым классом методов, в которых используется мезо-
скопический подход к описанию вещества. Метод LBE представляет собой дискретную модель сплошной
среды. При этом метод решеточных уравнений Больцмана более перспективен, чем обычные конечно-
разностные методы, так как более адекватен природе вещества. В настоящее время метод LBE вполне
может конкурировать с традиционными методами вычислительной гидродинамики, а в некоторых обла-
стях (многофазные и многокомпонентные течения) он имеет значительные преимущества. До настоящего
времени параллельные вычисления на одной или нескольких видеокартах (Graphics Processing Unit, GPU)
применялись только для простых вариантов метода LBE без фазовых переходов [5–9].

1. Метод решеточных уравнений Больцмана. В отличие от классических методов расчета те-
чений жидкости путем решения уравнений Навье–Стокса метод решеточных уравнений Больцмана рас-
сматривает течение как движение ансамбля псевдочастиц, имеющих некоторую функцию распределения
по дискретным скоростям.

Основная идея, предложенная в [10], заключается в том, что в кинетическом уравнении Больцмана
для описания гидрогазодинамики достаточно использовать дискретный конечный набор скоростей ча-
стиц ck. Это фактически означает, что непрерывна∑я функция распределения ϕ(ξ) по микроскопическим
скоростям ξ заменяется на систему δ-функций вида Nkδ(ξ − ck). Кроме того, в методе LBE скорости ck

k
выбираются таким образом, чтобы за шаг по времени ∆t частицы перелетали в соседние узлы регулярной
пространственной решетки, векторы которой удовлетворяют условию ek = ck∆t [1, 2]. Для трехмерной
девятнадцатискоростной модели D3Q19 [11] возможный набор векторов скорости (k = 0, 1, . . . , b; b = 18)
показан на рис. 1.

В методе LBE в качестве переменных используются коэффициенты перед δ-функциями, т.е. одноча-
стичные функции распределения Nk(x, t) для всего конечного набора скоростей частиц ck.

1 ФГБУН Институт гидродинамики им. М.А. Лаврентьева СО РАН (ИГиЛ СО РАН), просп. Лаврен-
тьева, 15, 630090, Новосибирск; вед. науч. сотр., e-mail: skn@hydro.nsc.ru
©c Научно-исследовательский вычислительный центр МГУ им. М. В. Ломоносова



вычислительные методы и программирование. 2012. Т. 13 131

Уравнение эволюции для функций распределения Nk имеют вид

Nk(x, t) = Nk(x − ck∆t, t− ∆t) + Ωk(N) + ∆Nk,

где Ωk — оператор столкновений, а ∆Nk — изменение функций распределения за счет действия объемных
сил (внутренних и внешних). Обычно используется оператор столкновений в виде BGK (Bhatnagar–Gross–
Krook [12]) приближения

1 ( )
Ωk = Neq(ρ,u − Ñk x, t , ( )

τ k ) ( ) 1

которое представляет собой просто релаксацию к локальному равновесию. Безразмерное время релакса-
ции τ определяет кинематическую вязкость ν = θ(τ−1/2)∆t. Изменяя в определенных пределах параметр
τ > 1/2, можно изменять вязкость жидкости. Здесь θ — нормированная кинетическая температура псев-

1( )2
дочастиц. Для трехмерной изотермической модели LBE D3Q19 имеем θ = h/∆t [11], где h — шаг

3
решетки.

Для реализации алгоритма вычислений нами ис- 2u
пользовано расщепление метода LBE по физическим
процессам. 3u 5

Уравнения переноса для функций распределе- 1u
4u

ния Nk вдоль характеристик (которые являются пря-
мыми для уравнения Больцмана) на дискретной ре-
шетке имеют вид 8 2

7

3
Ñk(x, t) = Nk(x − ck∆t, t− ∆t). (2)

1

Гидродинамические переменные (плотность жид- 9
4 10

кости ρ и скорость u) в узле вычисляются в соответ-
ствии с формулами

2d
3d

∑b 6 1d
ρ = Ñk, (3)

k=0 4d
∑b

ρu = ckÑk. (4) Рис. 1. Возможные векторы скорости частиц в
k=1 методе решеточных уравнений Больцмана для

трехмерной девятнадцатискоростной
Для изотермических вариантов LBE-моделей ис-

модели D3Q19.
пользуется разложение равновесных функций распре-
деления Максвелла–Больцмана в ряд по скорости u
до второго порядка [13]: ( )

cku (c 2
ku) u2

Neq
k (ρ,u) = ρwk 1 + + − . (5)

θ 2θ2 2θ

Векторы ck и коэффициенты wk зависят от конкретной решетки. Для трехмерн√ой девятнадцати-
скоростной модели D3Q19 допустимы три значения модуля скорости: |ck| = 0, h/∆t и 2 h/∆t. Весовые
коэффициенты равны w0 = 1/3, w1–6 = 1/18 и w7–18 = 1/36 [11].

Кроме того, на каждом шаге по времени происходит изменение функций распределения за счет опе-
ратора столкновений и действия сил:

( )
Nk(x, t) = Ñk(x, t) + Ωk Ñ(x, t) + ∆Ñk. (6)

Для учета действия объемных сил в методе LBE нами предложен метод точной разности [14–17]

∆Ñk(x, t) = Neq
k (ρ,u + ∆u) −Neq

k (ρ,u). (7)

Изменение скорости ∆u за шаг по времени определяется полной силой F , действующей на вещество в
узле, а именно

1
u + ∆u = u + F∆t. (8)

ρ



132 вычислительные методы и программирование. 2012. Т. 13

В случае действия объемных сил для вычисления физической скорости вещества u∗ следует исполь-
зовать выражение, определенное на половине шага по времени [18]:

∑b
1

ρu∗ = ckÑk + F∆t.
2

k=1

Обоснованием метода LBE можно считать тот факт, что во втором порядке разложения Чепмена–
Энскога из уравнений LBE получаются макроскопические уравнения гидродинамики, т.е. известные урав-
нения неразрывности и Навье–Стокса [3, 16].

2. Моделирование фазовых переходов. Компьютерное моделирование фазовых переходов мето-
дом LBE представляет собой метод сквозного счета границ раздела фаз, в том числе и вновь возникающих
в объеме вещества [19–21]. В этом случае вместо разрыва плотности моделируется тонкий переходной слой
жидкость–пар, в котором плотность изменяется плавно на размерах нескольких узлов решетки (анало-
гично методам сквозного счета ударных волн в газодинамике). При этом заметно упрощается логика
компьютерных программ, так как жидкая и газообразная фазы описываются единообразно. Кроме того,
отпадает необходимость в сложных граничных условиях на поверхностях раздела фаз.

Для этого в [19] было предложено ввести силы притяжения, действующие на вещество в узле со
стороны соседних узлов. При этом силы между узлами обеспечивают наличие поверхностного натяжения
на границе раздела фаз жидкость–пар.

В рамках изотермической модели в [20] было предложено вместо сил притяжения между узлами
использовать значение полной силы F , действующей на вещество в каждом узле. Для этого было введено
понятие псевдопотенциала U(ρ) = P (ρ) − ρθ. Сила, действующая на вещество в узле, выражается через
градиент псевдопотенциала

F = −∇U. (9)

В [21] для описания уравнения состояния произвольного вида P (ρ, T ) псевдопотенциал был записан
в форме

U = P (ρ, T ) − ρθ. (10)

В [22–24] нами предложено для модели [21] ввести новую функцию
√

Φ = −U . (11)

Тогда выражение для силы (9) можно переписать в эквивалентном виде
( )

F = A∇ Φ2 + 2(1 −A)Φ∇Φ, (12)

где A — свободный параметр.
Конечно-разностная формула для уравнения (12), обеспечивающая достаточную изотропность для

трехмерной модели D3Q19 [22–24] и записанная в векторной форме, имеет вид
[ ]

1 ∑ G ∑
k Gk

F (x) = (1 − 2A)Φ(x) Φ(x + ek)ek +A Φ2(x + ek)ek . (13)
αh G0 G0

k k

Здесь Gk > 0 — коэффициенты, которые различны для основных и диагональных направлений решет-
ки. Коэффициенты G1–6 = G0 соответствуют основным направлениям решетки. Для трехмерной модели
D3Q19 значения коэффициентов для диагональных направлений Gk, обеспечивающие изотропность про-
странства, равны G0/2, а α = 3.

Использовалось уравнение состояния Ван-дер-Ваальса, которое в приведенных переменных P̃ =
P/Pкр, ρ̃ = ρ/ρкр и T̃ = T/Tкр имеет вид

8ρ̃ T̃
P̃ = − ρ̃ . 1 )

3 − 3 2 ( 4
ρ̃

Здесь Pкр, ρкр и Tкр — значения давления, плотности и температуры в критической точке.
Аппроксимация (13) значительно улучшает результаты при LBE-моделировании. При A = −0.152

отклонение кривой сосуществования фаз для уравнения состояния Ван-дер-Ваальса от теоретической
меньше, чем 0.2% в диапазоне температур от критической до T̃ = 0.4 [22].



вычислительные методы и программирование. 2012. Т. 13 133

Хорошая изотропность аппроксимации (13) обеспечивает правильные значения поверхностного натя-
жения на границе раздела фаз и круглую форму капель жидкости в газе и паровых пузырей в жидкости в
стационарном случае. При этом выполняется закон Лапласа для скачка давления на кривой поверхности:

( )
1 1

∆P = σ + ,
R1 R2

где R1 и R2 — главные радиусы кривизны поверхности. Величина поверхностного натяжения σ зависит
от уравнения состояния флюида [25], при этом σ уменьшается с увеличением температуры и обращается
в нуль в критической точке.

В [15, 22, 24] было показано, что при моделировании фазовых переходов в методе LBE для учета дей-
ствия сил следует использовать метод точной разности (7). Результаты, полученные другими известными
методами учета действия сил [19, 26] (метод модификации оператора столкновений и метод явной про-
изводной), гораздо хуже и, более того, зависят от времени релаксации τ , что противоречит физическому
смыслу. В комбинированном методе [27] результаты не зависят от времени релаксации τ , но приводят к
сильно сдвинутым значениям плотности пара на кривой сосуществования [15, 22, 24].

3. Численная устойчивость алгоритма. В√работе [17] было показано, что критерием устойчи-
вости жидкой фазы является условие c̃ 6 c̃кр = 1 + θ̃ , где безразмерная скорость звука c̃ = cs∆t/h
(гидродинамическое чис√ло Куранта, возникающее для явных конечно-разностных схем уравнений газо-

( )
∂P

динамики). Здесь cs = — скорость звука для изотермических вариантов метода LBE, опре-
∂ρ

T

деляемая уравнением состояния вещества. При θ̃ = 1/3 критическое значение равно c̃к√р = 1.1547. Для
√ ( )
√√ ∂P̃

уравнения состояния в безразмерной форме число Куранта записывается в виде c̃ = k , где
∂ρ̃

( ) T
2

∆t 1
безразмерный параметр k = Pкр определяется характеристиками вещества и величиной шагов

h ρкр

по времени и координате. Как обычно, для устойчивости численных расчетов необходимо относительно
малое отношение ∆t/h [17].

4. Метод расщепления алгоритма LBE. Ниже представлен алгоритм метода LBE с фазовы-
ми переходами, который состоит из нескольких шагов, выполняемых последовательно (метод Яненко —
расщепление по физическим процессам).

1. Перенос значений функций распределения вдоль характеристик (2).
2. Вычисление новых значений плотности ρ по (3) и значений функции Φ с использованием (10), (11)

и уравнения состояния, например (14).
3. Вычисление полной силы взаимодействия (13), действующей на узел (т.е. значения градиента псев-

допотенциала).
4. Вычисление значений скорости в узле до и после действия сил (4) и (8) соответственно. Вычисление

соответствующих равновесных функций распределения (5).
5. Изменение функций распределения в узлах (6) за счет действия оператора столкновений (1) и за

счет действия сил с использованием метода точной разности (7).
Очевидно, что алгоритм LBE включает в себя вычисления преимущественно в локальном узле рас-

четной сетки за исключением переноса частиц и расчета сил взаимодействия между узлами, что позволяет
эффективно его распараллеливать на большое количество ядер GPU.

5. Параллельные вычисления на графических ускорителях. Графические процессоры на
видеокартах (Graphics Processing Unit, GPU) имеют возможность параллельных вычислений на большом
количестве ядер. Впервые GPU были использованы для моделирования методом LBE в работе [5]. Однако
до настоящего времени параллельные вычисления на одной или нескольких видеокартах применялись
только для простых вариантов метода LBE без фазовых переходов [5–9].

В настоящей работе параллельные расчеты выполнялись на графическом ускорителе GTX-580, имею-
щем 512 потоковых процессоров (ядер). Все ядра имеют доступ к относительно быстрой общей внутренней
памяти объемом 3 Гб. В действительности GTX-580 состоит из 16 мультипроцессоров по 32 ядра в каждом.
Распараллеливание основано на создании сотен миллионов потоков, каждый их которых осуществляет
относительно простые вычисления в узле по одному или по нескольким уравнениям (1)–(8), (10), (11),
(13), (14).

На значительное ускорение вычислений влияют не только большое количество ядер GPU, но и ряд



134 вычислительные методы и программирование. 2012. Т. 13

других факторов:
— основной объем электронных компонентов внутри GPU спроектирован именно под устройства вы-

числений (до 80%), тогда как у центрального процессора CPU для вычислительной части используется
примерно 20%;

— внутренняя память GPU (3 Гб для GTX-580) работает на скорости 192 Гб/с, что на порядок выше,
чем у оперативной памяти компьютера;

— каждый мультипроцессор имеет большое количество быстрых внутренних регистров (32 768 на
один блок);

— на GPU время переключения ядра между потоками происходит за один такт.
Для распараллеливания алгоритма на большое количество ядер современных графических процес-

соров использовалась технология программирования CUDA (Compute Unified Device Architecture) [28].
Первые три шага алгоритма реализованы в виде отдельных параллельных функций (ядер, kernel)

для GPU: MOVE, DENSITY и FORCE. Последние два шага алгоритма объединены в одну ядерную функцию,
условно названную COLLISION. Каждая ядерная функция выполняет относительно простые вычисления
в каждом узле.

Для варианта метода LBE с фазовыми переходами ускорение нашего алгоритма для GTX-580 до-
стигало 70–90 раз при вычислениях с двойной точностью по сравнению с одним ядром процессора Intel
Core 2 Duo с частотой 3.3 ГГц. Для трехмерных расчетов использовались расчетные сетки размерами до
256 × 256 × 224 для GTX-580 при 3 Гб общей внутренней памяти.

Архитектура GPU задает организацию вычислений по блокам, в каждом из которых может запус-
каться до 1024 потоков. Каждый поток выполняется одним ядром. Каждый блок выполняется одним
мультипроцессором. Совокупность блоков называется решеткой (Grid). Последовательность выполнения
огромного количества потоков и блоков не оговорена, но их полное завершение до вызова следующей
ядерной функции можно синхронизовать.

Каждому ядру GPU через внутренние переменные доступны: размеры блока blockDim.x, blockDim.y,
blockDim.z и координаты блока в решетке blockIdx.x, blockIdx.y и blockIdx.z, а также координаты
выполняемого в этот момент потока внутри блока threadIdx.x, threadIdx.y, threadIdx.z.

На рис. 2 показан пример разбиения трехмерной расчетной области размером nx×ny×nz на блоки, а
каждого блока — на потоки.

Шаг 1
Nk

ny
Move

Поток buff

Блок Шаг 2
Nk

1
y 1 nz

x z Copy
buff

nx 1

Рис. 2. Пример разбиения расчетной области на Рис. 3. Схема переноса значений функций
блоки и потоки распределения Nk в соседние узлы

через буферный массив

В технологии CUDA перед вызовом ядерной функции (например, DENSITY) необходимо задать раз-
меры блока (threads) и размеры решетки (grid):

dim3 threads(16,16,2);

dim3 grid(nx/threads.x, ny/threads.y, nz/threads.z);



вычислительные методы и программирование. 2012. Т. 13 135

DENSITY <<< grid, threads >>> (......);

Перед запуском ядерной функции массивы данных, предназначенные для параллельных вычислений,
должны быть переданы в память GPU или уже там находиться. При запуске ядерной функции блоки
распределяются между свободными мультипроцессорами или становятся в очередь. Аналогично, потоки
внутри мультипроцессора распределяются по ядрам для исполнения или становятся в очередь.

Все данные хранятся в общей памяти GPU в одномерных массивах. Каждый поток способен вычис-
лить индекс i элемента, для которого данный поток должен выполнить вычисления:

i=(blockIdx.z*blockDim.z + threadIdx.z+1)*ny*nx

+(blockIdx.y*blockDim.y + threadIdx.y+1)*nx

+ blockIdx.x*blockDim.x + threadIdx.x+1.

Так как основным ограничением при использовании GPU является объем быстрой внутренней памяти
устройства, то с целью оптимизации памяти на шаге переноса использовался всего один буферный массив
buff для всех функций распределения Nk (рис. 3).

Время, затрачиваемое функцией COLLISION для расчета всех узлов сетки 192 × 192 × 192 за один шаг
по времени для однокомпонентной двухфазной модели LBE, показано на рис. 4. Оптимальными для этой
ядерной функции оказались двумерные блоки размером 16 × 16 × 1.

При вычислениях одного шага по времени на устройстве GTX-580 затраты времени на выполнение
каждой параллельной функции (kernel) на сетке 256×256×224 (14.7 миллионов узлов) показаны в таблице
для случая оптимизации объема памяти. Для первых четырех функций использовались двумерные блоки
16 × 16 × 1.

Чистые затраты времени на выполнение всех ядерных функций за один шаг LBE-метода составляют
примерно 10 нс на один узел, при этом производительность GTX-580 составляет ∼ 100 MNUPS (Million
Node Updates Per Second), т.е. до 100 миллионов узлов сетки в секунду.

7000
Шаг по времени на решетке 192 х 192 х 192

для функции COLLISION

6000 4 х 4 Затраты времени на вычисления
ядерных функций во всех

узлах за шаг LBE

Функция мкс/шаг %
5000

Размеры блоков Collision 66 577 42.5
8 х 8 х 8

Density 21 299 13.6

8 х 8 х 4 Force 13 934 8.9
4000 8 х 8 х 2 Move+Copy 49 944 31.9

16 х16 х 2 Boundaries 1392 0.9
8 х 8

16 х 16
32 х 16 Всего: 153 146 100

3000
16 64 128 256 512

Число потоков
Рис. 4. Время, затрачиваемое на один шаг вычисления ядерной

функции COLLISION, при разных размерах блоков

6. Примеры моделирования двухфазных систем. Ниже приведены результаты моделирования
ряда двухфазных систем жидкость–пар.

На рис. 5 показаны результаты трехмерного моделирования спинодальной декомпозиции первона-
чально однородного состояния вещества, находящегося под спинодалью, на двухфазную систему жидкость–
пар. Со временем мелкомасштабные структуры укрупняются.

Время, мкс



136 вычислительные методы и программирование. 2012. Т. 13

а) б) в) г)

Рис. 5. Спинодальная декомпозиция. Паровая фаза показана прозрачной. Расчетная сетка 96× 96× 96,
t = 2000 (а), 3000 (б), 4000 (в), 7600 (г)

T

0 R

а) в) д)

z
y

x
б) г) е)

Рис. 6. Трехмерное моделирование термокапиллярного эффекта (эффект Марангони) для свободно висящей
пленки жидкости. Толщина пленки d = 24. Расчетная сетка 256× 256× 224,

t = 0 (б), 3100 (в), 3400 (г), 3700 (д), 4200 (е)

На рис. 6 показаны результаты моделирования термокапиллярного эффекта для свободно висящей
пленки, вдоль которой имеется неравномерное распределение температуры

 ( )
 ( )
T0 + ∆T 1 + cos π(r/R)2 при r < R,

T = T0 при r > R,

√
показанное на рис. 6а, где r = x2 + y2 . Граничные условия по x и по y периодические.

За счет распределения температуры вдоль пленки и, соответственно, поверхностного натяжения про-
исходит неоднородное растяжение пленки. Разрыв пленки жидкости происходит по окружности неко-
торого радиуса там, где градиент температуры и поверхностного натяжения близки к максимальным
значениям. В результате в центре образуется диск из жидкости, который за счет поверхностного натяже-
ния сначала трансформируется в тороидальное образование, а затем, после осцилляций, в каплю. Позже
происходит постепенное испарение капли жидкости.

На рис. 7 показан процесс разрушения тонкостенного жидкого пузыря, заполненного газом. В этом
случае использовался метод LBE для двух компонентов: газ, находящийся внутри пузыря, и жидкий пу-
зырь. Для жидкости использовано уравнение состояния Ван-дер-Ваальса, допускающее фазовый переход
жидкость–пар (испарение капель), а для газа — обычное газовое уравнение состояния.

При моделировании поведения многокомпонентных систем методом LBE каждый из компонентов s
и σ описывается своим набором одночастичных функций распределенияNs

k(x, t) иNσ
k (x, t) [19]. Уравнения



вычислительные методы и программирование. 2012. Т. 13 137

эволюции для компонентов имеют вид

Ns
k(x + ck∆t, t+ ∆t) =Ns

k(x, t) + Ωs
k + ∆Ns

k ,

Nσ
k (x + ck∆t, t+ ∆t) =Nσ

k (x, t) + Ωσ
k + ∆Nσ

k .

Здесь ∆Ns
k и ∆Nσ

k — изменения функций распределения под действием объемных сил. Операторы столк-
новений Ωs

k и Ωσ
k учитывают только столкновения частиц одного и того же сорта. Столкнов(ения м)ежду

частицами разных компонентов моделировались силами сопротивления F s
d = −F σ

d = −βρsρσ us−uσ , где
∑ ∑ ∑ Ns ∑ σ

ρs = Ns kck N c
k и ρσ = Nσ

k — плотности вещества компонентов смеси, а us = и uσ = k k
—

ρs ρσ
k k k k

скорости компонентов в данном узле.

а) б) в) г)

Рис. 7. Моделирование разрушения трехмерного тонкостенного жидкого пузыря.
Расчетная сетка 192× 192× 192, t = 0 (а), 1000 (б), 1100 (в), 1350 (г)

Ограниченная взаимная растворимость компонентов моделировалась силами отталкивания между
частицами разного сорта, находящимися в соседних узлах расчетной решетки. Суммарные силы, дей-
ствующие на вещество компонентов в узле за счет этих сил отталкивания, имеют вид

[ ]∑ [ ]
F s(x) = ψ ρs(x) Bkψ ρσ(x + ek) ek,

k
[ ]∑ [ ]

F σ(x) = ψ ρσ(x) Bkψ ρs(x + ek) ek.
k

Все коэффициенты Bk выражаются через один параметр взаимодействия компонентов B < 0, опре-
деляющий степень малости взаимной растворимости компонентов. Здесь ψ(ρ) — возрастающая функция
от плотности соответствующего компонента, вид которой определяет зависимость растворимости от дав-
ления.

В некоторый момент времени в стенке пузыря возникают отверстия, которые быстро расширяются
(рис. 7а и 7б). Затем происходит образование брызг в виде капель жидкости (рис. 7в и 7г), которые позже
испаряются.

7. Заключение. Метод LBE достаточно прост и эффективен для моделирования широкого круга
течений жидкости с возможными фазовыми переходами жидкость–пар.

Рассмотренный LBE-алгоритм весьма успешно реализован для параллельных вычислений на много-
процессорных графических ускорителях NVIDIA с использованием технологии программирования CUDA,
что дает новые возможности для численного моделирования двухфазных многокомпонентных систем.

Для варианта метода LBE с фазовыми переходами жидкость–пар параллельная реализация нашего
алгоритма на GTX-580 при вычислениях с двойной точностью в 70–90 раз быстрее, чем при вычислениях
на одном ядре процессора Intel Core 2 Duo с частотой 3.3 ГГц.

Производительность графического ускорителя GTX-580 для метода LBE с одним компонентом и
фазовыми переходами жидкость–пар составляет примерно 100 миллионов узлов сетки в секунду (100
MNUPS, Million Node Updates Per Second).

СПИСОК ЛИТЕРАТУРЫ

1. McNamara G.R., Zanetti G. Use of the Boltzmann equation to simulate lattice-gas automata // Physical Review
Letters. 1988. 61, N 20. 2332–2335.



138 вычислительные методы и программирование. 2012. Т. 13

2. Higuera F.J., Jiménez J. Boltzmann approach to lattice gas simulations // Europhys. Lett. 1989. 9, N 7. 663–668.
3. Chen S., Doolen G.D. Lattice Boltzmann method for fluid flow // Annu. Rev. Fluid Mech. 1998. 30. 329–364.
4. Aidun C.K., Clausen J.R. Lattice-Boltzmann method for complex flows // Annu. Rev. Fluid Mech. 2010. 42. 439–472.
5. Li W., Wei X., Kaufman A. Implementing lattice Boltzmann computation on graphics hardware // Visual Computer.

2003. 19. 444–456.
6. Tölke J., Krafczyk M. TeraFLOP computing on a desktop PC with GPU for 3D CFD // Int. J. of Computational

Fluid Dynamics. 2008. 22, N 7. 443–456.
7. Janßen C., Krafczyk M. Free surface flow simulations on GPGPU using the LBM // Computers and Mathematics

with Applications. 2011. 61, N 12. 3549–3563.
8. Obrecht C., Kuznik F., Tourancheau B., Roux J.-J. Multi-GPU implementation of the lattice Boltzmann method //

Computers and Mathematics with Applications. 2011. In press: doi: 10.1016/j.camwa. 2011.02.020.
9. Грачев Н.Е., Дмитриев А.В., Сенин Д.С. Моделирование динамики газа при помощи решеточного метода

Больцмана // Вычислительные методы и программирование. 2011. 12. 227–231.
10.Broadwell J.E. Study of rarefied shear flow by the discrete velocity method // J. Fluid Mech. 1964. 19. 401–414.
11.Qian Y.H., Orzag S.A. Lattice BGK models for the Navier–Stokes equation: Nonlinear deviation in compressible

regimes // Europhys. Lett. 1993. 21. 255–259.
12.Bhatnagar P.L., Gross E.P., Krook M.K. A model for collision process in gases. I. Small amplitude process in charged

and neutral one-component system // Physical Review. 1954. 94, N 3. 511–525.
13.Koelman J.M.V.A. A simple lattice Boltzmann scheme for Navier–Stokes fluid flow // Europhys. Lett. 1991. 15, N 6.

603–607.
14.Kupershtokh A.L. Calculations of the action of electric forces in the lattice Boltzmann equation method using the

difference of equilibrium distribution functions // Докл. VII Межд. научн. конф. “Современные проблемы элек-
трофизики и электрогидродинамики жидкостей”. Санкт-Петербург, 2003. 152–155.

15.Kupershtokh A.L. New method of incorporating a body force term into the lattice Boltzmann equation // Proc. of
the 5th Int. EHD Workshop. Poitiers (France), 2004. 241–246.

16.Куперштох А.Л. Учет действия объемных сил в решеточных уравнениях Больцмана // Вестн. НГУ. Серия
“Математика, механика и информатика”. 2004. 4, № 2. 75–96.

17.Kupershtokh A.L. Criterion of numerical instability of liquid state in LBE simulations // Computers and Mathematics
with Applications. 2010. 59, N 7. 2236–2245.

18.Ginzburg I., Adler P.M. Boundary flow condition analysis for the three-dimensional lattice Boltzmann model // J.
Phys. II France. 1994. 4, N 2. 191–214.

19.Shan X., Chen H. Lattice Boltzmann model for simulating flows with multiple phases and components // Physical
Review E. 1993. 47, N 3. 1815–1819.

20.Qian Y.H., Chen S. Finite size effect in lattice-BGK models // Int. J. of Modern Physics C. 1997. 8, N 4. 763–771.
21.Zhang R., Chen H. Lattice Boltzmann method for simulations of liquid–vapor thermal flows // Phys. Rev. E. 2003.

67, N 6. 066711.
22.Куперштох А.Л. Моделирование течений с границами раздела фаз жидкость–пар методом решеточных урав-

нений Больцмана // Вестн. НГУ. Серия “Математика, механика и информатика”. 2005. 5, № 3. 29–42.
23.Kupershtokh A.L., Karpov D.I., Medvedev D.A., Stamatelatos C.P., Charalambakos V.P., Pyrgioti E.C., Agoris D.P.

Stochastic models of partial discharge activity in solid and liquid dielectrics // IET Science, Measurement and
Technology. 2007. 1, N 6. 303–311.

24.Kupershtokh A.L., Medvedev D.A., Karpov D.I. On equations of state in a lattice Boltzmann method // Computers
and Mathematics with Applications. 2009. 58, N 5. 965–974.

25.Kupershtokh A.L. A lattice Boltzmann equation method for real fluids with the equation of state known in tabular
form only in regions of liquid and vapor phases // Computers and Mathematics with Applications. 2011. 61, N 12.
3537–3548.

26.He X., Shan X., Doolen G.D. Discrete Boltzmann equation model for nonideal gases // Phys. Rev. E. 1998. 57, N 1.
R13–R16.

27.Guo Z., Zheng C., Shi B. Discrete lattice effects on the forcing term in the lattice Boltzmann method // Phys. Rev.
E. 2002. 65, N 4. 046308(6).

28.NVIDIA CUDA C. Programming Guide. Version 4.0. 2011.

Поступила в редакцию
08.01.2012