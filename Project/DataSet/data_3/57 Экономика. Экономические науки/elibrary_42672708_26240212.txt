СОВРЕМЕННЫЕ МЕТОДЫ ИССЛЕДОВАНИЯ/ MODERN RESEARCH METHODS

ОРИГИНАЛЬНАЯ СТАТЬЯ ©  CC    BY 4.0

DOI: 10.26794/2587-5671-2020-24-1-14-23
УДК 330.43(045)
JEL C01

Сравнительный анализ прогнозных моделей ARIMA 
и lSTM на примере акций российских компаний

А. В. Алжеевa, Р. А. Кочкаровb

Финансовый университет, Москва, Россия
a https://orcid.org/0000-0001-8944-5679; b https://orcid.org/0000-0003-3186-3901

АННОТАЦИЯ
Цель статьи —  поиск лучшей модели для прогноза временных рядов с  учетом минимизации ошибок и высокой 
точности прогноза. Использован метод сравнительного анализа наиболее популярной «традиционной» экономе-
трической модели ARIMA и модели глубокого обучения LSTM (Long short-term memory) на основе рекуррентной 
нейронной сети. Приведено математическое описание этих прогнозных моделей. Авторы разработали алгоритмы 
для прогноза временных рядов, основанные на подходе “Rolling forecasting origin” («прогнозирование происхож-
дения»). Алгоритмы реализованы в среде программирования Python с подключенными библиотеками Keras, Theano 
и Statsmodels. В качестве входных наборов данных импортированы значения котировок акций российских компа-
ний: Алроса, Газпром, КамАЗ, НЛМК, Киви, Роснефть, ВТБ и Яндекс за период с 02.06.2014 по 11.11.2019 г. с разбив-
кой по неделям. Результаты исследования подтверждают превосходство модели LSTM, при которой среднеквадра-
тическая ошибка RMSE на 65% меньше, чем при использовании модели ARIMA. Сделан вывод, что для повышения 
качества прогноза временных рядов предпочтительно применять алгоритм на основе модели LSTM.
Ключевые слова: ARIMA; LSTM; прогнозные модели; акции; анализ; прогнозирование котировок; алгоритмы

Для цитирования: Алжеев А. В., Кочкаров Р. А. Сравнительный анализ прогнозных моделей ARIMA и lSTM на примере 
акций российских компаний. Финансы: теория и практика. 2020;24(1):14-23. DOI: 10.26794/2587-5671-2020-24-1-14-23

ORIGINAl PAPER

Comparative Analysis of ARIMA and lSTM Predictive 
Models: Evidence from Russian Stocks

A. V. Alzheeva, R. A. Kochkarovb

Financial University, Moscow, Russia
a https://orcid.org/0000-0001-8944-5679; b https://orcid.org/0000-0003-3186-3901

АbSTRACT
The article aims to find the best time series predictive model, considering the minimization of errors and high accuracy 
of the prediction. The authors performed the comparative analysis of the most popular “traditional” econometric model 
ARIMA and the deep learning model LSTM (Long short-term memory) based on a recurrent neural network. The study 
provides a mathematical description of these predictive models. The authors developed algorithms for predicting time 
series based on the “Rolling forecasting origin” approach. These are Python-based algorithms using the Keras, Theano 
and Statsmodels libraries. Stock quotes of Russian companies Alrosa, Gazprom, KamAZ, NLMK, Kiwi, Rosneft, VTB and 
Yandex for the period from June 2, 2014 to November 11, 2019, broken down by week, served as input data. The research 
results confirm the superiority of the LSTM model, where the RMSE error is 65% less than with the ARIMA model. 
Therefore, an LSTM model-based algorithm is more preferable for the better quality of time series prediction.
Keywords: ARIMA; LSTM; predictive models; stocks; analysis; stock quote prediction; algorithms

For citation: Alzheev A. V., Kochkarov R. A. Comparative аnalysis of ARIMA and lSTM predictive models: Evidence from 
Russian stocks. Finance: Theory and Practice. 2020;24(1):14-23. (In Russ.). DOI: 10.26794/2587-5671-2020-24-1-14-23

© Алжеев А. В., Кочкаров Р. А., 2020

14 ФИНАНСЫ: ТЕОРИЯ И ПРАКТИКА / FINANCE: THEORY AND PRACTICE   Т. 24,  № 1’2020



А. В. Алжеев, Р. А. Кочкаров

ВВЕДЕНИЕ В данной статье сравниваются модели ARIMA 
Прогнозирование временных рядов —  сложная за‑ и LSTM, а критерием сравнения является миними‑
дача, во многом обусловленная неожиданными из‑ зация ошибки прогноза. Модель ARIMA выбрана, 
менениями в экономике и асимметрией информа‑ исходя из ее способности работать с данными неста‑
ции. Из‑за волатильности рынка в последнее время ционарного характера. Из спектра моделей глубокого 
серьезную обеспокоенность вызывает качество про‑ обучения выбрана LSTM как наиболее подходящая 
гнозов регрессионных моделей, которое необходи‑ модель прогнозирования временных рядов с возмож‑
мо тщательно оценивать. ностью сохранения памяти в течение длительного 

Временной ряд —  это последовательность значе‑ периода времени.
ний наблюдений какой‑либо величины, взятых через 
относительно равные промежутки времени. Приме‑ АЛГОРИТМИЧЕСКАЯ ТОРГОВЛЯ
рами временного ряда могут быть: объем выпуска Алгоритмическая торговля в последние десятиле‑
продукции, число проданных страховых продуктов, тия активно развивается благодаря совокупности 
наводнения и т. п. Временные ряды широко использу‑ факторов: стремительному развитию методов ма‑
ются в статистике, обработке сигналов, распознавании шинного обучения, развитию технологий работы 
образов, эконометрике, финансах, астрономии, ин‑ с данными и их анализа, росту возможностей хра‑
женерии и в большинстве других видов человеческой нения и обработки большего объема данных. Кроме 
деятельности, где измеряются значения в течение того, сложность применяемых участниками рынка 
времени. Анализ временных рядов объединяет в себе алгоритмов торговых систем растет, поскольку они 
ряд моделей для извлечения значимой информации конкурируют не только с теми, кто не использует 
из данных с целью предсказывать будущие значения, автоматизированные системы, но и друг с другом. 
основываясь на прошлых. В связи с этими тенденциями исследование приме‑

Временной ряд всегда является упорядоченным нимости различных алгоритмов машинного обуче‑
во времени. Это отличает анализ временного ряда от ния к задачам алгоритмической торговли является 
поперечных исследований (к примеру, связь между актуальной задачей. В подобных исследованиях 
полом человека и заработной платой). Также име‑ есть интерес не только со стороны компаний, зани‑
ются отличия и от исследования пространственных мающихся алгоритмической торговлей, таких как 
выборок (зависимость заработной платы от регио‑ хедж‑фонды, но и со стороны научного сообщества, 
на). Модели временных рядов отражают факт того, поскольку применение алгоритмов машинного об‑
что близкие во времени наблюдения будут связаны учения к рассматриваемой области способно при‑
сильнее, чем наблюдения, более далекие друг от друга внести новые знания в развитие машинного обуче‑
во времени. ния как раздела компьютерных наук, которые могут 

Целью данной работы является поиск адекватной быть применены к другим предметным областям.
модели для прогноза временных рядов с учетом ми‑ Теоретической ценностью работы является разви‑
нимизации ошибок и высокой точности. тие исследований по применению методов машинно‑

Одной из распространенных и часто применяемых го обучения к алгоритмической торговле. Кроме того, 
в контексте прогнозирования финансовых временных подобные методы, могут быть перенесены на другие 
рядов является модель ARIMA (от англ. Autoregressive предметные области при поиске стратегии наиболее 
moving average —  интегрированная модель авторег‑ точного прогноза следующего значения временного 
рессии скользящего среднего, иногда ее называют ряда для максимизации прибыли. В качестве прак‑
моделью Бокса‑Дженкинса) [1]. Популярными мо‑ тической ценности работы можно рассматривать 
делями глубокого обучения являются RNN (от англ. возможность создания программных продуктов для 
Recurrent neural network — р екуррентная нейронная торговли на бирже на основании алгоритмов, иссле‑
сеть) [2] и ее модификация LSTM (от англ. Long short‑ дуемых в работе.
term memory —  сеть долгой краткосрочной памяти), 
предложенная в 1997 г. З. Хохрайтером и Ю. Шмид‑ МАШИННОЕ ОБУЧЕНИЕ 
хубером [3]. Глубокое обучение позволяет находить НА ФОНДОВОМ РЫНКЕ
сложные закономерности в последовательных про‑ Фондовый рынок —  публичная торговая площадка 
странственных цепочках. Рекуррентная нейронная для покупки и продажи ценных бумаг различных 
сеть, например, применяется для распознавания компаний. Попытки точно предсказать будущие зна‑
рукописного текста и речи. LSTM модель, в частности, чения цены той или иной акции являются важной 
была использована для предсказания волатильности экономической задачей для широкого круга ком‑
индекса S&P 500 [4–6]. паний, так как успешный прогноз может вылиться 

FINANCETP.FA.Ru 15



СОВРЕМЕННЫЕ МЕТОДЫ ИССЛЕДОВАНИЯ/ MODERN RESEARCH METHODS

в большой финансовый успех. С самого зарождения мами были простые и хорошо изученные деревья 
фондовых рынков люди искали и развивали способы решений машины опорных векторов. Для таких 
максимально точно предсказывать котировки цен‑ алгоритмов входными признаками обычно явля‑
ных бумаг. В итоге сформировались три основных ются технические индикаторы рынка. С началом 
подхода: фундаментальный анализ, технический успешного применения нейронных сетей к другим 
анализ и технологические методы. Несмотря на порой задачам, таким, как задачи обработки естественного 
взаимоисключающие результаты использования этих языка (natural language processing), нейронные сети 
подходов в рамках одной задачи (одни предсказывают стали применяться и в области алгоритмической 
будущее значение, другие — н аправление движения торговли, например, для предсказания движений 
для заданного периода времени), все они использу‑ цен на рынке под влиянием появляющихся поли‑
ются для торговли на фондовых рынках. При этом тических или экономических новостей. Появилась 
задача повышения точности прогноза продолжает возможность извлекать сигналы рынка из неструк‑
оставаться актуальной для всех компаний, работаю‑ турированной информации. Обучение с подкрепле‑
щих на фондовых рынках. Данная работа посвящена нием (reinforcement learning) является одним из бы‑
применению машинного (включая глубокое) обучения строразвивающихся разделов машинного обучения, 
к проблеме прогнозирования на фондовом рынке. с помощью этого метода достигнуты такие резуль‑
И классическое машинное обучение, и нейронные таты, как способность компьютера играть в различ‑
сети используются в качестве прогнозных инстру‑ ные игры на симуляторе Atari на уровне, превос‑
ментов, тем не менее обучение с подкреплением и ге‑ ходящем уровень человека, ничего изначально не 
нетические алгоритмы не обрели той популярности зная о правилах игры.
и степени разработанности, как многие классические Применение обучения с подкреплением к задачам 
алгоритмы (случайный лес, метод опорных векторов). алгоритмической торговли имело место и ранее, но 
Одними из известных видов нейронных сетей являет‑ более распространенным было применение обучения 
ся нейронная сеть прямого распространения вместе с учителем, так как позволяло достичь лучших резуль‑
с методом обратного распространения ошибки (как татов, однако в последнее время в связи с успехами, 
метода обучения). В торговле на фондовом рынке достигнутыми с помощью обучения с подкреплением 
нейронные сети могут имитировать действия агента, в других предметных областях, возрос интерес к ис‑
выполняющего те или иные задачи на рынке акций. следованиям возможности применения этого класса 
Важной задачей при построении нейронных сетей алгоритмов к задачам алгоритмической торговли.
является предобработка данных, и многие исследова‑ Генетические алгоритмы успешно применяются 
тели решают ее по‑своему, предлагая новые методы, к широкому спектру прикладных областей, например 
так как не существует устоявшихся практик одноз‑ к робототехнике. Можно применять генетические 
начной предобработки входных массивов данных алгоритмы к обобщенным задачам, например таким, 
ввиду большого разнообразия как самих данных, так как построение ансамблей алгоритмов машинного 
и ее типов. Выходные данные в рамках конкретной обучения для повышения точности работы отдельных 
задачи, напротив, могут быть однозначно определе‑ алгоритмов и построение деревьев решений. В таких 
ны, принимая вид финансовых или экономических задачах генетические алгоритмы также показывают 
показателей. Что касается оценки результатов, то свою эффективность. В задачах алгоритмической 
наиболее часто употребляемым методом является торговли изначально они применялись в основном 
сравнение результатов работы алгоритма со значе‑ для генерации так называемых торговых правил. Этот 
ниями из тестовой выборки. метод заключается в том, что с помощью генетических 

алгоритмов создаются функции от технических ин‑
СПОСОБЫ МАШИННОГО ОБУЧЕНИЯ дикаторов рынка, которые наиболее точно способны 

Наиболее традиционным способом применения предсказывать изменение цены актива на некотором 
машинного обучения к задаче алгоритмической промежутке времени. В настоящее время генети‑
торговли является обучение с учителем (supervised ческие алгоритмы применяются на практике для 
learning). В качестве целевой переменной, значе‑ построения автоматизированных торговых систем.
ние которой предсказывается алгоритмом, высту‑
пает изменение цены актива за некоторый период ИССЛЕДОВАНИЯ ВРЕМЕННЫХ РЯДОВ
времени или, альтернативно, волатильность рынка. Анализ временных рядов представляет собой ин‑
В начале исследований по применению машинно‑ тересную область исследования с большим коли‑
го обучения к прогнозированию событий на фи‑ чеством прикладных задач в бизнесе, экономике, 
нансовых биржах часто используемыми алгорит‑ финансах и компьютерных науках. Целью анализа 

16 ФИНАНСЫ: ТЕОРИЯ И ПРАКТИКА / FINANCE: THEORY AND PRACTICE   Т. 24,  № 1’2020



А. В. Алжеев, Р. А. Кочкаров

временного ряда является изучение его динамики, AR (Auto regressive) и MA (Moving average) процессы. 
построение модели, описывающей структуру дан‑ Как указано в акрониме модели, ARIMA(p, d, q) состоит 
ных и, наконец, прогноз будущих значений ряда. из следующих частей [1, 11]:
Крайне важно построение эффективной модели AR —  autoregressive. Регрессионная модель, кото‑
с получением максимально возможной точности. рая использует зависимость между наблюдениями 

Прогнозированием временных рядов традицион‑ и число интегрированных наблюдений (p);
но занимается эконометрика, используя различные I —  integrated. Для обеспечения стационарности 
методы. Модель ARIMA в течение долгого времени путем взятия разностей (d);
считается стандартом в данной области. Однако, не‑ MA —  moving average. Подход, анализирующий 
смотря на крайне широкое использование, модель зависимость между наблюдениями и остатками при 
ARIMA имеет некоторые ограничения. Например, применении модели к интегрированным наблюде‑
с помощью модели ARIMA сложно моделировать нели‑ ниям (q).
нейные зависимости между переменными. Более того, Простая форма AR модели порядка p, т. е. AR(p) 
предполагается постоянное стандартное отклонение может быть записана как линейный процесс следу‑
ошибок в модели, что на практике не наблюдается. ющим образом:
Использование интегрированного подхода совместно p
с моделью GARCH (от англ. Generalized auto‑regressive xt = c +∑ϕi xt −1+∈i ,  (1)
conditional heteroscedasticity —  авторегрессионная   i=1

условная гетероскедастичность) позволяет ослабить 
это ограничение, но построение и оптимизация моде‑ где xt  —  стационарная переменная; c —  константа; 
ли становятся более сложной задачей. Модель GARCH, ϕi  —  коэффициенты автокорреляции; а ∈i  —  остат‑
в этом смысле, предназначена для разъяснения кла‑ ки модели, белый шум с нулевым средним.
стеризации волатильности на финансовых рынках [7]. Простая форма MA модели порядка q, т. е. MA(q) 

Традиционное машинное обучение привнесло может быть записана так:
новые подходы к задачам прогнозирования. Такие q

алгоритмы, как Метод опорных векторов (Support xt = µ+∑θi ∈t −1,  (2)
Vector Machines —  SVM) и Случайный лес (Random   i=0

Forest —  RF) пользуются заслуженным вниманием 
специалистов во множестве областей, включая фи‑ где µ — математическое ожидание процесса (обы‑
нансы. Следующим шагом являлось применение чно предполагается равным нулю); θi  —  веса; θ0  — 
алгоритмов глубокого обучения (Deep learning — г лу‑ предполагается равным 1; ∈t  —  белый шум с нуле‑
бокое обучение). вым средним. Комбинация этих двух моделей дает 

В области глубокого обучения для прогнозирова‑ нам модель ARIMA порядка (p, q):
ния временных рядов наиболее часто применяется p q

модель LSTM —  особый тип сверточной нейронной xt = c +∑ϕi xt −1 +∈ i +∑θi ∈t −1 .   (3)
сети. Несмотря на относительную новизну этого ме‑      i=1 i=0

тода, подход со стороны глубокого обучения обрел 
широкую популярность среди исследователей. На‑ Параметры p и q называются порядком AR и MA, 
пример, К. Краусс и его коллеги использовали ряд соответственно. Использование ARIMA позволяет 
прогнозных подходов —  глубокое обучение, гради‑ делать прогноз на нестационарных данных из‑за вве‑
ентный бустинг над деревьями и случайный лес для дения в модель интегрированности. Это достигается 
моделирования S&P 500 [8]. Результатами являются с помощью взятия разностей —  вычитания уровней 
выводы о низкой производительности моделей глу‑ временного ряда друг из друга.
бокого обучения и сложности их обучения. Сравнение Учитывая сезонность временного ряда, с большой 
различных моделей проводилось на основе эконо‑ вероятностью весомый вклад в модель внесут крат‑
мических данных [9, 10]. косрочные компоненты. Таким образом в модели 

также необходимо учитывать сезонность —  сезон‑
МОДЕЛИ ARIMA И lSTM ную ARIMA (seasonal ARIMA —  SARIMA). Наиболее 

И ПРОГНОЗНЫЕ ВЫЧИСЛЕНИЯ важными этапами являются оценка коэффициентов 
Далее приведено математическое описание про‑ модели. Если дисперсия растет с течением времени, 
гнозных моделей ARIMA и LSTM. необходимо использовать стабилизирующие диспер‑

ARIMA —  это обобщенная модель ARMA (Auto‑ сию трансформации и взятие разностей. Используя 
regressive moving average), которая соединяет в себе автокорреляционную функцию и частную автокор‑

FINANCETP.FA.Ru 17



СОВРЕМЕННЫЕ МЕТОДЫ ИССЛЕДОВАНИЯ/ MODERN RESEARCH METHODS

реляционную функцию, следует измерять линейную трафик, банковские транзакции). LSTM нейронные 
зависимость между наблюдениями и величину q. сети хорошо подходят для классификации, обработки 

LSTM — э то подвид сверточной нейронной сети со и построения прогнозов на основе временных рядов, 
способностью «запоминания» значений наблюдений где взаимосвязанные явления могут происходить 
ранних этапов для использования их в будущем. Для с неопределенным временным лагом. Этот временной 
ознакомления с LSTM необходимо дать некоторые лаг приводит к затруднениям в использовании класси‑
определения и пояснения [2, 3]. ческих нейронных сетей в решении данных проблем 

Artificial neural network (искусственная нейронная из‑за затухания градиента, в то время как LSTM сети 
сеть) —  нейронная сеть, состоящая из по крайней нечувствительны к величине временного лага.
мере трех слоев: входного, скрытого и выходного. В LSTM сети существуют 3 типа слоев:
Количество переменных в наборе данных определяет 1. Слой «забывания» (Forget gate) —  на выход 
размерность или число узлов во входном слое. Эти подается число от 0 до 1, где 1 обозначает необходи‑
узлы соединены ребрами, каждое из которых несет мость полного запоминания, а 0 полностью стирает 
какой‑либо вес, от которого зависит, может ли сигнал из памяти.
пройти через слой или нет. Нейронная сеть обучается, 2. Слой «запоминания» (Memory gate) выбира‑
изменяя эти веса на основе данных. В скрытых слоях ет, какие данные необходимо сохранить. В первую 
узлы используют функцию активации (например, очередь с помощью сигмоидного слоя выбираются 
сигмоида) на взвешенной сумме входных данных, значения, которые затем запоминаются.
чтобы преобразовать их в выходные (в нашем случае 3. Выходной слой (Output gate) выбирает инфор‑
предсказания). Выходной слой генерирует вектор ве‑ мацию из каждой «ячейки», в которой произведено 
роятностей для различных предсказанных значений запоминание.
и выбирает один с наименьшей ошибкой. Веса не мо‑
гут быть оптимальны сразу, поэтому нейронная сеть СРАВНИТЕЛЬНЫЙ АНАЛИЗ МОДЕЛЕЙ 
обучается с учетом результата предыдущей итерации ARIMA И lSTM
обучения. Эти итерации называются эпохами и веса Поставив целью сравнение моделей ARIMA и LSTM, 
изменяются до тех пор, пока не достигнут оптималь‑ авторами была проведена серия экспериментов 
ного (заданного) значения. на финансовых данных в виде временных рядов. 

Recurrent neural network (сверточная нейронная Главным вопросом исследования —  какой алгоритм 
сеть) —  особая нейронная сеть, целью которой явля‑ ARIMA или LSTM позволяет более качественно про‑
ется предсказание следующего наблюдения в серии. изводить прогнозы временных рядов.
Идеей, стоящей за RNN, является желание извлечь Авторами собраны 1 исторические данные по ценам 
полезную информацию из серии наблюдений для акций российских предприятий: Алроса, Газпром, 
совершения предсказаний. Соответственно, более КамАЗ, НЛМК, Киви, Роснефть, ВТБ и Яндекс. Каждый 
ранние наблюдения необходимо запоминать. В мо‑ набор данных содержит такие значения, как ‘Open’, 
дели RNN внутренний слой служит для запоминания ‘High’, ‘Low’, ‘Close’, ‘Volume’. Для анализа выбран набор 
информации с предыдущих наблюдений серии. Глав‑ данных по значению ‘Close’ за период с 02.06.2014 по 
ной проблемой является запоминание небольшого 11.11.2019 г. с разбивкой по неделям. Также произведе‑
количества предшествующих наблюдений, что не но разделение данных на тренировочный и тестовый 
подходит для длинных (финансовых, экономических) набор в соотношении 70% к 30% без перемешивания. 
периодов. Для решения этой задачи были разрабо‑ Тренировочный набор данных был использован для 
таны LSTM сети. обучения модели, а тестовый — д ля оценки качества 

Long short‑term memory нейронная сеть (долгая ее обучения. Графики собранных данных представ‑
краткосрочная память) — э то искусственная сверточ‑ лены на рис. 1.
ная нейронная сеть, используемая в области глубокого Показатель RMSE (от англ. Root Mean Square Error, 
обучения. В отличие от обычных нейронных сетей RMS Error —  среднеквадратичная ошибка) исполь‑
с прямой связью, LSTM сети имеют обратные связи. зуется для оценки качества предсказания модели. 
Подобные сети способны обрабатывать не только от‑ Он измеряет разницу между истинным и предска‑
дельные единичные данные (например, изображения), занным значениями. Формула показателя задается 
но и целые последовательности данных (например, формулой [12]:
аудиозапись речи или видеозаписи). Поэтому LSTM 
сети способны решать такие задачи, как распознава‑
ние рукописного ввода, распознавание речи, опреде‑ 1 URL: https://www.finam.ru/profile/moex‑akcii/gazprom/export/ 
ление аномалий в больших потоках данных (сетевой (дата обращения: 14.11.2019).

18 ФИНАНСЫ: ТЕОРИЯ И ПРАКТИКА / FINANCE: THEORY AND PRACTICE   Т. 24,  № 1’2020



А. В. Алжеев, Р. А. Кочкаров

Рис. 1 / Fig. 1. Динамика изменения акций российских компаний / Stock performance of Russian companies
Источник / Source: составлено авторами / compiled by the authors.

сказании следующей точки временного ряда каждо‑
1 N

RMSE = ∑(xi − x 2


i ) ,  (4) го набора данных. Подход использует тренировоч‑
    N 1 ные наборы данных, каждый из которых содержит 

N на одно наблюдение больше, чем предыдущий. Су‑
где N  —  общее число наблюдений; а ∑(xi − xi )  ществует несколько различных вариаций данного 

1 алгоритма, среди которых известны следующие:
представляет собой квадрат суммы разностей 1. Одношаговый без переоценки. Модель оце‑
истинного значения и предсказания модели. Глав‑ нивает один набор тренировочных данных и затем 
ным достоинством использования метрики RMSE вычисляет прогноз на один шаг вперед.
является «штрафование» модели за большие 2. Многошаговый без переоценки. Аналогичный 
ошибки. предыдущему, однако прогноз дается на несколько 

следующих шагов.
РАЗРАБОТКА АЛГОРИТМОВ 3. Многошаговый с переоценкой. Прогноз вычи‑

ARIMA И lSTM сляется на несколько шагов вперед, однако модель 
Алгоритмы разработаны авторами для прогноза обучается заново на каждой итерации перед про‑
временных рядов и основаны на подходе “Rolling гнозом.
forecasting origin” («прогнозирование происхожде‑ В данной статье используется алгоритм с постро‑
ния») [13]. В основе алгоритма лежит фокус на пред‑ ением новой модели каждый раз, когда добавляются 

FINANCETP.FA.Ru 19



СОВРЕМЕННЫЕ МЕТОДЫ ИССЛЕДОВАНИЯ/ MODERN RESEARCH METHODS

 
Рис. 2 / Fig. 2. Алгоритм скользящего окна для модели ARIMA / Sliding window algorithm for ARIMA model
Источник / Source: составлено авторами / compiled by the authors.

новые данные. Алгоритмы реализованы в среде про‑ 1) данные разбиваются на тренировочный и те‑
граммирования Python 2 с подключенными библио‑ стовый наборы;
теками Keras, Theano и Statsmodels. 2) фиксируется параметр random_state для вос‑

На рис. 2 представлен алгоритм скользящего окна произведения результатов;
для модели ARIMA. Алгоритм ARIMA разбит на сле‑ 3) определяется функция fit_lstm, в качестве ар‑
дующие этапы: гументов принимается набор данных, число эпох 

1) входные данные (каждый финансовый вре‑ и число нейронов;
менной ряд) разбиваются на тренировочный и те‑ 4) создается скрытый слой;
стовый наборы; 5) задается оптимизационный алгоритм 

2) создаются дополнительные структуры (мас‑ и функция потерь (Adam и MSE);
сивы, в которых хранятся записи и вносятся изме‑ 6) после этого модель обучается, при этом ее 
нения о «текущих» исторических данных, прогнозы) внутреннее состояние каждый раз восстанавлива‑
для обучения модели; ется (код в строке 12) на исходное;

3) модель обучается на текущем наборе данных 7) производится прогноз и вычисляется метри‑
и производит прогноз, который далее записывается ка RMSE для модели LSTM.
в массив predictions, изменяя массив history;

4) вычисляется метрика RMSE для модели РЕЗУЛЬТАТЫ ИСПОЛНЕНИЯ АЛГОРИТМОВ
ARIMA. Результаты исполнения алгоритмов представлены 

На рис. 3 представлен алгоритм скользящего окна на рис. 4. На финансовых временных рядах модель 
для модели LSTM. LSTM показала себя лучше, чем модель ARIMA. Зна‑

В отличие от моделей регрессии, в анализе времен‑ чения RMSE моделей равны 10,8 и 26,7, соответст‑
ных данных существует последовательность зависи‑ венно. Применение модели LSTM позволяет умень‑
мостей между входными переменными. Сверточные шить значение RMSE на 65% по сравнению с моде‑
нейронные сети очень хорошо улавливают подобные лью ARIMA.
зависимости.

Алгоритм LSTM разбит на следующие этапы: ВЫВОДЫ
Сравнительный анализ двух алгоритмов на основе 

2 URL: https://www.python.org/ (дата обращения: 15.01.2020). моделей LSTM и ARIMA определил превосходство 

20 ФИНАНСЫ: ТЕОРИЯ И ПРАКТИКА / FINANCE: THEORY AND PRACTICE   Т. 24,  № 1’2020



А. В. Алжеев, Р. А. Кочкаров

 
Рис. 3 / Fig. 3. Алгоритм скользящего окна для модели lSTM / Sliding window algorithm for lSTM model
Источник / Source: составлено авторами / compiled by the authors.

модели LSTM над моделью ARIMA в части мини‑ лей в различных областях науки. Главным вопросом 
мизации среднеквадратической ошибки RMSE. является точность и адекватность новых подходов 
Значение ошибки RMSE модели LSTM меньше со‑ по сравнению с традиционными методами. В статье 
ответствующей ошибки для модели ARIMA в сред‑ проведено сравнение точности прогнозирования 
нем на 65%. моделей ARIMA и LSTM, представляющих два разных 

Развивающиеся в настоящее время технологии метода. Обе модели были применены на различных 
анализа больших данных, алгоритмы машинного наборах финансовых данных —  временных рядах 
обучения и, в частности, алгоритмы глубокого об‑ цены закрытия акции на конец недели — и  результаты 
учения набирают популярность среди исследовате‑ показывают превосходство модели LSTM.

FINANCETP.FA.Ru 21



СОВРЕМЕННЫЕ МЕТОДЫ ИССЛЕДОВАНИЯ/ MODERN RESEARCH METHODS

Рис. 4 / Fig. 4. Результаты исполнения алгоритмов ARIMA и lSTM / ARIMA and lSTM algorithm execution results
Источник / Source: составлено авторами / compiled by the authors.

Существующие на данный момент задачи оценки ве нейронных сетей, больших графов и машинного 
качества моделей весьма многочисленны. Авторы за‑ обучения для исследования инструментов финан‑
тронули лишь некоторые их аспекты. Представляется сового рынка российских компаний. В этом смысле 
целесообразным исследование и применение новых перспективным видится агрегированный подход, 
алгоритмов обработки больших данных на осно‑ комбинирующий разные подходы и алгоритмы.

БЛАГОДАРНОСТЬ
Работа выполнена при поддержке гранта РФФИ 18–00–01103. Финансовый университет, Москва, Россия.

ACKNOWlEDGEMENTS
The article was supported by the RFBR grant 18–00–01103. Financial University, Moscow, Russia.

СПИСОК ИСТОЧНИКОВ
1. Магнус Я. Р., Катышев П. К., Пересецкий А. А. Эконометрика. Начальный курс. М.: Дело; 2007. 504 с.
2. Schmidhuber J. Habilitation. System modeling and optimization. Postdoctoral thesis. Munich: Technical University 

of Munich; 1993. 209 p. (In German).
3. Hochreiter S., Schmidhuber J. Long short‑term memory. Neural Computation. 1997;9(8):1735–1780. DOI: 10.1162/

neco.1997.9.8.1735
4. Brownlee J. Time series prediction with LSTM recurrent neural networks in Python with Keras. Machine Learning 

Mastery. 2016. URL: https://machinelearning mastery.com/time‑series‑prediction‑lstm‑recurrent‑neural‑
networks‑python‑keras

5. Gers F. A., Schmidhuber J., Cummins F. Learning to forget: Continual prediction with LSTM. Neural Computation. 
2000;12(10):2451–2471. DOI: 10.1162/089976600300015015

6. Кратович П. В. Нейронные сети и модели ARIMA для прогнозирования котировок. Программные продукты 
и системы. 2011;(1):95–98.

7. Garcia F., Guijarro F., Moya I., Oliver J. Estimating returns and conditional volatility: A comparison between the 
ARMA‑GARCH‑M models and the backpropagation neural network. International Journal of Complex Systems in 
Science. 2012;1(2):21–26.

8. Krauss C., Do X. A., Huck N. Deep neural networks, gradient‑boosted trees, random forests: Statistical arbitrage 
on the S&P 500. European Journal of Operational Research. 2017;259(2):689–702. DOI: 10.1016/j.ejor. 2016.10.031

9. Chung J., Lee D., Seo Y., Yoo C. D. Deep attribute networks. NIPS Workshop on Deep Learning and Unsupervised 
Feature Learning. 2012;3. URL: http://www.eng.uwaterloo.ca/~jbergstr/files/nips_dl_2012/Paper%2011.pdf

10. Fischer T., Krauss C. Deep learning with long short‑term memory networks for financial market predictions. 
European Journal of Operational Research. 2018;270(2):654–669. DOI: 10.1016/j.ejor.2017.11.054

22 ФИНАНСЫ: ТЕОРИЯ И ПРАКТИКА / FINANCE: THEORY AND PRACTICE   Т. 24,  № 1’2020



А. В. Алжеев, Р. А. Кочкаров

11. Эконометрика. Елисеева И. И., ред. М.: Финансы и статистика; 2006. 576 с.
12. Armstrong J. S., Collopy F. Error measures for generalizing about forecasting methods: Empirical comparisons. 

International Journal of Forecasting. 1992;8(1):69–80. DOI: 10.1016/0169–2070(92)90008‑W
13. Hyndman R. J., Athanasopoulos G. Forecasting: Principles and practice. 2nd ed. Melbourne: OTexts; 2018. 382 p.

REFERENCES
1. Magnus Ya.R., Katyshev P. K., Peresetsky A. A. Econometrics. Beginner course. Moscow: Delo; 2007. 504 p. (In Russ.).
2. Schmidhuber J. Habilitation. System modeling and optimization. Postdoctoral thesis. Munich: Technical University 

of Munich; 1993. 209 p. (In German).
3. Hochreiter S., Schmidhuber J. Long short‑term memory. Neural Computation. 1997;9(8):1735–1780. DOI: 10.1162/

neco.1997.9.8.1735
4. Brownlee J. Time series prediction with LSTM recurrent neural networks in Python with Keras. Machine Learning 

Mastery. 2016. URL: https://machinelearning mastery.com/time‑series‑prediction‑lstm‑recurrent‑neural‑
networks‑python‑keras

5. Gers F. A., Schmidhuber J., Cummins F. Learning to forget: Continual prediction with LSTM. Neural Computation. 
2000;12(10):2451–2471. DOI: 10.1162/089976600300015015

6. Kratovich P. V. Neural networks and ARIMA models for predicting quotes. Programmnye produkty i sistemy = 
Software & Systems. 2011;(1):95–98. (In Russ.).

7. Garcia F., Guijarro F., Moya I., Oliver J. Estimating returns and conditional volatility: A comparison between the 
ARMA‑GARCH‑M models and the backpropagation neural network. International Journal of Complex Systems in 
Science. 2012;1(2):21–26.

8. Krauss C., Do X. A., Huck N. Deep neural networks, gradient‑boosted trees, random forests: Statistical arbitrage 
on the S&P 500. European Journal of Operational Research. 2017;259(2):689–702. DOI: 10.1016/j.ejor. 2016.10.031

9. Chung J., Lee D., Seo Y., Yoo C. D. Deep attribute networks. NIPS Workshop on Deep Learning and Unsupervised 
Feature Learning. 2012;3. URL: http://www.eng.uwaterloo.ca/~jbergstr/files/nips_dl_2012/Paper%2011.pdf

10. Fischer T., Krauss C. Deep learning with long short‑term memory networks for financial market predictions. 
European Journal of Operational Research. 2018;270(2):654–669. DOI: 10.1016/j.ejor.2017.11.054

11. Eliseeva I. I., ed. Econometrics. Moscow: Finansy i statistika; 2006. 576 p. (In Russ.).
12. Armstrong J. S., Collopy F. Error measures for generalizing about forecasting methods: Empirical comparisons. 

International Journal of Forecasting. 1992;8(1):69–80. DOI: 10.1016/0169–2070(92)90008‑W
13. Hyndman R. J., Athanasopoulos G. Forecasting: Principles and practice. 2nd ed. Melbourne: OTexts; 2018. 382 p.

ИНФОРМАЦИЯ ОБ АВТОРАХ / AbOuT THE AuTHORS

Андрей Вадимович Алжеев —  студент магистратуры Департамента анализа данных, при‑
нятия решений и финансовых технологий, Финансовый университет, Москва, Россия
Andrei V. Alzheev —  Master’s student, Department of Data Analysis, Decision Making and 
Financial Technology, Financial University, Moscow, Russia
alzheev@gmail.com

Расул Ахматович Кочкаров — к андидат экономических наук, доцент Департамента анали‑
за данных, принятия решений и финансовых технологий, Финансовый университет, Мо‑
сква, Россия
Rasul A. Kochkarov —  Cand. Sci. (Econ.), Assoc. Prof., Department of Data Analysis, Decision 
Making and Financial Technology, Financial University, Moscow, Russia
rasul_kochkarov@mail.ru

Статья поступила в редакцию 18.11.2019; после рецензирования 17.12.2019; принята к публикации 20.12.2019.
Авторы прочитали и одобрили окончательный вариант рукописи.
The article was submitted on 18.11.2019; revised on 17.12.2019 and accepted for publication on 20.12.2019.
The authors read and approved the final version of the manuscript.

FINANCETP.FA.Ru 23