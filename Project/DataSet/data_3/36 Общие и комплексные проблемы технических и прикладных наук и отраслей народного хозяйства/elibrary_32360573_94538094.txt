ТЕХНОЛОГИИ БОЛЬШИХ ДАННЫХ ДЛЯ КОРРЕЛЯЦИИ 
СОБЫТИЙ БЕЗОПАСНОСТИ НА ОСНОВЕ УЧЕТА ТИПОВ 
СВЯЗЕЙ 

Котенко И.В.1, Федорченко А.В.2, Саенко И.Б.3, Кушнеревич А.Г.4

Работа посвящена исследованию подхода к параллельной обработке данных для выполнения задач 
корреляции событий безопасности на основе технологий больших данных. Рассматриваются различные 
методы и задачи корреляции событий безопасности, а также технологии обработки больших данных, 
применимые для задач мониторинга безопасности. Основное внимание уделяется задачам выявления 
связей между типами событий безопасности и оценки зависимости силы связей от распределения 
событий во времени. Описывается реализация задач корреляции на платформе Spark, и приводятся 
результаты экспериментальной оценки показателей процессов корреляции событий безопасности.5

Ключевые слова: корреляция событий, инциденты безопасности, коэффициент корреляции 
Пирсона, SIEM-системы, большие данные, параллельная обработка данных

DOI: 10.21681/2311-3456-2017-5-2-16

Введение сотен / тысяч таких источников данных. В резуль-
В настоящее время средства обнаружения, тате в SIEM-систему за день могут поступать на 

предупреждения и предотвращения компью- обработку данные о десятках / сотнях миллионов 
терных атак и вредоносной активности, а также событий безопасности. 
мониторинга и управления безопасностью пред- Обработка этих данных включает такие опера-
ставлены различными классами решений. Одним ции, как фильтрация, агрегация, приоритезация, 
из таких классов являются системы SIEM (Security корреляция и другие. Наибольшей вычислитель-
Information and Event Management) [1-3]. Основ- ной сложностью обладает операция корреляции 
ными задачами SIEM-систем являются сбор боль- событий безопасности. Суть этой операции за-
ших массивов гетерогенных данных о событиях ключается в определении причинно-следствен-
безопасности и обнаружение инцидентов и угроз ных связей между поступающими на обработку 
безопасности в результате их обработки [4,5]. событиями. Это позволяет выявлять вредоносную 
При этом одной из достаточной острых проблем, и аномальную активности, определять источник 
стоящих перед современными SIEM-системами, и цель атаки, обнаруживать многошаговые ата-
является проблема обработки больших данных, ки, делать выводы об инцидентах безопасности и 
которая вызвана необходимостью обработки вырабатывать эффективные контрмеры [6,7]. При 
огромных массивов разнородных данных о собы- этом следует отметить, что все эти действия долж-
тиях безопасности (логов), поступающих в SIEM- ны выполняться в реальном или близком к реаль-
систему от различных источников. В качестве ис- ному времени, чтобы не дать возможности злоу-
точников больших данных выступают операцион- мышленнику реализовать свои вредоносные цели. 
ные системы, системы управления базами данных, Однако проблема выполнения операции кор-
антивирусные средства, сетевые элементы, си- реляции событий безопасности в SIEM системах в 
стемы обнаружения атак и т.д. Современная ком- реальном или близком к реальном времени остает-
пьютерная сеть, безопасность которой управля- ся нерешенной проблемой. Ее решение возможно 
ется SIEM-системой, может содержать несколько только с использованием современных подходов, 

1  Котенко  Игорь  Витальевич,  доктор  технических  наук,  профессор,  Санкт-Петербургский  институт  информатики  и 
автоматизации Российской академии наук, Университет ИТМО, Санкт-Петербург, Россия. E-mail: ivkote@comsec.spb.ru 

2  Федорченко Андрей Владимирович, мл. научный сотрудник, Санкт-Петербургский институт информатики и автоматизации 
Российской академии наук, Университет ИТМО, Санкт-Петербург, Россия. E-mail: fedorchenko@comsec.spb.ru 

3  Саенко  Игорь  Борисович,  доктор  технических  наук,  профессор,  ведущий  научный  сотрудник,  Санкт-Петербургский 
институт  информатики  и  автоматизации  Российской  академии  наук,  Университет  ИТМО,  Санкт-Петербург,  Россия. 
E-mail: ibsaen@comsec.spb.ru 

4  Кушнеревич  Алексей  Геннадьевич,  младший  научный  сотрудник,  Санкт-Петербургский  институт  информатики  и 
автоматизации Российской академии наук, Университет ИТМО, Санкт-Петербург, Россия. E-mail: kushnerevich@comsec.spb.ru 

5  Работа выполнена при поддержке гранта РНФ №15-11-30029.

2 Вопросы кибербезопасности  №5(24) - 2017 



Технологии больших данных для корреляции событий безопасности ...
средств и методов обработки Больших Данных. 
Одним из таких подходов является использование 
современных программных средств реализации 
параллельных потоковых вычислений. 

Известно несколько средств реализации 
параллельных вычислений. К числу наиболее 
распространенных относятся Hadoop и Spark. 
При этом Spark на больших объемах входных 
данных показывает более высокую производи-
тельность. В то же время Spark является более 
молодым средством. Работы, в которых Spark 
применяется для обработки событий безопас-
ности, только начинают появляться. Это позво-
лило сформулировать основные цели работы, 
которыми являются (1) формализация задач 
выявления связей между типами событий без-
опасности и оценки зависимости силы связей 
от распределения событий во времени, решае- Рис. 1. Схема процесса корреляции данных  
мых в SIEM-системах при корреляции событий в SIEM-системе
безопасности, (2) реализация алгоритмов реше-
ния этих задач в Spark и (3) экспериментальная •	 анонимизация	 (преобразование	данных	с	
оценка полученных решений. целью исключения их нежелательного разглаше-

Новизна работы заключается в формальной ния);
спецификации и реализации в среде параллель- •	 фильтрация	(отсеивание	дублируемых,	ма-
ных вычислений нового подхода к выявлению лозначительных или бесполезных данных);
косвенных связей между типами событий без- •	 агрегация	 (получение	 новых	 данных	 с	 ис-
опасности и оценке зависимости силы связи по пользованием различных функций агрегирования, 
отношению к времени, основанной на использо- таких как average(), count(), min(), max() and so on); 
вании коэффициентов корреляции Пирсона. Тео- •	 анализ	 (нахождение	 закономерностей	
ретический вклад работы состоит в развитии ме- появления и зависимостей, в том числе скрытых, 
тодов корреляции, которые позволяют выявлять между событиями безопасности); 
однотипные и разнотипные связи между события- •	 собственно	 корреляция	 (определение	
ми безопасности, а также развитии технологии об- взаимосвязей между экземплярами событий и их 
работки Больших данных на примере корреляции групп);
больших массивов разнородных данных о собы- •	 ранжирование	 (оценка	 результатов	 кор-
тиях безопасности в SIEM системах. реляции по определенным признакам); 

•	 приоритезация	(вычисление	степени	важ-
Постановка задачи и релевантные работы ности результатов процесса корреляции).
О процессе корреляции данных о событиях В последовательности этапов, представленной 

безопасности принято говорить в широком и уз- на рис. 1, корреляция понимается в узком смысле 
ком смысле слова. В широком смысле слова под слова. Ее суть заключается в нахождении причин-
корреляцией данных понимается вся предвари- но-следственных связей между анализируемыми 
тельная обработка данных, собираемых SIEM си- событиями безопасности. Эта операция по своей 
стемой от источников. Результаты этой обработки вычислительной сложности является наиболее 
помещаются в хранилище данных SIEM системы и сложной из всех этапов, перечисленных на рис.1. 
используются в дальнейшем для проведения бо- Реализация этого этапа с помощью параллельных 
лее детального и тщательного анализа информа- вычислений представляет несомненный интерес 
ции о безопасности. Обычно в рамках корреляции с научной и практической точек зрения. Поэтому 
данных о событиях безопасности, понимаемой  в в дальнейшем в работе говоря о корреляции со-
широком смысле слова, выделяются следующие бытий безопасности, будем рассматривать опре-
этапы (рис. 1) [6,8,9]: деление этой операции в узком смысле слова.

•	 нормализация	 (приведение	 собираемых	 Таким образом, постановка задачи, решаемой 
данных к единому формату); в работе, заключается в следующем. Входными 

Вопросы кибербезопасности  №5(24) - 2017 3



Мониторинг безопасности объектов УДК 004.75
(исходными) данными является поток данных о кации администратора безопасности (проекти-
событиях безопасности, которые относятся к раз- ровщика). 
личным типам. Необходимо разработать метод Другие методы корреляции, такие как шаблон-
обработки входного потока данных, позволяю- но-ориентированный (сценарно-ориентирован-
щий выявлять прямые и косвенные связи между ный) [12], граф-ориентированный [15,16], осно-
экземплярами событий различных типов и допу- ванный на машине конечных состояний [15,17], 
скающий свое распараллеливание в среде Spark. основанный на анализе схожести [18,19] и другие, 

Различные методы корреляции данных были по своей сути имеют различные модели представ-
впервые использованы в Intrusion Detection ления событий безопасности и их связей. Однако, 
Systems (IDSs) для обнаружения связей между се- в конечном итоге, они также могут быть выраже-
тевыми событиями с целью их последующей агре- ны в виде правил, поскольку все они являются сиг-
гации и выявления атак, в том числе распреде- натурными методами. 
ленных и многошаговых [3]. Методы корреляции Достаточно интересным современным направ-
данных о событиях безопасности, реализованные лением развития методов корреляции событий 
в IDSs, были в дальнейшем внедрены и адаптиро- является применение подходов, базирующихся на 
ваны в SIEM-системах для обработки данных о со- машинном обучении и интеллектуальном анали-
бытиях безопасности. В настоящее время процесс зе данных, таких как байесовские сети [12,15,20], 
корреляции данных в различных SIEM-системах иммунные сети [15,20], искусственные нейрон-
отличается большим многообразием реализо- ные сети [15,20-22] и другие. Достоинство данных 
ванных в них методов и подходов [10,11]. В общем подходов заключается в возможности самосто-
случае следует считать, что для корреляции воз- ятельной (безусловной) корреляции событий с 
можно использование комбинации различных минимизацией ручной настройки. Однако для по-
методов, каждый из которых обладает своими до- строения моделей обучения требуется предвари-
стоинствами и недостатками. тельный анализ самих данных, который далеко не 

Все методы корреляции данных можно услов- всегда можно автоматизировать. Кроме того, при-
но разделить на сигнатурные и эвристические. менение интеллектуальных подходов накладыва-
Данные методы могут применять различные под- ет дополнительные требования по оценке адек-
ходы, основанные на анализе схожести, статисти- ватности и качества моделей, а исходные данные 
ческом анализе, интеллектуальном анализе дан- обучения должны быть репрезентативными.
ных и прочие. Анализ применяемых методов кор- Применение параметрических и непараме-
реляции в существующих решениях значительно трических показателей корреляции (линейных, 
усложняется ввиду отсутствия работ с детальным различных ранговых и других), в том числе ко-
описанием используемых методов корреляции. эффициентов Пирсона, описывается в [23-25] для 

В настоящее время наиболее распространен- решения задач оценки алгоритмов, выявления об-
ным и простым в реализации, однако достаточно разов распределенных DoS-атак, выделения под-
сложным в настройке и не приспособленным к множеств признаков данных, по которым произ-
автоматизированной адаптации, является пра- водится обнаружение вторжений. 
вило-ориентированный метод [12-14]. Основным В [26] рассматриваются детерминированный 
принципом настройки SIEM-систем, использу- и стохастический подходы корреляции событий 
ющих данный метод, является составление пра- для задачи обнаружения сетевых атак. Предлага-
вил корреляции в зависимости от характеристик ется вероятностная модель процесса корреляции 
анализируемой инфраструктуры. Работа модуля событий, которая основана на их пространствен-
корреляции на основе правило-ориентирован- но-временном анализе. В рамках представленной 
ного метода базируется на фиксированном соот- модели, пространства событий связываются в 
несении событий друг с другом при выполнении цепи последовательностей, а каждому простран-
определенных условий. Данные условия могут ству в текущий момент соответствует конкретное 
содержать логические операции над данными, состояние из множества состояний. Полученные 
их свойствами и вычисляемыми показателями. цепи последовательностей используются для вы-
Главным недостатком данного метода является числения вероятности выполнения определенно-
сложность процесса составления правил. Дру- го сценария атаки. 
гим недостатком является тот факт, что качество В [27] рассматривается процесс корреляции 
выполнения корреляции правило-ориентиро- для обнаружения атак в облачной вычислитель-
ванным методом напрямую зависит от квалифи- ной среде, как системе распределенных сенсоров. 

4 Вопросы кибербезопасности  №5(24) - 2017 



Технологии больших данных для корреляции событий безопасности ...
Для выполнения подхода предлагается использо- теке MLib из состава фрэймворка многопоточной 
вать технологию CEP (Complex Event Processing). обработки информации Spark.
Предлагаемая онтологическая модель обнаруже- Анализ релевантных работ показывает, что в 
ния атак включает сценарии, индикаторы, симпто- настоящее время разработано достаточно боль-
мы и воздействия атак, а также состояние предпо- шое количество методов корреляции данных, 
лагаемой цели. которые обладают различными достоинствами 

В [28] предлагается использование модели по- и недостатками. Ряд предлагаемых подходов ба-
ведения приложений для выявления неправомер- зируется на использовании сценариев атак для 
ной и аномальной активности. Исходными дан- формирования последовательностей атакующих 
ными для построения модели являются события, действий, что относит их к классу сигнатурных 
отражающие системные вызовы всевозможных методов и предполагает значительные времен-
приложений. Выделено 5 уровней представления ные затраты для настройки и адаптации к целевой 
модели, верхним уровнем является выделенная инфраструктуре. Важным направлением дальней-
функциональность. На основе исходной инфор- шего совершенствования методов корреляции 
мации формируется профиль нормального пове- является их адаптация к технологиям обработки 
дения за счет обработки мульти-графа, в котором Big Data и параллельных вычислений. Среди со-
каждой вершиной является событие. временных средств, реализующих параллельные 

Для определения возможности применять со- вычисления, одним из наиболее предпочтитель-
временные средства параллельной обработки ных является фреймворк Spark. В представленной 
в процессе корреляции данных о событиях без- работе акцент делается на выявлении связей меж-
опасности были проанализированы работы, по- ду типами событий и оценке зависимости силы 
священные применению технологии обработки связей от распределения событий во времени. 
Big Data для выполнения различных задач обеспе- Одним из подходов к оценке указанной зависимо-
чения безопасности. Пример Stream Processing сти является применение двумерного линейного 
Engine для обработки событий представлен в [29]. коэффициента Пирсона, поскольку данный пока-
Предлагаемый подход позволяет обеспечить  гиб- затель требует наименьших затрат вычислитель-
кое управление ресурсами и балансировку на- ных ресурсов.
грузки с низкими накладными расходами. В [30] 
описываются результаты исследования различ- Математические основы процесса корреля-
ных средств обработки больших данных из соста- ции событий безопасности
ва фрэймворков Hadoop и Spark, которые приме- А. Основные задачи процесса корреляции 
нялись для решения задач анализа сетевого тра- Для исследования возможности и оценки ре-
фика с целью выявления аномальной активности. зультативности параллельной обработки данных 
В этой работе для проведения экспериментов был в процессе корреляции событий безопасности не-
использован вычислительный кластер, а задачи обходимо в первую очередь выделить основные 
анализа трафика были реализованы за счет само- задачи корреляции. К числу общих задач процес-
обучающихся алгоритмов. Результаты проведен- са корреляции относятся: 
ных исследований показали явное преимущество •	 преобразование	 низкоуровневых	 собы-
технологии многопоточной обработки данных тий в высокоуровневые события с помощью агре-
Spark над другими сравниваемыми технологиями гирования; 
работы с большими данными. •	 определение	 связей	между	 разноуровне-

[31] посвящена сравнению технологий об- выми событиями и информацией безопасности; 
работки больших данных для анализа сетевого •	 приоритезация	событий			вычисление	важ-
трафика. Результатом этой работы является выяв- ности событий и их групп в рамках задачи обеспе-
ление преимущества в точности классификации чения безопасности; 
трафика с помощью алгоритма случайного леса •	 обнаружение	 инцидентов	 и	 формирова-
деревьев решений (Random Forest) над алгорит- ние предупреждений безопасности. 
мом наивного Байеса (Naïve Bayes). Также, как и в Первоначальным этапом корреляции событий 
[30], указывается вычислительное преимущество безопасности является сбор разнородных (сырых) 
технологии Spark. данных из множества разнородных источников. 

В [32] алгоритмы интеллектуального анализа Заключительным этапом корреляции является 
больших данных для выполнения задач монито- определение текущего состоянии защищенности 
ринга безопасности были реализованы в библио- анализируемой сетевой инфраструктуры.

Вопросы кибербезопасности  №5(24) - 2017 5



Мониторинг безопасности объектов УДК 004.75
В ходе исследования различных аспектов па- Выделение прямых связей осуществляется на 

раллельной обработки событий безопасности основе анализа структур типов событий по их рав-
следует учитывать, что процесс корреляции яв- нозначным (одинаковым) свойствам. Например, 
ляется непрерывным. Кроме того, он должен вы- для ОС Windows при сравнении типов событий 
полняться в реальном масштабе времени. Также «Завершение процесса» (4689) и «Вызвана приви-
стоит отметить, что основной причиной приме- легированная служба» (4673), равнозначным свой-
нения параллельных вычислений в процессе кор- ством является «ProcessId» (процесс-инициатор). 
реляции событий безопасности является условно Косвенные однотипные связи соединяют собы-
неограниченное количество источников. Следо- тия, свойства которых эквивалентны по типу со-
вательно, необходимо полагать, что количество держимого, косвенные разнотипные связи связы-
исходных данных для обработки также является вают события, свойства которых эквивалентны по 
неограниченным. Выполнение данных условий значениям, но имеют различные типы содержи-
возможно осуществлять с помощью применения мого. Например, событие типа «Запуск процесса» 
технологий обработки Big Data и средств, реали- (4688) помимо свойства «NewProcessID» содержит 
зующих параллельную обработку данных (напри- свойство «CreatorProcessID». Оба свойства ини-
мер, Hadoop или Spark). циализируют идентификатор процесса, только в 

Глобальная цель нашего исследования заклю- первом случае – наследника, а во втором – пред-
чается в разработке метода автоматизированной ка. Данная связь является косвенной однотипной 
корреляции разнородной информации безопас- по типу содержимого. Событие типа «Запуск про-
ности, основанной на параллельных вычислениях. цесса» содержит также свойство «ProcessName», 
Для достижения данной цели предлагается исполь- обозначающее «Имя исполняемого модуля в фай-
зовать результаты структурного, функционально- ловой системе». «NewProcessID» и «ProcessName» 
го, поведенческого и эволюционного анализа за- это свойства разного типа, и они образуют между 
щищаемых инфраструктур. Выделение указанных собой косвенную разнотипную связь. Нахождение 
выше задач способствует достижению глобальной косвенных связей делается на основе содержа-
цели и обусловлено соответствующими аспектами тельного анализа свойств типов событий. 
сложности анализируемых компьютерных инфра- Анализ структур типов событий является по-
структур как сложных динамических систем [33]. следовательно выполняемой операцией, по-

В рамках разработки метода автоматизирован- скольку прямые связи определяются при посту-
ной параллельной корреляции больших данных плении только первого экземпляра события не-
о событиях безопасности в работе исследовалось известного типа, при условии, что формат типа 
решение следующих подзадач задач: является нормализованным. 

•	 определение	 косвенных	однотипных	 свя- Определение косвенных связей условно яв-
зей между типами событий; ляется однократно выполняемой операцией, но 

•	 вычисление	 частных	 и	 общих	 коэффици- продолжительной во времени с точки зрения ана-
ентов корреляции между типами событий; лиза исходных данных и принятия решения о на-

•	 определение	временного	окна	(репрезен- личии связи между типами событий. Иными слова-
тативной выборки) событий для анализа. ми, прямые связи определяются незамедлительно 

Ниже приводится описание порядка решения при поступлении события нового типа, а выявле-
каждой из выше упомянутых задач для исследова- ние косвенных связей требует предварительного 
ния возможности их эффективной параллелели- анализа достаточно большого количества данных 
зации. с накоплением полученных результатов. 

Б. Определение косвенных однотипных связей Определение косвенной однотипной связи 
В предыдущем исследовании авторов [34] в ка- Rindir.same для любых двух типов t1 и t2 производится 

честве основы механизма поиска зависимостей путем оценки результата пересечения множеств 
в исходных данных для применения различных значений их свойств: 
статистических методов корреляции был выбран 
граф связей типов событий. При данном подходе     (1)
связи между типами событий предлагается разде-
лять на следующие классы: где p1 и p2 являются неравнозначными свой-

•	 прямые	связи; ствами, которые характеризуют типы t1 и t2, а V (p1) 
•	 косвенные	 однотипные	 и	 разнотипные	 и V (p2) являются, соответственно, множествами 

связи. их значений. 

6 Вопросы кибербезопасности  №5(24) - 2017 



Технологии больших данных для корреляции событий безопасности ...
При этом предполагается, что оценка пере- ровки разнотипных неравнозначных свойств в 

сечения свойств и непосредственное принятие результате их корреляции. В данном случае также 
решения о наличии косвенных связей между рас- может быть применен метод ранговой корреля-
сматриваемыми типами может производиться ции, когда для двух и более свойств производится 
путем вычисления отношения количества иден- ранжирование их значений, полученных из экзем-
тичных значений к общему количеству значений пляров событий безопасности. Однако в настоя-
(уникальных в рамках сравнения) двух множеств. щей работе данная операция не рассматривается. 
Это условие схематично иллюстрируется на рис. 2. Этот вопрос планируется рассмотреть в дальней-

 ших исследованиях.
V(p1) V(p2) Полученные в результате выполнения выше 

описанных операций косвенные однотипные свя-
зи являются основой для уточнения графа отно-
шений типов событий и дальнейшего вычисления 
коэффициентов корреляции между типами собы-
тий.

В. Определение коэффициента корреляции 
между типами событий 

N uniq Niden i
1 N un q Привязка событий ко времени приводит к тому, 

2
что между двумя произошедшими событиями 

Рис. 2. Основные параметры для вычисления  всегда имеется некоторый, как правило, ненуле-
косвенных связей вой, временной интервал. В результате в качестве 

одного из основных признаков корреляции сле-
Положим, что Niden обозначает количество дует учитывать временную задержку между двумя 

идентичных значений во множествах V (p1) и V рассматриваемыми событиями. 
(p2),  N uniq

1    количество уникальных значений во Обозначим временную задержку между собы-
множестве V (p1), а N uniq

2  – количество уникальных тием en и событием ei (i < n) как dTi . При этом для 
значений во множестве V (p2). Тогда в качестве установления наличия связи экземпляра события 
функции  можно ис- en с конкретным типом событий t следует учиты-
пользовать следующее выражение: вать только множество ранее зафиксированных 

событий {et
1, et

2,… et
k}, k < n, поскольку e являет-

   (2) ся зафиксированным во времени свидетельством 
какого-либо действия. 

При этом учитывается, что множества V (p1) и V В качестве второго признака корреляции пред-
(p2) не нулевые. Также необходимым требованием лагается учитывать относительный вес прямых 
для использования выражения (2) является нали- связей между событиями. Относительный вес wi 
чие по крайне мере одного отличающегося зна- связи события en с событием ei  (i < n) вычисляется 
чения во множествах V (p1) и V (p2). В противном по следующей формуле: 
случае свойства p1 и p2 будут однозначно иденти-
фицированы как однотипные неравнозначные.                                                               (3)

При параллельном вычислении оценки на-
личия косвенной связи между типами событий где N iden

i  – количество идентичных значений 
следует учитывать, что изначально обработке равнозначных свойств событий en и ei; N direct

i  – об-
подвергаются все значения всех свойств типов. щее количество равнозначных свойств между 
Только после установления однотипного нерав- двумя событиями. 
нозначного отношения между двумя рассматри- Таким образом, в результате обработки данных 
ваемыми свойствами производится модификация в ходе процесса корреляции событий необходимо 
графа связей для тех типов, которые содержат сформировать два количественных ряда, соответ-
в своей структуре данные свойства. Кроме того, ствующих выделенным признакам для выполне-
необходимо отметить, что косвенная однотипная ния корреляции. Первый ряд содержит значения 
связь может быть установлена внутри одного типа временных задержек, а второй ряд содержит от-
событий (t1 = t2). носительные веса прямых связей между экзем-

Определение косвенной разнотипной связи, плярами событий одного типа и экземплярами 
по сути, представляет собой операцию группи- событий другого или этого же типа. Это позволит 

Вопросы кибербезопасности  №5(24) - 2017 7



Мониторинг безопасности объектов УДК 004.75

      (4)
               

где n – число ранее произошедших событий вместе с событием en. 

определить частные коэффициенты корреляции Достаточно важной задачей для выполнения 
между типами (или внутри типа) событий. корреляционного анализа, в том числе для опре-

Для вычисления частного коэффициента кор- деления необходимого и достаточного количе-
реляции между типами событий предлагается ис- ства используемых данных, является определение 
пользовать коэффициент парной корреляции (ко- статистической выборки, или временного окна. В 
эффициент Пирсона). В этом случае частный коэф- этом случае необходимым условием успешного 

Пирсона). В этом случае частный коэфффииццииееннтт  ккоррреелляяццииии  r priv12    ммеежжддуу т итпиапмаим сио бытий решения задачи является полнота (репрезента-
событий t1 и t2 вычисляется по следующейt1 ф ио t2р вмыучлиес: л яется по формуле 4. тивность) и минимальная избыточность в анали-

𝑟𝑟����
� = 𝑛𝑛 ∑���

��� 𝑤𝑤�𝑑𝑑𝑑𝑑� − ∑���О
��� 𝑤𝑤бщ

� ∙и∑й �к�о�э
��� 𝑑𝑑ф𝑑𝑑фициент корреляции  между зируемом наборе исходных данных.

�
� типами событий t1 и t2 может  быть вычислен как Одним из способов решения задачи вычисле-

�𝑛𝑛 ∑��� �
��� (𝑤𝑤�)� − (∑ ��

��� 𝑤𝑤�)� ∙ с�р𝑛𝑛ед∑н�е�е� з
��� (н𝑑𝑑а𝑑𝑑ч

�)е�ни−е (д∑л�я� ч�а
��� 𝑑𝑑ст𝑑𝑑н

�)ы�х коэффици(4е)нтов по ния временного окна является применение ча-
следующей формуле: стотно-временного анализа зафиксированных 

 действий. В данном случае экземпляры должны 
где n – число ранее произошедших событий вместе с событием en.  

Общий коэффициент корреляции 𝑟𝑟���   (5) быть упорядочены по типам, поскольку на основе 
��  между типами со  б   ы  т  и   й    t  1   и     t 2    м   о  ж   е  т        полученной выборки будет вычисляться коэффи-

быть вычислен как среднее значение для частных коэффициентов по следующей 
где  – i-й частный коэффициент корреля- циент корреляции между типами событий. Данная 

формуле:  
� ����

��� (5
= ∑ ц

��� 𝑟𝑟ии; k – количество частных коэффициент
� )ов кор- операция подразумевает деление генеральной 

𝑟𝑟�� реляц
𝑘𝑘  ии между типами t1 и t2. совокупности на временные интервалы, задавае-

Предложенный подход к установлению взаи- мые экспертным путем, и вычисление частот по-
 моотношений между типами событий ориенти- явления экземпляров событий для каждого типа в 
где  𝑟𝑟����

�  – i-й частный коэффициентр оквоарнр енлая цоипир; едkе л–е нкиоел илчиенсетйвноы хч азсатвниысихм остей каждом интервале. Пример частотно-временного 
коэффициентов корреляции между типампио tк1а из аtт2е. лей схожести (относительных весов) от анализа фрагмента журнала событий безопасно-

Предложенный подход к установлвернеимюе нвиз. аОидмноаоктон сотшоиент иойтм метеижтдь,у ч ттои пвыамчис ление сти представлен на рис. 3. 
событий ориентирован на определениек оэлфифниейцниеынхт овза вкоирсирмелоясцтиейи  япволкяаезтастяе лперйе двари- На рис.3 отображено количество зафиксиро-
схожести (относительных весов) от втреелмьненыим.  этОадпноамк ов  осцтеоникте  совтямзеетйи тмье,ж дчут от ипами, ванных событий по типам в пределах каждого 
вычисление коэффициентов корреляциип озявволляяеютсщя имп руетдовчанрииттье нлаьпнрыамвл еэнтиаеп ормеб евр  в гра- из периодов. В анализируемом фрагменте жур-
оценке связей между типами, позволяющфием с вуятзоечйн тиитпьо нва спорбаывтлиейн.ие ребер в графе нала выделено 5 типов (EventID в ОС Windows), 
связей типов событий. D. Определение временного окна анализа со- а общее число периодов равно 100, по 5 минут 

 бытий безопасности для их корреляции каждый. С точки зрения вычисления временно-
D. Определение временного окна анализа событий безопасности для их 

корреляции 
Достаточно важной задачей для выполнения корреляционного анализа, в 

том числе для определения необходимого и достаточного количества 
используемых данных, является определение статистической выборки, или 
временного окна. В этом случае необходимым условием успешного решения 
задачи является полнота (репрезентативность) и минимальная избыточность в 
анализируемом наборе исходных данных. 

Одним из способов решения задачи вычисления временного окна является 
применение частотно-временного анализа зафиксированных действий. В данном 
случае экземпляры должны быть упорядочены по типам, поскольку на основе 
полученной выборки будет вычисляться коэффициент корреляции между типами 
событий. Данная операция подразумевает деление генеральной совокупности на 
временные интервалы, задаваемые экспертным путем, и вычисление частот 
появления экземпляров событий для каждого типа в каждом интервале. Пример 
частотно-временного анализа фрагмента журнала событий безопасности 
представлен на рис. 3.  

Рис. 3. График частот появления событий безопасности по типам в периодах

8 Вопросы кибербезопасности  №5(24) - 2017 



Технологии больших данных для корреляции событий безопасности ...
го окна, представленный график не является до- корреляции на множестве событий отрезка време-
статочно информативным, хотя при визуальной ни [T0; Tk+1] при k > 2, что позволит проверять вы-
оценке можно сказать, что в целом зафиксиро- полнение требования определения необходимого 
ванные события имеют связь, а также частично объема исходных данных для анализа [34]. 
обладают цикличным характером появления. В представленном примере частотно-времен-
Однако следует отметить наличие явно зависи- ного анализа взято прямое направление хода вре-
мого возмущения уровня частот событий типов мени. Однако определение временного окна так-
4663, 5154 и 4674. Также примечателен тот факт, же может быть выполнено в обратном исчислении 
что события последних двух типов имели одина- времени (так как  производится анализ истории) 
ковые показатели частот до указанного момента с целью поиска момента Tk . Данный подход тео-
времени. ретически обеспечивает оценку репрезентатив-

Также необходимо отметить, что другим фак- ности выборки для ее извлечения из генеральной 
тором оценки репрезентативности вместо частот совокупности. В дальнейшем мы планируем рас-
появления могут (а в некоторых случаях и должны) ширить данную методику за счет использования 
выступать другие показатели, например, свойство других факторов оценки, например, динамично-
схожести, отклонение коэффициента корреляции сти изменения значений свойств событий, откло-
и другие. нения схожести и других.

Более эффективным способом вычисления Также следует отметить, что временное окно 
временного окна является отслеживание относи- должно обязательно вычисляться с разделением 
тельного изменения средней частоты появления по фактору группировки, если данная операция 
событий каждого типа по периодам за прошедшее присутствует в анализе. В случае вычисления за-
время. График относительного изменения частот висимости показателя схожести типов событий от 
событий безопасности по типам при использова- временной задержки, подобным фактором явля-
нии данных, аналогичных данным, представлен- ется тип события. Это объясняется тем, что разные 
ным на рис. 3, приведен на рис. 4. типы свидетельствуют о разных происходящих 

При достижении максимально допустимого явлениях. Отсюда следует, что при обнаружении 
значения отклонения частоты событий (напри- связи рассматриваемого экземпляра события 
мер, 0.005) на всем промежутке исходных данных с определенным явлением необходимо учитывать 
(начиная с периода T0) по отношению к сред- временное окно для извлечения выборки среди 
нему значению частоты за пройденное время событий соответствующего типа.
(точка Tk), следует расширить временное окно, по 
меньшей мере, на один период, чтобы за это время Реализация параллельных вычислений для ре-
была возможность расчета коэффициентов корре- шения задач корреляции событий безопасности
ляции. При положительном исходе (отклонение В случае включения компонента корреляции 
частоты не превысило максимальный уровень) в целевую инфраструктуру для определения кос-
допускается дальнейшие выполнение процесса венных однотипных связей между типами собы-

Рис. 4. График относительного изменения частот событий безопасности по типам

Вопросы кибербезопасности  №5(24) - 2017 9



Мониторинг безопасности объектов УДК 004.75
тий в реальном времени необходимы значитель-     files = sc.parallelize(files_list)

ные вычислительные мощности. Это вызвано тем,     result = files.map(calcOverallRs)

что количество возможных свойств и их значе-     output = result.collect()
 

ний может исчисляться тысячами и миллионами     output_file = open(«...», ‹w›)
экземпляров соответственно. В свою очередь,     for lst in output:
задача вычисления частных и общих коэффици-         for r in lst:
ентов корреляции заключается в последователь-             output_file.write(«Overall R = 
ном вычислении относительного веса связи w rel {}.\n».format(r))

i  
между экземплярами событий за счет сравнения             output_file.close()

их свойств, а также в расчете временной задержки 
dTi и их суммировании для нахождения частного В приведенном на выше коде вначале создает-
коэффициента корреляции. Даже с использовани- ся и устанавливается конфигурация приложения 
ем оптимального размера временного окна объем Spark. Затем создается точка входа SparkContext, 
вычислений при решении этой задачи достаточно которая предоставляет связь с кластером Spark. 
велик. В случае обычных локальных вычислений При создании точки входа указывается, в каком 
это приводит к большому времени обработки режиме запускается задача. В рассмотренном 
входных наборов данных о событиях безопасно- выше случае, задача запускается локально в вось-
сти. Длительность процесса корреляции данных в ми параллельных потоках. Однако, кроме локаль-
этом случае может варьироваться от нескольких ного режима, здесь можно указать и распределен-
десятков минут до нескольких часов. Наконец, ре- ный режим под управлением менеджеров ресур-
шение задачи определения временного окна под- сов YARN из пакета Hadoop или Mesos. 
разумевает мгновенную обработку миллионов В переменной input_path указывается папка, 
элементов матрицы отношений между типами со- файлы из которой станут входными данными. Пути 
бытий, если учитывать требование работы в режи- к входным файлам размещаются в переменной 
ме, близком к реальному времени [34]. files_list и составляют локальную коллекцию. 

Для того, что повысить эффективность об- Далее с помощью функции parallelize локальная 
работки данных о событиях безопасности, в коллекция преобразуется в распределенную. Для 
том числе снизить время, затрачиваемое на их каждого элемента распределенной коллекции 
обработку при корреляции событий безопас- files далее применяется оператор отображения 
ности, необходимо прибегнуть к методам ор- map, который вызывает функцию, переданную ему 
ганизации параллельных и распределенных в качестве параметра для всех элементов files. 
вычислений. Одним из способов организации При этом запуск этой функции осуществляется в 
такого рода вычислений является использо- отдельных параллельных потоках для каждого 
вание технологий обработки больших данных, элемента. Функция calcOverallRs является функ-
в том числе на основе программной платфор- цией вычисления общих коэффициентов корреля-
мы Spark. Для выполнения параллельных вы- ции. Преобразование распределенной коллекции 
числений для процесса корреляции событий в локальную осуществляется с помощью функции 
безопасности был выбран способ разделения collect. Завершающие действия кода предназна-
входных данных на части и анализ по частям чены для  сохранения результатов вычисления ко-
в разных потоках. Фрагмент исходного кода, эффициентов корреляции в файл.
реализующего решение задачи определения Рассмотрим теперь алгоритмы реализации па-
косвенных однотипных связей, представлен раллельных вычислений для нахождения общих 
на далее: коэффициентов корреляции. Участок кода Spark, 

представленный на следующем отрывке кода, на-
if __name__ == «__main__»: ходит все уникальные типы событий eventIDs во 
       conf = SparkConf() входном dataset:
    conf.setAppName(«Analysis»)  
    sc = SparkContext(«local[8]», conf=conf) tree = ElementTree.parse(file)

root = tree.getroot()
    input_path = «...» ids = root.findall(«./ns:Event/ns:System/
    files_list = [join(input_path, f) for f ns:EventID»

in listdir(input_path) if isfile(join(input_ eventIDs = set(id.text for id in ids)
path, f))]

 

10 Вопросы кибербезопасности  №5(24) - 2017 



Технологии больших данных для корреляции событий безопасности ...
Поиск уникальных типов событий происходит    denominator = sqrt(n*sum([pow(rel

следующим образом. Вначале строится дерево ativeWeights[i], 2) for i in range(n)]) - 

XML-файла tree. В результате получается корень pow(sum(relativeWeights), 2)) * \
sqrt(n * sum([pow(dTs[i], 2) for i in 

дерева root. Далее выполняется поиск всех тегов range(n)]) - pow(sum(dTs), 2))
EventID, вложенных в корень. Для найденных те-    partialR = numerator / denominator
гов берутся их значения (text), которые составля-    partialRs.append(partialR)
ют набор всех типов событий eventIDs во входном    relativeWeights.clear()
файле.    dTs.clear()

После того, как найдены уникальные типы со-
бытий, события группируются по типам. Для каж- overallR = sum(partialRs) / len(partialRs)

дого типа событий вначале происходит вычисле- print(«Overall R =», overallR)
partialRs.clear()

ние частных коэффициентов корреляции. Затем 
находятся общие коэффициенты корреляции. Сначала находятся имена свойств типов 

Код Spark, реализующий этот алгоритм, пред-
dataNames, затем находятся все прямые связи ти-

ставлен ниже. При этом следует отметить, что пов путем пересечения множеств dataNames. Да-
eventTypes является словарем, в котором по зна- лее попарно для всех событий двух типов вычис-
чению типа можно получить все события, относя- ляются временные задержки dTi и относительные 
щиеся к данному типу. веса прямых связей wi. Если временная задержка 

dTi имеет отрицательное значение, то это событие 
for typeA, typeB in product(eventTypes, 

eventTypes): не берется в рассмотрение, поскольку оно про-
dataNames1 = findTypeAEventDataNames() изошло после текущего. 
dataNames2 = findTypeBEventDataNames() После вычисления всех wi и dTi вычисляются 

частные коэффициенты корреляции в соответ-
# Find direct connections by intersecting ствии с (4). На основе частных коэффициентов 
directConns = list(dataNames1 & dataNames2) корреляции далее вычисляется общий коэффици-
partialRs = [] ент корреляции в соответствии с (5).
k = 0
for e1 in eventTypes[typeA]:
   relativeWeights = [] Результаты экспериментов
   dTs = [] Для проведения экспериментов использова-
   t1 = e1.getTimestamp() лась платформа Supermicro X9DRL-3F c двумя про-
   nV1 = e2.findDataNameValues() цессорами Intel Xeon E5-2620 v2 @ 2.1 ГГц. На базе 
   for e2 in eventTypes[typeB]: гипервизора ESXi 6.0 была создана виртуальная 
       t2 = e2.getTimestamp() машина с операционной системой Ubuntu Server 
       dt = (t1 - t2).total_seconds() 16.04. Машине было выделено 8 thread, зарезер-
  
       # Considering only past events to t1 вировано (reserved) 2 ГГц процессора, также было 
       if dt <= 0: зарезервировано 32 ГБ ОЗУ. Поверх операци-
           continue онной системы была установлена программная 
       nV2 = e2.findDataNameValues() платформа Spark 1.6.1.

В работе для проведения экспериментальной 
   # k is the number of matching values оценки в целях повышения достоверности полу-
       k = sum([1 if nV1[i] == nV2[i] else ченных результатов используется входной поток 

0 for i in range(len(directConns))]) данных, собранный с офисного компьютера. В ка-
   # if no direct conns is found then w честве входных данных был взят файл размером 

= 0 7 ГБ, в котором содержалось приблизительно 7 
       w = k / len(directConns) if миллионов событий, относящихся к 81 типу. Ис-

len(directConns) else 0 ходные данные были предварительно собраны из 
       relativeWeights.append(w) журнала событий безопасности ОС Windows 8 на 
       dTs.append(dt) офисном компьютере за период, примерно рав-
   ный 2 суткам. 
      n = len(dTs)
   numerator = В ходе анализа исходных данных было установ-
n*sum([relativeWeights[i]*dTs[i] for i in лено, что все типы событий можно разделить на 

range(n)]) - sum(relativeWeights)*sum(dTs) две группы: (1) часто встречающиеся и (2) редко 

Вопросы кибербезопасности  №5(24) - 2017 11



Мониторинг безопасности объектов УДК 004.75

Рис. 5. Статистика часто встречающихся типов событий

встречающиеся. К первой группе относятся типы Статистические подходы при выполнении 
событий со значением Count менее 100, ко второй процесса корреляции событий безопасности 
 – остальные типы. применялись ранее. Сложность примеснения ве-

Показатели количества произошедших собы- роятностной оценки заключается в необходимо-
тий первой и второй группы представлены на рис. сти обеспечения соответствия исходных данных 
5 и рис. 6 соответственно. определенным требованиям, например, их одно-

Из рис. 5 и рис. 6 видно, что наиболее слож- родности, нормальному закону распределения 
ными являются вычисления относительных ве- и другим. Выбор конкретного статистического 
сов прямых связей между такими типами, как показателя (коэффициента корреляции, коэффи-
4658 и 4656. Это приводит к необходимости об- циента детерминации и пр.) и возможность его 
рабатывать 2959 * 1664 пар событий в режиме, применения в реализации процесса корреляции 
близком к реальному, что является чрезвычай- можно определить в ходе анализа исходных дан-
но сложной задачей, если не использовать па- ных и результатов вычисления такого показате-
раллельные вычисления и не ограничивать ана- ля. В данной работе предложено использовать 
лизируемую выборку. операцию вычисления показателя линейной 

При выполнении задачи выявления косвен- корреляции Пирсона с учетом факторов отно-
ных связей в ходе анализа исходных данных было сительной схожести событий (w) и временной 
определено 134 уникальных свойства типов со- задержки их возникновения (dT). Для конкрети-
бытий. Пересечение множеств значений данных зации и сравнения результатов коэффициенты 
свойств позволило выявить 15 свойств, относя- корреляции вычисляются между парами типов 
щихся друг к другу как неравнозначные одно- событий, поскольку показатель относительной 
типные. Уточнение графа связей типов событий схожести зависит от типовой структуры событий. 
за счет дополнения узлов соответствующими кос- В данном случае важность фактора схожести и 
венными связями увеличило количество ребер временной задержки для общего процесса кор-
(общее количество связей) примерно на 20%. реляции не учитывается. 

Рис. 6. Статистика редко встречающихся типов событий

12 Вопросы кибербезопасности  №5(24) - 2017 



Технологии больших данных для корреляции событий безопасности ...
Таблица 1.

Значения для времени обработки входных наборов данных
Режим обработки Объем, МБ Время, сек

локальный 9,1 3876
параллельный 9,1 531
параллельный 18,2 1039
параллельный 27,3 1573
параллельный 36,4 2074
параллельный 45,5 2615
параллельный 54,6 3136
параллельный 63,7 3637
параллельный 72,8 4198

Вычисленные коэффициенты корреляции могут на процессоре 8x2ГГц ЦПУ с реализацией восьми 
быть использованы для предварительной оценки потоков. В качестве входного набора использовал-
происходящих процессов в анализируемой инфра- ся набор данных, увеличенный по сравнению с пре-
структуре. Стоит отметить, что результаты данных дыдущим в 8 раз. Таким образом, максимальный 
вычислений свидетельствуют о наличии и характе- объем входного набора данных достигал 72,8 МБ.
ре линейной связи между указанными факторами, Результаты экспериментальной оценки време-
однако отсутствие линейной связи не может свиде- ни обработки входных наборов данных представ-
тельствовать об отсутствии связи как таковой (воз- лены в табл. 1.
можно наличие сложной нелинейной связи). Зависимости времени обработки данных от 

Экспериментальная оценка оперативности ре- объема входного набора данных представлены на 
ализации процесса корреляции на рассмотренном рис. 7.
выше наборе данных была проведена с учетом Анализируя данные на рис. 7 можно сделать 
двух сценариев на основании решения задачи по- следующие выводы. Во-первых, время обработ-
иска общих коэффициентов корреляции. В первом ки данных при решении задачи корреляции со-
случае использовался однопоточный режим при бытий безопасности уменьшается с увеличени-
частоте процессора 2 ГГц. При этом объем входно- ем количества параллельных потоков. При этом 
го набора данных равнялся 9,1 МБ. В этом сценарии эта зависимость близка к прямо пропорцио-
полагалось, что параллелизация вычислений для нальной, т.е. применение восьми потоков позво-
выполнения процесса корреляции событий безо- лило сократить время обработки приблизитель-
пасности отсутствовала. Результаты, полученные в но в восемь раз. С другой стороны, зависимость 
этом сценарии, рассматриваются как контрольные, времени обработки данных от объема входного 
с которыми сравниваются результаты, полученные набора близка к линейному виду. Так, если объ-
при реализации параллельных вычислений. ем входного набора увеличить в восемь раз, то 

Во втором сценарии применялся метод парал- время обработки данных также увеличится при-
лелизации вычислений на основе разделения на- мерно в восемь раз. Это является вполне законо-
бора данных на части. Вычисления производились мерным результатом.

Рис. 7. Зависимости времени обработки от объема входного набора данных

Вопросы кибербезопасности  №5(24) - 2017 13



Мониторинг безопасности объектов УДК 004.75
Сравнение с методами машинного обучения В ходе выполнения задачи поиска косвенных 

для анализа сетевого трафика, например [32], по- однотипных связей были получены результаты, 
казало, что время вычисления коэффициентов кор- позволяющие уточнять граф связей между типа-
реляции сравнимо с временем извлечения при- ми событий журнала безопасности ОС Windows, 
знаков на платформе Spark и значительно меньше построенным по прямым связям, примерно на 
времени выполнения этапа обучения при сопо- 20 процентов. Экспериментальные результаты по-
ставлении объемов данных и вычислительных ре- казали, что время обработки данных в процессе 
сурсов. В целом экспериментальная оценка време- корреляции событий безопасности находится в 
ни обработки данных в процессе корреляции со- обратно пропорциональной зависимости от ко-
бытий безопасности показывает, что применение личества реализованных в Spark параллельных 
параллельных вычислений позволяет реализовать потоков. При этом зависимость времени  обра-
требования по выполнению этого процесса в ре- ботки от объема входного набора данных близка 
альном или близком к реальному времени. к линейному виду. Это позволяет утверждать, что 

применение параллельных вычислений позволя-
Выводы ет реализовать требования по выполнению этого 
В настоящей работе предложен новый под- процесса с учетом предварительной оценки ис-

ход к реализации процесса корреляции событий ходных данных в реальном или близком к реаль-
безопасности. Данный подход базируется на вы- ному времени. 
явлении связей между событиями безопасности В дальнейшем предполагается формирование 
и оценке зависимости их относительной силы от списка значимых факторов из множества воз-
распределения событий во времени, основанной можных факторов и выбор наиболее подходящих 
на вычислении и использовании коэффициентов статистических показателей, характеризующих 
корреляции, а также распараллеливании вычис- связь между ними, для оценки связанности кон-
лений с использованием технологий обработки кретных экземпляров событий. Предполагается 
больших данных. Рассмотрено содержание про- исследование подходов с использованием раз-
цесса корреляции событий безопасности и вы- личных факторов оценки и группировки событий. 
делены основные задачи, требующие для своего Полученные результаты планируется использо-
решения значительных вычислительных ресур- вать при разработке алгоритмов решения задач 
сов. Показана возможность и оценена резуль- корреляции с учетом комплексирования выпол-
тативность применения параллельных вычис- няемых операций. Дальнейшими направлениями 
лений на примере решения задачи вычисления исследований также является интеграция функци-
частных и общих коэффициентов корреляции ональных возможностей Spark в среду существую-
на множествах связей между типами событий. щих SIEM-систем. 

Рецензент: Молдовян Александр Андреевич, доктор технических наук, профессор, заведующий на-
учно-исследовательским отделом проблем информационной безопасности Федерального государ-
ственного бюджетного учреждения науки «Санкт-Петербургский  институт информатики и автома-
тизации Российской академии наук», Санкт-Петербург, Россия.  E-mail: maa1305@yandex.ru    

Литература
1.  И.В. Котенко, И.Б. Саенко, Р.М. Юсупов. Новое поколение систем мониторинга и управления инцидентами безопасности // Научно-

технические ведомости СПбГПУ. Информатика. Телекоммуникации. Управление. 2014. № 3(198). C. 7–18.
2.  И.В. Котенко, И.Б. Саенко. К новому поколению систем мониторинга и управления безопасностью // Вестник Российской академии 

наук, Том 84, № 11, 2014, С.993–1001.
3.  И.В. Котенко, И.Б. Саенко. SIEM-системы для управления информацией и событиями безопасности // Защита информации. Инсайд, 

2012, № 5, С.54-65.
4.  I. Kotenko, O. Polubelova, and I. Saenko. «The ontological approach for SIEM data repository implementation», in Proceedings of the 2012 

IEEE International Conference on Green Computing and Communications, Conference on Internet of Things, and Conference on Cyber, 
Physical and Social Computing, 2012, pp. 761–766.

5.  И.В. Котенко, И.Б. Саенко, О.В. Полубелова, А.А. Чечулин. Применение технологии управления информацией и событиями 
безопасности для защиты информации в критически важных инфраструктурах // Труды СПИИРАН. Вып.1 (20), 2012. C.27-56.

6.  C. Kruegel, F. Valeur, and G. Vigna, Intrusion Detection and Correlation: Challenges and Solutions, Springer, 2004, 118 p.
7.  I.V. Kotenko, A.A. Chechulin. A Cyber Attack Modeling and Impact Assessment Framework. Proceedings of 5th International Conference 

on Cyber Conflict 2013 (CyCon 2013). 2013, pp. 119–142.
8.  И.В. Котенко, И.Б. Саенко. Построение системы интеллектуальных сервисов для защиты информации в условиях кибернетического 

противоборства // Труды СПИИРАН. 2012. № 3(22). С. 84–100.
9.  И.В. Котенко, И.Б. Саенко. Архитектура системы интеллектуальных сервисов защиты информации в критически важных 

инфраструктурах // Труды СПИИРАН. 2013. № 1(24). С. 21–40.

14 Вопросы кибербезопасности  №5(24) - 2017 



Технологии больших данных для корреляции событий безопасности ...
10.  А.В. Федорченко, Д.С. Левшун, А.А. Чечулин, И.В. Котенко. Анализ методов корреляции событий безопасности в SIEM-системах. 

Часть 2 // Труды СПИИРАН. 2016. Вып. 6(49). С.5-27.
11.  И.В. Котенко. Интеллектуальные механизмы управления кибербезопасностью // Управление рисками и безопасностью // Труды 

Института системного анализа Российской академии наук. Т.41, 2009. С.74-103.
12.  R. Sadoddin and A. Ghorbani, «Alert correlation survey: framework and techniques», in Proceedings of 2006 International 

Conference on Privacy, Security and Trust: Bridge the Gap Between PST Technologies and Business Services (PST`06), 2006, 
Article no. 37.

13.  A. Hanemann and P. Marcu, «Algorithm design and application of service-oriented event correlation», in Proceedings of Conference BDIM 
2008, 3rd IEEE/IFIP International Workshop on Business-Driven IT Management, 2008, pp. 61–70.

14.  T. Limmer and F. Dressler, «Survey of event correlation techniques for attack detection in early warning systems», Tech. report, University 
of Erlangen, Dept. of Computer Science 7,  2008, 37 p.

15.  A. Muller.  «Event correlation engine», Master`s Thesis, Swiss Federal Institute of Technology Zurich, 2009, 165 p.  
16.  P. Ning and D. Xu. «Correlation analysis of intrusion alerts», in Intrusion Detection Systems: series Advances in Information Security, 

Springer, 2008, vol. 38, pp. 65–92.
17.  A.A. Ghorbani, W. Lu, and M. Tavallaee, Network Intrusion Detection and Prevention, Springer, 2010, 224 p.
18.  M. Hasan. «A conceptual framework for network management event correlation and filtering systems», in Proceedings of the Sixth IFIP/

IEEE International Symposium on Integrated Network Management, 1999, pp. 233–246.
19.  U. Zurutuza and R. Uribeetxeberria, «Intrusion detection alarm correlation: a survey», in Proceedings of IADAT International Conference 

on Telecommunications and computer Networks, 2004, pp. 1–3.
20.  D.W. Guerer, I. Khan, R. Ogler, and R. Keffer, An Artificial Intelligence Approach to Network Fault Management, SRI International, 1996, 10 p.
21.  M. Tiffany. «A survey of event correlation techniques and related topics», http://www.tiffman.com/netman/netman.html.
22.  H.T. Elshoush and I. M. Osman, «Alert correlation in collaborative intelligent intrusion detection systems – A survey», in Applied Soft 

Computing, 2011, pp. 4349–4365.
23.  G. Kou, Y. Lu, Y. Peng, Y. Shi. Evaluation of classification algorithms using MCDM and rank correlation. International Journal of Information 

Technology & Decision Making, No. 1, Vol. 11, 2012, pp.197-225.
24.  W. Wei, F. Chen, Y. Xia, G. Jin. A Rank Correlation Based Detection against Distributed Reflection DoS Attacks. IEEE Communications 

Letters, vol. 17, is. 1, 2013, pp.173-175.
25.  G. Beliakov, J. Yearwood, A. Kelarev. Application of Rank Correlation, Clustering and Classification in Information Security. Journal of 

Networks, No 7, 2012, pp 935-945.
26.  G. Jiang, G. Cybenko. Temporal and spatial distributed event correlation for network security. American Control Conference 2004, IEEE 

Xplore, 2004, pp.996-1001.
27.  М. Ficco. Security event correlation approach for cloud computing. International Journal of High Performance Computing and 

Networking, Vol. 7, No. 3, 2011, pp. 173–185.
28.  M. Davis, E. Korkmaz, A. Dolgikh, V. Skormin. Resident Security System for Government/Industry Owned Computers // Computer Network 

Security. Lecture Notes in Computer Science, Springer-Verlag, Vol.10446, pp.185-194.
29.  V. Gulisano, R. Jimenez-Peris, M. Patiño-Martinez, C. Soriente, P. Valduriez. StreamCloud: An Elastic and Scalable Data Streaming System. 

IEEE Transactions on Parallel and Distributed Systems, Volume: 23, Issue: 12, Dec. 2012, pp. 2351-2365.
30.  S. Marchal, X. Jiang, R. State, and T. Engel, «A big data architecture for large scale security monitoring», in Proceedings of the IEEE 

International Congress on Big Data, 2014, pp. 56 63.
31.  D Priya, «Network anomaly detection on fast streaming data using spark», in International Journal of Advanced Research in Computer 

and Communication Engineering, 2016, vol. 5, issue 7, pp. 487-489.
32.  G. Koutsoumpakis, Spark-Based Application for Abnormal Log Detection, Uppsala Universitet, 2014, 40 p.
33.  Y. Bar-Yam, Dynamics of Complex Systems, Perseus Books, Cambridge, MA, USA, 1997.
34.  A. Fedorchenko, I. Kotenko, and D. El Baz, «Correlation of security events based on the analysis of structures of event types», in Proceedings 

of the 9th IEEE International Conference on Intelligent Data Acquisition and Advanced Computing Systems: Technology and Applications 
(IDAACS’2017), 2017. pp 270-276.

BIG DATA TECHNOLOGIES FOR SECURITY EVENT 
CORRELATION BASED ON EVENT TYPE ACCOUNTING

Kotenko I.6, Fedorchenko A.7, Saenko I.8, Kushnerevich A.9

The work is devoted to the research of the approach to parallel data processing for performing the tasks 
of security events correlation based on big data technologies. Various methods and tasks of security events 
correlation, as well as technologies for processing big data, applicable for security monitoring tasks are con-
sidered. The main attention is paid to the tasks of identifying the links between security events types and the 

6  Igor Kotenko, Dr.Sc., Professor, St. Petersburg Institute for Informatics and Automation of the Russian Academy of Sciences, ITMO 
University, Saint-Petersburg, ivkote@comsec.spb.ru 

7  Andrey Fedorchenko , St. Petersburg Institute for Informatics and Automation of the Russian Academy of Sciences, ITMO University, 
Saint-Petersburg, fedorchenko@comsec.spb.ru 

8  Igor Saenko, Dr.Sc., Professor, St. Petersburg Institute for Informatics and Automation of the Russian Academy of Sciences, ITMO 
University, Saint-Petersburg, ibsaen@comsec.spb.ru 

9  Alexey Kushnerevich, St. Petersburg Institute for Informatics and Automation of the Russian Academy of Sciences, ITMO University, 
Saint-Petersburg, kushnerevich@comsec.spb.ru 

Вопросы кибербезопасности  №5(24) - 2017 15



Мониторинг безопасности объектов УДК 004.75
evaluation of the strength dependence of the events distribution in time. The implementation of the correla-
tion tasks on the Spark platform is described, and the results of the experimental evaluation of the security 
events correlation processes are given.

Keywords: events correlation, security events, Pearson’s correlation coefficient, SIEM-systems, big 
data, parallel data processing

References
1.  I.V. Kotenko, I.B. Saenko, and R.M. Yusupov, «New Generation of Security information and Event Management Systems», in St. Petersburg 

State Polytechnical University Journal. Computer Science. Telecommunication and Control Systems. 2014. vol. 3(198). pp. 7–18.
2.  I.V. Kotenko and I.B. Saenko. «Creating New Generation Cybersecurity Monitoring and Management Systems», in Herald of the Russian 

Academy of Sciences, 2014, vol.84, no.6, pp.993-1001. 
3.  I.V. Kotenko and I.B. Saenko. «SIEM-systems for security information and events management», in Protection of the information. Inside, 

2012, no.5, pp.54–65.
4.  I. Kotenko, O. Polubelova, and I. Saenko, «The ontological approach for SIEM data repository implementation», in Proceedings of the 2012 

IEEE International Conference on Green Computing and Communications, Conference on Internet of Things, and Conference on Cyber, 
Physical and Social Computing, 2012, pp. 761–766.

5.  I.V. Kotenko, I.B. Saenko, O.V. Polubelova, and A.A. Chechulin, «Application of security information and event management technology for 
information security in critical infrastructures», SPIIRAS Proceedings, 2012, Issue 1(20), pp.27-56.

6.  C. Kruegel, F. Valeur, and G. Vigna, «Intrusion Detection and Correlation: Challenges and Solutions», Springer, 2004, 118 p.
7.  I.V. Kotenko, and A.A. Chechulin, «A Cyber Attack Modeling and Impact Assessment Framework» in Proceedings of 5th International 

Conference on Cyber Conflict 2013 (CyCon 2013). 2013, pp. 119–142.
8.  I.V. Kotenko and I.B. Saenko, «Developing the system of intelligent services to protect information in cyber warfare», in SPIIRAS 

Proceedings, 2012, Issue 3(22), pp.84-100.
9.  I.V. Kotenko and I.B. Saenko, «Architecture of the system of intelligent services to protect information in cyber warfar», SPIIRAS 

Proceedings. 2012. vol. 1(24). pp. 21–40. 
10.  A.V. Fedorchenko, D.S. Levshun, A.A. Chechulin, and I.V. Kotenko, «Analysis of security event sorrelation methods in SIEM-systems. Part 2», 

in SPIIRAN Proceedings. 2016. Issue. 6(49). pp.5-27. 
11.  I.V. Kotenko, «Intelligent mechanisms of cybersecurity management», in Risk and security management. Proceedings of the Institute of 

System Analysis of the Russian Academy of Sciences, 2009,  Vol.41, pp.74-103.
12.  R. Sadoddin and A. Ghorbani, «Alert correlation survey: framework and techniques», in Proceedings of 2006 International 

Conference on Privacy, Security and Trust: Bridge the Gap Between PST Technologies and Business Services (PST`06), 2006, 
Article no. 37.

13.  A. Hanemann and P. Marcu, «Algorithm design and application of service-oriented event correlation», in Proceedings of Conference BDIM 
2008, 3rd IEEE/IFIP International Workshop on Business-Driven IT Management, 2008, pp. 61–70.

14.  T. Limmer and F. Dressler, «Survey of event correlation techniques for attack detection in early warning systems», Tech. report, University 
of Erlangen, Dept. of Computer Science 7,  2008, 37 p.

15.  A. Muller.  «Event correlation engine», Master`s Thesis, Swiss Federal Institute of Technology Zurich, 2009, 165 p.  
16.  P. Ning and D. Xu. «Correlation analysis of intrusion alerts», in Intrusion Detection Systems: series Advances in Information Security, 

Springer, 2008, vol. 38, pp. 65–92.
17.  A.A. Ghorbani, W. Lu, and M. Tavallaee, Network Intrusion Detection and Prevention, Springer, 2010, 224 p.
18.  M. Hasan. «A conceptual framework for network management event correlation and filtering systems», in Proceedings of the Sixth IFIP/

IEEE International Symposium on Integrated Network Management, 1999, pp. 233–246.
19.  U. Zurutuza and R. Uribeetxeberria, «Intrusion detection alarm correlation: a survey», in Proceedings of IADAT International Conference 

on Telecommunications and computer Networks, 2004, pp. 1–3.
20.  D.W. Guerer, I. Khan, R. Ogler, and R. Keffer, An Artificial Intelligence Approach to Network Fault Management, SRI International, 1996, 10 p.
21.  M. Tiffany. «A survey of event correlation techniques and related topics», http://www.tiffman.com/netman/netman.html.
22.  H.T. Elshoush and I. M. Osman, «Alert correlation in collaborative intelligent intrusion detection systems – A survey», in Applied Soft 

Computing, 2011, pp. 4349–4365.
23.  G. Kou, Y. Lu, Y. Peng, Y. Shi. Evaluation of classification algorithms using MCDM and rank correlation. International Journal of Information 

Technology & Decision Making, No. 1, Vol. 11, 2012, pp.197-225.
24.  W. Wei, F. Chen, Y. Xia, G. Jin. A Rank Correlation Based Detection against Distributed Reflection DoS Attacks. IEEE Communications 

Letters, vol. 17, is. 1, 2013, pp.173-175.
25.  G. Beliakov, J. Yearwood, A. Kelarev. Application of Rank Correlation, Clustering and Classification in Information Security. Journal of 

Networks, No 7, 2012, pp 935-945.
26.  G. Jiang, G. Cybenko. Temporal and spatial distributed event correlation for network security. American Control Conference 2004, IEEE 

Xplore, 2004, pp.996-1001.
27.  М. Ficco. Security event correlation approach for cloud computing. International Journal of High Performance Computing and 

Networking, Vol. 7, No. 3, 2011, pp. 173–185.
28.  M. Davis, E. Korkmaz, A. Dolgikh, V. Skormin. Resident Security System for Government/Industry Owned Computers // Computer Network 

Security. Lecture Notes in Computer Science, Springer-Verlag, Vol.10446, pp.185-194.
29.  V. Gulisano, R. Jimenez-Peris, M. Patiño-Martinez, C. Soriente, P. Valduriez. StreamCloud: An Elastic and Scalable Data Streaming System. 

IEEE Transactions on Parallel and Distributed Systems, Volume: 23, Issue: 12, Dec. 2012, pp. 2351-2365.
30.  S. Marchal, X. Jiang, R. State, and T. Engel, «A big data architecture for large scale security monitoring», in Proceedings of the IEEE 

International Congress on Big Data, 2014, pp. 56 63.
31.  D Priya, «Network anomaly detection on fast streaming data using spark», in International Journal of Advanced Research in Computer 

and Communication Engineering, 2016, vol. 5, issue 7, pp. 487-489.
32.  G. Koutsoumpakis, Spark-Based Application for Abnormal Log Detection, Uppsala Universitet, 2014, 40 p.
33.  Y. Bar-Yam, Dynamics of Complex Systems, Perseus Books, Cambridge, MA, USA, 1997.
34.  A. Fedorchenko, I. Kotenko, and D. El Baz, «Correlation of security events based on the analysis of structures of event types», in Proceedings 

of the 9th IEEE International Conference on Intelligent Data Acquisition and Advanced Computing Systems: Technology and Applications 
(IDAACS’2017), 2017. pp 270-276.

16 Вопросы кибербезопасности  №5(24) - 2017