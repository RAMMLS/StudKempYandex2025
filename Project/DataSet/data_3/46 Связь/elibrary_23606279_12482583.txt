ТЕХНИКА РАДИОСВЯЗИ 
Выпуск 1 (24) 2015 
 
 
УДК 621.394.18 
 
 

СИСТЕМА ВВОДА ПРЕДЫСКАЖЕНИЙ  
НА ОСНОВЕ КОРРЕКТИРУЮЩИХ ТАБЛИЦ 

 
© И.Е. Кащенко  

 
Описывается разработанная автором система компенсации нелинейных ис-

кажений транзисторных радиопередающих устройств декаметрового диапазона. 
За основу взят принцип предыскажения сигнала, поступающего на радиопереда-
ющее устройство. Вводимые предыскажения рассчитываются на основе коррек-
тирующих таблиц фазы и амплитуды сигнала, что обеспечило высокие результа-
ты работы системы на примере реального радиопередающего устройства.  

Ключевые слова: линеаризация, компенсация, нелинейные искажения, таб-
лица фазы, таблица амплитуды, радиопередающий тракт. 

 
 

SYSTEMS OF PREDISTORTIONS INPUT ON THE BASIS  
OF CORRECTING TABLES 

 
© I.E. Kashchenko 

 
This paper describes the system of balancing of nonlinear distortions of decameter 

transistor radio transmitters developed by the author. It is based on the principle of dis-
tortion of signal incoming into radio transmitter. Input predistortions are calculated on 
the basis of correcting tables of phase and amplitude of the signal, which provides high 
effectiveness of work of the system by way of example of real radio transmitters. 

Keywords: linearization, balancing, nonlinear distortions, phase table, amplitude 
table, radio-transmitting path. 

 
В настоящее время наиболее эффективным и наименее затратным методом 

линеаризации радиопередающих устройств стал метод ввода цифровых 
предыскажений сигнала. Существует множество различных способов расчёта 
величины, на которую должен быть искажён полезный сигнал, чтобы умень-
шить величину интермодуляционных составляющих на выходе радиопередаю-
щего устройства. Но наиболее распространёнными являются два из них: это 
расчёт с помощью аналитической модели и расчёт на основе корректирующих 
таблиц. 

Аналитическая модель уже была исследована и испытана автором на при-
ёмопередающем устройстве [1]. Суть аналитической модели заключается в опи-
сании поведения динамических нелинейных систем (усилителей мощности). 
Наиболее приближённой к реальности и пригодной для вычислений является 
полиномиальная модель с памятью. В результате исследований и дальнейшей 
адаптации алгоритмов у данной системы было обнаружено два недостатка:  

78 



– во-первых, выявлена необходимость в изменении степени полинома и 
порядка памяти для различных частот в декаметровом диапазоне. При этом вы-
бор степени и порядка полинома должен осуществляться эмпирическим мето-
дом, что значительно увеличивает время настройки системы; 

– во-вторых, к недостатку данной модели можно отнести сложность аппа-
ратной реализации в сравнении с методом на основе корректирующих таблиц. 
Требуется наличие специализированных высокопроизводительных программи-
руемых логических интегральных схем (ПЛИС) и цифровых сигнальных про-
цессоров (ЦСП) [2].  

Модель на основе корректирующих таблиц принципиально отличается от 
аналитической модели. В исходном виде она достаточно проста и не может 
сравниться с полиномиальной моделью в части гибкости и универсальности. 
Однако есть возможность значительно повысить эти показатели для корректи-
рующих таблиц за счёт использования алгоритмов, схожих с алгоритмами, при-
менёнными в полиномиальной модели с памятью. В этом случае данный метод 
будет достаточно точным и лишённым недостатков, присущих полиномиальной 
системе с памятью. Появляется возможность реализовать данный метод на базе 
сигнальных процессоров без использования специализированных ПЛИС.  

Существует несколько методов построения корректирующих таблиц: 
• коррекция комплексной огибающей сигнала (Gain based) [3]; 
• коррекция действительной и мнимой части комплексного сигнала 

(Mapping based) [3]: 
• коррекция амплитуды и фазы сигнала (полярная коррекция – Polar 

based) [3]. 
В данном эксперименте за основу был взят метод полярной коррекции 

сигнала, алгоритм формирования которого приведён на рис. 1. 
 

 
 

Рис. 1. Структурная схема полярного метода коррекции сигнала 
 

В отличие от комплексных таблиц коррекции полярный метод может со-
держать таблицы, представленные в виде чисел с фиксированной точкой без 
ухудшения эффективности своей работы [4]. 

Для создания таблиц коррекции необходимо получить характеристики ис-
следуемого радиопередающего устройства. Для исследования переходной ха-

79 



рактеристики был выбран способ сравнения входного и выходного сигналов ра-
диопередающего устройства.  

Реализация данного способа была осуществлена на радиопередающем 
устройстве РПДУ-1м2 (разработка ОАО «ОНИИП»). Для более качественного 
эксперимента параметры линейности были сознательно снижены. Мощность на 
частоте 29,9 МГц составила Pвых=950 Вт, интермодуляционные искажения 3-го 
порядка (ИМИ-3) –32,5 дБ. 

Наличие широкополосного цифрового входа у РПДУ-1м2 позволило реа-
лизовать один из основных методов построения систем ввода цифровых 
предыскажений – увеличение полосы предыскажённого сигнала в 3–5 раз отно-
сительно полосы основного сигнала. Этот метод обусловлен прежде всего тем, 
что при прохождении сигнала через нелинейную систему ввода предыскажений 
на её выходе появляются интермодуляционные составляющие нечётных поряд-
ков. При этом их амплитудная величина по модулю равна величине интермоду-
ляционных составляющих линеаризуемого радиопередающего устройства, а фа-
зовая величина имеет противоположный знак. Поэтому, не обеспечивая требо-
вания по ширине полосы сигнала, поступающего на вход усилителя мощности, 
система ввода предыскажений не может влиять на интермодуляционные иска-
жения, возникающие в усилителях мощности за полосой сигнала. 

Для проведения экспериментальных исследований по линеаризации РПДУ-1м2 
была разработана система ввода предыскажений на базе ПЭВМ и обратного кана-
ла, представленного системой переноса спектра частот в низкочастотную область. 
Структурная схема системы ввода предыскажений РПДУ-1м2 представлена на рис. 2. 

 

 
 

Рис. 2. Структурная схема системы ввода предыскажений для РПДУ 
 

Данная система ввода предыскажений предусматривает первоначальную 
калибровку по тестовому сигналу. В качестве тестового сигнала был выбран 
двухтоновый сигнал с определённым частотным разносом между тонами.  

80 



Двухтоновый тестовый сигнал позволяет получить переходные характери-
стики путём его сравнения с сигналом на выходе РПДУ. Временная задержка 
между входным и выходным сигналами находится с помощью функции взаим-
ной корреляции. После этого рассчитываются амплитудные и фазовые искаже-
ния, которые вносят усилители мощности. Таким образом, находятся величины, 
которые необходимо представить в инверсной форме, чтобы обеспечить требуе-
мую величину вводимых предыскажений.  

Максимальная величина частотного разноса тонов для тестового сигнала 
была определена в ходе измерения амплитудно-частотной характеристики 
(АЧХ) радиопередающего тракта в полосе основного сигнала. Измерение АЧХ 
проводилось методом многотонового анализа, т. е. был сформирован сигнал, 
состоящий из 16 гармонических колебаний, равноудалённых по частоте в диапа-
зоне от 300 до 3300 Гц. При прохождении такого сигнала через радиочастотный 
тракт появляется возможность оценить неравномерность АЧХ на выходе тракта. 
Из полученной АЧХ (рис. 3) были определены частоты с равными амплитудами, 
лежащие в диапазоне от 1500 до 1900 Гц. 

 
Рис. 3. Анализ АЧХ в основной полосе сигнала тракта РПДУ-1м2  

методом многочастотного сигнала  
 

Следует учитывать, что при линеаризации тракта декаметрового диапазона 
частот в полосе телефонного сигнала от 300 до 3400 Гц не следует выбирать ча-
стотную разницу между двумя тонами меньше 100 Гц, так как в этом случае на по-
лученную характеристику повлияют термические факторы «эффекта памяти». Это 
требование следует соблюдать при построении неадаптивных или слабоадаптивных 
систем ввода цифровых предыскажений на основе прямого обучения.  

Работа системы ввода предыскажений осуществляется следующим образом: 
тестовый сигнал, приходящий от внешнего источника (телефонный канал), поступает 
на вход ПЭВМ, затем происходит предыскажение полезного сигнала в соответствии с 
вычисленными таблицами коррекции амплитуды и фазы сигнала. Далее этот сигнал 

81 



транслируется по стыку Ethernet на широкополосный цифровой вход РПДУ-1м2, где 
происходят перенос спектра в высокочастотную область и дальнейшее усиление сиг-
нала. На выходе РПДУ-1м2 измерителем мощности контролируется выходной сиг-
нал, и с помощью направленного ответвителя и аттенюатора часть мощности выход-
ного сигнала транслируется на устройство переноса спектра частот. В результате по-
лученные данные с выхода РПДУ-1м2 поступают на вход ПЭВМ.  

Полученные инверсные характеристики описываются с помощью таблиц 
коррекции, представленных на рис. 4, в которых адресом таблицы является мо-
дуль или мощность полезного сигнала, а содержимое ячейки – величина, на ко-
торую необходимо изменить модуль или фазу полезного сигнала.    

 
АМ РМ

Адрес LUT Адрес LUT

... Amp_pd1 ... Phase_pd1
|A|2 |A|2 

... Amp_pd2 ... Phase_pd2

... Amp_pd3 ... Phase_pd3

... ... ... ...
   

 
Рис. 4. Принцип адресации таблиц коррекции по модулю передаваемого сигнала  

 
Для создания таких таблиц использовался метод кусочно-линейной ап-

проксимации с оптимизацией по среднеквадратичному отклонению (СКО).  
Для того чтобы ускорить вычисления, исходные данные массива входного 

сигнала были представлены в виде разреженных матриц. Количество столбцов 
матрицы будет соответствовать количеству опорных точек таблиц коррекции.    

Формирование входной матрицы можно представить в виде 
− x + xi

N i ( j −1)
 a x

( − ) = ∑ +1 – для нижнего предела, (1) 
j 1 i

x j = 2 xi − xi
j ( j −1)

 
 

x + xi
N i ( j −1)

 a x
( ) = ∑  – для верхнего предела, (2) 

j i
x j = 2 xi − xi

j ( j −1)
где a  – формируемый массив входных данных, ix – индексы 

для x ∈[xi( j −1); xi j ), x – входной вектор данных, xi – заданные опорные точки 

таблицы, j  – индекс опорной точки. Далее представляем данные в виде разре-
женной матрицы на основе (1) и (2) вида 
 

a( j − ) a
i ( j) 0

1 i
x x

 a = 0 a( ) a( +1) . (3) 
j i + j i

x 1 x +1
0 0 ...

82 



Эта матрица вместе с опорными точками таблицы и выходными данными 
будет представлять не что иное, как систему линейных уравнений, представлен-
ную в матричном виде 
 a × yi = y , (4) 
 

где a  – разреженная матрица входных данных, yi  – опорные точки выходных 
данных, y  – выходной вектор. Далее, применяя алгоритм деления с минимиза-
цией СКО, находим опорные значения таблицы корректировки. Таким образом 
находятся значения таблиц амплитуды и фазы. 

 
а 
 

 
б 

 
Рис. 5. Амплитудная (а) и фазовая (б) характеристики 

системы ввода предыскажений в сравнении  
с семейством измеренных инверсных характеристик РПДУ-1м2 

83 



Данный метод позволил получить оптимальные значения адреса и содер-
жимого ячейки, полностью описывающие нелинейное поведение системы ввода 
предыскажений. На графиках (рис. 5) представлены семейства нелинейных ин-
версных характеристик РПДУ-1м2. Первый график описывает инверсное искаже-
ние амплитуды сигнала, второй – инверсное искажение фазы исходного сигнала 
относительно его амплитуды. Количество опорных точек таблиц коррекции для 
обоих графиков равно 256. Критерием для выбора количества опорных точек и 
оценки аппроксимации является анализ полученных данных модели и данных, 
снятых непосредственно с усилителя мощности. Способом анализа этих результа-
тов является метод вычисления СКО модели от экспериментальных данных [1]. 

В этом случае отклонение равно 0,001 В для амплитуды сигнала и 0,003 
рад. для разности фаз сигнала без учёта дрейфа частоты опорного генератора 
(ОГ) РПДУ. Сравнивая полученное значение с модулем тестового сигнала 
V0 = 2,7 В, можно сделать вывод о высокой точности созданной модели коррек-
тора.  Дальнейшее увеличение количества опорных точек таблиц коррекции не 
ведёт к существенному снижению СКО модели. Полученные опорные значения 
записываются в ячейки памяти таблиц коррекции, и система готова к работе с 
полезным сигналом. В ходе экспериментов с реальными сигналами были полу-
чены следующие результаты по снижению уровня ИМИ-3 и уровня внеполос-
ных излучений.  

На рис. 6 представлен спектр выходного сигнала РПДУ-1м2 без 
предыскажений и с предыскажениями. При введении предыскажений уровень 
ИМИ-3 снизился на 23,5 дБ, а уровень ИМИ-5 – на 15,2 дБ. Частоты тонов про-
верочного сигнала (1400 и 2300 Гц) отличаются от тестового (калибровочного) 
сигнала (1500 и 1900 Гц), потому что проверочный сигнал определён требовани-
ями к радиопередающим устройствам по вносимым интермодуляционным ис-
кажениям, а тестовый сигнал получен исходя из АЧХ тракта.  

 
Рис. 6. Спектр двухтонового сигнала с предыскажениями и без предыскажений 

Далее были проведены эксперименты с использованием OFDM-сигналов с 
полосой 3100 Гц (рис. 7). Результатом работы системы ввода предыскажений 
стало снижение уровня внеполосных излучений на 15,3 дБ.  

84 



Таким образом, система способна улучшать спектральные характеристики 
РПДУ при работе со сложными видами сигналов. 

 
Рис. 7. Спектр OFDM-сигнала с предыскажениями и без предыскажений 

 

Подытоживая вышеизложенное, можно сделать вывод, что автору статьи 
удалось разработать достаточно простую и эффективную систему ввода 
предыскажений, не требующую высокой производительности устройств обра-
ботки сигналов. Экспериментальные значения эффективности системы получи-
лись выше, чем у полиномиальной системы с памятью [1], а время, затраченное 
на обработку сигналов и калибровку системы, значительно сократилось. В даль-
нейшем планируется создание системы с постоянной адаптацией по обратному 
каналу для повышения устойчивости работы алгоритмов линеаризации при вли-
янии дестабилизирующих факторов на антенно-фидерный тракт. 

 
ЛИ Т Е Р А Т У Р А  

 
1. Кащенко И.Е., Богданов А.В. Результаты экспериментального исследования ли-

неаризации радиопередающего тракта // Успехи современной радиоэлектроники. – 2014. 
– № 11. – С. 38–42.  

2. Epstein T. Serrano C. RF Power Amplifier Characterization for Predistortion Linear-
ization in partial fulfillment of the requirements for the degree of Bachelor of Science. – 
Worcester Polytechnic Institute, 2007. 

3. Makbule Pehlivan Aslan. Adaptive digital predistortion for power amplifier lineariza-
tion. – Turkey, 2008. 

4. Turusan Kolcuoglu. Linearization of power amplifiers with memoryless baseband 
predistortion method. – Turkey: Middle East Technical University, 2011. 

 
 

Сведения об авторе 
 
Кащенко Игорь Евгеньевич – инженер-программист ОАО «ОНИИП» (Омск). E-mail: 
info@oniip.ru.   
 
 

Статья получена в октябре 2014 г. 

85