ПРИЕМОПЕРЕДАЮЩАЯ ТЕХНИКА 
2017 Техника радиосвязи  Выпуск 2 (33) 

 
 
 
 

УДК 621.391.8 
 
 

© И. Е. Кащенко 
Омский научно-исследовательский институт приборостроения, Омск, Российская 
Федерация 

 
ИМИТАЦИОННОЕ МОДЕЛИРОВАНИЕ АЛГОРИТМА АДАПТАЦИИ  

НА ОСНОВЕ РЕКУРСИВНОГО МЕТОДА ПРОГНОЗА ОШИБКИ (RPEM) 
ДЛЯ СИСТЕМ ВВОДА ПРЕДЫСКАЖЕНИЙ 

Рассмотрена имитационная модель алгоритма адаптации на основе рекурсивного 
метода прогноза ошибки (RPEM) для систем ввода предыскажений. Данный алго-
ритм предназначен для систем ввода предыскажений, основанных на косвенном 
обучении, и позволяет производить настройку параметров без предварительной 
калибровки. Эффективность работы алгоритма адаптации показана на примере 
системы ввода предыскажений для имитационной модели усилителя мощности 
декаметрового диапазона радиоволн. 
Ключевые слова: алгоритм адаптации, рекурсивный метод прогноза ошибки, систе-
ма ввода предыскажений, нелинейные искажения, системы с косвенным обучением. 
Формат цитирования: Кащенко И. Е. Имитационное моделирование алгоритма 
адаптации на основе рекурсивного метода прогноза ошибки (RPEM) для систем 
ввода предыскажений // Техника радиосвязи. 2017. Вып. 2 (33). С. 60–67. 

 
 
© I. E. Kashchenko 
Omskiy Naucho Issledovatelskiy Institut Priborostroeniya, Omsk, Russian Federation 

 
IMITATING SIMULATION OF THE ADAPTATION ALGORITHM  
BASED ON RECURSIVE PREDICTION ERROR METHOD (RPEM)  

FOR PREDISTORTIONS INPUT SYSTEMS  

A simulation model of the adaptation algorithm based on recursive prediction error 
method (RPEM) for predistortions input systems is considered. This algorithm is in-
tended for systems of predistortions input based on indirect teaching and it allows to 
perform adjustment of parameters without predetermined calibration. The operating ef-
ficiency of the adaptation algorithm is shown by way of example of predistortions input 
system for the simulation model of a decameter-range power amplifier. 
Keywords: adaptation algorithm, recursive prediction error algorithm, predistortions input 
system, non-linear distortions, systems with indirect teaching. 
For citation: Kashchenko I. E. Imitating simulation of the adaptation algorithm based 
on recursive prediction error method (RPEM) for predistortions input systems // Radio 
communication technology. 2017. Iss. 2 (33), pp. 60–67. 
 

60 



 

Введение 
В современных средствах радиосвязи для усиления радиочастотного сиг-

нала используются широкополосные транзисторные усилители мощности. С це-
лью обеспечения режима максимального промышленного КПД радиопередаю-
щего устройства усилители мощности работают в режиме близком к насыще-
нию. Однако в таком режиме они вносят весьма существенные нелинейные ис-
кажения в передаваемый сигнал. Для устранения этого недостатка используются 
системы линеаризации усилителей мощности. В настоящее время наиболее по-
пулярной системой линеаризации является система ввода предыскажений. 
Принцип ее работы основан на искажении поступающего на вход усилителя 
мощности сигнала в соответствии с его инверсной нелинейной характеристикой. 
Такая система обладает высокой эффективностью и не требует вмешательства в 
радиочастотный тракт усилителя мощности.  

При проектировании систем ввода цифровых предыскажений необходимо 
учитывать зависимость нелинейных свойств усилителей мощности от частоты 
несущего колебания. Для радиопередающего устройства (РПДУ) декаметрового 
диапазона радиоволн коэффициент перекрытия по частоте, как правило, больше 
15, при этом нелинейные свойства усилителей мощности зависят от частоты не-
сущего колебания [1]. Кроме того, необходимо учитывать изменения нелиней-
ных свойств усилителей мощности с течением времени и при воздействии 
внешних дестабилизирующих факторов.  

Для учѐта вышеизложенных особенностей усилителей мощности необхо-
дима адаптация параметров системы ввода предыскажений.  

Наиболее оптимальным алгоритмом с точки зрения эффективности и ско-
рости сходимости является алгоритм на основе рекурсивного метода прогноза 
ошибки (RPEM) [2]. Этот алгоритм предполагает использование системы ввода 
предыскажений с косвенным обучением [3]. Основным преимуществом данного 
алгоритма является возможность работы с любыми нелинейными системами без 
какой-либо настройки параметров, но адекватность его работы с моделями ре-
альных усилителей мощности мало изучена. Цель  данной статьи – освещение 
результатов имитационного моделирования работы системы ввода предыскаже-
ний с усилителем мощности. В качестве модели усилителя мощности была ис-
пользована полиномиальная модель с памятью на основе параметров, получен-
ных от реального усилителя мощности. 

 
Применение алгоритма RPEM в составе систем ввода предыскажений 

с косвенным обучением 
Структурная схема системы ввода предыскажений с косвенным обучени-

ем представлена на рис. 1. Адаптация параметров системы ввода предыскаже-
ний происходит по сигналу ошибки, который является разностью между сигна-
лом на выходе блока ввода предыскажений в прямом канале и сигналом на вы-
ходе обучающегося фильтра в обратном канале [4; 5]. 

При использовании косвенного обучения коэффициенты системы ввода 
предыскажений постоянно подстраиваются (рекурсия) при сравнении двух сиг-
налов с выхода блока ввода предыскажений и с выхода обучающегося фильтра.  

61 



 

x(n) Блок ввода y(n) Нелинейный z(n)
предыскажений усилитель

C(n) мощности

+ e(n)
+

-
Обучающийся 

~ фильтр
y(n) ~

C (n)

 

Рис. 1. Структурная схема системы ввода предыскажений  
с косвенным обучением 

 
В качестве математической модели блока ввода предыскажений целесооб-

разно использовать полиномиальную модель с памятью, ввиду меньшего коли-
чества настраиваемых параметров. Математическая модель обучающегося 
фильтра представляет собой выражение 

P
~y(n) c~T

k zk (n) , (1) 
 k 1  

T
где    c~k (n) (c~k ,0 (n)...c~ ˆ (n)) – вектор параметров обучающегося фильтра; 

k ,M 1

z(n)k

~z (n) ... – вектор степенных множителей входного сигнала;  

z(n Mˆ 1)k

 

Перепишем вектор параметров обучающегося фильтра в виде 

c~(n) (с~T
1 (n)...с~T (n) T

p ) . (2) 
 

Сигнал ошибки e(n) определяется как 

e(n) y(n) ~y(n) . (3) 
 

Коэффициенты блока ввода предыскажений обновляются рекурсивно с по-
мощью RPEM-метода. RPEM-метод основан на минимизации целевой функции 

N
1

V (c~) lim E e2 (n) . (4) 
N N

 n 1

Отрицательный градиент функции e(n)  по вектору параметров c~(n)  
определяется как 

62 



 

T
z1(n)

T
t (n) c (n e(n) ~

~ ) c~(n) y(n) ... . (5)
z (n)

 p  
Тогда настройка коэффициентов системы ввода предыскажений определяется 
следующими выражениями: 

e(n) y(n) сT (n)z(n) , (6) 
 

 (n) 0 (n 1) 1 0 , (7) 

s(n) T (n)P(n 1) (n) (n) , (8) 
 

P(n) (P(n 1) P(n 1) (n)s 1(n) T (n)P(n 1)) / (n) , (9) 
 

c~(n 1) c~(n) P(n) (n)e(n) , (10) 
 

где λ(n) – параметр забывания, экспоненциально возрастающий до 1 при n→∞, 
λ0 и λ(0) – настраиваемые параметры, как правило, оптимальную сходимость 

–1
обеспечивают значения λ0=0,99 и λ(0)=0,95 [6]. Кроме того, P(n) = nR (n), где 
R(n) – аппроксимация Гессе в алгоритме Гаусса – Ньютона [6; 7]. Наиболее оп-
тимальным начальным значением для параметра P(n) является значение 
P(n) = ρI, где I – единичная матрица и ρ – константа, определяющая степень до-
верия к начальным значениям вектора с(0). При отсутствии первоначальных 
значений, т. е. с(0) = 0, скорость сходимости значительно возрастает.  

При приближении сигнала ошибки e(n) к нулю сигнал с выхода усилителя 
мощности приближается к значению сигнала x(n), при этом процесс подстройки 
коэффициентов стремится к состоянию динамического равновесия, по достиже-
нии которого процесс коррекции сигнала можно назвать квазистационарным.  

 
Имитационная модель системы ввода предыскажений на основе  

алгоритма RPEM 
На основе данных, представленных в выражениях (1–10), была разработа-

на имитационная модель алгоритма адаптации на основе рекурсивного метода 
прогноза ошибки (RPEM). 

Работа полиномиального блока ввода предыскажений уже довольно по-
дробно освещена в литературе [8]. Интерес представляет работа обучающегося 
фильтра и алгоритма адаптации. Для представления сигнала с выхода усилителя 
мощности в соответствии с полиномиальной моделью [8] можно использовать 
схему преобразования сигнала z(n) (рис. 2). Таким образом, выходная матрица Z 
будет представлять собой матрицу значений для полиномиальной модели с па-
мятью. 

63 



 

 
 

Рис. 2. Схема преобразования сигнала z(n) 
 
Далее необходимо произвести операции над сигналами Z и e(n) в соответ-

ствии с формулами (6–10). На рис. 3 изображена структурная схема метода 
адаптации на основе алгоритма RPEM, в которой блок формирователя Z и блок 
комплексного сопряжения приводят Z к виду 

z(n)k

~z (n) ... . (11) 

z(n Mˆ 1)k

 

Исходя из того факта, что представляемая модель имеет линейную зави-
симость от параметров, можно записать равенство 

z(n)T T
. (12) 

 

Далее производятся операции, соответствующие формулам (6–10). 
Таким образом, представленная схема реализует алгоритм адаптации на 

основе метода RPEM.  
 

 
Рис. 3. Структурная схема работы алгоритма RPEM 

64 



 

Результаты моделирования и их обсуждение 
Для оценки эффективности работы алгоритма RPEM как метода адаптации 

системы ввода предыскажений был проведѐн ряд экспериментов с использова-
нием представленных выше имитационных моделей. 

В качестве объекта исследований была выбрана имитационная модель 
усилителя мощности декаметрового диапазона радиоволн. В качестве тестового 
сигнала был взят широкополосный сигнал (полоса сигнала F = 1 МГц) с высо-
ким уровнем пик-фактора (отношение пиковой мощности сигнала к его средней 
мощности) около 10 дБ. Выбор сигнала обусловлен тем, что динамические свой-
ства модели усилителя мощности при прохождении широкополосных сигналов с 
высоким уровнем пик-фактора проявляются в максимальной степени. 

Начальные параметры системы ввода предыскажений с использованием 
метода адаптации на основе алгоритма RPEM не были установлены, т. е. систе-
ма производит адаптацию с «нуля». На рис. 4 представлен спектр сигнала на вы-
ходе модели усилителя мощности с использованием предыскажений в сравне-
нии со спектром сигнала без применения предыскажений, а также спектр исход-
ного сигнала.  

 
Рис. 4. Спектры сигналов на входе и выходе модели РПДУ 

 
Как видно на данном рисунке, система ввода предыскажений с использо-

ванием метода адаптации на основе алгоритма RPEM позволяет существенно 
снизить нелинейные искажения сигнала на выходе модели усилителя мощности. 
Снижение уровня внеполосных составляющих составляет порядка 17–25 дБ.  

Скорость сходимости, т. е. время, необходимое для установления состоя-
ния динамического равновесия для метода RPEM, является наименьшим по 
сравнению с другими методами для систем предыскажений на основе непрямого 
обучения. Для данной модели время сходимости составило 9 мс.  

65 



 

Стоит отметить тот факт, что алгоритм RPEM для выполнения одной ите-
рации обновления всех коэффициентов системы ввода предыскажений при ис-
пользовании порядка полинома K = 5 и глубины памяти M = 3 требует около 
3000 операций умножения для 32-битных чисел в формате фиксированной точ-
ки. В то же время менее быстрый и менее точный алгоритм LMS для систем с 
прямым обучением [9] требует всего лишь 60 операций умножения с теми же 
параметрами системы ввода предыскажений. При этом чтобы обеспечить мини-
мальное время сходимости алгоритма, частота обновления коэффициентов си-
стемы ввода предыскажений при заданных параметрах должна лежать в преде-
лах от 0,001 до 0,01 от частоты дискретизации сигнала [3].  

Данный факт не является существенным при построении системы ввода 
предыскажений для узкополосных сигналов при наличии современных аппарат-
ных средств цифровой обработки сигналов. Однако с увеличением полосы пере-
даваемого сигнала вычислительных ресурсов может потребоваться значительно 
больше. Например, для сигнала с частотой дискретизации 2 МГц от аппаратной 
части потребуется производительность от 60 до 600 MFLOPS. 

Существенного снижения количества операций умножения для алгоритма 
RPEM можно добиться путѐм уменьшения глубины памяти системы ввода 
предыскажений. Для этого необходимо провести анализ передаточной характе-
ристики и оценить динамические свойства радиопередающего тракта [9].  

 
Заключение 
В ходе проведенного моделирования показано, что алгоритм адаптации на 

основе метода RPEM позволяет существенно снизить уровень внеполосных не-
линейных искажений и соответственно увеличить эффективный динамический 
диапазон. Важным фактом является то, что данный алгоритм, в отличие от алго-
ритмов с прямым обучением [10], способен работать без предварительной ка-
либровки параметров нелинейного радиопередающего тракта.  

 
Л И Т Е Р А Т У Р А  

1. Кащенко И. Е. Алгоритм адаптации для системы ввода цифровых предыска-
жений // Техника радиосвязи. 2015. № 4 (27). С. 89–94. 

2. Gan L., Abd-Elrady E. Digital predistortion of memory polynomial systems using 
direct and indirect learning architectures // Institute of Signal Processing and Speech Commu-
nication. Graz University of Technology, 2009. 

3. Gan L., Abd-Elrady E. Linearization of weakly nonlinear systems using FIR filters 
and Recursive Prediction Error method // Proc. Of MLSP’08, Cancun, Mexico, 2008. 

4. Memory polynomial predistorter based on the indirect learning architecture / 
L. Ding [et al.] // Proc. of GLOBECOMM. Taipei, Taiwan, 2002, pp. 967–671. 

5. A robust digital baseband predistorter constructed using memory polynomials/ L. 
Ding [et al.] // IEEE Trans. on Communications, vol. 52, no. 1, pp. 159–165. 

6. Ljung L., Soderstrom T. Theory and Practice of Recursive Identification // M.I.T. 
press, Cambridge, MA, USA, 1983. 

7. Soderstorm T., Stoica P. System Identification // Prentice-Hall International. Hemel 
Hempstead, United Kingdom, 1989. 

8. Konstantinou K., Kim E. Digital predistortion of wideband signals based on power 
amplifier model with memory // IEEE Letters. Vol. 37, 2001, pp. 1417–1418. 

66 



 

9. Zhu A., Pedro J. C., Brazil T. J. Dynamic deviation reduction-based Volterra behav-
ioral modeling of RF power amplifiers // IEEE Trans. On Microwave Theory and Technique. 
Vol. 54, 2006, no. 12, pp. 4323–4332. 

10. Giesbers D., Mann S., Eccleston K. Adaptive digital predistortion linearization for 
RF power amplifiers // Proceedings of Electronics New Zealand Conference. New Zealand, 
2006, pp. 244–248.  

 
 

Сведения об авторе 

Кащенко Игорь Евгеньевич – инженер-программист АО «ОНИИП», аспирант Омского 
государственного технического университета. E-mail: info@oniip.ru. 

 
 
 

Поступила в редакцию: декабрь 2016 г. 
Рецензирование: январь 2017 г. 
Принята в печать: апрель 2017 г. 

 

67