РАДИОЛИНИИ И СИСТЕМЫ РАДИОСВЯЗИ 
2021 Техника радиосвязи  Выпуск 3 (50) 
 
 
 
 
УДК 621.397.335 
DOI 10.33286/2075-8693-2021-50-07-16 
 
 
© О. В. Салтыков 
Омский научно-исследовательский институт приборостроения, Омск, Российская 
Федерация 
 

АЛГОРИТМ ТАКТОВОЙ И ЧАСТОТНОЙ СИНХРОНИЗАЦИИ  
КВ-МОДЕМА 

Предложен дополненный к автокорреляционному алгоритм частотно-временной 
синхронизации высокоскоростного модема, работающего в условиях сильно дис-
пергирующего канала. Показано, что в условиях перераспределения энергии лучей 
предложенный алгоритм позволяет добиться удовлетворительной синхронизации. 
Ключевые слова: синхронизация модема, тактовая синхронизация, частотная под-
стройка, временная метрика. 
Для цитирования: Салтыков О. В. Алгоритм тактовой и частотной 
синхронизации КВ-модема // Техника радиосвязи. 2021. Выпуск 3 (50). С. 7–16. 
DOI: 10.33286/2075-8693-2021-49-07-16. 

 
 
© O. V. Saltykov 
Omsk Scientific-Research Institute of Instrument Engineering, Omsk, Russian Federation 
 
HF MODEM CLOCK AND FREQUENCY SYNCHRONIZATION ALGORITHM 

The article proposes an algorithm for time-frequency synchronization of a high-speed 
modem operating under conditions of a highly dispersing channel, supplemented by an 
autocorrelation algorithm. It is shown that under the conditions of ray energy redistribu-
tion, the proposed algorithm makes it possible to achieve satisfactory synchronization. 
Keywords: modem synchronization, clock synchronization, frequency control, time metric. 
For citation: Saltykov O. V. HF modem clock and frequency synchronization algorithm 
// Radio communication technology. 2021. Issue 3 (50), pp. 7–16. DOI: 10.33286/2075-
8693-2021-49-07-16. 
 
Введение 
Частотная подстройка и тактовая синхронизация являются теми функци-

ями, которые определяют помехоустойчивость модема. Если демодулятор высо-
коскоростной и использует для корректировки сигнала эквалайзер, то требования 
к точности синхронизации его существенно возрастают. В литературе часто об-
суждаются различные корреляционные и автокорреляционные алгоритмы ча-
стотно-временной синхронизации высокоскоростных модемов в многолучевых 

7 



каналах, но слабо диспергирующих [1]. В более сложных каналах, каким, напри-
мер, является коротковолновый (КВ), быстрое и значительное перераспределение 
энергетики лучей приводит к существенным ошибкам таких алгоритмов синхро-
низации, что влечет появление аномальных ошибок демодуляторов.  

Целью  проведенного исследования являлась доработка автокорреляцион-
ного алгоритма, использующая оценивание импульсной характеристики канала и 
позиционирование ее в окне анализа. В результате этой доработки стало возмож-
ным корректировать моменты синхронизации от корреляционных алгоритмов. 

 
Постановка задачи 
Часто в основе частотно-временной системы синхронизации лежит авто-

корреляционный принцип измерения остаточного частотного сдвига и нахожде-
ния момента тактовой синхронизации. Для этого в информационный поток поме-
щают два или больше одинаковых отрезков сигналов, вместе называемых синхро-
символом, между которыми и находится автокорреляция. По пику автокорреля-
ционной функции (АКФ) определяется начальный момент радиограммы, а также 
выполняется процедура компенсации частотного сдвига. Обычно считается, что 
в автокорреляционном методе при парных тестовых комбинациях (ТК) сигнал мо-
дулятора искажается каналом примерно одинаково, что и должно дать один пик. 
В подобном автокорреляционном методе может участвовать несколько (2, 4, 8 
или 16) одинаковых тестовых последовательностей. 

Используем известный метод синхронизации на примере четырех ТК, кото-
рый может быть масштабирован на любое количество ТК. Подпоследовательно-
сти в составе общей или полной ТК назовем малыми ТК, в отличие от полного 
синхросимвола, объединяющего их все. 

Метод частотно-временной синхронизации на основе четырех ТК впервые 
был описан двумя авторами, имена которых этот метод теперь и носит – Shi-Ser-
pedin Synchronizer (S&S) [2]. Несмотря на то, что конкретно эта оценка была пред-
ложена для OFDM-модема, она хорошо себя зарекомендовала и для многих дру-
гих приложений, т. е. она универсальна. В этом алгоритме четыре последователь-
ности, следующие друг за другом, не просто повторяются, но имеют различные 
знаки. Если обозначить одну из таких малых последовательностей как «В» (век-
тор, или массив), то четыре малые ТК в S&S будут выглядеть так: [+B+B –B+B]. 
Знаки были определены с помощью моделирования, когда тестировались у дан-
ной конструкции всевозможные сочетания знаков: [±B±B±B±B]. Можно отме-
тить, что имеются и другие работы на данную тему с аналогичными исследовани-
ями и для большего числа малых ТК в структуре единого синхросимвола [3]. Ми-
нимальное их число, как понятно, может быть две: [+B±B].  

Приемник анализирует сигнал в окне анализа из N выборок, охватывая тем 
самым всю большую ТК. С каждой новой выборкой на этом окне анализа вычис-
ляется так называемая временная метрика, в которой и содержится информация о 
приходе полезного сигнала. Допустим, l – номер пришедшего отсчета. В памяти 
хранится история из N отсчетов. Если начало синхросимвола обозначить номером 
l = 0, то смещение номера l в ту или иную сторону означает отсутствие правиль-
ного положения синхросимвола. Только когда последний полностью заходит в 
окно анализа, означает нахождение искомого момента времени.  

Отсчеты окна анализа разделяются на четыре вектора (массива): 

8 



R T
1  [r(l),...,r(l  N / 41)] , R  [r(l  N / 4 r( / T

2 ),..., l  2N 41)] , 

R  [r(l  2N / 4),...,r(l  3N / 41)]T , R  [r(l  3N / 4),...,r(l  N 1)]T
3 4 . 

Эти векторы соответствуют малым ТК. Находятся суммы всевозможных 
скалярных произведений этих векторов с учетом знака, группируемые в следую-
щем порядке: 

P1(l)  RH H H
1 R2  R2 R3  R3 R4 ,

 P2 (l)  RHR  RH
1 3 2 R4 ,  (1) 

P (l)  RH
3 1 R4.

В первой сумме – смежные векторы, во второй – через один, в третьей – 
через два. Это комплексные величины, причем в каждой сумме фазы произведе-
ний, как понятно, равны, так как эти векторы находятся на равном расстоянии 
друг от друга. Соответственно, у второй суммы фаза в два раза больше, чем у 
первой, а у третьей – в три раза, поэтому в одну сумму эти произведения объеди-
нять нельзя. Временная метрика строится как нормированная сумма (1) – к вели-

чине энергии этих векторов | Ri |2 : 

P(l)
 Q(l)  , (2) 

V (l)

3 4

где P(l)  | P1(l) |  | P2(l) |  | P3(l) | , V (l)  RH
i R . 

i
2 i1

Когда синхросимвол точно заходит в окно анализа (𝑙 = 0), сумма (2) будет 
максимальной. Так как в сумме (2) шесть произведений (1), а векторов (и их энергий) 
– четыре, то 6/4 и должен быть нормирующий множитель энергии, чтобы временная 
метрика была Q(l) 1 . В этом случае удобно устанавливается порог ( 0Tc 1), по 

которому можно анализировать достижения максимума временной функции. По 
аналогичным правилам выстраивается временная метрика и для любого другого 
числа малых ТК в общей ТК. Необходимо только определить путем моделирова-
ния наилучшее распределение их знаков по критерию наилучшей точности. 

Начало синхросимвола находится с помощью определения максимума: 

 tˆ  arg max Q(l) . (3) 
l

При этом частотный сдвиг канала равен 

 2 F
f  arg P (tˆ ( )

1 )  s ,  Гц, 4  
 N

где Fs– частота дискретизации, Гц. Используется только P1(l) . 

9 



Однако в условиях многолучевого КВ-канала, когда присутствует постоян-
ное перераспределение лучей, этого алгоритма оказывается недостаточно. То, что 
алгоритм автокорреляционный, совсем не означает, что временная метрика (2) бу-
дет иметь выраженный пик. Часто эта характеристика (выраженного пика) при-
водится в противовес корреляционному алгоритму, имеющему много пиков в 
многолучевом канале. Но и при автокорреляции различные лучи будут давать в 
метрике несколько максимумов, так как все лучи будут коррелировать друг с дру-
гом. Так что в таком сложном канале, как коротковолновый, момент синхрониза-
ции ТК будет заметно прыгать в пределах его памяти, которая может быть значи-
тельной (до десятка миллисекунд). Отсюда возникают целые блоки ошибок демо-
дулятора. В связи с этим необходима доработка данного алгоритма, чтобы не те-
рять группы информации. 

 
Результаты работы 
В данной статье предложен один из возможных вариантов такой доработки, 

заключающийся в совместном действии автокорреляционной метрики, описан-
ной выше, а также измерения импульсной характеристики (ИХ) канала и позици-
онирования ее в начало окна анализа. Именно это позиционирование позволяет 
ввести коррекцию к автокорреляционному алгоритму, что приводит к более точ-
ному оцениванию начала ТК. 

Метод оценивания ИХ канала, основанный на методе наименьших квадра-
тов (НК) ошибки, также известен [4–6]. Кратко опишем его здесь. Пусть на вход 
канала поступает детерминированная последовательность из N  элементов 
a0 ,a1,...,aN1 . Принимаемая смесь сигнала с шумом будет иметь вид 

 z Ag  n , (5) 

где A – матрица передаваемого сигнала; g – вектор отсчётов ИХ канала; n – век-
тор отсчётов канального шума. Рассмотрим фрагмент сигнала длительностью
(N Q)T , где Q – относительная память канала (в символах), T – длительность 

такта (символа). Соответствующая ему матрица A  имеет вид 

 aQ aQ1 ... a0 
 
aQ1 aQ ... a1

 A    . (6) 
 ... ... ... ... 
 
aN 1 aN 2 ... aN 1Q 

В матрице A присутствуют только известные элементы ТК a0 ,a1,...,aN1 . 

Метод НК заключается в отыскании такой оценки вектора отсчётов ИХ ( g ), ко-
торая минимизирует евклидову норму (или квадрат нормы) вектора ошибки 

2
 e min . (7) 

10 



Вектор ошибки e  определяется как разность принятого сигнала z  и его 
оценки zˆ  Agˆ : 

 e  z  Agˆ . (8) 

2
Для минимизации (7) необходимо, чтобы все частные производные e  по 

компонентам вектора ĝ  обращались в нуль. В результате получается 

 ˆ H 1 H
g  (A A) A z . (9) 

Вводя обозначение H 1 H
F  

(A A) A , окончательно получаем алгоритм ра-
боты оценивателя ИХ по методу НК: 

 gˆ Fz . (10) 

Если шум отсутствует, то z  Ag  и (9) даёт точную оценку: 

 gˆ  H 1 H
(A A) A Ag  g . (11) 

При наличии шума 

 gˆ  H 1 H
(A A) A (Ag n) g  n2 , (12) 

H 1 H
где n2  (A A) A n – шум в тракте оценивания. Дисперсии 2

n  всех компонент 

вектора n  одинаковы. Дисперсия каждой компоненты вектора n2  равна 

N Q1
2

 2,i  
2
n  f *

i, j fi, j , (13) 
j0

где fi, j  – компоненты матрицы F . Если второй сомножитель в (13) меньше 1, то 

дисперсия погрешности оценки будет меньше дисперсии шума канала. Это усло-
H

вие соблюдается, если матрица A A  хорошо обусловлена. Элементы матрицы
H

A A представляют собой элементы АКФ передаваемого сигнала. Чем острее 
H

АКФ, тем лучше обусловлена A A и тем меньше второе слагаемое в (13). 
Векторы рассматриваются как столбцы, поэтому будем говорить о «верх-

них» и «нижних» отсчетах массивов. Из (10) можно заметить, что отсчеты ИХ в 
векторе ĝ  начинаются в окне анализа сверху столбца (старые отсчеты времени), 

если лента отсчетов принятого сигнала z  начинается сверху с момента zQ1  и 

заканчивается внизу массива отсчетом zN , т. е. начальная часть ТК (первые Q 

11 



отсчетов) не участвует в данной процедуре по свойству свертки для ограничен-
ного отрезка сигнала. Если же это положение ленты отсчетов входного сигнала 
будет сдвинуто в ту или иную сторону (смещение тактовой синхронизации), то и 
положение ИХ в окне анализа (или в векторе ĝ ) будет смещено. Окно анализа вы-

бирается несколько шире памяти канала Q, поэтому алгоритм дополняется анали-
зом положения ИХ внутри массива ĝ . 

В первую очередь находится максимальный отсчет ИХ, и вся ИХ нормиру-
ется к этому значению. Ввиду перераспределения лучей канала, сверху (в старых 
отсчетах) массива могут присутствовать другие лучи, меньшие максимума, кото-
рые нужно определить. Для этого анализируются максимумы старых отсчетов ИХ 
с использованием некоторого порога, чтобы исключить шум. Включение новых 
(ранних) лучей относительно максимума и представляет собой смещение оценки 
ИХ  , которая добавляется с учетом знака к ранее найденному моменту синхро-

низации от автокорреляционного алгоритма. С этого нового момента также оце-
нивается частотное смещение канала. В результате получается более точная си-
стема синхронизации, устойчивая к перераспределению лучей. Также оценка ча-
стотного сдвига получается более точной. Если ИХ участвует в демодуляции сиг-
нала, то с этого момента необходимо заново ее измерить в более узком окне ана-
лиза, включающего только память канала Q. Это позволит иметь более точную 
оценку ИХ и исключит лишние шумы канала. 

Результаты работы алгоритма проверены в эксперименте на реальной 
трассе КВ-канала и OFDM-модема с полосой сигнала в 3 кГц, частотой дискрети-
зации сигналов 9600 Гц, длительностью OFDM-символа 32,5 мс (четверть его – 
защитный интервал). Три таких OFDM-символа объединяются в кадр. Один из 
них являлся синхросимволом (4 малых ТК), два других – информационные, со-
держащие также пилотные части, используемые для LMS-эквалайзера. OFDM-
символ заключал в себе 65 информационных символов и 11 пилотных (всего 76). 
Каждый информационный символ представлял собой 4-QAMсозвездие, т.е. вклю-
чал 2 бит информации. Таким образом, кадр содержал 260 бит информации, ра-
диограмма состояла из 500 кадров. По синхросимволам оценивалась канальная 
ИХ (примерно 10 раз в секунду), а по информационным – вероятность ошибки. 
Малая ТК состояла из 19 отсчетов последовательности Задова – Чу [7]. На каж-
дом кадре ИХ оценивалась независимо, оценки не усреднялись. 

По проведенным оценкам канальная ИХ в данном эксперименте могла 
включать от одного до трех лучей, которые с течением времени изменялись по 
своей энергии, а также по расстоянию между лучами. Первый луч мог стано-
виться меньше последующих. Быстрая смена энергетики лучей предполагает ре-
гулярные вставки в информационный поток ТК, используемых для подстройки 
системы синхронизации и оценивания ИХ. Рис. 1 иллюстрирует некоторые при-
меры типичных ИХ, измеренных на данной трассе (в расширенном окне). 

 

12 



   

Рис. 1. Иллюстрации типичных ИХ на экспериментальной КВ-трассе 
(«семплы» (samples) – отсчеты массива ИХ с интервалом  

дискретизации 1/9600 = 104 мкс) 

 
Результатом работы тактовой системы синхронизации является определе-

ние для демодулятора начала каждого OFDM-символа на временной оси с точно-
стью до интервала дискретизации (104 мкс). Назовем их тактовыми моментами 
синхронизации. В эксперименте в каждом кадре этот момент определялся незави-
симо, окно анализа помещалось на 51 отсчет ранее ожидаемого момента синхро-
низма (известного от предыдущих кадров) для целей захвата всего возможного 
разброса оценок этих отсчетов, которые и принимались за новую оценку. 

На рис. 2 представлена гистограмма разброса тактовых моментов синхро-
низации одного автокорреляционного алгоритма без подстройки смещений   от 

алгоритма оценивания ИХ на двухлучевой трассе. При таком разбросе этих мо-
ментов демодулятор часто выдает аномальные ошибки. 

На рис. 3 показаны гистограммы при работе полного (предложенного) алго-
ритма, когда моменты синхронизации корректируются с учетом смещений ИХ, ги-
стограмма которых (смещений ИХ) представлена дополнительно на рис. 3 вверху.  

 
 

 

Рис. 2. Гистограмма разброса тактовых моментов синхронизации  
одного автокорреляционного алгоритма 

13 



 

Рис. 3. Гистограммы разброса тактовых моментов синхронизации  
полного алгоритма 

 
Как следует из рис. 2 и нижнего рис. 3, разброс тактовых моментов синхро-

низации уменьшился на порядок. При скорректированных тактовых моментах де-
модулятор уже не выдает аномальных ошибок, поэтому последние обусловлены 
только шумом канала. 

 
Обсуждение результатов 
Вопросы синхронизации в высокоскоростных модемах имеют определен-

ную историю, которая в основном связана с улучшением остроты формы пика 
АКФ (временная функция, time metric) в сложных каналах. Вероятно, например, 
для OFDM-модемов начальной точкой отсчета можно считать появление синхро-
низатора Schmidl-Cox Synchronizer (S&C) [8]. Конечно, и ранее использовались 
подобные системы, но наиболее систематичное и целенаправленное изучение 
началось с этого момента. Форма пика АКФ при использовании этого устройства 
была наиболее плоская. Сами авторы ввели для нее термин, кочующий из работы 
в работу – plateau (плато, плоскогорье), что весьма симптоматично для предпола-
гаемого «острия». Авторское решение проблемы погрешности синхронизации с 
помощью предложенного вычисления момента синхронизации на плоском 
участке АКФ оказалось недостаточным для окончательного решения задачи син-
хронизации, поэтому вскоре был создан синхронизатор Coulson Synchronizer (CS) 
[9]. Он использовал мощный алгоритм, оценивающий множество дополнитель-
ных параметров и требующий множество вычислений. Можно сказать, что прак-
тической популярности он не приобрел, но позволял обеспечить заметно лучшую 
синхронизацию, чем синхронизатор S&C. 

14 



Minn-Zeng-Bhargava Synchronizer (MZB) [10] стал следующим алгоритмом, 
имеющим достаточно острый пик АКФ и требующим относительно небольшого 
объема вычислений. Но АКФ алгоритма имела также и значительной величины 
боковые лепестки, что отрицательно влияло на вероятность пропуска радио-
граммы или «ложной тревоги».  

Алгоритм Shi-Serpedin Synchronizer (S&S) [2], использованный в качестве 
прототипа в данной работе, имел параметры, удовлетворяющие многие практиче-
ские приложения. Метод универсальный, легко расширяемый в сторону усложне-
ния или упрощения (количество ТК и форма временной метрики), что показали 
последующие работы. Возможно Park Synchronizer (PS) [11] обладал по совокуп-
ности еще более лучшими характеристиками, но он имел жесткую структуру, в 
том числе и формы ТК, не всегда соответствующую требованиям разработчиков. 

Исходя из новых публикаций по «обострению пика», можно было сделать 
вывод, что достигнут некоторый предел эффективности синхронизаторов. 

В данном случае задача разработки алгоритма синхронизатора решена для 
диспергирующих каналов, где улучшение пика временной метрики затруднено 
из-за нестабильности положения данного пика на временной оси. Поэтому для 
решения задачи синхронизации в рассматриваемых каналах требуются иные под-
ходы, и, несмотря на то что предложенное решение имеет значительную вычис-
лительную сложность, для диспергирующих каналов оно обладает определенной 
эффективностью. 

 
Заключение 
Таким образом, предложенный алгоритм позволяет значительно снизить раз-

брос тактовых моментов синхронизации в условиях сильно диспергирующего ка-
нала. По результатам эксперимента в двухлучевом канале на ближней трассе раз-
брос тактовых моментов синхронизации снижен на порядок. Тем самым подтвер-
ждена эффективность предложенного алгоритма. Сравнение гистограмм рис. 2 и 3 
ясно доказывает необходимость такой доработки известных методов для решения 
задач синхронизации сигналов, распространяющихся в сложных каналах. 

 
Л И Т Е Р А Т У Р А  

1. Mengali U. and D’Andrea A.N. Synchronization Techniques for Digital Receivers. 
Plenum Press, N. Y., 1997, p. 520. 

2. Shi K., and Serpedin E. Coarse frame and carrier synchronization of OFDM systems: 
A new metric and comparison // IEEE Trans. Wireless Commun. Vol. 3, no. 4, July 2004, 
pp. 1271–1284. 

3. Minn H., Bhargava V. K., and Letaief K. B. A Robust Timing and Frequency 
Synchronization for OFDM Systems // IEEE Trans. on Wireless Comm. Vol. 2, no. 4, July 2003, 
pp. 822–839. 

4. Салтыков О. В. Измерение импульсной характеристики КВ канала для 
демодуляции сигналов // Техника радиосвязи. 2001. Выпуск 6. С. 3–15. 

5. Николаев Б. И., Салтыков О. В. Сравнение способов оценивания импульсной 
характеристики КВ радиоканала // Информатика, радиотехника, связь : сборник трудов 
учёных Поволжья. Самара, 2001. Выпуск 6. С. 10–13. 

6. Чингаева А. М. Оценивание дисперсии канального шума при наличии сигнала // 
Инфокоммуникационные технологии. 2007. Т. 5, № 4. С. 26–28. 

7. Yang Wen, Wei Huang and Zhongpei Zhang. CAZAC sequence and its application in 
LTE random access // Proc. 2006 IEEE Inform. Theory Workshop (ITW’06), pp. 544–547. 

15 



8. Schmidl T. M. and Cox D. C. Robust Frequency and Timing Synchronization for 
OFDM // IEEE Trans. Comm. Vol. 45, no. 12, Dec. 1997, pp. 1613–1621. 

9. Coulson А. J. Maximum Likelihood Synchronization for OFDM Using a Pilot Symbol: 
Analysis // IEEE Journal on Selected Areas in Communications. Vol. 19, no. 12, Dec 2001, 
pp. 2495–2503. 

10. Minn H., Zeng M. and Bhargava V. K. On Timing Offset Estimation for OFDM 
Systems // IEEE Comm. Lett. Vol. 4, no. 7, July 2000, pp. 242–244. 

11. Park B., Cheon H., Kang C. and Hong D. A Novel Timing Estimation Method for 
OFDM Systems // IEEE Communications Letters. Vol. 7, no. 5, 2003, pp. 239–241. 

 
 

Сведения об авторе 

Салтыков Олег Валерьянович, сотрудник АО «ОНИИП», e-mail: trs@oniip.ru. 
 
 
 
  Поступила в редакцию: май 2021 г. 

Рецензирование: июнь 2021 г. 
Принята в печать: август 2021 г. 

16