Классификация и сравнительное исследование систем аутентификации… Егорова А.А., Федосеев В.А. 

Классификация и сравнительное исследование 
 систем аутентификации JPEG-изображений,  

основанных на встраивании полухрупких водяных знаков 
А.А. Егорова 2, В.А. Федосеев 1, 2 

1 ИСОИ РАН – филиал ФНИЦ «Кристаллография и фотоника» РАН,  
443001, Россия, Самарская область, г. Самара, ул. Молодогвардейская, д. 151, 

2 Самарский национальный исследовательский университет имени академика С.П. Королёва,  
443086, Россия, Самарская область, г. Самара, Московское шоссе, д. 34 

Аннотация 
В статье рассматриваются системы полухрупких цифровых водяных знаков, предназна-

ченные для защиты от несанкционированных изменений изображений, представленных в 
формате JPEG. Эти системы позволяют обнаруживать и определять местоположение изме-
нений, а некоторые также приближённо восстанавливать исходное содержимое. Приводятся 
формальные схемы, описывающие процедуры встраивания цифровых водяных знаков и 
аутентификации. Рассматривается более десятка систем данного типа, предложенных с 
2000 года, и предлагается их классификация по различным критериям. Представлены ре-
зультаты экспериментальных исследований различных систем по оценке уровня искажений, 
возникающих при встраивании информации, а также погрешности при извлечении. Кроме 
того, исследована работоспособность систем в смысле обеспечения частичной стойкости к 
JPEG-сжатию. 

Ключевые слова: цифровой водяной знак, ЦВЗ, аутентификация изображений, полух-
рупкий водяной знак, JPEG, QIM, НЗБ. 

Цитирование: Егорова, А.А. Классификация и сравнительное исследование систем 
аутентификации JPEG-изображений, основанных на встраивании полухрупких водяных 
знаков / А.А. Егорова, В.А. Федосеев // Компьютерная оптика. – 2019. – Т. 43, № 3. – С. 419-
433. – DOI: 10.18287/2412-6179-2019-43-3-419-433. 

Введение искажениям, характерным для конкретного сценария 
Стремительное развитие телекоммуникационных использования изображений. Класс защищённых 

систем предоставляет колоссальные возможности по ЦВЗ шире робастных. Такие водяные знаки прояв-
хранению и распространению изображений. В то же ляют стойкость ещё и по отношению к преднаме-
время сегодня существует большое число доступных ренным атакам со стороны злоумышленника. При 
средств обработки изображений, позволяющих с лёг- этом предполагается, что злоумышленнику известен 
костью вносить в них изменения. Такие манипуляции используемый способ встраивания ЦВЗ. Полухруп-
могут быть преднамеренно вредоносными или могут кие ЦВЗ используют в ситуации, когда некоторые 
непреднамеренно влиять на интерпретацию содер- изменения изображения считаются допустимыми 
жимого изображений, что может, в свою очередь, (как правило, это изменения, не оказывающие суще-
привести к нарушению авторских прав и нанести тем ственного влияния на содержимое и не нарушающие 
самым значительные убытки правообладателю. В его структуру). Они применяются в различных зада-
связи с этим проблема аутентификации изображений чах криминалистики, медицины, в военной сфере и 
весьма актуальна в современном мире. Одним из спо- могут служить для аутентификации данных, полу-
собов её решения является встраивание цифрового чения маски изменений и восстановления искажён-
водяного знака (ЦВЗ) в защищаемое изображение ной информации. Полухрупкие ЦВЗ, как правило, 
(контейнер). ЦВЗ представляет собой малозаметную незаметны глазу и разрушаются под воздействием 
компоненту, наличие которой может свидетельство- изменений, не относящихся к «разрешённым», в 
вать о подлинности изображения [1]. Совокупность список которых зачастую относят искажения, воз-
методов и средств, образующих единое решение для никающие вследствие сжатия с потерями (до опре-
встраивания ЦВЗ, мы будем называть системой делённого уровня качества). 
встраивания ЦВЗ или кратко ЦВЗ-системой. Ключе- Одним из наиболее распространённых стандартов 
вой характеристикой ЦВЗ-систем является стойкость, сжатия изображений с потерями является JPEG, по-
под которой понимается возможность извлечения этому для него разработано более двух десятков си-
ЦВЗ из искажённого изображения [2, 3]. стем встраивания хрупких и полухрупких ЦВЗ. 

Различают хрупкие, стойкие (робастные), защищён- Наибольшее практическое применение среди них 
ные (безопасные) и полухрупкие ЦВЗ-системы [1, 4]. нашли системы, производящие внедрение водяного 
Хрупкие ЦВЗ разрушаются при любых модификаци- знака в коэффициенты блочного дискретного коси-
ях изображений и в большинстве случаев использу- нусного преобразования (ДКП) изображения [4 – 18]. 
ются для проверки целостности информации. Робаст- Это обусловлено тем, что такие методы тесно связа-
ные ЦВЗ обладают стойкостью к непреднамеренным ны с процедурой сжатия и потому способны обеспе-

Компьютерная оптика, 2019, том 43, №3 419 



Классификация и сравнительное исследование систем аутентификации… Егорова А.А., Федосеев В.А. 

чить визуальную неразличимость ЦВЗ и одновремен- ваться на основе секретного ключа, так и формиро-
но с этим стойкость к JPEG. Особую ценность пред- ваться на основе некоторых характеристик контейне-
ставляют системы, обеспечивающие стойкость при ра с возможным использованием ключа. В качестве 
заданном пользователем диапазоне значений показа- примеров второго подхода можно привести исполь-
теля качества JPEG-сжатия (Quality Factor, QF – це- зование хэш-функции от средней яркости изображе-

ния в окрестности встраивания или битов знака раз-
лое число от 1 до 100) [6 – 11]. ностей между значениями пар пикселей, координаты 

Несмотря на значительное число существующих которых определяются ключом. Затем полученный 
полухрупких к JPEG систем встраивания ЦВЗ, в лите- ЦВЗ встраивается в защищаемое изображение I (при 
ратуре практически отсутствуют работы, посвящённые этом также может быть использована часть секретно-
их сравнению. Одним из немногих исключений явля- го ключа), результатом чего является модифициро-
ется обзорная статья [19], однако она охватывает более ванное изображение I W, которое далее передаётся по 
широкий класс систем, что делает проведённый анализ открытому каналу и может быть изменено. Отметим, 
менее детальным. Кроме того, в этой работе не прове- что встраивание на практике реализуется таким обра-

зом, чтобы сохранить неизменными характеристики, 
дён расчёт показателей исследуемых систем по единой используемые при формировании ЦВЗ. То есть при 
методике и на едином наборе данных. По этой причине генерации ЦВЗ по изображению I W мы должны полу-
в настоящей работе представлен обзор наиболее зна- чить тот же ЦВЗ W. 
чимых ЦВЗ-систем, полухрупких к JPEG, приведена Отметим, что пунктирными прямоугольниками на 
классификация существующих решений по различным рис. 1, 2 обозначены этапы, а пунктирными 
критериям и проведён сравнительный анализ их ос- стрелками – процессы передачи данных, которые мо-
новных показателей.  гут отсутствовать в отдельных системах. В частности, 

Статья организована следующим образом. В пер- в некоторых системах отсутствует этап извлечения 
вом параграфе представлены схемы аутентификации характеристик контейнера. В этом случае ЦВЗ полно-
изображений на основе ЦВЗ-систем. Во втором пара- стью определяется секретным ключом. 
графе описываются основные этапы JPEG-сжатия, а 
также основные структурные компоненты ЦВЗ-
систем, предназначенных для JPEG-изображений. В 
третьем параграфе приводится обзор основных суще-
ствующих на данный момент полухрупких систем, a 
также их классификация по различным параметрам. 
Четвёртый параграф посвящён экспериментальным 
исследованиям рассмотренных ЦВЗ-систем, прове-
дённым для проверки их работоспособности и срав-
нения в единых условиях.  

Рис. 1. Аутентификация изображений при помощи 
1. Аутентификация изображений  ЦВЗ-системы: встраивание информации 
с использованием ЦВЗ-систем 

Пришедшее на аутентификацию изображение мы 
Схемы, представленные на рис. 1, 2, иллюстриру-

будем обозначать IW
ют процедуру аутентификации изображений с ис-  (рис. 2). При отсутствии изме-
пользованием ЦВЗ-систем. На этапе встраивания ин- нений оно эквивалентно I W. На принимающей сто-
формации (рис. 1) сначала происходит формирование роне сначала производится формирование ЦВЗ на ос-
ЦВЗ, представляющего собой двоичную последова- нове ключа и изображения IW . 
тельность (W ). Он может как полностью генериро-

 
Рис. 2. Аутентификация изображений при помощи ЦВЗ-системы: извлечение информации 

420 Компьютерная оптика, 2019, том 43, №3 



Классификация и сравнительное исследование систем аутентификации… Егорова А.А., Федосеев В.А. 

Результирующий ЦВЗ (обозначим его W ) совпа- Матрицы квантования для различных значений 
дает с W, если ЦВЗ формируется только лишь на ос- QF рассчитываются по следующей формуле: 

нове ключа или, если изменения в IW  относительно Q50  round 50 / QF  , QF  50,
IW не затронули характеристики, используемые при QQF    (2) 

Q50  2 0,02QF  , 50  QF 100.
формировании ЦВЗ. Одновременно с этим произво-
дится извлечение ЦВЗ, встроенного в изображение Для QF = 100 матрица полностью состоит из еди-
IW  (обозначим его WR). Совпадение W  и W R означа- ниц. Опорная матрица Q50 имеет вид: 
ет, что изображение не было подвергнуто «неразре- 16 11 10 16 24 40 51 61 
шённым» искажениям. В противном случае изобра-  
жение IW  расценивается как искажённое. 12 12 14 19 26 58 60 55 

14 13 16 24 40 57 69 56 
При обнаружении факта искажений далее может  

выполняться построение маски изменений E – бинар- 14 17 22 29 51 87 80 62
Q50   

  . (3) 
ного изображения, значения «1» в котором указывают 18 22 37 56 68 109 103 77
на то, что соответствующий пиксель изображения  

24 35 55 64 81 104 113 92 
IW , вероятно, был изменён, в то время как нулевые 49 64 78 87 103 121 120 101
значения говорят об обратном. Заключительным оп-  
циональным этапом, присутствующим лишь в неко- 72 92 95 98 112 100 103 99 
торых системах, является этап восстановления иска- Таким образом, согласно (2), уменьшение QF при-
жённых фрагментов изображения IW  на основе из- водит к росту значений в матрице QQF, что, в свою 
влечённого ЦВЗ WR. очередь, приводит к возрастанию числа нулей среди 

2. Построение ЦВЗ-систем, адаптированных Di(m1, m2), а следовательно, и к уменьшению размера 
к стандарту сжатия JPEG архива. 

2.1. Процедура JPEG-сжатия 
Сжатие с потерями в формате JPEG включает сле-

дующие ключевые шаги [20]: 
1. Исходное изображение I размера N1×N2 делится 

на непересекающиеся блоки Ii размера 8×8, где 
i = 1, ... ,N – номер блока, а N = N  

1N2 / 64 – общее коли-
чество непересекающихся блоков. 

2. Для каждого блока Ii, состоящего из 64 отсчётов 
Ii (n1, n2), 0  n1, n2  7, вычисляется прямое ДКП. Полу-
ченные значения мы будем обозначать Bi (m1, m2), 0  m1, 
m2  7. Коэффициенты, расположенные вблизи левого 
верхнего угла, характеризуют низкочастотную состав-
ляющую. Угловой элемент B  

i (0, 0), значение которого 
равно средней яркости пикселей блока Ii, мы будем  
называть DC-отсчётом, все прочие – AC-отсчётами. Рис. 3. Зигзагообразная развёртка спектра ДКП 

3. Производится квантование коэффициентов 4. Обход значений Di(m1, m2) в зигзагообразном 
каждого блока B  

i (m1, m2) с использованием матрицы порядке, как показано на рис. 3, и последующее ста-
квантования QQF размера 8×8, соответствующей за- тистическое кодирование этих значений. Далее в ста-
данному пользователем значению параметра качества тье мы будем для удобства обозначать ДКП-
сжатия QF (от 1 до 100), по формуле: коэффициенты D  

i ( j), где j = 1...64 – номер коэффици-
 B(m ,m )  ента при зигзагообразном обходе. 

Di (m , m )  round 1 2
1 2   . (1) Схема рассмотренной процедуры сжатия JPEG 

QQF (m1,m2 )  показана на рис. 4.

 
Рис. 4. Схема алгоритма сжатия JPEG

Компьютерная оптика, 2019, том 43, №3 421 



Классификация и сравнительное исследование систем аутентификации… Егорова А.А., Федосеев В.А. 

2.2. Основные особенности ЦВЗ-систем, производится на уровне блоков коэффициентов блоч-
полухрупких к JPEG-сжатию ного ДКП. При этом в общем случае исходное изоб-

Большинство существующих ЦВЗ-систем, полух- ражение и изображение с ЦВЗ представляются в не-
рупких к JPEG, базируется на двух свойствах: сжатом виде, как показано на рис. 5. Поэтому встраи-

– отношение между коэффициентами, находящи- ванию предшествует этап расчёта ДКП, а вслед за 
мися в одинаковых позициях в двух разных блоках, встраиванием выполняется обратное ДКП. Таким об-
до и после сжатия не изменяется; разом, результатом применения данной схемы явля-

– квантованное с некоторым (первоначальным) ется изображение I W, подготовленное для последую-
шагом значение можно восстановить после последу- щего JPEG-сжатия в том смысле, что встроенный 
ющего квантования с меньшим шагом, если к иска- ЦВЗ обладает частичной стойкостью к JPEG в задан-
жённому числу повторно применить процедуру кван- ном диапазоне значений QF. 
тования с первоначальным шагом: Этап формирования ЦВЗ на рис. 5 опущен, по-

скольку в нём нет никакой дополнительной конкрети-
quan (x,1)  quan (quan (quan (x,1),2 ),1) , (4) зации по сравнению с рис. 1. Наличие двух альтерна-

где  тивных вариантов на рис. 5 показывает, что встраи-
1  2 и quan(x, ) = round(x / ). вание может происходить как в уже квантованные 
Первое свойство обычно используется при гене- ДКП-коэффициенты, так и непосредственно во время 

рации зависящего от характеристик контейнера ЦВЗ самой процедуры квантования (например, когда мо-
[6, 13, 17] и в системах, способных восстанавливать дификация информации производится при помощи 
искажённую информацию [5, 10]. Второе лежит в ос- алгоритмов семейства QIM, речь о которых пойдёт в 
нове систем, которые позволяют задавать минималь- параграфе 3). 
но допустимый уровень сжатия QF [5, 6, 7, 9, 17]. Состав операций, выполняемых при извлечении 

Во всех системах рассматриваемого класса работа информации, очевиден из рис. 2 и 5, поэтому позво-
с изображениями и непосредственно встраивание лим себе опустить схему данного этапа. 

 
Рис. 5. Схема встраивания ЦВЗ в системах, полухрупких к JPEG-сжатию 

ble) [13] и на методе расширения спектра (Spread Spec-
3. Классификация систем встраивания ЦВЗ, trum Watermarking) [22]. 

полухрупких к JPEG-сжатию  НЗБ-встраивание в полухрупких к JPEG методах 
3.1. По используемому методу встраивания производится после выполнения процедуры квантова-

Одной из ключевых характеристик полухрупких к ния путём замены одного или нескольких квантован-
JPEG ЦВЗ-систем является метод встраивания ЦВЗ, то ных ДКП коэффициентов изображения битами водя-
есть способ модификации спектральных компонент. ного знака. Алгоритм прост в реализации, не требует 

В существующих на сегодняшний день решениях больших вычислительных ресурсов и позволяет 
наибольшее распространение получили метод измене- скрыть в изображении достаточно большой объём ин-
ния наименее значимых бит (НЗБ-встраивание) [4] и формации, что обусловливает его активное использо-
методы на основе управляемого переквантования вание [6, 7]. Однако в то же время НЗБ-встраивание в 
(QIM, Quantization Index Modulation) [21]. Однако по- спектральной области может сопровождаться значи-
мимо них используются и другие подходы, в частно- тельными искажениями контейнера, а факт использо-
сти, базирующиеся на изменении позиции последнего вания этого метода может быть обнаружен. 
ненулевого элемента (LNZ, Last Non Zero) [12], на ис- В отличие от НЗБ-встраивания, QIM (подробно 
пользовании табличных преобразований (Mapping Ta- рассмотренный в [3, 23, 24]) осуществляет одновре-

422 Компьютерная оптика, 2019, том 43, №3 



Классификация и сравнительное исследование систем аутентификации… Егорова А.А., Федосеев В.А. 

менно квантование данных и встраивание водяного со значением «1». Тогда если в таблице ему соответ-
знака, производя модуляцию значений коэффициентов ствует «1», то его значение не изменяется, в противном 
ДКП в соответствии со значениями битов встраивае- случае его значение заменяется на значение ближай-
мого водяного знака. QIM более устойчив к атакам по шего по соседству коэффициента, которому в таблице 
сравнению с НЗБ-встраиванием и потенциально может соответствует «1». 
приводить к меньшим погрешностям. Особенностью Наконец, метод встраивания информации с расши-
QIM является тот факт, что под этим названием подра- рением спектра состоит в распределении небольшого 
зумевается не один метод, а целое семейство методов, числа бит ЦВЗ среди большого числа компонент изоб-
отличающихся используемыми функциями квантова- ражения-контейнера с использованием функции, зави-
ния. В известных системах полухрупких ЦВЗ также сящей от секретного ключа [22]. В системах, исполь-
используются различные версии QIM [9 – 11]. зующих такой подход [14, 15], встраивание произво-

Альтернативным способом внедрения информа- дится путём внесения небольшой аддитивной или 
ции в JPEG-изображения является смена чётности по- мультипликативной шумоподобной последовательно-
зиции последнего ненулевого элемента (LNZ) блока сти в большое число коэффициентов. Для аутентифи-
квантованных ДКП коэффициентов. Такая операция кации учитывается поблочная корреляция модифици-
позволяет встроить один бит водяного знака в каж- рованных коэффициентов с заданной шумоподобной 
дый блок. В полухрупкой системе Fallahpour & последовательностью. Высокое значение корреляции 
Megias, 2016 [12], стойкой к JPEG-сжатию и аддитив- свидетельствует об аутентичности рассматриваемого 
ному шуму, смена чётности LNZ-компоненты произ- блока. Системы этой группы показывают хорошие ре-
водится в тех блоках, где её позиция превышает за- зультаты на однородных областях изображений, кроме 
данное пороговое значение, остальные блоки пропус- того, их важным преимуществом является повышенная 
каются. Такой подход прост в реализации, не требует стойкость ЦВЗ к искажениям за счёт распределения 
больших затрат по времени, что позволяет применять встраиваемой информации среди множества коэффи-
его в системах реального времени. циентов ДКП. Однако эффективность таких систем 

Другой альтернативный способ встраивания водя- снижается на текстурированных фрагментах. Кроме 
ных знаков основан на использовании табличного того, они не позволяют регулировать минимально до-
отображения. В полухрупкой системе Mursi et al., 2009 пустимый уровень сжатия QF, при котором сохраняет-
[13] такая таблица представляет собой соответствие ся их стойкость к JPEG.  
номеров коэффициентов, расположенных в случайном В табл. 1 представлены основные существующие 
порядке, последовательности из нулей и единиц. ЦВЗ-системы, для каждой из которых во втором 
Встраивание происходит следующим образом: допу- столбце приводится метод изменения ДКП-
стим, в некоторый коэффициент нужно встроить бит коэффициентов. 

Табл. 1. Основные свойства полухрупких ЦВЗ-систем: метод встраивания ЦВЗ, частотная область 
 и число изменяемых коэффициентов 

Метод 
ЦВЗ-система  изменения Область частот, в которую производится Число изменяемых 

коэффициентов встраивание ЦВЗ коэффициентов блока 

Lin & Chang, 2000 [6] НЗБ НЧ: j = 7, ..., 9 для обнаружения изменений Разное. Основной вариант:  
 и j = 10, ..., 15 для восстановления 3 для обнаружения изменений 

и 6 для восстановления 
Lin & Chang, версия 

Cox et al. [1] НЗБ ВЧ: j = 37, ..., 64 4 

Ho & Li, 2004 [7] НЗБ Разная (наибольшие ненулевые 
 коэффициенты блока) 4 

Huang, 2013 [8] НЗБ НЧ: j = {5;8;9;13} 4 
Ye et al., 2003 [9] QIM НЧ, j = {5;8;9;13}СЧ: j = 2, ..., 20 4 
Preda & Vizireanu, 

2015 [10] QIM НЧ: j = 2, ..., 2Nw Разное 
Wang et al., 
 2011 [11] QIM НЧ (для обнаружения изменений), 6 для обнаружения изменений 

НЧ, СЧ, ВЧ (для восстановления) 4 для восстановления 
Fallahpour & Megias, Смена чётности Разная  

2016 [12] позиции LNZ (зависит от установленного  4 
значения порога) 

Mursi et al., 2009 [13] Табличное 
отображение НЧ: j = 2, ..., 6 5 

Lin et al., 2000 [14] Расширение 
спектра НЧ, СЧ: j = 2, ..., 36 35, при этом встраивается 

 1 бит на блок 
Al-Mualla, 2007 [15] Расширение 

спектра НЧ, СЧ: j = 2, ..., 36 35, при этом встраивается 
 1 бит на блок 

 

3.2. По местоположению енты (за исключением DC-отсчёта) или среднеча-
 и количеству изменяемых коэффициентов стотные (СЧ) [6, 8 – 11]. Потенциальный недостаток 

Большинство полухрупких к JPEG систем встраи- такого подхода заключается в том, что низкие часто-
вают водяной знак в низкочастотные (НЧ) коэффици- ты значительно информативнее высокочастотных, 

Компьютерная оптика, 2019, том 43, №3 423 



Классификация и сравнительное исследование систем аутентификации… Егорова А.А., Федосеев В.А. 

поэтому их изменение может привести к заметному ношение между квантованными коэффициентами, 
ухудшению качества защищаемого изображения. С находящимися в одинаковых позициях в двух разных 
другой стороны, для НЧ-коэффициентов ниже по- блоках, до и после сжатия не изменяется. Это обу-
грешность квантования, как видно из матрицы (2). словлено тем, что во время квантования по формуле 
Известны работы [1, 7, 11], в которых внедрение во- (1) каждый блок ДКП коэффициентов поэлементно 
дяного знака производится в несколько высокоча- делится на одну и ту же матрицу квантования QQF, 
стотных коэффициентов (ВЧ) и при этом, согласно которая соответствует заданному значению парамет-
утверждениям авторов, обеспечивается высокое каче- ра качества QF. В результате этого коэффициенты 
ство извлечения ЦВЗ. Также встраивание в высокоча- разных блоков, находящиеся в одинаковых позициях, 
стотные коэффициенты нередко происходит и в си- делятся на один и тот же элемент матрицы QQF, таким 
стеме [12] на основе LNZ-изменения, так как послед- образом, отношение между ними сохраняется, а его 
ний ненулевой коэффициент блока может распола- изменение свидетельствует о том, что изображение 
гаться в области высоких частот. подвергалось модификациям. 

В зависимости от назначения ЦВЗ-системы или её В Ho & Li, 2004 [7] встраиваемая информация за-
особенностей использования объём встраиваемого висит от значений характеристик, вычисленных по 
ЦВЗ может меняться. В подавляющем большинстве значениям коэффициентов, взятых из соседних бло-
систем в каждый блок размера 8×8 встраивается оди- ков, следующим образом: на основе случайной по-
наковое число бит ЦВЗ. Однако в некоторых систе- следовательности, генерируемой с использованием 
мах, в частности, в [12], в зависимости от распреде- секретного ключа, определяется группа коэффициен-
ления значений коэффициентов ДКП, часть блоков тов в рассматриваемом блоке и в восьми соседних с 
может быть пропущена при встраивании.  ним. Затем для каждой из четырёх групп вычисляют-

Также следует отметить, что в большинстве си- ся две характеристики: одна зависит от знака коэф-
стем число изменяемых коэффициентов блока соот- фициентов группы, вторая – от их величины. 
ветствует числу бит, которое приходится на этот блок В Mursi et al., 2009 [13] в состав ЦВЗ входит сек-
(будем обозначать его NW). Исключение составляют ретная последовательность и разница между коэффи-
системы, основанные на методе расширения спектра циентами соседних блоков, что делает ЦВЗ устойчи-
[14, 15], которые изменяют большое число компонент вым ещё и к искажению типа «копирование-вставка» 
спектра ДКП для того, чтобы встроить 1 бит инфор- [25, 26]. 
мации. Другой характеристикой контейнера, которая мо-

Если система используется только для обнаруже- жет использоваться при генерации ЦВЗ, является 
ния факта изменений или для построения маски из- значение самого информативного коэффициента бло-
менений, число бит, приходящихся на один блок, ко- ка – DC. Такой подход применён в системе Huang, 
леблется в диапазоне от 1 до 6. Если в системе реали- 2013 [8], где биты ЦВЗ представляют собой зашиф-
зуется процедура частичного восстановления изоб- рованную комбинацию бит DC-компонент блоков 
ражения после обнаружения несанкционированных контейнера. В Ye et al., 2003 [9] в процессе формиро-
изменений, то, как правило, дополнительно встраи- вания ЦВЗ всегда используется DC-коэффициент те-
ваются ещё не менее 4 бит информации [6, 11]. Таким кущего блока, а также три коэффициента, определяе-
образом, суммарное количество может превысить мые случайной последовательностью. Все они явля-
10 бит на блок. ются параметрами хэш-функции, которая подписыва-

В столбцах 3 и 4 табл. 1 представлены данные по ется секретным ключом правообладателя. 
основным системам в части местоположения и коли- В системе Preda & Vizireanu, 2015 [10] ЦВЗ пред-
чества изменяемых коэффициентов ДКП. ставляет собой значение хэш-функции, параметрами 

3.3. По способу формирования ЦВЗ которой являются координаты блока и секретная по-
следовательность. Это также делает ЦВЗ устойчивым 

Ещё одним важным свойством, по которому могут к искажению типа «копирование-вставка». 
быть классифицированы рассматриваемые ЦВЗ- В Wang et al., 2011 [11] для генерации битов ЦВЗ, 
системы, является способ формирования водяного отвечающих за восстановление изображения, встраи-
знака (рис. 1). В простейшем случае ЦВЗ представля- ваются дополнительные 4 бита информации, значе-
ет собой псевдослучайную последовательность и ге- ния которых определены как нормализованные сред-
нерируется на основе секретного ключа [10, 12, 14, ние значения подблоков контейнера размером 4×4. 
15]. Однако в ряде систем для повышения стойкости Сводные сведения по способам формирования 
ЦВЗ может формироваться на основе каких-либо ха- ЦВЗ для различных систем представлены в табл. 2. 
рактеристик (инвариант) защищаемого изображения. 
Кроме того, нередки случаи, когда ЦВЗ представляет 3.4. По назначению 
собой конкатенацию псевдослучайной последова- Наконец, ещё одной важнейшей характеристикой 
тельности и вычисляемых характеристик защищаемо- ЦВЗ-систем, используемых для аутентификации 
го изображения. Рассмотрим некоторые примеры. изображений, является их назначение, то есть кон-

В системах [6, 13] при генерации ЦВЗ принимает- кретная решаемая задача аутентификации. Возможны 
ся во внимание одно из отмеченных в подпарагра- следующие варианты (см. рис. 2) в порядке от про-
фе 2.1 свойств JPEG-сжатия, согласно которому от- стого к сложному: 

424 Компьютерная оптика, 2019, том 43, №3 



Классификация и сравнительное исследование систем аутентификации… Егорова А.А., Федосеев В.А. 

1) выявление факта искажений без детализации их жение искажений происходит с точностью до блока 
местоположения; размером 8×8. Использование встраиваемой последо-

2) обнаружение и локализация искажений (то есть вательности большой длины снижает вероятность 
построение маски изменений); пропуска искажённых блоков, в то время как исполь-

3) построение маски изменений и приближённое зование специальных способов формирования ЦВЗ на 
восстановление искажённых областей. основе характеристик контейнера, рассмотренных в 

Большинство ЦВЗ-систем рассматриваемого клас- подпараграфе 3.3, повышает точность построения 
са решают вторую задачу, что отмечено в табл. 2, при маски изменений за счёт обеспечения стойкости к от-
этом в подавляющем большинстве случаев обнару- дельным типам искажений. 

Табл. 2. Основные свойства полухрупких ЦВЗ-систем: принцип формирования ЦВЗ и назначение системы 

ЦВЗ-система Используются ли характеристики изображения 
 при формировании ЦВЗ Назначение 

Lin & Chang, 2000 [6] Да, кодируются знаки разниц между первыми шестью AC коэф- Обнаружение изменений,  
фициентами текущего блока с некоторым другим восстановление 

Lin & Chang, версия 
Cox et al. [1] Нет Обнаружение изменений 

Ho & Li, 2000 [7] Да (зависимость от 9 соседних блоков) Обнаружение изменений 
Huang, 2013 [8] Да, в генерации ЦВЗ участвуют 5 бит DC коэффициента блока Обнаружение изменений 

Ye et al., 2003 [9] Да, в генерации ЦВЗ участвует DC и три AC коэффициента 
 из первых двадцати Обнаружение изменений 

Preda & Vizireanu, ЦВЗ зависит от координат блока контейнера и случайной 
2015 [10]  последовательности,  Обнаружение изменений 

генерируемой при помощи секретного ключа 
ЦВЗ для обнаружения изменений – псевдослучайная последова-

Wang et al., 2011 [11] тельность. ЦВЗ для восстановления – нормализованные средние Обнаружение изменений,  
значения подблоков восстановление 

Fallahpour & Megias, 
2016 [12] Нет Обнаружение изменений 

Mursi et al., 2009 [13] Да, зависит от разницы между коэффициентами двух соседних 
 блоков, но включает также псевдослучайную последовательность Обнаружение изменений 

Lin et al., 2000 [14] Нет Обнаружение изменений 
Al-Mualla, 2007 [15] Нет Обнаружение изменений 

 

Решение третьей задачи предусмотрено в систе- показателя QF, к которому можно обеспечить стой-
мах Lin & Chang, 2000 [6] и Wang et al., 2011 [11]. В кость, а также качество защищённого изображения, 
первой из них биты ЦВЗ, используемые для восста- как правило, измеряемое при помощи показателя 
новления, содержат JPEG-архив исходного изобра- PSNR (Peak Signal-To-Noise Measure) [1, 6]. В табл. 3 
жения, уменьшенного вдвое по каждому из измере- отражены данные по этим показателям, взятые из 
ний, полученный с использованием низкого значения оригинальных работ. Как видно из таблицы, они не-
QF (в качестве примера приводится значение 25). Та- достаточно полны, чтобы сделать вывод о преимуще-
ким образом, 4 блока 8×8 защищённого изображения стве тех или иных систем. 
в совокупности задают приближённую копию одного В отношении минимального значения QF, это 
блока 16×16 исходного изображения, при этом, со- объясняется тем, что ввиду упомянутого в подпара-
гласно данным табл. 1, для этого используется графе 2.2 свойства квантования, использующие его 
24 бита. Распределение фрагментов архива среди системы теоретически вовсе не должны иметь огра-
блоков определяется ключом. ничений на значения QF. Однако погрешности при 

В системе Wang et al., 2011 [11] в каждый блок квантовании защищённого изображения в простран-
8×8 встраиваются по 4 бита, используемых для при- ственной области и рамки допустимого качества 
ближённого восстановления четырёх коэффициентов изображений, определяемые практическими аспекта-
(DC и трёх первых AC-коэффициентов) другого бло- ми, приводят авторов к введению ограничений. В 
ка. Соответствие между блоками устанавливается при большинстве случаев эти ограничения вводятся умо-
помощи ключа. Восстановление ДКП-коэффициентов зрительно и не продиктованы результатами конкрет-
осуществляется при помощи линейной регрессии, ко- ных исследований. 
эффициенты которой определяются заранее на этапе Значение показателя PSNR между исходным и за-
настройки системы. щищённым изображениями главным образом зависит 

от следующих факторов: 
4. Экспериментальные исследования 1) числа встраиваемых бит ЦВЗ; 

4.1. Основные показатели рассмотренных систем 2) местоположения изменяемых коэффициентов; 
К числу основных объективных характеристик 3) используемого метода встраивания; 

полухрупких ЦВЗ-систем для JPEG-изображений, ко- 4) значения QF; 
торые приводят большинство авторов оригинальных 5) используемого набора данных.  
статей, относятся минимально допустимое значение 

Компьютерная оптика, 2019, том 43, №3 425 



Наименование статьи ФИО авторов 
 

Табл. 3. Сравнительные показатели полухрупких к JPEG ЦВЗ-систем (по материалам оригинальных статей) 
Минимальные значения QF, 

ЦВЗ-система к которым можно обеспечить PSNR, дБ 
стойкость системы 

Lin & Chang, 2000 [6] Не указано (исследованы QF ≥ 50) 43,02 (для QF = 50) для обнаружения изменений 
32,75 (для QF = 50) для восстановления 

Lin & Chang, версия Cox et al. [1] Не указано Нет данных 
Ho & Li, 2000 [7] 50 32,7 (для QF = 50) 
Huang, 2013 [8] 50 41,2 (для QF = 50) 

Ye et al., 2003 [9] Не указано (исследованы QF ≥ 75) Около 40 (для QF = 75)  
Preda & Vizireanu, 2015 [10] Не указано (исследованы QF ≥ 50) 44,63 (для QF = 50) 

Wang et al., 2011 [11] 65 (для восстановления) 37,61 (для QF = 75) 
Fallahpour & Megias, 2016 [12] Без ограничений 41 

Mursi et al., 2009 [13] 80 Нет данных 
Lin et al., 2000 [14] Нет связи с QF 36,67 

Al-Mualla, 2007 [15] Нет связи с QF 35,53 
 

Факторы 1 – 3 являются неотъемлемыми свой- значена Lin & Chang, версия Cox et al., 2000). Уже из 
ствами системы, в то время как 4 и 5 характеризуют табл. 1, 2 видно, что она имеет значительные отличия 
условия проведения вычислительного эксперимента. от оригинала. В дополнение к этому изменены и про-
Практический интерес представляет исследование цедуры встраивания и извлечения информации. 28 
влияния факторов 1 – 3 на значение PSNR, но един- высокочастотных коэффициентов (j = 37, ..., 64) при 
ственный способ отделить их от 4 – 5 – это независи- встраивании разделяются на NW = 4 группы по 8 ко-
мые эксперименты в унифицированных условиях. эффициентов в соответствии с секретным ключом. 

В последующих подпараграфах приводятся ре- Сумма по модулю 2 наименее значимых бит восьми 
зультаты проведённых нами сравнительных экспери- коэффициентов в каждой группе должна равняться 
ментальных исследований некоторых систем встраи- встраиваемому биту информации. Если это условие 
вания ЦВЗ из числа рассмотренных в параграфе 3. соблюдается, то изменений не происходит. В против-
При проведении исследований решались следующие ном случае инвертируется младший бит одного из ко-
задачи:  эффициентов в группе. 
 оценка уровня искажений, возникающих при В системе Huang, 2013 [8] при встраивании ин-

встраивании защитного ЦВЗ; формации вместо (5) используется формула: 
 проверка работоспособности в смысле обеспече- DW

ния частичной стойкости ЦВЗ к JPEG-сжатию. i  jk   2 Di  jk  2  Wi,k , (6) 

4.2. Системы, отобранные для исследования где 0,5 <  < 1 – параметр, характеризующий интен-
При отборе систем, участвовавших в эксперимен- сивность ЦВЗ. По умолчанию в экспериментах мы 

тальных исследованиях, мы руководствовались глав- использовали значение  = 0,6, предложенное в ори-
ным образом необходимостью обеспечить полный гинальной работе.  
охват в части методов модификации коэффициентов В системе Preda & Vizireanu, 2015 [10] позиции jk 
ДКП, рассмотренных в подпараграфе 3.1. Среди си- выбираются согласно ключу из промежутка [2; 2NW]. 
стем одной группы приоритет отдавался системам, В системе используются следующие формулы встра-
получившим большее распространение, а также более ивания и извлечения информации: 
простым в реализации. Полный перечень отобранных  B j
систем можно увидеть в табл. 4. Рассмотрим кратко BW   i  k  

i jk  round  W
  i ,k 2QQF  jk  

их основные отличительные особенности, дополня-  2Q j 
QF k   (7) 

ющие их свойства, отражённые в параграфе 3 и  Wi ,kQQF  jk  ,
табл. 1, 2. 

В системе Lin & Chang, 2000 [6] используется из- W R W
i ,k  round Bi  jk  QQF  jk  (mod 2) . (8) 

менённая матрица квантования QQF = QQF + 1 (то есть Для сопоставления различных версий QIM в рам-
все значения увеличиваются на единицу). По- ках работы мы исследовали также простую модифи-
видимому, это сделано для повышения стойкости. кацию системы Preda & Vizireanu, 2015, которую обо-
Встраивание информации в квантованные коэффици- значили Sign-QIM. Она отличается главным образом 
енты производится по стандартной для НЗБ-методов тем, что знак компоненты водяного знака зависит от 
формуле: того, в какую сторону происходит округление моди-

DW
i  jk   2 Di  jk  2 Wi,k , (5) фицируемого ДКП-коэффициента функцией round. 

Благодаря этому ошибка в коэффициенте jk, вызван-
где jk, k = 0, ..., NW –1 – позиции изменяемых коэффи- ная встраиванием информации, гарантированно не 
циентов ДКП в зигзагообразной развёртке, а Wj,k – это превышает QQF(jk): 
k-й бит ЦВЗ, встраиваемый в i-й блок. 

Кроме системы Lin & Chang, 2000, мы анализиро- BW
i  jk   Bri  jk   Si  jk  Wi ,k QQF  jk  , (9) 

вали также её версию, приведённую в книге [1] (обо- где 

426 Компьютерная оптика, 2019, том 43, №3 



Классификация и сравнительное исследование систем аутентификации… Егорова А.А., Федосеев В.А. 

 B
  i  jk   позиции jk дополнялись наиболее логичным образом. 

Bri jk  round  2QQF jk ,
 2QQF  j      (10) В третьем режиме в качестве jk использовались 4 ко-

k  эффициента с наименьшими значениями QQF(jk) со-
гласно (2). Для систем Lin & Chang (версия Cox et al.) 

  1, Bi ( jk )  Br ( ) ,
 i jk

Si jk   (11) и Lin et al., 2000 такая установка противоречила 
1, иначе. принципу встраивания информации, поэтому они в 

Ещё одна система на основе метода QIM – Wang этой части исследования не участвовали. 
et al., 2011 [11] – отличается от рассмотренных тем, Результаты экспериментов отражены в табл. 4 – 6. 
что не изменяет значения коэффициентов ДКП, от- Для системы Fallahpour & Megias, 2016 во всех таб-
стоящих не более чем на QQF, 0 <  < 0,5, от кванто- лицах в скобках указана доля ЦВЗ, которую удалось 
ванного значения. Эта мера позволяет снизить иска- встроить (в этой системе предусмотрена возможность 
жения при встраивании информации. Точную форму- пропуска блоков). Помимо PSNR, также указаны зна-
лу встраивания мы не будем приводить по причине её чения BER при извлечении информации из неиска-
громоздкости. В экспериментах использовалось зна- жённого изображения. 
чение  = 0,25. С точки зрения искажений наилучший результат в 

Три другие системы: Fallahpour & Megias, 2016 первом режиме показала система Sign-QIM – моди-
[12], Mursi et al., 2009 [13] и Lin et al., 2000 [14] – уже фикация Preda & Vizireanu, 2015. Однако после вы-
были подробно рассмотрены в подпараграфе 3.1. равнивания NW лучшие результаты показала система 

Wang et al., 2011. Следует отметить, что и по ошибке 
4.3. Порядок проведения экспериментов извлечения также лидируют эти две системы.  

При проведении экспериментов в качестве меры Если сравнивать различные методы встраивания, 
точности извлечения использовался показатель BER можно сделать вывод о безусловном преимуществе 
(Bit Error Rate), равный отношению числа неверно систем на базе QIM. Далее с небольшим отставанием 
извлечённых бит к длине ЦВЗ. В качестве меры каче- следует система, использующая табличное отображе-
ства изображения со встроенным ЦВЗ использовался ние, и системы на базе НЗБ-встраивания. Встраива-
показатель PSNR. ние на основе изменения позиции LNZ-элемента при-

Эксперименты проводились на 10 изображениях водит к существенным искажениям даже при сни-
размерами 512×512 из набора данных USC-SIPI Image женном объёме встраиваемой информации.  
Database [27] (“Lenna”, “Peppers”, “Baboon”, “Bridge” Система Lin et al., 2000 на основе расширения 
и др.); результаты расчёта показателей BER, PSNR спектра сильнее всего искажает изображение. Поми-
усреднялись.  мо этого, она обладает высокой ошибкой извлечения 

При встраивании информации использовались два и не связана со значением QF, поэтому применение 
варианта значений минимального QF, к которому данной системы как полухрупкой по отношению к 
требовалось обеспечить стойкость ЦВЗ: 50 и 70. При JPEG-сжатию представляется нецелесообразным.  
исследовании всех систем водяной знак генерировал- Для большинства остальных систем ошибка из-
ся на основе ключа и не зависел от защищаемого влечения довольно низкая, за исключением системы 
изображения. Такое упрощение является оправдан- Huang, 2013, в которой ошибка может быть суще-
ным для двух задач, решавшихся в ходе эксперимен- ственной в некоторых случаях. По-видимому, это 
тального исследования (сформулированных в пара- обусловлено наличием параметра  в формуле (5). 
графе 4.1). Если бы мы дополнительно исследовали, На рис. 6, 7 показаны увеличенные фрагменты 
например, точность построения маски изменений, то изображений с ЦВЗ, встроенным при помощи различ-
это потребовало бы реализации адаптивных процедур ных систем (с использованием оригинальных значений 
формирования ЦВЗ, описанных в подпараграфе 3.3. NW). Эти рисунки иллюстрируют характер искажений, 

4.4. Оценка искажений, вызванных встраиванием возникающих в результате встраивания ЦВЗ. 
защитного ЦВЗ 

4.5. Исследование стойкости ЦВЗ при JPEG-сжатии 
Для оценки уровня искажений, возникающих в ре-

В рамках второго эксперимента мы исследовали 
зультате встраивания защитного ЦВЗ, мы исследова-

влияние показателя качества сжатия QF* защищённо-
ли системы в трёх различных режимах:  

го изображения в формате JPEG на точность после-
1) число встраиваемых бит на блок NW и позиции из-

дующего восстановления ЦВЗ. Если встраивание ЦВЗ 
меняемых коэффициентов jk, k = 0, ..., NW –1 зада-

произведено с показателем QF, то в идеальном случае 
ны согласно табл. 1 (авторские значения); 

полухрупкая система должна себя вести следующим 
2) NW одинаковое для всех систем (рассматривались 

значения 1 и 4), а jk заданы согласно табл. 1; образом: при QF*  QF значение ошибки извлечения 

3) N BER должно быть близким к нулю, а при QF* < QF 
W и jk одинаковые для всех систем. 

Таким образом, в первом режиме мы анализиро- оно должно быть близким к 0,5, что соответствует ве-

вали оригинальные системы, во втором – сочетание роятности случайного угадывания каждого бита ЦВЗ 
метода встраивания ЦВЗ и области встраивания, в в отдельности. На практике могут встречаться немно-

третьем – исключительно метод встраивания. Если гочисленные ненулевые значения BER при QF*  QF, 
оригинальное значение NW было меньше 4, то лишние объясняемые округлением значений пикселей после 

Компьютерная оптика, 2019, том 43, №3 427 



Классификация и сравнительное исследование систем аутентификации… Егорова А.А., Федосеев В.А. 
 

обратного ДКП, и, как следствие, искажением спек- системы. В области QF* < QF неизбежно присутству-
тральных компонент при извлечении информации. ет переходная фаза, когда график BER постепенно 
Если BER достигает уровня 0,01 и выше, как правило, снижается с 0,5 до 0. Этот промежуток должен быть 
это свидетельствует уже о несовершенстве ЦВЗ- как можно короче.  

Табл. 4. Исследование качества изображений с ЦВЗ и точности извлечения при отсутствии искажений 
 при встраивании с параметром QF = 50 

ЦВЗ-система Оригинальные значения NW NW = 1 NW = 4 
NW PSNR, дБ BER PSNR, дБ BER PSNR, дБ BER 

Lin & Chang, 2000 [6] 3 37,75 1,9E-04 41,59 1,5E-04 36,57 2,1E-04 
Huang, 2013 [8] 4 39,06 1,2E-03 47,34 1,8E-01 39,06 1,2E-03 

Lin & Chang, версия Cox et al. [1] 4 27,19 2,8E-04 34,81 2,7E-04 27,19 2,8E-04 
Preda & Vizireanu, 2015 [10] 3 39,62 4,9E-05 45,26 7,3E-05 38,40 9,2E-05 

Sign-QIM 3 42,99 0 48,93 0 41,77 0 
Wang et al., 2011 [11] 6 38,83 4,1E-06 48,94 0 42,06 0 

Fallahpour & Megias, 2016 [12] 1 35,39 
(96%) 3,2E-03 35,39 

(96%) 3,2E-03 35,39 
(24%) 3,2E-03 

Mursi et al., 2009 [13] 5 37,13 2,1E-04 45,82 1,2E-04 36,90 3,4E-04 
Lin et al., 2000 [14] 1 33,66 5,3E-02 33,66 5,3E-02 – – 

 

Табл. 5. Исследование качества изображений с ЦВЗ и точности извлечения при отсутствии искажений 
 при встраивании с параметром QF = 70 

Оригинальные значения NW NW = 1 NW = 4 
ЦВЗ-система 

NW PSNR, дБ BER PSNR, дБ BER PSNR, дБ BER 
Lin & Chang, 2000 [6] 3 41,38 1,8E-04 44,94 2,0E-04 40,28 1,8E-04 

Huang, 2013 [8] 4 43,00 2,7E-03 51,23 2,1E-01 43,00 2,7E-03 
Lin & Chang, версия Cox et al. [1] 4 31,72 1,2E-03 39,48 1,9E-03 31,72 1,2E-03 

Preda & Vizireanu, 2015 [10] 3 43,77 7,3E-05 49,71 2,7E-04 42,66 8,5E-05 
Sign-QIM 3 47,33 0 52,77 0 46,26 6,1E-06 

Wang et al., 2011 [11] 6 43,27 4,1E-06 52,80 0 46,40 0 
37,60 37,60 37,60 

Fallahpour & Megias, 2016 [12] 1 5, E 0  5,1E-03 5,1E-03
(99 1 - 3

%) (99%) (25  
%) 

Mursi et al., 2009 [13] 5 42,10 1,1E-04 49,50 1,2E-04 41,36 3,6E-04 
Lin et al., 2000 [14] 1 33,66 5,3E-02 33,66 5,3E-02 – – 

 

Табл. 6. Исследование качества изображений с ЦВЗ и точности извлечения при отсутствии искажений 
 при стандартизации числа бит и положения модифицируемых коэффициентов 

QF=50 QF=70 

ЦВЗ-система NW = 1 NW = 4 NW = 1 NW = 4 
PSNR, 

BER PSNR, дБ BER PSNR, дБ BER PSNR, дБ BER 
дБ 

Lin & Chang, 2000 [6] 41,59 1,5E-04 36,57 2,1E-04 44,94 2,0E-04 40,28 1,8E-04 
Huang, 2013 [8] 44,06 6,1E-02 39,07 1,2E-03 47,48 1,4E-01 43,01 2,9E-03 

Preda & Vizireanu, 2015 [10] 45,26 7,3E-05 38,40 9,2E-05 49,71 2,7E-04 42,66 8,5E-05 
Sign-QIM 48,93 0 41,77 0 52,77 0 46,26 6,1E-06 

Wang et al., 2011 [11] 48,94 0 42,06 0 52,80 0 46,40 0 
Fallahpour & Megias, 2016 35,39 35,39 37,60 37,60 

3,2E-03 3,2E-03 5,1E-03 5,1E-03 
[12] (96%) (24%) (99%) (25%) 

Mursi et al., 2009 [13] 45,82 1,2E-04 36,90 3,4E-04 49,50 1,2E-04 41,36 3,6E-04 
 

Результаты этого эксперимента для QF = 50 пред- Табл. 7. Показатели отклонения значений BER 
ставлены на рис. 8. Заметно, что для всех систем  от их теоретической оценки в серии экспериментов 

 с JPEG-сжатием 
имеются отклонения от идеальной картины. Для 

ЦВЗ-система errFN errFP 
оценки степени этих отклонений для каждой кривой Lin & Chang, 2000 [6] 8,247 0,041 
были рассчитаны следующие показатели: Huang, 2013 [8] 6,176 1,574 

QF 1 Lin & Chang, версия Cox et al. [1] 8,461 0,629 
err Preda & Vizireanu, 2015 [10] 7,120 0,033 

FN   0.5 BER QF *  , (12) 
QF* QF 25 Sign-QIM 7,085 0,024 

Wang et al., 2011 [11] 3,796 2,001 
QF 24

err Fallahpour & Megias, 2016 [12] 8,278 11,558 
FP   BER QF *  . (13) 

QF* QF Mursi et al., 2009 [13] 8,642 0,029 
Lin et al., 2000 [14] 9,318 2,440 

Их значения приведены в табл. 7. Более значимым из Huang, 2013 [8], α=1 7,178 0,026 
них является errFP. Wang et al., 2011 [11], β=0 2,691 1,112 

 

428 Компьютерная оптика, 2019, том 43, №3 



Классификация и сравнительное исследование систем аутентификации… Егорова А.А., Федосеев В.А. 

     
(а) исходное (б) Lin & Chang, 2000 (в) Huang, 2013 (г) Lin & Chang, верcия (д) Preda & Vizireanu, 
изображение PSNR = 37,5 PSNR = 37,1 Cox et al., PSNR = 27,2 2015 PSNR = 39,5 

     
(е) Sign-QIM (ж) Wang et al., 2011 (з) Fallahpour & Megias, (и) Mursi et al., 2009 (к) Lin et al., 2000 
PSNR = 43,0 PSNR = 38,8 2016, SNR = 36,7 PSNR = 37,5 PSNR = 33,7 

Рис. 6. Встраивание ЦВЗ в изображение “Goldhill” с использованием оригинальных значений NW (QF = 50, увеличение 6×) 

     
(а) исходное (б) Lin & Chang, 2000 (в) Huang, 2013 (г) Lin & Chang, верcия (д) Preda & Vizireanu, 
изображение PSNR = 38,2 PSNR = 37,7 Cox et al., PSNR = 27,2 2015 PSNR = 39,9 

     
(е) Sign-QIM (ж) Wang et al., 2011 (з) Fallahpour & Megias, (и) Mursi et al., 2009 (к) Lin et al., 2000 
PSNR = 43,0 PSNR = 38,8 2016, SNR = 38,7 PSNR = 36,6 PSNR = 33,7 

Рис. 7. Встраивание ЦВЗ в изображение “Peppers” с использованием оригинальных значений NW (QF = 50, увеличение 6×) 

 
Рис. 8. Влияние уровня JPEG-сжатия на ошибку извлечения ЦВЗ 

Компьютерная оптика, 2019, том 43, №3 429 



Классификация и сравнительное исследование систем аутентификации… Егорова А.А., Федосеев В.А. 
 

Как показывают результаты, в области QF*  QF извлечении ЦВЗ. Данное исследование показало, что 
большинство систем демонстрируют низкие значения основное влияние на качество результирующего изоб-
BER. Среди исключений для систем Huang, 2013 и ражения оказывает расположение модифицируемых 
Wang et al., 2011 большое число ошибок объясняется коэффициентов ДКП, а именно соответствующие им 
наличием параметров α и β. Если минимизировать значения матрицы QQF. Так, система Lin&Chang, вер-
влияние этих параметров, приравняв их к 1 и 0 соот- сия Cox et al., несмотря на механизм минимизации ис-
ветственно (что делает эти системы близкими к дру- кажений при квантовании, существенно проигрывает 
гим системам на основе НЗБ-встраивания и QIM со- прочим системам за счёт использования высокоча-
ответственно), то уровень ошибок падает. Впрочем, стотных коэффициентов. 
это повлечёт снижение PSNR для изображений с ЦВЗ. Сравнивая различные методы встраивания ЦВЗ, 
Для системы Lin & Chang, версия Cox et al. высокий можно сказать, что наилучшим образом проявили се-
уровень ошибок обусловлен зависимостью между бя системы на основе QIM, и главным образом си-
различными коэффициентами в блоке. Ошибка стема Wang et al., 2011. Помимо высокого качества 
наступает в случае изменения любого из 8 коэффици- защищённых изображений, эта система обеспечивает 
ентов в группе, в то время как для других систем всё безошибочное извлечение ЦВЗ из неискажённого 
определяется одним коэффициентом. Наибольший контейнера. Помимо этой системы, хорошо показала 
уровень ошибок наблюдается у системы Fallahpour & себя система Sign-QIM, являющаяся модификацией 
Megias, 2016. Это объясняется переменным количе- системы Preda & Vizireanu, 2015, а также Mursi et al., 
ством бит, встраиваемым в каждый блок. Таким обра- 2009 на основе табличного отображения.  
зом, для данной системы ошибка при извлечении Кроме того, исследована работоспособность си-
ЦВЗ может проявляться не только в инверсии бита, стем в смысле обеспечения частичной стойкости к 
но и в его пропуске. Последнее приводит к рассин- JPEG-сжатию. Исследование показало, что системы 
хронизации встроенного и извлечённого ЦВЗ и, сле- Lin & Chang, 2000, Preda & Vizireanu, 2015, Sign-QIM, 
довательно, резкому росту BER. Наконец, система Lin Mursi et al., 2009, а также Huang, 2013 и Wang et al., 
et al., 2000, не использующая при встраивании пара- 2011 (при должном подборе множителей α и β) поз-
метр QF, не позволяет добиться формы ступенчатой воляют выполнять полухрупкое встраивание. Остав-
функции на графике. Таким образом, данная система шиеся три системы (Lin&Chang, версия Cox et al., 
не позволяет обеспечить полухрупкость ЦВЗ. Fallahpour&Megias, 2016, Lin et al., 2000) по разным 

Среди прочих систем наилучшее значение показа- причинам не позволяют этого добиться. 
теля errFP достигается для системы Sign-QIM, немно- Благодарности 
гим уступают ей Huang, 2013 (при α = 1), Mursi et al., 
2009, Preda & Vizireanu, 2015 и Lin & Chang, 2000. Работа выполнена за счет гранта Российского 

В области QF* < QF почти все системы имеют пе- научного фонда (проект № 18-71-00052). 
реходную фазу, однако следует отметить, что боль- Литература 
шинство из них уже при небольшом отличии QF* от 1. Cox, I. Digital Watermarking and Steganography: Morgan 
QF превышают порог в 0,05. Этот факт можно ис- Kaufmann / I. Cox, J. Kilian, F.T. Leighton, T. Shamoon. – 
пользовать в качестве индикатора наличия недопу- Elsevier, 2008. – 624 p. 
стимых искажений изображения со встроенным ЦВЗ. 2. Федосеев, В.А. Цифровые водяные знаки и стеганогра-
Как показывает табл. 7, наименьшие отклонения от фия: учеб. пособие / В.А. Федосеев. – Самара: Изда-
теоретических значений наблюдаются для системы тельство Самарского университета, 2019. – 144 с. 
Wang et al., 2011. 3. Федосеев, В.А. Унифицированная модель систем встраи-

вания информации в цифровые сигналы / В.А. Федосеев // 
Заключение Компьютерная оптика. – 2016. – Т. 40, № 1. – С. 87-98. 

В настоящей работе рассмотрен класс полухруп- 4. Barni, M. Watermarking systems engineering: Enabling 
ких ЦВЗ-систем, предназначенных для аутентифика- digital assets security and other applications / M. Barni, 

ции JPEG-изображений. Приведено формальное схе- F. Bartolini. – CRC Press, 2004. – 500 p. 
5. Lin, C.-Y. Issues and solutions for authenticating MPEG 

матическое описание сценария использования систем video / C.-Y. Lin, S.-F. Chang // Proceedings of SPIE. – 
данного класса. Подробно рассмотрено свыше десят- 1999. – P. 54-65. 
ка таких систем, и предложена их классификация по 6. Lin, C.-Y. Semifragile watermarking for authenticating 
различным критериям: по используемому методу JPEG visual content / C.-Y. Lin, S.-F. Chang // Electronic 
встраивания, по местоположению и количеству изме- Imaging. – 2000. – P. 140-151. 
няемых коэффициентов, а также по способу форми- 7. Ho, C.K. Semi-fragile watermarking scheme for authentica-
рования ЦВЗ. Так, в рамках первой классификации tion of JPEG images / C.K. Ho, C.-T. Li // International 
выделены следующие методы: НЗБ-встраивание, Conference on Information Technology: Coding and Com-

QIM, изменение позиции LNZ компоненты, таблич- puting, 2004. Proceedings. – 2004. – Vol. 1. – P. 7-11. 
8. Huang, L.-Y. Authentication watermarking algorithm re-

ное отображение и расширение спектра. sisting JPEG compression based on preliminary quantiza-
В рамках исследовательской части работы прове- tion / L.-Y. Huang // Information Technology Journal. – 

дена оценка уровня искажений, возникающих при 2013. – Vol. 12(16). – P. 3723-3728. 
встраивании информации, а также погрешности при 

430 Компьютерная оптика, 2019, том 43, №3 



Классификация и сравнительное исследование систем аутентификации… Егорова А.А., Федосеев В.А. 

9. Ye, S. A quantization-based image authentication system / 18. Евсютин, О.О. Улучшенный алгоритм встраивания инфор-
S. Ye, Z. Zhou, Q. Sun, E. Chang, Q. Tian // Proceedings of мации в сжатые цифровые изображения на основе метода 
the 2003 Joint Fourth International Conference on Infor- PM1 / О.О. Евсютин, А.С. Кокурина, А.А. Шелупанов, 
mation, Communications and Signal Processing, 2003 and И.И. Шепелев // Компьютерная оптика. – 2015. – Т. 39, № 4. 
the Fourth Pacific Rim Conference on Multimedia. Proceed- – С. 572-581. – DOI: 10.18287/0134-2452-2015-39-4-572-581. 
ings of the 2003 Joint. – 2003. – Vol. 2. – P. 955-959. 19. Yu, X. Review on semi-fragile watermarking algorithms for 

10. Preda, R.O. Watermarking-based image authentication ro- content authentication of digital images / X. Yu, C. Wang, 
bust to JPEG compression / R.O. Preda, D.N. Vizireanu // X. Zhou // Future Internet. – 2017. – Vol. 9, Issue 4. – 56. 
Electronics Letters. – 2015. – Vol. 51(23). – P. 1873-1875. 20. Wallace, G.K. The JPEG still picture compression standard 

11. Wang, H. A novel fast self-restoration semi-fragile watermark- / G.K. Wallace // IEEE Transactions on Consumer Electron-
ing algorithm for image content authentication resistant to ics. – 1992. – Vol. 38, Issue 1. – P. xviii-xxxiv. 
JPEG compression / H. Wang, A. Ho, X. Zhao // Digital Foren- 21. Chen, B. Quantization index modulation: A class of provably 
sics and Watermarking. – 2011. – Vol. 7128. – P. 72-85. good methods for digital watermarking and information em-

12. Fallahpour, M. Flexible image watermarking in JPEG do- bedding / B. Chen, G. Wornell // IEEE Transaction on Infor-
main / M. Fallahpour, D. Megias // 2016 IEEE International mation Theory. – 2001. – Vol. 47, Issue 4. – P. 1423-1443. 
Symposium on Signal Processing and Information Technol- 22. Cox, I.J. Secure spread spectrum watermarking for multi-
ogy (ISSPIT). – 2016. – P. 311-316. media / I.J. Cox, J. Kilian, F.T. Leighton, T. Shamoon // 

13. Mursi, M. A DCT-based secure JPEG image authentication IEEE Transactions on Image Processing. – 1997. – Vol. 6, 
scheme / M. Mursi, G.M.R. Assassa, H. Aboalsamh, Issue 12. – P. 1673-1687. 
K. Alghathbar // World Academy of Science, Engineering 23. Mitekin, V. A new QIM-based watermarking algorithm ro-
and Technology. – 2009. – Vol. 53. – P. 681-687. bust against multi-image histogram attack / V. Mitekin, 

14. Lin, E.T. Detection of image alterations using semifragile V. Fedoseev // Procedia Engineering. – 2017. – Vol. 201. – 
watermarks / E.T. Lin, C.I. Podilchuk, E.J. Delp // Security P. 453-462. – DOI: 10.1016/j.proeng.2017.09.687. 
and Watermarking of Multimedia Contents II. – 2000. – 24. Митекин, В.А. Алгоритмы встраивания информации на 
Vol. 3971. – P. 152-164. основе QIM, стойкие к статистической атаке / 

15. Al-Mualla, M.E. Content-adaptive semi-fragile water- В.А. Митекин, В.А. Федосеев // Компьютерная оптика. 
marking for image authentication / M.E. Al-Mualla // 2007 – 2018. – Т. 42, № 1. – С. 118-127. – DOI: 10.18287/2412-
14th IEEE International Conference on Electronics, Circuits 6179-2018-42-1-118-127. 
and Systems. – 2007. – P. 1256-1259. 25. Глумов, Н.И. Обнаружение дубликатов на изображе-

16. Wong, P.H.W. Data hiding technique in JPEG compressed ниях / Н.И. Глумов, А.В. Кузнецов // Компьютерная оп-
domain / P.H.W. Wong, O.C.L. Au, J.W.C. Wong // Pro- тика. – 2011. – Т. 35, № 4. – С. 508-512. 
ceedings of SPIE – The International Society for Optical 26. Глумов, Н.И. Обнаружение на изображениях искус-
Engineering, 2001. – P. 309-320. ственных изменений локального происхождения / 

17. Xiao, J. A semi-fragile watermarking distinguishing JPEG Н.И. Глумов, А.В. Кузнецов // Автометрия. – 2011. – 
compression and gray-scale-transformation from malicious Т. 47(3). – С. 4-12. 
manipulation / J. Xiao, Z. Ma, B. Lin, J. Su, Y. Wang // 27. The USC-SIPI Image Database [Электронный ресурс]. – 
2010 IEEE Youth Conference on Information, Computing Режим доступа: http://sipi.usc.edu/database/ (дата обра-
and Telecommunications (YC-ICT). – 2010. – P. 202-205. щения 07.04.2019). 

 
 

Сведения об авторах 
Егорова Анна Александровна, 1995 года рождения. В 2017 году окончила Самарский национальный ис-

следовательский университет имени академика С.П. Королёва (Самарский университет) с отличием по специ-
альности «Информационная безопасность автоматизированных систем». В настоящее время является аспиран-
том Самарского университета. Основные сферы научных интересов: обработка изображений, обнаружение ис-
кажений на цифровых изображениях, защита информации. E-mail: 2358anna@gmail.com . 

 
Федосеев Виктор Андреевич, 1986 года рождения, в 2009 году окончил Самарский государственный 

аэрокосмический университет имени академика С.П. Королёва (ныне – Самарский университет) по специаль-
ности «Прикладная математика и информатика», кандидат физико-математических наук (2012). В настоящее 
время работает доцентом кафедры геоинформатики и информационной безопасности Самарского университета 
и научным сотрудником в ИСОИ РАН – филиале ФНИЦ «Кристаллография и фотоника» РАН. Области науч-
ных интересов: анализ изображений, цифровые водяные знаки, стеганография. E-mail: vicanfed@gmail.com . 
 
 

ГРНТИ: 28.23.15 
Поступила в редакцию 8 апреля 2019 г. Окончательный вариант – 22 апреля 2019 г. 

 
 

A classification of semi-fragile watermarking systems for JPEG images 
A.A. Egorova 2, V.A. Fedoseev 1,2 

1IPSI RAS - Branch of the FSRC “Crystallography and Photonics” RAS,  
Molodogvardeyskaya 151, 443001, Samara, Russia, 

2Samara National Research University, 443086, Russia, Samara, Moskovskoye Shosse 34 

Компьютерная оптика, 2019, том 43, №3 431 



Классификация и сравнительное исследование систем аутентификации… Егорова А.А., Федосеев В.А. 
 

Abstract  
The article discusses semi-fragile digital watermarking systems designed to protect JPEG im-

ages against unauthorized changes. These systems allow detecting and locating changes, and some 
of them are able to restore the original content. Formal schemes describing the procedures for wa-
termark embedding and authentication are given. We consider more than a dozen systems of this 
type and classify them according to various criteria. We also consider the results of experimental 
studies of these systems estimating their level of distortions arising from watermark embedding. In 
addition, we test the systems whether they are able to operate in the semi-fragile way. 

Keywords: digital watermarking, image authentication, semi-fragile watermarking, JPEG, 
QIM, LSB. 

Citation: Egorova AA, Fedoseev VA. A classification of semi-fragile watermarking systems 
for JPEG images. Computer Optics 2019; 43(3): 419-433. DOI: 10.18287/2412-6179-2019-43-3-
419-433. 

Acknowledgements: The work was funded by the Russian Science Foundation under grant #18-
71-00052. 

References [15] Al-Mualla ME. Content-adaptive semi-fragile watermark-
ing for image authentication. 2007 14th IEEE International 

[1] Cox I, Kilian J, Leighton FT, Shamoon T. Digital Water- Conference on Electronics, Circuits and Systems 2007; 
marking and Steganography: Morgan Kaufmann. Elsevier; 1256-1259. 
2008. [16] Wong PHW, Au OCL, Wong JWC. Data hiding technique 

[2] Fedoseev VA. Digital Watermarking and Steganography: in JPEG compressed domain. Proceedings of SPIE – The 
A Tutorial. 2nd ed. Samara: Samara University; 2019. International Society for Optical Engineering 2001; 309-

[3] Fedoseev VA. A unified model for information hiding sys- 320. 
tems. Computer Optics 2016; 40: 87-98. [17] Xiao J, Ma Z, Lin B, Su J, Wang Y. A semi-fragile water-

[4] Barni M, Bartolini F. Watermarking systems engineering: marking distinguishing JPEG compression and gray-scale-
Enabling digital assets security and other applications. CRC transformation from malicious manipulation. 2010 IEEE 
Press; 2004. Youth Conference on Information, Computing and Tele-

[5] Lin C-Y, Chang S-F. Issues and solutions for authenticat- communications (YC-ICT) 2010; 202-205. 
ing MPEG video. Proceedings of SPIE 1999; 54-65. [18] Evsutin OO, Kokurina AS, Shelupanov AA, Shepelev II. 

[6] Lin C-Y, Chang S-F. Semifragile watermarking for au- An improved algorithm for data hiding in compressed digi-
thenticating JPEG visual content. Electronic Imaging 2000; tal images based on PM1 method. Computer Optics 2015; 
140-151. 39(4): 572-581. DOI: 10.18287/0134-2452-2015-39-4-

[7] Ho CK, Li CT. Semi-fragile watermarking scheme for au- 572-581. 
thentication of JPEG images. International Conference on [19] Yu X, Wang C, Zhou X. Review on Semi-Fragile Water-
Information Technology: Coding and Computing, 2004. marking Algorithms for Content Authentication of Digital 
Proceedings 2004; 1: 7-11. Images. Future Internet 2017; 9(4): 56. 

[8] Huang L-Y. Authentication watermarking algorithm resist- [20] Wallace GK. The JPEG still picture compression standard. 
ing JPEG compression based on preliminary quantization. IEEE Transactions on Consumer Electronics 1992; 38(1): 
Information Technology Journal 2013; 12(16): 3723-3728. xviii-xxxiv. 

[9] Ye S, Zhou Z, Sun Q, Chang E, Tian Q. A quantization- [21] Chen B, Wornell G. Quantization index modulation: A 
based image authentication system. Proceedings of the class of provably good methods for digital watermarking 
2003 Joint Fourth International Conference on Infor- and information embedding. IEEE Transaction on Infor-
mation, Communications and Signal Processing, 2003 and mation Theory 2001; 47(4): 1423-1443. 
the Fourth Pacific Rim Conference on Multimedia. Pro- [22] Cox IJ, Kilian J, Leighton FT, Shamoon T. Secure spread 
ceedings of the 2003 Joint 2003; 2: 955-959. spectrum watermarking for multimedia. IEEE Transactions 

[10] Preda RO, Vizireanu DN. Watermarking-based image au- on Image Processing 1997; 6(12): 1673-1687. 
thentication robust to JPEG compression. Electronics Let- [23] Mitekin V, Fedoseev V. A new QIM-based watermarking 
ters 2015; 51(23): 1873-1875. algorithm robust against multi-image histogram attack. 

[11] Wang H, Ho A, Zhao X. A novel fast self-restoration semi- Procedia Engineering 2017; 201: 453-462. DOI: 
fragile watermarking algorithm for image content authenti- 10.1016/j.proeng.2017.09.687. 
cation resistant to JPEG compression. Digital Forensics [24] Mitekin VA, Fedoseev VA. New secure QIM-based in-
and Watermarking. – 2011. – Vol. 7128. – P. 72-85. formation hiding algorithms. Computer Optics 2018; 

[12] Fallahpour M, Megias D. Flexible image watermarking in 42(1): 118-127. DOI: 10.18287/2412-6179-2018-42-1-
JPEG domain. 2016 IEEE International Symposium on 118-127. 
Signal Processing and Information Technology (ISSPIT) [25] Glumov NI, Kuznetsov AV. Copy-move image forensics 
2016; 311-316. detection. Computer Optics 2011; 35(4): 508-512. 

[13] Mursi M, Assassa GMR, Aboalsamh H, Alghathbar K. A [26] Glumov NI, Kuznetsov AV. Detection of local artificial 
DCT-based secure JPEG image authentication scheme. changes in images. Optoelectronics, Instrumentation and 
World Academy of Science, Engineering and Technology Data Processing 2011; 47(3): 207-214. DOI: 
2009; 53: 681-687. 10.3103/S8756699011030010. 

[14] Lin ET, Podilchuk CI, Delp EJ. Detection of image altera- [27] The USC-SIPI Image Database. Source: 
tions using semifragile watermarks. Security and Water- http://sipi.usc.edu/database/ 
marking of Multimedia Contents II 2000; 3971: 152-164. 

 
 

432 Компьютерная оптика, 2019, том 43, №3 



Классификация и сравнительное исследование систем аутентификации… Егорова А.А., Федосеев В.А. 

Author’s information  
Anna Aleksandrovna Egorova (b. 1995) graduated with honors from Samara National Research University (Sama-

ra University) majoring in Information Security of Computer-Aided Systems in 2017. Nowadays she is a postgraduate 
at Samara National Research University. Main research interests: image processing, digital image forgery detection and 
information security. E-mail: 2358anna@mail.ru . 

 
Victor Andreevich Fedoseev (b. 1986) graduated (2009) from Samara State Aerospace University (presently, Sa-

mara National Research University), majoring in Applied Mathematics and Computer Science. Candidate degree in 
Computer Science (2012). Currently he is an associate professor at the Geoinformatics and Information Security 
вepartment at Samara University and a research scientist at Image Processing Systems Institute оf RAS – Branch of the 
FSRC “Crystallography and Photonics” RAS. His scientific interests include image processing and analysis, digital wa-
termarking and steganalysis. E-mail: vicanfed@gmail.com . 
 
 

Received April 8, 2019. The final version – April 22, 2019.  
 

 

Компьютерная оптика, 2019, том 43, №3 433