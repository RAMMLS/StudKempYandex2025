Локализация человека в кадре видеопотока с использованием алгоритма на основе… Амосов О.С., Иванов Ю.С., Жиганов С.В. 

ЛОКАЛИЗАЦИЯ ЧЕЛОВЕКА В КАДРЕ ВИДЕОПОТОКА С ИСПОЛЬЗОВАНИЕМ АЛГОРИТМА 
НА ОСНОВЕ РАСТУЩЕГО НЕЙРОННОГО ГАЗА И НЕЧЁТКОГО ВЫВОДА 

О.С. Амосов1, Ю.С. Иванов1, С.В. Жиганов1 

1ФГБОУ ВО «Комсомольский-на-Амуре государственный технический университет»,  
Комсомольск-на-Амуре, Россия 

Аннотация 

Решается задача локализации человека в кадре видеопотока с помощью алгоритма рас-
ширяющегося нейронного газа и признакового описания на основе гистограмм ориентиро-
ванных градиентов. В основе алгоритма используется оригинальная нейро-нечеткая модель 
растущего нейронного газа для обучения с подкреплением (GNG-FIS). Также предложена 
модификация алгоритма GNG-FIS с использованием двухпроходного обучения с нечеткой 
перемаркировкой классов и построением тепловой карты.  

В результате экспериментов показатель правильных локализаций разработанного клас-
сификатора составил от 90,5 % до 93,2 %, в зависимости от условий сцены, что позволяет 
применять алгоритм в реальных системах ситуационной видеоаналитики. 

Ключевые слова: локализация человека, растущий нейронный газ, кластеризация, нечет-
кий вывод. 

Цитирование: Амосов, О.С. Локализация человека в кадре видеопотока с использова-
нием алгоритма на основе растущего нейронного газа и нечеткого вывода / О.С. Амосов, 
Ю.С. Иванов, С.В. Жиганов // Компьютерная оптика. – 2017. – Т. 41, № 1. – С. 46-58. – DOI: 
10.18287/2412-6179-2017-41-1-46-58. 

Введение Для распознавания людей на выделенных деск-

Распознавание нештатных ситуаций особенно акту- рипторах изображения Далал и Триггс [7] предложи-

ально в системах, где требуется незамедлительное авто- ли использовать метод опорных векторов (Support 

матическое принятие решения. Так, например, в систе- Vector Machine, SVM) [8]. Несмотря на достоинства 

мах безопасности к нештатным ситуациям можно отне- метода [8], также существует и ряд недостатков [9]: 

сти нестандартное поведение людей, связанное с • метод чувствителен к шумам и нормализации 
хулиганством, грабежом, потасовкой, праздношатание, данных, т.е. изображение должно быть приведе-

бег, появление в кадре посторонних предметов. но к предопределенному стандарту; 

Задачи распознавания и реагирования на такие си- • не существует общего подхода к автоматиче-
туации решаются алгоритмами интеллектуальной (си- скому выбору ядра в случае линейной неразде-
туационной) видеоаналитики, которые включают в себя: лимости классов. 
распознавание номерных знаков [1], детекторы движе- Подход, основанный на вычислении признаков 
ния [2], распознавание лиц [3], обеспечение безопасно- HOG и последующей классификации с использовани-
сти на транспорте [4] и т.д. При этом основным объек- ем алгоритма SVM, получил название HOG SVM [7]. 
том, который необходимо локализовать и распознать в В статье [10] предлагается модификация HOG 
кадре видеопоследовательности, является человек. SVM, основанная на использовании в качестве слабо-

Одним из классических подходов для решения за- го классификатора деревьев решений заданной высо-
дачи локализации объектов в кадре видеопотока яв- ты, что повышает скорость вычисления HOG. 
ляется алгоритм Виолы–Джонса [3], успешно пока- В работе [11] применен метод деформируемых 
завший себя при локализации лиц. Алгоритм основан моделей. Он использует анализ геометрических огра-
на выделении локальных признаков и последующем ничений, позволяя производить поиск в кадре чело-
обучении классификатора. В качестве признакового века с уменьшенным масштабом. 
описания используются признаки Хаара [3].  В работе [12] предлагается иной подход, основан-

Алгоритм реализован в виде загружаемых класси- ный на использовании пространственно-временных 
фикаторов для локализации следующих объектов: признаков. В статье описываются признаки движения 
лицо человека (frontalface), верхняя часть тела чело- с раздельными пространственными и временными ги-
века (upperbody) [5], нижняя часть тела человека стограммами, что позволяет определить человека в 
(lowerbody), тело человека (fullbody), глаза (eye) и др. сложных ситуациях. 

Тем не менее использование признаков Хаара ока- Однако, несмотря на различные модификации 
залось малоэффективно в ситуациях, когда большин- HOG SVM, существенным ограничением метода 
ство (в том числе и фон) объектов на изображении опорных векторов является неустойчивость по отно-
обладают схожими цветовыми характеристиками [6]. шению к шуму в исходных данных. Шумовые выбро-
Для решения этой проблемы Далал и Триггс [7] пред- сы обучающей выборки будут учтены при построе-
ложили использовать информацию о контурах объек- нии разделяющей гиперплоскости [13, 14], т.е. по-
та на основе гистограммы направленных градиентов строенное на них решающее правило будет опираться 
(Histogram of Oriented Gradients, HOG). на шум.  

46 Компьютерная оптика, 2017, том 41, №1 



Локализация человека в кадре видеопотока с использованием алгоритма на основе… Амосов О.С., Иванов Ю.С., Жиганов С.В. 

При этом все цифровые изображения, как правило, изображение. В памяти компьютера изображение 
подвержены тем или иным шумовым искажениям, свя- представляется в виде двухмерной матрицы пикселей 
занным с условиями съемки или помехами и влияю- It размером, width×height, где t – номер кадра в видео-
щим на качество работы классификатора в целом.  последовательности. Каждый пиксель в матрице 

Таким образом, возникает необходимость исполь- представлен некоторым неотрицательным числом: 
зования классификаторов устойчивых как к шумам, • от 0 до 255, если изображение черно-белое; 
возникающим на поступающих изображениях, так и к • от 0 до 2553, если изображение в модели RGB 
шумовым выбросам в обучающей выборке. (Red – красный, Green – зеленый, Blue – синий). 

В последнее время наилучшие результаты в опти- По кадру видеопоследовательности требуется оп-
ческом распознавании образов достигаются при по- ределить, если он есть, список прямоугольников, в 
мощи использования искусственных нейронных се- которых присутствует локализируемый объект – че-
тей (ИНС) [15, 16, 17]. В работе [18] приводится ловек: 
сравнение различных алгоритмов для задачи распо-

rectangleη = {x, y, w, h} ,  (1) 
знавания рукописных цифр.  

Наиболее перспективным представляется исполь- где x, y – координаты центра η-го прямоугольника, 
зование глубоких нейросетей (Deep Neural Network) w – ширина, h – высота. 
[19, 20]. В работе приведено объединение классиче- Необходимо заметить, что в кадре может присут-
ских подходов и сверточной нейронной сети. В рабо- ствовать несколько объектов. 
те [19] показано, что использование классических ме- Поиск объекта будет выполняться «сканирующим 
тодов вместе со сверточной нейронной сетью значи- окном» Cr, где r – номер сканирующего окна (шаг 
тельно улучшает качество локализации человека. сканирования), которое представляет собой матрицу 
Основными недостатками таких сетей являются низ- пикселей. Окно проходит последовательно по изо-
кая скорость обучения и необходимость большого бражению с шагом 1 или более пикселей (слева на-
объема обучающих данных.  право, сверху вниз) с изменением масштаба при каж-

Для задачи локализации человека в видеопотоке дом проходе. Размер окна определяется его шириной 
особый интерес представляют нейронные сети, обу- с wc и высотой  hc. 
чаемые без учителя [21, 22], так как они используют При прохождении сканирующего окна по изобра-
модель обучения, наиболее близкую к биологической жению для каждого положения окна необходимо оп-
[23]. Такой подход позволяет обнаружить скрытые за- ределить, содержится ли в окне человек или нет. Это 
висимости и закономерности, существующие между может быть выполнено путем отнесения анализируе-
объектами, тем самым разделяя множество образов на мой части изображения к одному из двух классов. 
различные классы, в том числе и на шумовые выбросы.  Первый класс – наличие человека, второй класс – его 

Среди существующих самоорганизующихся сетей отсутствие. Причем, если в окне Cr содержится иско-
наилучшую самоорганизацию показал алгоритм, мый объект, то rectangle  = {xr, yr, wr, hr}, где xr, yr – 
предложенный М. Мартинесом, С. Берковичем и К. координаты центра сканирующего окна, а wr, hr – его 
Шультеном в работе [24] и названный растущий ней- высота и ширина.  
ронный газ (Growing Neural Gas, GNG). Алгоритм от- Так как существует всего два класса  
личается высокой скоростью обучения.  {«не-человек»; «человек»}={–1; +1}, то задача лока-

Таким образом, при построении алгоритма для ре- лизации человека в кадре видеопотока сводится к за-
шения задачи локализации человека в кадре видеопо- даче классификации. Рассмотрим классическую по-
тока перспективными являются следующие подходы: становку задачи классификации [14]. 
• использование признакового пространства HOG; Дано множество X, в котором хранится описание 
• использование самоорганизующихся нейронных объектов o. Y – конечное множество классов. Ре-

сетей в качестве классификатора из-за их устой- шающей функцией (классификатором) F является 
чивости к шумовым выбросам. отображение множества X в множество Y, т.е. 

Научная новизна предлагаемой работы состоит в F: X →Y. Признак f объекта o – это отображение 
применении комбинированного алгоритма на основе f:o→Df, где Df – множество допустимых значений 
нейро-нечеткой модели растущего нейронного газа признака f. Если задан набор признаков f1,…,fm для 
для обучения с подкреплением в задаче локализации некоторого объекта o, то вектор признаков x объекта 
человека в видеопотоке. Новым в алгоритме является o∈X может быть определен так: x = (f1(o),…,fm(o)). 
применение двухпроходного обучения с последую- Классификатор F должен быть способен класси-
щей перемаркировкой классов, осуществляемой бло- фицировать произвольный объект o∈X. Приведенная 
ком нечеткого вывода. постановка задачи иллюстрируется рис. 1. 

1. Постановка задачи локализации человека  Оптимальным считается классификатор, который 

в кадре видеопотока дает наименьшую вероятность ошибки P(x) при всех 
допустимых значениях x. Тогда критерием оптималь-

Пусть имеется непрерывный видеопоток S, со-
ности будет P(x ) → min . Следует отметить, что 

стоящий из отдельных кадров. Каждый кадр видео- x∈X

последовательности представляет собой цифровое ошибки разделяются на «ошибки 1-го рода» (ложно-

Компьютерная оптика, 2017, том 41, №1 47 



Локализация человека в кадре видеопотока с использованием алгоритма на основе… Амосов О.С., Иванов Ю.С., Жиганов С.В. 

положительные) – ложное срабатывание, «ошибки 2- 1. Выполняется предобработка с выделением ин-
го рода» (ложноотрицательные) – пропуск события.  формации о яркости изображения и перевод 

изображения в признаковое пространство HOG.  
2. Выполняется классификация объекта, выделен-

ного сканирующим окном, алгоритмом растуще-
го нейронного газа. 

3. Выполняется переход к бинарной классифика-
ции путем маркировки с использованием нейро-
нечеткой модели растущего нейронного газа. 

 
Рис. 1. Постановка задачи бинарной классификации 4. Выполняется нечеткая перемаркировка и построе-

ние тепловой карты для уменьшения ошибки 2-го 
В оптическом распознавании образов для оценки 

рода. 
бинарного классификатора применяется ROC-анализ 

Алгоритм представлен на рис. 3, где FGNG – клас-
(receiver operating characteristic, рабочая характери-

сификатор нейронного газа, l – номер класса, D – 
стика приёмника) [25]. Количественную интерпрета-

обучающее множество. 
цию ROC дает показатель AUC (area under ROC 

RGB
curve, площадь под ROC-кривой) — площадь, огра- I t

ниченная ROC-кривой и осью абсцисс. Блок предобработки
Для обучения классификатора F используется и перевода в признаковое

пространство HOG
обучающая выборка, заданная множеством 
D = {(x1, y1),…,(x Перевод к модели HSV

v, yv)}, где yj∈Y = {–1; +1}, j = 1…v. 
В качестве признакового пространства нами ис-

пользуется метод HOG [7], как наиболее зарекомен- Применение адаптивной
гистограммы

довавший себя для решения задачи локализации че-
ловека. Тогда алгоритм перевода в пространство 
HOG выглядит следующим образом: Сканирующее окно

Φ:o → x j
j .   (2) 

Переход в пространство
Пример изображения в пространстве HOG пред- признаков

ставлен на рис. 2.  x

Алгоритм нейронного газа FGNG Обученный
классификатор

1
N1ÎY ={1...1}

Маркировка с использованием
нейро-нечёткой классификации

y Dtrain Dtest
vÎY={+1;-1}

Блок нечёткой перемаркировки
и построения тепловой карты

Нечёткая перемаркировка Dsupport

D

Тепловая карта

Порог

а б rectangleh
  

Рис. 2. Пример изображения в формате:  Рис. 3. Решение задачи локализации человека 

а) оригинальный кадр; б) визуализация HOG 2.1. Предобработка изображения  
Использование метода HOG имеет следующие с выделением информации о яркости  

преимущества: Пусть имеется кадр видеопотока It в модели RGB. 
1. Устойчивость к геометрическим преобразовани- Необходимо извлечь информацию о яркостных ха-

ям изображения. рактеристиках изображения. 
2. Высокая устойчивость к шуму, связанному с Классический алгоритм использует изображение в 

движением за счет глубокого разбиения про- модели RGB, но, как показывает практика [26], модель 
странства малыми ядрами. HSV (Hue – тон, Saturation – насыщенность, Value – 

2. Решение задачи локализации человека в кадре значение) [27] более информативна для локализации 

видеопотока с использованием метода нейронного человека [26].  

газа и последующей перемаркировкой В отличие от распространенной цветовой модели 
RGB, каналы HSV содержат информацию о цветовом 

Решение задачи локализации человека в кадре ви- тоне, насыщенности и яркости. На рис. 4 приведены 
деопотока разбивается на решение ряда подзадач: изображения в моделях RGB (а) и HSV (б), что под-

48 Компьютерная оптика, 2017, том 41, №1 



Локализация человека в кадре видеопотока с использованием алгоритма на основе… Амосов О.С., Иванов Ю.С., Жиганов С.В. 

тверждает предположение о высокой информативно- • α, β – коэффициенты для адаптации ошибок. 
сти модели HSV.  2. Задаются два начальных узла υ и v в случайных 

точках ωυ и ωv, υ и v соединяются ребром, возраст 
age которого равен нулю. Ошибка err в узлах υ и v 
принимается равной нулю. 

3. Выбирается очередной объект o, который пред-
ставлен вектором x из входного множества D. 

4. Определяются узлы ψ 1 и ψ 2 – первый и второй по 
критерию близости к o. В качестве меры близости 

а)  б)  используется стандартное евклидово расстояние 
Рис. 4. Изображение в различных цветовых моделях: E = ||ω

 
ψ – x||, ψ  = ψ 1, ψ2. 

 а) RGB, б) HSV 
5. Увеличивается на 1 возраст дуг, исходящих от ψ1. 

Для повышения контрастности изображения ис-
пользуется метод адаптивной эквализации (выравни- 6. Счетчик ошибки нейрона ψ1 увеличивается на вели-

вания) гистограммы, подробно описанный в работе чину квадрата расстояния до o: E(ψ1) = ||ωψ1 – x||2. 

[28], заключающийся в вычислении нескольких гис- 7. ψ1 и узлы, соединённые с ним, смещаются по на-
тограмм, каждая из которых соответствует отдельной правлению к o на расстояния ∆ωψ1 = εξ(x– ωψ ) и 

1

части изображения. ∆ωψn = εξ(x– ωψ ) соответственно, где 0
n  < εξ << 1 и 

Для программной реализации данного метода 0 < εξ << εζ. 
можно использовать готовую функцию adapthisted из 

8. Если ψ 1 и ψ 2 соединены ребром, то возраст ребра 
библиотеки компьютерного зрения OpenCV [27]. 

обнуляется; в противном случае между ψ 1 и ψ2 соз-
После обработки изображения IHSV

t  методом адап- дается новое ребро с возрастом, равным нулю. 
тивного выравнивания гистограммы adapthisted (It) по 9. Все ребра в графе с возрастом более agemax удаля-
нему проходит сканирующее окно, результатом кото- ются. В случае, если после этого некоторые узлы 
рого становится некая область-объект o, которую не- не имеют ребер (оказываются изолированы), эти 
обходимо отнести к одному из множества классов. узлы также удаляются.  

2.2. Классификация объекта алгоритмом  10. Если номер текущей итерации кратен величине λ, 
растущего нейронного газа осуществляется вставка нового узла в точке 

Пусть имеется объект o, представленный вектором ωρ = 0,5(ωϑ–ωκ), где ϑ – узел с наибольшей накоп-

признакового описания x, а также обучающая выбор- ленной ошибкой; κ – узел, соединенный ребром ϑ 

ка, заданная конечным множеством D. Необходимо с наибольшей накопленной ошибкой. Ребро меж-

построить оптимальный классификатор F, дающий ду κ и ϑ удаляется, вместо него добавляется но-
наименьшую вероятность ошибки распознавания при вый узел – ρ и добавляются рёбра между κ и ρ, а 
различных значениях x. также между ρ и ϑ. Ошибка err в узлах κ и ϑ 

В качестве классификатора предлагается исполь- уменьшается умножением на константу α < 1; зна-
зовать алгоритм растущего нейронного газа [24]. Ал- чение ошибки нового нейрона ρ инициализирует-
горитм применялся для задач оптического распозна- ся равным значению ошибки ϑ. 
вания образов, анализа временных рядов, кластериза- 11. Ошибка err во всех узлах уменьшается умножени-
ции и др. [24, 30, 31].  ем на константу β < 1. 

В работах [32, 33] также предлагались различные 12. Если условие остановки не выполнено, перейти к 
модификации, основанные на изменении механизма шагу 2. Стандартным условием остановки являет-
роста, онлайн-обучении и др. ся выполнение определенного количества итера-

При этом, как правило, решалась либо задача кла- ций обучения τ. Пример структуры GNG приведен 
стеризации [34], либо задача многомерной классифи- на рис. 5. 
кации. Таким образом, можно утверждать, что алго-
ритм GNG может быть применен для построения 
классификатора, удовлетворяющего условиям приве-
денной ранее задачи. 

Алгоритм обучения нейронного газа выглядит 
следующим образом [24]: 
1. Установить параметры растущего нейронного газа: 

• agemax – максимальный возраст ребра;  
• εξ, ε

Рис. 5. Пример структуры GNG 
ζ – коэффициенты обучения нейрона-

победителя и его соседей; Для решения задачи локализации человека на изо-

• λ – количество итераций для вставки нового бражении с использованием алгоритма GNG была со-
узла (нейрона); ставлена обучающая выборка D. Выборка была со-

• τ – количество итераций до остановки обуче- ставлена на основе классических наборов открытых 

ния; баз данных [35, 36], а также данных, собранных 

Компьютерная оптика, 2017, том 41, №1 49 



Локализация человека в кадре видеопотока с использованием алгоритма на основе… Амосов О.С., Иванов Ю.С., Жиганов С.В. 

вручную. В выборке представлены позитивные изо- класс является позитивным (с присутствием челове-
бражения (с человеком) и негативные (без человека) в ка), а другой – негативным (без присутствия челове-
равных количествах. Для ускорения сходимости и ка), т.е отнесение к классам yj∈Y = {+1; –1}. 
повышения качества кластеризации при обучении Казалось бы, очевидным способом приведения к 
данные подавались потоком с чередованием негатив- задаче бинарной классификации является искусст-
ных и позитивных изображений [14]. венное ограничение числа кластеров в сети растуще-

Тестирующая выборка была составлена на осно- го нейронного газа на этапе обучения. Но при этом 
вании первоначального набора данных случайным теряется суть самоорганизации, а результат работы 
разбиением выборки D на 2 части в соотношении алгоритма ухудшается с увеличением количества 
обучающая / тестирующая – 50 / 50 %. разнородных данных в выборке, что делает такой 

Изображения в выборке были нормированы к фор- подход неприемлемым. 
мату 128×64 пикселей. Обучающая выборка Dtrain Для перехода к задаче бинарной классификации, т.е 
содержит 1500 позитивных и 1500 негативных изобра- понижения размерности, нами предлагается использо-
жений. Тестирующая выборка Dtest содержит 3000 изо- вание заранее размеченного и разбитого на 2 класса 
бражений с тем же соотношением позитивных/нега- обучающего множества. После обучения классифика-
тивных, что и обучающая выборка. Примеры изобра- тора FGNG необходимо выполнить маркировку (изме-
жений из обучающей и тестовой выборки приведены нение метки класса) полученных классов на позитив-
на рис. 6а – негативные и рис. 6б – позитивные. ные и негативные. Выполнение такой маркировки яв-

Результатом обучения растущего нейронного газа ляется трудноформализуемой задачей, которая 
является разбиение обучающего множества на Nl ≥ 2 решается с использованием блока нечеткого вывода.  
классов, т.е. решается задача кластеризации. Важно от- Поэтому нами предлагается объединение нейрон-
метить, что состав и количество кластеров формируется ных сетей и нечеткой логики. Такой подход показал 
в ходе самоорганизации и неизвестно заранее. В отли- свою эффективность во многих задачах [37, 38]. Так, 
чие от линейных классификаторов, разделяющих мно- например, одной из известных нейро-нечетких струк-
гомерное пространство на 2 класса, алгоритм GNG соз- тур является ANFIS [39]. 
дает отдельные кластеры для зашумленных объектов. Нами предлагается структура нейро-нечеткой мо-

При получении на вход GNG нового объекта o, дели (GNG-FIS), принцип работы которой представ-
отсутствующего в обучающей выборке Dtrain, алго- лен на рис. 7. В предлагаемом алгоритме входные 
ритм будет относить его к одному из известных клас- данные подаются на нейронную сеть GNG, а выход 
сов. Таким образом, решается задача многоклассовой из нейронной сети обрабатывается при помощи не-
классификации, нам же необходимо решить задачу четкой системы FIS. 
бинарной классификации, т.е. отнесения объекта o к В этом случае нейронная сеть действует как пре-
одному из двух классов: «человек»/«не человек». процессор нечетких выходов, что позволяет привести 

классификатор к бинарному виду. 
Информация о маркерах

Dtrain -1
а)      HOG GNG FIS

+1

 
Рис. 7. Принцип работы предлагаемого алгоритма 

GNG- FIS 

б)      Маркировка выполняется в 2 этапа: на первом 
Рис. 6. Примеры изображений, содержащихся в обучающей этапе используется классический алгоритм, на втором 

и тестирующей выборках: этапе используются нечеткие правила. 
 а) негативные; б) позитивные Первый этап маркировки выглядит следующим 

2.3. Маркировка с использованием нейро-нечеткой образом: 
модели растущего нейронного газа 1. Необходимо создать массив объектов R, размером 

Пусть имеется обученный классификатор F равным количеству классов Nl. Каждый объект R 
GNG, 

относящий объект о, т.е. его признаковое описание x, содержит следующие параметры, характеризую-

к одному из множества Nl классов. Необходимо при- щие состав кластера (класса): 

вести работу классификатора FGNG к решению задачи • npos – количество позитивных образов; 

бинарной (двух классовой) классификации, где один • nneg – количество негативных образов. 

50 Компьютерная оптика, 2017, том 41, №1 



Локализация человека в кадре видеопотока с использованием алгоритма на основе… Амосов О.С., Иванов Ю.С., Жиганов С.В. 

2. Необходимо классифицировать объект o из обу- Алгоритм вывода Мамдани, состоящий из 16 пра-
чающего множества Dtrain с помощью обученной вил, был реализован в системе Matlab. 
сети GNG.  В качестве функции принадлежности использует-

3. Необходимо выбрать объект Rl∈R, где l – полу- ся симметричная гауссовская кривая (gaussmf). 
ченный номер класса из сети GNG. Используя за- Правило вывода для нечёткой маркировки в об-
ранее установленную маркировку из Dtrain, требу- щем виде записывается так: 
ется увеличить один из параметров Rl следующим if hl (npos ) = Th (hl )&ml (npos ) = Tm (ml ) &
образом: 
• если образ негативный – увеличиваем значение &hl (nneg ) = Th (hl )&ml (nneg ) = Tm (ml ),  (7) 

nneg на 1; then ql = Tq .
• если образ позитивный – увеличиваем значе-

ние npos на 1. В результате работы алгоритма нечеткой марки-

После завершения 1-го этапа маркировки сле- ровки «положительные» и «сомнительные» кластеры 

дующие классы маркируются как негативные, если: маркируются как +1 (позитивные), «отрицатель-
ные» – как –1 (негативные). 

• количество nneg больше, чем npos (nneg > npos); 
Таким образом, результатом работы предложен-

• количество nneg и npos равно (nneg = npos); 
ного алгоритма GNG-FIS является yi∈Y = {–1; +1}. 

• количество nneg равно 1 (npos = 1). 
На 2-м этапе для всех кластеров, удовлетворяю- 2.4. Нечеткая перемаркировка 

щих условию 0 < nneg < npos , необходимо вычислить:  и построение тепловой карты 

• долю позитивных: Нами был проведен промежуточный эксперимент 
h для выявления недостатков предложенного алгорит-

l (npos ) = npos /(npos + nneg )100,  (3) 
ма. Сравнение проводилось с классическими алго-

• долю негативных: 
ритмами: HOG SVM, Viola Jones с классификатором 

hl (nneg ) = nneg /(npos + nneg )100,  (4) fullbody [29]. 
• среднее евклидово расстояние для позитивных Для проведения вычислительного эксперимента 
образов до центра кластера: нами была разработана программа на объектно-
m (n ) ( l ориентированным языке программирования C#, в ко-

l pos = ∑Epos )/npos ,  (5) 
торой были реализованы алгоритмы GNG-FIS.  

• среднее евклидово расстояние для негативных 
Программа была протестирована на компьютере 

образов до центра кластера: 
со следующими характеристиками: ЦПУ – Intel Core 

m (n ) ( l
l neg = ∑Eneg )/nneg .  (6) i5-2500 CPU @ 3.30GHz; ОЗУ – 8 Gb; ОС – Microsoft 

Переход к нечеткой модели доверия к кластерам Windows 10. 
выглядит следующим образом. Для обучения алгоритма GNG-FIS использовались 

Пусть имеются входные переменные hl(npos), следующие параметры:  
hl(nneg), ml(npos), ml(nneg) и выход q, характеризующий 1. Гистограмма направленных градиентов: размер 
степень доверия к кластерам. Введем терм- ячейки 16×16, размер блока 32×32, шаг сдвига 
множества: блока 16×16, размер изображения 64×128. 
1. Th(hl) = {маленькая, средняя, большая} – для доли 2. Растущий нейронный газ: εξ = 0,2, εξ = 0,006, 

позитивных/негативных образов,  α = 0,5, λ  = 100, β = 0,995, τ = 6000, agemax = 50. 
2. Tm(ml) = {маленькая, средняя, большая}  – для Результаты проведенного промежуточного экспе-

среднего евклидового расстояния образов до цен- римента (табл. 1) на описанной ранее выборке Dtest 
тра кластеров. показывают высокий уровень ошибки 2-го рода, что 

3. Tw = {положительный, сомнительный, отрицатель- обуславливает необходимость модификации предло-
ный} – для выхода q.  женного алгоритма.  

Табл. 1. Результаты эксперимента, Dtest – 3000 тестирующих образов 

Название Количество не распознанных Количество ложных распознаваний Общая Время Время 
метода (ошибка 2-го рода) (ошибка 1-го рода) ошибка обработки обучения 

HOG SVM 481 93 19,13 % 1 мс 3–5 часов 
Viola–Jones 1119 91 40,33 % 24 мс 3–5 дней 
GNG-FIS 149 123 9,06 % 10 мс 5 часов 
Для повышения качества работы алгоритма нами щего множества Dtest до 2100, с шагом 100 образов. В 

предлагается использование двухпроходного обуче- качестве критерия сравнения использовалось значе-
ния с дополнительной перемаркировкой, т.е измене- ние процента общей ошибки каждого из алгоритмов, 
нием метки класса.  причем допустимым колебанием можно считать зна-

Процесс последующей перемаркировки предпола- чение, не превышающее 0,5 %. 
гает наличие отдельного подкрепляющего множества Для выборки Dtest размером 2100/2400/2700 обра-
Dsupport. зов значения процентов общей ошибки по результа-

Была проведена серия дополнительных экспери- там тестирования следующие: 
ментов с последовательным уменьшением тестирую- •  HOG SVM – 19,05 / 19,33 / 18,81; 

Компьютерная оптика, 2017, том 41, №1 51 



Локализация человека в кадре видеопотока с использованием алгоритма на основе… Амосов О.С., Иванов Ю.С., Жиганов С.В. 

•  Viola–Jones – 40,29 / 40,17 / 9,96; • На вход GNG подается изображение из под-
• GNG-FIS – 8,95 / 9,46 / 9,22. крепляющего множества Dsupport, на выходе будет 
Таким образом, уменьшение тестирующей выбор- получен номер класса l, к которому относится 

ки на 900 изображениях является допустимым и по- изображение. Выбираем из массива объект с по-
зволяет сформировать подкрепляющее множество лученным номером класса Rl. 
Dsupport, которое будет использовано для корректиров- • Если объект из Dsupport не содержит человека и 
ки работы алгоритма.  евклидово расстояние от объекта до центра кла-

Тогда, в отличие от классического подхода к по- стера «маленькое», а класс маркирован как поло-
строению обучающей и тестирующей выборки, нами жительный, то класс маркируется как негативный 
предлагается сформировать подкрепляющую выбор- (не содержит человека). 
ку Dsupport путем случайного разбиения обучающего В табл. 2 представлены результаты сравнения ал-
множества D на 3 части (D  

train /  
 Dtest / Dsupport) в пропор- горитмов HOG SVM, Viola-Jones, GNG-FIS и GNG-

циях 50 % / 35 %
 / 15 %. FIS с использованием двухпроходной перемаркиров-

В случае появления ошибок 1-го или 2-го рода ки. Эксперимент проводился на тестирующей выбор-
классы должны быть перемаркированы по правилам: ке 2100 образов (0,35 % от множества D).  

Табл. 2. Результаты эксперимента, Dtest – 2100 тестирующих образов 

Количество не распознанных Количество ложных распознаваний Общая 
Название метода 

(ошибка 2-го рода) (ошибка 1-го рода) ошибка 
HOG SVM 358 42 19,05 
Viola–Jones 801 45 40,29 
GNG-FIS 76 112 8,95 
GNG-FIS с использованием 

120 52 8,19 
двухпроходной перемаркировки 

Применение двухпроходной перемаркировки не- Алгоритм построения таких карт сводится к сле-
сколько увеличивает ошибку 2-го рода, но за счёт дующему: 
снижения количества ложных срабатываний (ошибки 1) Пусть I(width, height) – изображение. 
1-го рода) общая эффективность алгоритма увеличи- 2) Создается пустая матрица весов G размером 

вается.  width×height. 

Принцип работы предлагаемого модифицирован- 3) Выбирается коэффициент масштаба тепловой кар-

ного алгоритма GNG-FIS с использованием двухпро- ты d. 

ходной перемаркировки представлен на рис. 8. 4) На каждом шаге сканирования, количество кото-
рых зависит от размера изображения: 

Информация о маркерах а) При прохождении сканирующего окна Cr раз-
мером wc×hc, по изображению I: 

FIS • если окно отнесено к положительному 
Dtrain классу, в матрице G выделяется область Q, 

Марки-
ровка соответствующая координатам и размеру 

-1
окна Cr на изображении I. Значения всех Q 

HOG GNG
элементов увеличиваются на d; 

+1
• если окно отнесено к отрицательному клас-

Пере-
Dsupport марки- су, в матрице G выделяется область Q, со-

ровка ответствующая координатам и размеру ок-
на Cr на изображении I. Значения всех Q 

Информация о маркерах элементов уменьшаются на d. 
 

Рис. 8. Принцип работы модифицированного алгоритма б) После завершения работы сканирующего окна 
GNG-FIS с использованием двухпроходной перемаркировки области с высокими значениями характеризуют 

позитивные классы, а области с отрицательны-
Так как работа алгоритма подразумевает исполь-

ми значениями характеризуют негативные. 
зование «сканирующего окна» с настраиваемым ша-

На рис. 9 представлена матрица G, а также ее ви-
гом сканирования и изменяющимся масштабом при 

зуализация в виде поверхности и карты уровней. 
многократных итерациях, то возникает эффект пере-

Таким образом, если количество негативных сра-
крывающихся областей. То есть при прохождении 

батываний в области больше позитивных, то вероят-
окна возможна многократная классификация, когда 

ность отнесения ее к позитивному классу снижается. 
один и тот же объект будет распознан классификато-

Применение такого подхода позволяет бороться с 
ром с небольшими сдвигами.  

эффектом «единичных выбросов», т.е. единичных 
Такой эффект позволяет построить «тепловые 

ошибочных срабатываний классификатора. При на-
карты» классификации. Подобный подход применя-

ложении матрицы G на изображение I мы получаем 
ется во многих задачах, в том числе и для локализа-

тепловую карту, представленную на рис. 10. 
ции пешеходов [40].  

52 Компьютерная оптика, 2017, том 41, №1 



Локализация человека в кадре видеопотока с использованием алгоритма на основе… Амосов О.С., Иванов Ю.С., Жиганов С.В. 

Существенным отличием второго эксперимента 
30 является источник изображений для тестирования – 
20 видеокамеры действующей системы видеонаблюде-
10 ния Университета. 
0

-10 Видеопоток, получаемый с камеры 1 (рис. 11а), об-
-20 ладает следующими параметрами: угол наклона ~45°, 
-30

а)  б)  уровень освещения – 300 Лк (утро), разрешение – 
Рис. 9. Визуализация матрицы G 640×480 пикселей, помещение (длинный коридор).  

Видеопоток, получаемый с камеры 2 (рис. 11б), об-
ладает следующими параметрами: угол наклона ~60°, 
уровень освещения – 250 Лк (день), помещение (узкий 
оживленный холл), разрешение – 640×480 пикселей.  

Видеопоток, получаемый с камеры 3 (рис. 11в), об-
   ладает следующими параметрами: угол наклона ~35°, 

Рис. 10. Визуализация «тепловой карты» уровень освещения – более 1000 Лк (пасмурный день), 
Применение настраиваемого порогового фильтра улица (вход и тротуар), разрешение – 640×480 пикселей. 

позволяет выбрать области с наибольшей вероятно- Для экспериментов были вручную промаркирова-
стью нахождения в ней человека. ны видеопоследовательности продолжительностью 

Тогда конечным результатом работы предложен- по 5 минут с частотой кадров (Frame Per Second, FPS) 
ного модифицированного нейро-нечеткого алгоритма 30 кадров/с.  

расширяющегося нейронного газа является список 
прямоугольников, в которых присутствует локализи-
руемый объект – человек rectangleη.  

3. Эксперимент с перемаркировкой на данных, 
полученных с камер видеонаблюдения    

Рис. 11. Видеокамеры действующей системы 
Разработанная нами программа была доработана с видеонаблюдения Университета: а) камера 1, длинный 

учетом предложенных модификаций.  коридор; б) камера 2, узкий оживленный холл; в) камера 3, 
При обучении используется выборка, полученная улица (вход и тротуар) 

случайным разбиением первоначального набора дан- Сравнение классификаторов выполнялось путем 
ных на 3 части: построения ROC-кривых с вычислением показателя 

• Dtrain – содержит 3000 изображений; AUC, характеризующего качество классификации.  
• Dtest– содержит 2100 изображений; В табл. 3 и на рис. 12 приведены результаты сравне-
• Dsupport – содержит 900 изображений. ния алгоритмов: Viola–Jones, HOG-SVM, GNG-FIS без 
Параметры обучения не изменялись. маркировки, GNG-FIS с перемаркировкой для камеры 1. 

Табл. 3. Результаты второго эксперимента на видеопотоке с камеры наблюдения 1 

Количество верных Количество ложных локализаций Процент правильных 
Название метода 

локализаций (ошибка 1-го рода) локализаций (AUC) 
HOG SVM 66 35 92,3 % 
Viola–Jones 56 17 82,9 % 
GNG-FIS 66 20 87,5 % 
GNG-FIS с применением 
двухпроходного обучения и  66 11 93,2 % 
построением тепловой карты 

          
Рис. 12. ROC-кривые для камеры 1: а) HOG SVM, б) Viola–Jones, в) GNGFIS, г) GNGFIS  

(с двухпроходным обучением и тепловой картой) 

Компьютерная оптика, 2017, том 41, №1 53 



Локализация человека в кадре видеопотока с использованием алгоритма на основе… Амосов О.С., Иванов Ю.С., Жиганов С.В. 

Следует отметить, что при попадании в поле зре-
ния камеры каждый объект (человек) должен детек-
тироваться на каждом кадре. При этом в колонках 
«количество верных локализаций» и «количество 
ложных локализаций» указано количество человек и 
количество ложных объектов, локализованных хотя 
бы один раз.  

На рис. 13 показана работа тестируемых алгорит-
мов и возникающие ошибки.  

4. Обсуждение результатов экспериментов 

Проверка алгоритма осуществляется как на от-
крытых контрольных наборах изображений, так и на 
реальной задаче охранного видеонаблюдения при 
сложных условиях.  

Как показывает практика, особый интерес вызы-
вают именно экспериментальные данные, получен-
ные на действующих камерах, а не на синтезирован-
ных выборках данных, пригодных для обучения и 
предварительного контроля. Важно отметить, что во 
втором вычислительном эксперименте в одном кадре 
могло присутствовать одновременно несколько чело-
век, что не влияло на качество и скорость работы ал-
горитмов, так как в основе всех рассмотренных под-
ходов лежит принцип сканирующего окна.  

Применение «тепловой карты» снижает количест-
во ложных срабатываний, что видно из форм ROC-
кривых (кривая смещается влево или вверх под влия-

 
нием ошибок того или иного рода), приведенных на 

Рис. 13. Работа тестируемых алгоритмов 
рис. 12. 

Табл. 4. Результаты сравнения всех классификаторов для 3 камер 

Процент правильных лока- Процент правильных лока- Процент правильных лока-
Название метода 

лизаций на камере 1 (AUC) лизаций на камере 2 (AUC) лизаций на камере 3 (AUC) 
HOG SVM 92,3 % 91,1 % 93,1 % 
Viola–Jones 82,9 % 81,5 % 85,5 % 
GNG-FIS 87,5 % 86,7 % 81,7 % 
GNG-FIS с применением 
двухпроходного обучения и 93,2 % 92,2 % 90,5 % 
построением тепловой карты 

Анализируя табл. 4 и рис. 13, можно утверждать, • высокий процент распознавания за счет сни-
что классические методы мало устойчивы к возмож- жения количества ложных срабатываний 
ным перекрытиям объектов на изображении и пока- (ошибки 1-го рода); 
зывают большую ошибку в помещениях с малой • возможность адаптивной корректировки ре-
площадью (рис. 13в). Предлагаемый нами алгоритм зультатов кластеризации, что позволяет про-
показывает более высокий процент правильных лока- вести более «тонкую» настройку алгоритма; 
лизаций для внутренних камер (рис. 13а–в) и чуть • высокая скорость обучения алгоритма. 
меньший процент на изображениях, полученных с Однако для предложенного алгоритма остается 
уличных камер видеонаблюдения, в особенности для трудность при подборе параметров обучения. 
удаленных объектов (рис. 13д). Однако этот алгоритм 

Заключение 
обладает возможностью «тонкой» подстройки, что 
позволит адаптировать его под конкретные условия В настоящей статье решена задача локализации 

съемки. человека в кадре видеопотока с помощью расши-

Кроме того, рис. 13 демонстрирует применения ряющегося нейронного газа, нечеткого вывода и при-

тепловой карты (множественной классификации) для знакового описания на основе гистограмм ориенти-

снижения ошибок 1-го рода. рованных градиентов.  

Результаты доказывают, что предложенный алго- Научная новизна состоит в применении комбини-

ритм с модификацией имеет следующие преимущест- рованного алгоритма на основе растущего нейронно-

ва перед классическими алгоритмами: го газа и нечеткого вывода для обучения с подкреп-
лением в задаче локализации человека в видеопотоке. 

54 Компьютерная оптика, 2017, том 41, №1 



Локализация человека в кадре видеопотока с использованием алгоритма на основе… Амосов О.С., Иванов Ю.С., Жиганов С.В. 

Новым в алгоритме является применение двухпро- 10. Казаков, А. Быстрый алгоритм обнаружения пешехо-
ходного обучения и последующей перемаркировкой дов по видеоданным / А. Казаков, А. Бовырин // 

классов, осуществляемой блоком нечеткого вывода. Proceedings of the 22nd International Conference on 

Классические алгоритмы настроены на высокий Computer Graphics and Vision. – 2012. – С. 144-148. 
11. Cho, H. Real-time pedestrian detection with deformable part 

порог срабатывания, что приводит к пропуску объек-
models / H. Cho, P.E. Rybski, A. Bar-Hillel, W. Zhang // Intelli-

тов. В отличие от известных алгоритмов локализации gent Vehicles Symposium (IV), 2012 IEEE, Alcala de Henares. – 
человека в кадре видеопотока, предлагаемый подход 2012. – P. 1035-1042. – DOI: 10.1109/IVS.2012.6232264. 
ориентирован на ситуационную видеоаналитику, в 12. Hua, Ch. Pedestrian detection by using spatio temporal his-
которой главное – не пропустить тревожное событие.  togram of oriented gradients / Ch. Hua, Y. Makihara, 

По сравнению с классическими алгоритмами Y. Yagi // IEICE Transactions on Information and Systems. 
предлагаемый модифицированный подход устойчив к – 2013. – Vol. E96-D(6). – P. 1376-1386. – DOI: 

ошибкам 2-го рода, обладает высокой скоростью обу- 10.1587/transinf.E96.D.1376. 

чения, а также обладает возможностями адаптивной 13. Vapnik, V.N. An overview of statistical learning theory / 
V.N. Vapnik // IEEE Transactions on Neural Networks. – 1999. 

настройки за счет корректировки правил. 
– Vol. 10(5). – P. 988-999. – DOI: 10.1109/72.788640. 

Таким образом, указанные преимущества позво- 14. Воронцов,  К.В.  Математические методы обучения 
ляют применять предложенный алгоритм в реальных по прецедентам (теория обучения машин) [Элек-
системах локализации образов, что подтверждается тронный  ресурс] / К.В. Воронцов.  – 2011. – URL: 
результатами экспериментов. http://www.machinelearning.ru/wiki/images/6/6d/Voron-

ML-1.pdf (дата обращения 21.10.16).  
Благодарности 15. Cireşan, D. Multi-column deep neural networks for image 

Работа выполнена при поддержке Минобрнауки classification / D. Cireşan, U. Meier, J. Schmidhuber // Pro-
России научного проекта – госзадания в рамках про- ceedings of IEEE Conference on Computer Vision and Pat-

ектной части № 2.1898.2017/ПЧ «Создание математи- tern Recognition. – 2012. – P. 3642-3649. – DOI: 

ческого и алгоритмического обеспечения интеллекту- 10.1109/CVPR.2012.6248110.  
16. Cireşan, D. Flexible, high performance convolutional neu-

альной информационно-телекоммуникационной сис-
ral networks for image classification / D. Cireşan, U. Meier, 

темы безопасности вуза». J. Masci, L.M. Gambardella, J. Schmidhuber // Proceedings 

Литература of the Twenty-Second International Joint Conference on Ar-
tificial Intelligence. – 2011. – Vol. 2. – P. 1237-1242. – 

1. Амосов, О.С. Модифицированный алгоритм локализа- DOI: 10.5591/978-1-57735-516-8/IJCAI11-210. 
ции номерных знаков транспортных средств на основе 17. Karungaru, S.G. Face recognition in colour images using 
метода Виолы-Джонса / О.С. Амосов, Ю.С. Иванов // neural networks and genetic algorithms / S.G. Karungaru, 
Информатика и системы управления. – 2014. – Т. 39, M. Fukumi, N. Akamatsu // International Journal of Compu-
№ 1. – С. 127-140.  tational Intelligence and Applications. – 2005. – Vol. 5(1). – 

2. Мельников, И.И. Детектор движения на основе им- P. 55-67. – DOI: 10.1142/S1469026805001477. 
пульсных нейронных сетей / И.И. Мельников, К.А. Де- 18. Солдатова, О.П. Применение свёрточной нейронной 
миденков, И.А. Емельянов, И.А. Евсеенко // Информа- сети для распознавания рукописных цифр / О.П. Сол-
ционные технологии. – 2013. – № 7. – С. 57-60.  датова, А.А. Гаршин // Компьютерная оптика. – 2010. – 

3. Viola, P. Robust real-time face detection / P. Viola, M.J. Jones // Т. 34, № 2. – С. 252-259. 
International Journal of Computer Vision. – 2004. – Vol. 57(2). – 19. Verma, A. Pedestrian detection via mixture of CNN experts 
P. 137-154. – DOI: 10.1023/B:VISI.0000013087.49260.fb. and thresholded aggregated channel features / A. Verma, 

4. Минаев, Е.Ю. Детектирование и распознавание объектов R. Hebbalaguppe, L. Vig, S. Kumar, E. Hassan // Proceed-
в системах автомобильной безопасности на основе фрак- ings of the 2015 IEEE International Conference on Com-
тального анализа / Е.Ю. Минаев, А.В. Никоноров // Ком- puter Vision Workshop (ICCVW '15), Santiago. – 2015. – 
пьютерная оптика. – 2012. – Т. 36, № 1. – С. 124-130.  P. 555-563. – DOI: 10.1109/ICCVW.2015.78. 

5. Viola, P. Detecting Pedestrians Using Patterns of Motion 20. Ouyang, W. Joint Deep Learning for Pedestrian Detection / 
and Appearance / P. Viola, M.J. Jones, D. Snow // Interna- W. Ouyang, X. Wang // Proceedings of the 2013 IEEE In-
tional Journal of Computer Vision. – 2005. – Vol. 63(2). – ternational Conference on Computer Vision. – 2013. – 
P. 153-161. – DOI: 10.1007/s11263-005-6644-8. P. 2056-2063. – DOI: 10.1109/ICCV.2013.257. 

6. Enzweiler, M. Monocular Pedestrian Detection: Survey and Ex- 21. Хайкин, С. Нейронные сети: Полный курс: Пер. с англ.  
periments / M. Enzweiler, G.M. Dariu // IEEE Transactions on / С. Хайкин.; пер. с англ.  – М.: Вильямс, 2008. – 1103 
Pattern Analysis and Machine Intelligence. – 2009. Vol. 31(12). – с. – ISBN: 5-8459-0890-6. 
P. 2179-2195. – DOI: 10.1109/TPAMI.2008.260. 22. Кохонен, Т. Самоорганизующиеся карты / Т. Кохонен; 

7. Dalal, N. Histograms of oriented gradients for human detec- пер. с англ. – М.: БИНОМ. Лаборатория знаний, 2008. – 
tion / N. Dalal, B. Triggs // IEEE Computer Society Confer- 655 с. – ISBN: 5-94774-352-3. 
ence on Computer Vision and Pattern Recognition. – 2005. 23.  Уоссермен, Ф. Нейрокомпьютерная техника: Теория 
– P. 886-893. – DOI: 10.1109/CVPR.2005.177. и практика / Ф. Уоссермен; пер. с англ. – М. : Мир.  

8. Cristianini, N. An introduction to support Vector Machines 1992. – 240 с.  
and other kernel-based learning methods / N. Cristianini,  24. Martinetz, T.M. "Neural-gas" network for vector quantiza-
J. Shawe-Taylor. – Cambridge: Cambridge University tion and its application to time series prediction / 
Press, 2000. – P. 204. – ISBN: 978-0521780193. T.M. Martinetz, S.G. Berkovich, K.J. Schulten // IEEE 

9. Лекции по методу опорных векторов [Электронный ре- Transactions on Neural Networks. – 1993. – Vol. 4(4). – 
сурс] / К.В. Воронцов. – URL: http://www.ccas.ru/vo- P. 558-569. –DOI: 10.1109/72.238311. 
ron/download/SVM.pdf (дата обращения 10.06.2016). 

Компьютерная оптика, 2017, том 41, №1 55 



Локализация человека в кадре видеопотока с использованием алгоритма на основе… Амосов О.С., Иванов Ю.С., Жиганов С.В. 

25. Fawcett, T. An introduction to ROC analysis / T. Fawcett // 33. Муравьёв, А.С. Модифицированный алгоритм расту-
Pattern Recognition Letters – Special Issue: ROC Analysis щего нейронного газа применительно к задаче класси-
in Pattern Recognition. – 2006. – Vol. 27(8). – P. 861-874. фикации / А.С. Муравьёв, А.А. Белоусов // Вестник 
– DOI: 10.1016/j.patrec.2005.10.010.  науки Сибири. – 2014. – Т. 14, № 4. – С. 105-111. 

26. Goto, Y. CS-HOG: Color similarity-based HOG / Yuhi Goto, 34. Айвазян, С.А. Прикладная статистика: Классификация и 
Y. Yamauchi, H. Fujiyoshi // Proceedings of 19th Korea-Japan снижение размерности / С.А. Айвазян, В.М. Бухштабер, 
Joint Workshop on Frontiers of Computer Vision. – 2013. – И.С. Енюков, Л.Д. Мешалкин. – М.: Финансы и статисти-
P. 266-271. – DOI: 10.1109/FCV.2013.6485502.  ка, 1989. – 607 с. – ISBN: 5-279-00054-X. 

27. Agoston, M.K. Computer graphics and geometric model- 35. INRIA Person Dataset [Электронный ресурс]. – URL: 
ing: Implementation and algorithms // M.K. Agoston. – http://pascal.inrialpes.fr/data/human/ (дата обращения 
London: Springer, 2005. – P. 300-306. – ISBN: 978-1- 10.07.2016). 
85233-818-3. – DOI: 10.1007/b138805. 36. Caltech Pedestrian Detection Benchmark [Электронный 

28. Pizer, S.M. Adaptive histogram equalization and its varia- ресурс]. – URL: http://www.vision.caltech.edu/Image_Da-
tions / S.M. Pizer, E.P. Amburn, J.D. Austin, R. Cromartie, tasets/CaltechPedestrians/ (дата обращения 10.07.2016). 
A. Geselowitz, T. Greer, B.T.H. Romeny, J.B. Zimmerman 37. Amosov, O.S. High-speed neurofuzzy algorithms for filter-
// Computer Vision, Graphics, and Image Processing. – ing the mobile object trajectory parameters / O.S. Amosov, 
1987. – Vol. 39(3). – P. 355-368. – DOI: 10.1016/S0734- E.A. Malashevskaya, S.G. Baena // 23rd Saint Petersburg 
189X(87)80186-X. International Conference on Integrated Navigation Systems, 

29. Библиотека компьютерного зрения OpenCV [Электрон- ICINS 2016. – 2016. – P. 389-392. 
ный ресурс]. – URL: http://docs.opencv.org/ (дата обра- 38. Park, Y.M. A self-organizing fuzzy logic controller for dy-
щения: 10.07.2016).  namic systems using a fuzzy auto-regressive moving aver-

30. Beyer, O. Online semi-supervised growing neural gas / O. Beyer, age model / Y.M. Park, U.C. Moon, K.Y. Lee // IEEE 
Ph. Cimiano // International Journal of Neural Systems. – 2012. – Transactions on Fuzzy Systems. – 1995. – Vol. 3(1). – 
P. 425-435. – DOI: 10.1142/S0129065712500232. P. 75-82. – DOI: 10.1109/91.366563. 

31. Qin, A.K. Robust growing neural gas algorithm with appli- 39. Jang, J.-S.R. ANFIS: adaptive-network-based fuzzy infer-
cation in cluster analysis / A.K. Qin, P.K. Suganthan // Neu- ence system / J.-S.R. Jang // IEEE Transactions on Systems, 
ral Networks. – 2004. – Vol. 17(8). – P. 1135-1148. – DOI: Man and Cybernetics. – 1993. – Vol. 23(3) – P. 665-685. – 
10.1016/j.neunet.2004.06.013. DOI: 10.1109/21.256541. 

32. Beyer, O. Online labelling strategies for growing neural gas / 40. Dollar P. Pedestrian detection: An evaluation of the state of the 
O. Beyer, P. Cimiano // Proceedings of 12th International Con- art / P. Dollar, C. Wojek, B. Schiele, P. Perona // IEEE Transac-
ference on Intelligent Data Engineering and Automated Learning. tions on Pattern Analysis and Machine Intelligence. – 2012. – 
– 2011. – P. 76-83. – DOI: 10.1007/978-3-642-23878-9_10. Vol. 34(4). – P. 743-761. – DOI: 10.1109/TPAMI.2011.155. 

 

 

Сведения об авторах 

Амосов Олег Семенович, 1957 года рождения, доктор технических наук, профессор, работает заведующим кафед-
рой промышленной электроники в ФГБОУ ВО «Комсомольский-на-Амуре государственный технический универси-
тет». Область научных интересов: фильтрация и оценивание состояния стохастических систем, оптимальное управле-
ние, искусственные нейронные сети, нечеткие системы, навигация и управление движением. E-mail: osa18@yandex.ru . 

 
Иванов Юрий Сергеевич, 1987 года рождения, кандидат технических наук, работает доцентом кафедры про-

мышленной электроники в ФГБОУ ВО «Комсомольский-на-Амуре государственный технический университет». 
Область научных интересов: программирование, распознавание образов, машинное обучение, электроника, не-
четкие системы, искусственные нейронные сети, E-mail: ivanov_ys@garmvis.ru . 

 
Жиганов Сергей Викторович, 1991 года рождения, в 2012 году окончил ФГБОУ ВО «Комсомольский-на-

Амуре государственный технический университет» по магистерской программе подготовки 231000 «Програм-
мная инженерия», работает системным администратором ИТ-управления ФГБОУ ВО «Комсомольский-на-Амуре 
государственный технический университет». Область научных интересов: программирование, проектирование 
программного обеспечения, машинное обучение, искусственные нейронные сети, распознование образов, нечет-
кие системы. E-mail: id_zero@list.ru . 
 

 

ГРНТИ: 28.23.15 
Поступила в редакцию 21 июля 2016 г. Окончательный вариант – 20 января 2017 г. 

 

 

HUMAN LOCALIZATION IN VIDEO FRAMES 
USING A GROWING NEURAL GAS ALGORITHM AND FUZZY INFERENCE 

O.S. Amosov 1, Y.S. Ivanov 1, S.V. Zhiganov 1 
1 Komsomolsk-on-Amur State Technical University, Komsomolsk-on-Amur, Russia 

Abstract 

A problem of human body localization in video frames using growing neural gas and feature 
description based on the Histograms of Oriented Gradients is solved. The original neuro-fuzzy 

56 Компьютерная оптика, 2017, том 41, №1 



Локализация человека в кадре видеопотока с использованием алгоритма на основе… Амосов О.С., Иванов Ю.С., Жиганов С.В. 

model of growing neural gas for reinforcement learning (GNG-FIS) is used as a basis of the algo-
rithm. A modification of the GNG-FIS algorithm using a two-pass training with fuzzy remarking 
of classes and building of a heat map is also proposed. 

As follows from the experiments, the index of the correct localizations of the developed classi-
fier from 90.5% to 93.2%, depending on the conditions of the scene, that allows the use of the al-
gorithm in real systems of situational video analytics.  

Keywords: human localization, growing neural gas, clustering, fuzzy inference. 
Citation: Amosov OS, Ivanov YS, Zhiganov SV. Human localiztion in video frames using a 

growing neural gas algorithm and fuzzy inference. Computer Optics 2017; 41(1): 46-58. DOI: 
10.18287/2412-6179-2017-41-1-46-58. 

Acknowledgements: The work was supported by the Russian Ministry of Education re-search 
project - state task in the framework of the project № 2.1898.2017 / PCH "Creating Mathematical 
and algorithmic support of intellectual information and telecommunication high school security". 

 

   

References [15] Cireşan D, Meier U, Schmidhuber J. Multi-column deep 

[1] Amosov OS, Ivanov YS. Modified algorithm of localiza- neural networks for image classification. CVPR '12 2012: 

tion of license plates of vehicles based on the method of 3642-49. DOI: 10.1109/CVPR.2012.6248110. 
[16] Cireşan D, Meier U, Masci J, Gambardella L, Schmid-

Viola-Jones [in Russian]. Informatics and Control Systems 
2014; 39(1); 127-140.  huber J. Flexible, high performance convolutional neural 

[2] Melnikov II, Demidenko SV, Evseenko IA, Emelyanov networks for image classification. In: Proceedings of the 
Twenty-Second International Joint Conference on Artifi-

IA. Motion detection based on pulsed neural networks [In 
Russian]. Information Technology 2013; 7: 57-60.  cial Intelligence (IJCAI '11) 2011; 2: 1237-1242. DOI: 

[3] Viola P, Jones M. Robust real-time face detection. Interna- 10.5591/978-1-57735-516-8/IJCAI11-210.  
[17] Karungaru SG, Fukumi M, Akamatsu N. Face recognition 

tional Journal of Computer Vision 2004; 57(2): 137-154. 
DOI: 10.1023/B:VISI.0000013087.49260.fb. in colour images using neural networks and genetic algo-

[4] Minaev EY, Nikonorov AV. Object detection and recogni- rithms. International Journal of Computational Intelligence 

tion in the driver assistace system based on the fractal analy- and Applications 2005; 5(1); 55-67; DOI: 
10.1142/S1469026805001477.  

sis [in Russian]. Computer Optics 2012; 36(1): 124-130. 
[5] Viola P, Jones MJ, Snow D. Detecting Pedestrians Using [18] Soldatova OP, Garshin AA. Convolutional neural network 

Patterns of Motion and Appearance. Int J Comput Vision applied to handwritten digits recognition [In Russian]. 
Computer Optics 2010; 34(2): 252-259. 

2005; 63(2): 153-161. DOI: 10.1007/s11263-005-6644-8. 
[6] Enzweiler M, Dariu MG. Monocular Pedestrian Detection: [19] Verma A, Hebbalaguppe R, Vig L, Kumar S, Hassan E. 

Survey and Experiments. IEEE Transactions on Pattern Pedestrian detection via mixture of CNN experts and 
thresholded aggregated channel features. ICCVW '15 

Analysis and Machine Intelligence, 2009; 31(12): 2179-
2195. DOI: 10.1109/TPAMI.2008.260. 2015: 555-563. DOI: 10.1109/ICCVW.2015.78.  

[7] Dalal N, Triggs B. Histograms of oriented gradients for [20] Ouyang W, Wang X. Joint deep learning for pedestrian de-

human detection. IEEE Computer Society Conference on tection. ICCV '13 2013: 2056-2063. DOI: 
10.1109/ICCV.2013.257. 

Computer Vision and Pattern Recognition 2005: 886-893. 
DOI: 10.1109/CVPR.2005.177. [21] Haykin S. Neural Networks: A Comprehensive Founda-

[8] Cristianini N, Shawe-Taylor J. An introduction to support tion. Upper Saddle River, NJ, USA: Prentice Hall PTR; 
1998. ISBN: 0132733501.  

Vector Machines and other kernel-based learning methods. 
Cambridge: Cambridge University Press; 2000. ISBN: [22] Kohonen T. Self-organizing maps. Berlin, Heidelberg: 

978-0521780193. Springer-Verlag; 2001. ISBN: 978-3-540-67921-9. 

[9] [23] Wasserman PD. Neural computing: theory and practice. 
Lectures on the method of support vector machine [In Russian]. 
Source: <http://www.ccas.ru/voron/download/SVM.pdf>. New York, NY, USA: Van Nostrand Reinhold Co.; 1989. 

[10] Kazakov A, Bovyrin A. Fast algorithm for the detection of ISBN:0-442-20743-3. 

pedestrians on the video data [in Russian]. The 22nd Inter- [24] Martinetz TM, Berkovich SG, Schulten KJ. "Neural-gas" 
network for vector quantization and its application to time 

national Conference on Computer Graphics and Vision 
2012; 144-148.  series prediction. IEEE Transactions on Neural Networks 

[11] Cho H, Rybski PE, Bar-Hillel A and Zhang W. Real-time 1993; 4(4): 558-569. DOI: 10.1109/72.238311.  
[25] Fawcett T. An introduction to ROC analysis. Pattern Rec-

pedestrian detection with deformable part models. Intelli-
gent Vehicles Symposium (IV), 2012 IEEE, Alcala de He- ognition Letters – Special issue: ROC analysis in pattern 

nares 2012: 1035-1042. DOI: 10.1109/IVS.2012.6232264.  recognition 2006; 27(8): 861-874. DOI: 

[12] 10.1016/j.patrec.2005.10.010.  
Hua С, Makihara Y, Yagi Y. Pedestrian detection by using 
spatio temporal histogram of oriented gradients. IEICE [26] Goto Y, Yamauchi Y, Fujiyoshi H. CS-HOG: Color simi-

Transactions on Information and Systems 2013; E96-D(6): larity-based HOG. FCV 2013: 266-271. DOI: 
10.1109/FCV.2013.6485502.  

P. 1376-1386. DOI: 10.1587/transinf.E96.D.1376. 
[13] Vapnik VN. An overview of statistical learning theory. [27] Agoston MK. Computer graphics and geometric modeling: 

IEEE Transactions on Neural Networks 1999; 10(5): 988- Implementation and algorithms. London: Springer; 2005. 

999. DOI: 10.1109/72.788640. ISBN: 978-1-85233-818-3. DOI: 10.1007/b138805.  
[28] Pizer SM, Amburn EP, Austin JD, et al. Adaptive histo-

[14] Vorontsov KV. Mathematical methods of training on prec-
edents (machine learning theory) [In Russian]. Source: gram equalization and its variations. Computer Vision, 

<http://www.machinelearning.ru/wiki/images/6/6d/Voron- Graphics, and Image Processing 1987; 39(3); 355-368. 
DOI: 10.1016/S0734-189X(87)80186-X.  

ML-1.pdf>. 

Компьютерная оптика, 2017, том 41, №1 57 



Локализация человека в видеопотоке с использованием алгоритма на основе… Амосов О.С., Иванов Ю.С., Жиганов С.В. 

[29] The image processing library OpenCV. [36] Caltech Pedestrian Detection Benchmark. Source: 
Source:<http://docs.opencv.org/>. <http://www.vision.caltech.edu/Image_Datasets/CaltechPe

[30] Beyer O, Cimiano P. Online semi-supervised growing neu- destrians/ >.  
ral gas. International Journal of Neural Systems 2012; [37] Amosov OS, Malashevskaya EA, Baena SG. High-speed 
22(5): 425-435. DOI: 10.1142/S0129065712500232. neurofuzzy algorithms for filtering the mobile object tra-

[31] Qin AK, Suganthan PK. Robust growing neural gas algorithm jectory parameters. 23rd Saint Petersburg International 
with application in cluster analysis. Neural Networks 2004; Conference on Integrated Navigation Systems, ICINS 
17(8): 1135-1148. DOI: 10.1016/j.neunet.2004.06.013. 2016: 389-392.  

[32] Beyer O, Cimiano P. Online labelling strategies for grow- [38] Park YM, Moon UC, Lee KY. A self-organizing fuzzy 
ing neural gas. IDEAL 2011: 76-83. DOI: 10.1007/978-3- logic controller for dynamic systems using a fuzzy auto-
642-23878-9_10.  regressive moving average model. IEEE Transactions on 

[33] Muravev AS, Belousov AA. Modified algorithm of grow- Fuzzy Systems 1995; 3(1): 75-82. DOI: 
ing neural gas applied to the problem of classification [In 10.1109/91.366563. 
Russian]. Siberia Science Bulletin 2014; 4(14); 105-111. [39] Jang J.-SR. ANFIS: adaptive-network-based fuzzy infer-

[34] Ayvazyan SA, Buchstaber VM, Enyukov IS, Meshalkin ence system. IEEE Transactions on Systems, Man and Cy-
LD. Applied Statistics: Classification and reduction of di- bernetics 1993; 23(3): 665-685. DOI: 10.1109/21.256541.  
mension [In Russian]. Moscow: "Finansy i Statistica" Pub- [40] Dollar P, Wojek C, Schiele B, Perona P. Pedestrian detec-
lisher; 1989.  tion: An evaluation of the state of the art. IEEE PAMI 

[35] INRIA Person Dataset. Source: 2012; 34(4): 743-761. DOI: 10.1109/TPAMI.2011.155. 
<http://pascal.inrialpes.fr/data/human/>.  

 

 

Authors’ information  

Oleg Semenovich Amosov, (b. 1957), doctor of Technical Sciences, professor, working head of Industrial Electron-
ics department in Komsomolsk-on-Amur State Technical University. Research interests: filtering and estimation of the 
state of stochastic systems, optimal control, artificial neural networks, fuzzy systems, navigation and motion control. E-
mail: osa18@yandex.ru . 

 
Yuri Sergeyevich Ivanov, (b. 1987), PhD in Technical Sciences, work assistant professor of Industrial Electronics 

department in Komsomolsk-on-Amur State Technical University. Research interests: programming, pattern recognition, 
machine learning, electronics, fuzzy systems, artificial neural networks. E-mail: ivanov_ys@garmvis.ru . 

 
Sergey Viktorovich Zhiganov, (b. 1991), graduated from Komsomolsk-on-Amur State Technical University for the 

Master's program of training 231000 “Software Engineering” in 2012 year, working a system administrator IT Man-
agement Komsomolsk-on-Amur State Technical University. Research interests: programming, software design, ma-
chine learning, artificial neural networks, recognition of images, fuzzy systems. E-mail: id_zero@list.ru . 
 

 

Received July 21, 2016. The final version – January 20, 2017.  
 

 

58 Компьютерная оптика, 2017, том 41, №1