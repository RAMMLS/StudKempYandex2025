АСТРОФИЗИЧЕСКИЙ БЮЛЛЕТЕНЬ, 2008, том 63, № 2, с. 193–204

УДК 520.36;520.844-17

ОБРАБОТКА ПЗС-НАБЛЮДЕНИЙ СО СКАНИРУЮЩИМ
ИНТЕРФЕРОМЕТРОМ ФАБРИ-ПЕРО. II.

ДОПОЛНИТЕЛЬНЫЕ ПРОЦЕДУРЫ
©c 2008 А. В. Моисеев1, О. В. Егоров2

1Специальная астрофизическая обсерватория, Нижний Архыз, 369167 Россия
2Государственный астрономический институт им. П. К. Штернберга, Москва, 119992 Россия

Поступила в редакцию 12 ноября 2007 г.; принята в печать 20 ноября 2007 г.

Описывается пакет программ, используемых в САО РАН для обработки и анализа данных, по-
лучаемых со сканирующим интерферометром Фабри-Перо. Большинство применяемых алгоритмов
были уже приведены ранее в статье [1]. В данной работе основное внимание уделяется дополнитель-
ным процедурам, необходимым в случае применения сканирующего ИФП высокого спектрального
разрешения: удалению паразитных бликов и измерению дисперсии скоростей ионизованного газа в
галактических и внегалактических объектах.

1. ВВЕДЕНИЕ В САО РАН сканирующий ИФП является со-
ставной частью многорежимного редуктора све-

Сканирующий интерферометр Фабри-Перо тосилы SCORPIO [4] с ПЗС-матрицей в каче-
(ИФП) позволяет детально изучать структуру стве детектора. В отличие от двумерных счетчиков
и кинематику галактик, туманностей и других фотонов, которые в последнее время стали вновь
протяженных объектов. Идея этого метода наблю- использоваться в комбинации с ИФП (см. [5]),
дений достаточно подробно изложена в статьях использование более “медленных” ПЗС требует
[1, 2], там же приведены ссылки на более ранние иных алгоритмов обработки получаемых данных.
работы. Результатом наблюдений является на- Прежде всего это касается проблемы поканальной
бор двумерных интерферограмм, представляющих фотометрической коррекции и вычитания спектра
собой свертку монохроматического изображения ночного неба. Подробно этот вопрос рассматри-
объекта с кривой пропускания ИФП на данном вался в работе [1], где приводятся основные алго-
шаге сканирования. После специальной обработки ритмы, на которых основано программное обеспе-
(коррекции за фазовый сдвиг) из них можно чение, используемое для обработки наблюдений со
собрать “куб данных”. В таком кубе каждому про-
странственному элементу в плоскости детектора SCORPIO в режиме сканирующего ИФП.
сопоставляется индивидуальный спектр. Спек- Согласно базе данных ASPID1), за 2000–
тральный диапазон обычно невелик и составляет 2007 гг. на 6-м телескопе САО РАН в рамках двух
всего 5–50AA, что позволяет изучать, к примеру, десятков наблюдательных программ было полу-
кинематику ионизованного газа по одной-двум чено около 180 кубов данных ИФП, которые уже
эмиссионным линиям. послужили основой для более 30-ти публикаций.
Для обработки данных наблюдений с ИФП Опыт обработки этого наблюдательного материала

требуется соответствующее программное обеспе- позволил усовершенствовать наш пакет программ
чение, заметно отличающееся от используемого и разработать ряд новых полезных процедур
при анализе данных, получаемых со щелевыми анализа данных. Их описанию и посвящается
спектрографами. В работе [1] представлен краткий данная работа. В разделе 2 рассматривается
обзор распространенных систем обработки таких проблема борьбы с бликами, возникающими в
данных. Из появившихся в литературе свежих ра- ИФП высокого разрешения. Задаче наилучшей
бот на эту тему следует отметить статью [3], в аппроксимации профилей эмиссионных линий с
которой предложен ряд новых процедур: адаптиро- целью определения дисперсии скоростей иони-
ванное пространственное бинирование кубов перед зованного газа посвящен раздел 3. Далее, в
построением полей скоростей, алгоритмы поиска разделе 4, кратко описывается пакет программ,
эмиссионных линий и вычитания линий ночного
неба. 1)http://alcor.sao.ru/db/aspid/.

13 АСТРОФИЗИЧЕСКИЙ БЮЛЛЕТЕНЬ том 63 № 2 2008



194 МОИСЕЕВ, ЕГОРОВ

используемый сейчас для обработки наблюдений имелся соблазн использовать IFP501, посколь-
на 6-м телескопе со сканирующим ИФП в составе ку в остальном он обладает хорошими характе-
прибора SCORPIO. ристиками, прежде всего относительно высоким

(для внегалактической астрономии) спектральным
разрешением R ≈ 8300 в линии Hα. Такой при-

2. ВЫЧИТАНИЕ БЛИКОВ бор оказался востребованным на 6-м телескопе
для наблюдений, выполнение которых с IFP235

Сейчас SCORPIO укомплектован двумя ска- невозможно из-за того, что он обеспечивает бо-
нирующими интерферометрами (далее IFP235 и лее низкое спектральное разрешение. Прежде все-
IFP501) с зазором между пластинами, соответ- го это наблюдения туманностей с относительно
ствующим 235 и 501 порядкам интереференции на небольшим (в пределах 100–200 км/c) разбросом
длине волны λ6562.8Å. Подробные характеристи- лучевых скоростей: объектов Хербига-Аро, обла-
ки обоих интерферометров приводятся в статье стей звездообразования в нашей и других
[1]. Установка ИФП в выходном зрачке системы, галактиках и т. п.
между коллиматором и камерой фокального ре- В ряде случаев следы от бликов можно удалить
дуктора, приводит к появлению на изображении на этапе обработки данных, применяя соответству-
паразитных бликов. Блики возникают в результате ющие алгоритмы. Рис. 1 (идея которого почерпнута
переотражения света внутри пластин интерферо- нами из [6, 7]) наглядно иллюстрирует сложную
метра и между ними и ближайшими линзами фо- систему возникающих бликов. Именно, изображе-
кального редуктора, поверхностями узкополосного ние галактики (G) порождает близкие блики E0G
фильтра и т. д. Эта проблема хорошо известна, и E
различные “семейства” бликов описаны в работе 1G, яркость которых составляет 4% и 12% от

яркости объекта. Далее E1G порождает E2G, а тот
[6], а несколько более подробное описание дается — E
в статье [7]. Ввод в пучок IFP235 порождает блики 3G, яркость которых составляет 1.4% и 0.15%
так, что основное изображение и эти блики рас- от яркости G, т. е. уменьшается в геометрической
полагаются симметрично относительно оптической прогрессии, как и должно быть при многократных
оси ИФП. Интенсивность таких бликов (будем на- переотражениях. Эти блики возникают на передней
зывать их, согласно классификации из работ [6, 7], пластине ИФП, до того, как свет пройдет через
“диаметральными бликами”, “D”) составляет око- интерферометр, поэтому они являются монохро-

матическими — их относительная интенсивность
ло 10% от интенсивности основного изображения. в кубе данных не меняется с длиной волны λ.
Обычно в таких случаях рекомендуется наклонить В то же время блик E0G возникает на задней
ИФП к оптической оси системы, чтобы сместить пластине ИФП уже после того, как произошла
блик за пределы поля детектора. Однако из-за кон- интерференция. На интерферограмме изображение
структивных особенностей SCORPIO такой вари- этого блика попадает в область, соответствующую
ант невозможен. Поэтому в процессе наблюдений другим длинам волн. Таким образом, в кубе данных
необходимо располагать изображение объекта в будет наблюдаться сдвиг по λ между спектрами G
стороне от оптической оси, а также следить за тем, и E0G, величина которого зависит от положения
чтобы на него не накладывались блики от звезд изображения на детекторе.
поля. Из-за этого в большинстве случаев полезное
поле зрения SCORPIO уменьшается вдвое. На рис. 1 также отмечены диаметральные бли-

ки, то есть расположенные симметрично относи-
При наблюдениях с IFP501 возникает еще од- тельно оптической оси интерферометра. Изобра-

но семейство бликов — “экспоненциальное” (“E”, жение галактики G и соответствующий ему блик
согласно терминологии из [6, 7]). Эти блики об- DG расположены симметрично относительно оп-
разуются в результате переотражений внутри пла- тической оси, блик E1G порождает вторичный диа-
стин ИФП и создают более серьезную проблему, метральный блик DE1G, а E2G — соответственно
чем диаметральные, поскольку ближайший из них — DE2G и т.д. Блик DG также порождает се-
появляется на расстоянии всего 16′′ от изображе- мейство вторичных экспоненциальных бликов, на
ния объекта и имеет значительную интенсивность рисунке заметен E1DG. Последний переналага-
(около 12% от яркости объекта). Столь интенсив- ется с диаметральным бликом DE0G. Структура
ные блики являются следствием деградации про- диаметрального блика довольно сложна, что хо-
светляющего (антирефлексного) покрытия внеш- рошо заметно на примере блика от яркой звезды
них поверхностей пластин IFP501. К сожалению, фона — DS. Именно, этот блик состоит из двух
стоимость замены пластин (или перенапыление изображений звезды — нормального (интенсивно-
покрытий) в данном случае близка к стоимости стью ∼5% от интенсивности звезды S) и сильно
сборки нового ИФП, которая весьма велика. И расфокусированного, так что изображение звезды
все же до приобретения нового интерферометра превращается в кольцо, суммарная интенсивность

АСТРОФИЗИЧЕСКИЙ БЮЛЛЕТЕНЬ том 63 № 2 2008



ОБРАБОТКА ПЗС-НАБЛЮДЕНИЙ СО СКАНИРУЮЩИМ ИНТЕРФЕРОМЕТРОМ 195

Рис. 1. Примеры бликов в интерферометре IFP501. Наблюдения 30/31.I. 2007 в линии Hα по заявке C. Muñoz-
Tuñón. Галактика II Zw 70 обозначена как “G”, яркая звезда фона — как “S”. Показана сумма всех каналов в
кубе данных. Диаметральные и экспоненциальные блики обозначены как “D” и “E” соответственно. Крестиком
отмечен центр поля зрения.

которого составляет около 10% от интенсив- где семейство экспоненциальных бликов можно
ности S. представить в виде:
Заметим, что далеко не всегда удается обнару-

жить такое большое количество ложных изобра- Ighost(x, y, λ) ≈ f0P̂ I−1
real(x − ∆x0, y − ∆y0, z)

жений, как на рис. 1. Здесь показан предельный
случай наблюдения относительно яркого эмисси- i∑max

онного объекта, чаще удается заметить только са- + fiIreal(x − ∆xi, y − ∆yi, λ). (2)
мые яркие блики (DG, E0G и E1G). Мы столь по- i=1
дробно останавливаемся на картине возникающих
бликов, поскольку считаем, что это поможет поль- Относительная яркость бликов fi убывает в гео-
зователям прибора ориентироваться в полученных метрической прогрессии с ростом числа отражений
данных и отличать реальные эмиссионные детали i, поэтому суммирование ведется не до бесконеч-
от бликов. ности, а до imax = 3 − 5, вклад бликов более вы-
Если идеальный (без бликов) куб данных обо- соких порядков обычно незначителен. По этой же

значить как Ireal, то приведенный в шкалу длин
причине не учитывается вклад вторичных бликов,

волн наблюдаемый куб выглядит как таких как немонохроматические сателлиты бликов
монохроматического семейства. Первое слагаемое
вo (2) описывает блик E0G, смещенный по шкале

Iobs(x, y, λ) = Ireal(x, y, λ) + Ighost(x, y, λ), (1) длин волн. Здесь P̂ обозначает операцию “фазовой

АСТРОФИЗИЧЕСКИЙ БЮЛЛЕТЕНЬ том 63 № 2 2008 13*



196 МОИСЕЕВ, ЕГОРОВ

коррекции”, т. е. переход от спектров в шкале с целью компенсации значительных (более 10–
номеров каналов ИФП z к шкале длин волн: 20%) вариаций FWHM-изображений звезд (см.

описание фотометрической коррекции в статье [1]).
I(x, y, λ) = P̂ I(x, y, z) = I(x, y, k(z + p(x, y))),

На рис. 2 показано вычитание бликов вокруг
где p(x, y) — так называемая фазовая карта (по- изображения карликовой галактики II Zw 70. Дру-
дробнее смотри раздел 2 в работе [1]), а k(z) = гие примеры данных наблюдений, подвергнутых
= k1z + k0 — линейная функция, коэффициенты вышеописанной процедуре очистки от бликов,
которой определяются тем, какой конкретно ска- можно найти, например, в работах [8, 9] (изучение
нирующий ИФП используется. Соответственно, областей звездообразования в карликовых галак-
I−1 тиках IC1613 и VII Zw403), [10] (кинематика иони-
real – есть результат обратного перехода от шкалы
длин волн к каналам интерферометра: зованного газа в голубых компактных галактиках),

[11] (исследование истечений из молодых звездных
I−1
real(x, y, z) = P̂−1Ireal(x, y, λ). объектов в области HL/HX Tau).

Нашей задачей является получение из Еще одна проблема возникает при наблюдениях
Iobs наи-

лучшего приближения к очищенному от бликов объектов с очень большим градиентом поверхност-
ной яркости, когда интенсивный блик от компакт-

кубу Ireal. Для этого мы используем следующую ной детали, например от ядра галактики, проециру-
итерационную процедуру. Подставляя в выражение ется на значительно менее яркие области. Уровень
(2) Iobs вместо Ireal, получаем первое приближение пуассоновских шумов определяется суммарной ин-
для модели бликов – I1

ghost(Ireal). Тогда, согласно тенсивностью блика и подложки. Поэтому после
(1), первое приближение для очищенного куба: вычитания модели блика возможна ситуация, когда
I1 полезный сигнал в этой области будет сравним
real = Iobs − I1

ghost. Подставляя I1
real в выражение

(2), получаем следующее приближение к модели с амплитудой шумов, обусловленных статистикой
блика I2 фотонов. Чтобы избежать потерь спектральной ин-

ghost и так далее, до In
ghost. Поскольку формации от областей низкой яркости при наблю-

относительная яркость бликов невелика (fi  1), дениях таких объектов, мы рекомендуем разделить
то требуется всего несколько (n = 3 − 4) итераций, планируемую экспозицию пополам и выполнять
чтобы построить модель блика, близкую к реаль- наблюдения последовательно при двух различных
ной. ориентациях поля зрения прибора, развернутых по
Для семейства монохроматических бликов позиционному углу примерно на 90◦. Блики в по-

(i ≥ 1) выполняются соотношения: лученных двух кубах данных будут проецироваться
∆ на разные области объекта. После первичной об-

xi = i∆x1, ∆yi = i∆y1, fi = f i, работки из каждого куба вычитается своя модель
поэтому модель (2) имеет всего шесть свобод- бликов и маскируются области, где после удале-
ных параметров, которые подбираются так, чтобы ние бликов резко уменьшилось отношение сиг-
минимизировать отклонения между In

ghost и Iobs. нал/шум. Затем кубы объединяются в один, причем
Средние значения этих параметров приведены в спектры из замаскированных областей в каждом
таблице, они мало меняются от ночи к ночи. кубе заменяются “хорошими” спектрами из дру-

гого набора данных. Одним из лучших примеров
Параметры модели бликов в линииHα применения вышеописанного алгоритма является

обработка наблюдений близкой карликовой галак-
тики IC 10, представленная в работе [12] (изобра-

i = 0 i=1 жение эмиссионных оболочек ионизованного газа
занимает более половины поля зрения SCORPIO).

fi 0.038 0.11
Рис. 3 иллюстрирует последовательность действий

∆xi, ′′ -7.67 9.80 при вычитании бликов из изображений этой галак-
∆ тики.

yi, ′′ -16.42 13.63

Наш опыт обработки наблюдательных данных, 3. ИЗМЕРЕНИЕ ДИСПЕРСИИ СКОРОСТЕЙ
полученных с помощью IFP501, показал, что Ряд программ, выполняемых с ИФП (например
построенная по вышеописанной схеме модель, как построение карт дисперсии скоростей ионизован-
правило, хорошо описывает реальные блики, без ного газа в галактиках), требуют точных оценок
заметной систематики. Исключение составляют полуширин эмиссионных линий. При этом необ-
только данные, полученные при нестабильных ат- ходимо учитывать уширение, вносимое аппарат-
мосферных условиях, когда приходилось прибегать ным профилем прибора. Традиционно использует-
к сглаживанию отсчетов в отдельных каналах ся следующее соотношение (подразумевается, что

АСТРОФИЗИЧЕСКИЙ БЮЛЛЕТЕНЬ том 63 № 2 2008



ОБРАБОТКА ПЗС-НАБЛЮДЕНИЙ СО СКАНИРУЮЩИМ ИНТЕРФЕРОМЕТРОМ 197

Рис. 2. Вычитание бликов, показана сумма всех каналов куба данных для галактики II Zw 70. (a) Исходное
изображение, (b) модель распределения яркости в бликах, (c) результат вычитания модели из исходного куба.

и аппаратный профиль спектрографа и исходный
— до аппаратного уширения — профиль линии
описываются функциями Гаусса с дисперсиями
σreal и σins соответственно):

√
σobs = σ2

real + σ2
ins. (3)

Здесь σobs обозначает дисперсию гауссианы, с
помощью которой описывается профиль линии, на-
блюдаемой на выходе прибора. Говоря в дальней-
шем о проблеме измерения дисперсии скоростей,
мы будем иметь в виду проблему оценки σreal по на-
блюдаемым спектрам. При этом необходимо пом-
нить, что уширение линий в спектре наблюдаемого
объекта может вызываться не только дисперсией
скоростей σgas (мера хаотических движений вдоль
луча зрения), но и рядом других факторов. Так,
для интегрального спектра HII-областей можно
записать, согласно работе [13]:

σ2
real = σ2

gas + σ2
N + σ2

tr, (4)

где σ2
N ≈ 3 км/c и σ2

tr ≈ 9.1 км/c соответствуют
естественной ширине эмиссионной линии и ее теп-
ловому уширению при температуре 104 K.
Благодаря простоте и наглядности соотношение

(3) широко используется в анализе спектральных
данных, часто его обобщают, заменяя σ на FWHM.
Но при этом следует понимать, что строгое равен-
ство в (3) выполняется только для функций Гаусса,

Рис. 3. Сумма каналов в кубах данных для галактики IC 10, поскольку результатом свертки двух гауссиан яв-
наблюдения 8/9.IX.2005 в линии Hα по заявке Т. А. Лозин- ляется тоже гауссиана. Для щелевого спектрогра-
ской, показан фрагмент размером 72′′ × 72′′. (a) Исходное фа предположение о гауссовской форме инстру-
изображение в первом кубе, (b) после вычитания бликов,
стрелка указывает на области с неудовлетворительным каче- ментального профиля, как правило, верно. Однако
ством вычитания, (c) изображение в кубе, полученное после аппаратный профиль ИФП, задаваемый функцией
поворота поля зрения на 90◦, (d) вычитание бликов из второго Эри, обладает широкими крыльями, и его лучшей
куба (стрелки указывают на некачественные области), (e) аппроксимацией является не гауссиана, а профиль
сумма обоих кубов данных. Лоренца (см., к примеру, [1, 6]). Поэтому, если

исходный профиль эмиссионной линии является

АСТРОФИЗИЧЕСКИЙ БЮЛЛЕТЕНЬ том 63 № 2 2008



198 МОИСЕЕВ, ЕГОРОВ

гауссовским с дисперсией, определяемой соотно-
шением (4), то наблюдаемый профиль является
сверткой профилей Гаусса и Лоренца, т. е. задается
функцией Фойгта (Voigt):

∫
V (λ, y) √ 1 y ∞ e−x2

dx
= ,

2πσ 2
real π −∞ y + (a − (5)

x)2

где

√λ − λ w
a = 0 i

, y = √ ns
.

2σreal 2σreal

Здесь λ0 — центральная длина волны, а через wins Рис. 4. Пример профиля спектральной линии Hα в галактике
обозначена полуширина аппаратного (Лоренцев- II Zw 70 по наблюдениям с IFP501 (точки). Линией показана
ского) профиля ИФП, определяемая по спектру аппроксимация функцией Гаусса (a) и профилемФойгта (b).
линий калибровочной лампы. Аппроксимируя на-
блюдаемый профиль функцией (5), получаем тре-
буемую оценку σreal. На рис. 4 видно, что профиль вблизи линии Hα wins = 35 км/c (для IFP501) и
Фойгта значительно лучше гауссианы описывает wins = 115 км/c (для IFP235). Результаты расче-
крылья линий для спектров галактик, наблюдаемых тов — зависимости ошибки измерения лучевых
с помощью IFP501. Из общих соображений ясно, скоростей и дисперсии скоростей от уровня сигна-
что для оценки дисперсии скоростей использовать ла— показаны на рис. 5ab и 6ab. Как и ожидалось,
соотношение (3) менее корректно, чем выражение в случае симметричных линий ошибка измерения
(5). В первом случае приходится использовать лучевой скорости не зависит от алгоритма измере-
гауссовскую аппроксимацию для профилей линий, ния. На уровне сигнала S/N = 30 она составляет
систематически отличающихся от этого приближе- 2.5 и 8 км/c для интерферометров IFP501 и IFP235
ния (рис. 4a), что может внести ошибку в оценку соответственно.
σreal. Однако этот подход к измерению дисперсии
скоростей во внегалактических HII-областях весь- С ошибкой измерения дисперсии скоростей си-
ма популярен (см., к примеру, работы [10, 13, 14]). туация иная. Как и ожидалось, ошибка измерений,
Представляется, что популярность этого метода основанных на аппроксимации профилем Фойгта,
вызвана не только тем, что формула (3) внешне плавно уменьшается с ростом уровня сигнала и
выглядит проще, чем (5), но также и тем, что воз- составляет всего несколько км/с для S/N > 20.
можность гаусс-аппроксимации профилей спек- Это ошибки, обусловленные шумом в измеряемых
тральных линий предусмотрена практических во спектрах, систематическая компонента ошибок в
всех пакетах обработки астрономических данных. них отсутствует. Напротив, если измерения осно-
Применение профиля Фойгта для анализа внега- ваны на соотношении (3), то при S/N ≥ 10 начина-
лактических спектров менее распространено (см., к ет доминировать не случайная, а систематическая
примеру, [15]), несмотря на то, что при современном ошибка измерений. А именно, оценка дисперсии
развитии вычислительных средств расчет интегра- скоростей завышается, что иллюстрируют рис. 5с
ла в (5) труда не представляет. и 6с. Оценки дисперсии скоростей, полученные из
Мы оценили ошибки измерения кинематических гаусс-аппроксимации профилей, больше реальных

параметров (лучевой скорости и дисперсии ско- на 7–8 км/с и 20–25 км/с для IFP501 и IFP235 со-
ростей) в обоих вышеописанных подходах. Ап- ответственно. Для ширин линий с σreal > 100 км/с
паратный профиль ИФП сглаживался гауссиа- такая систематическая ошибка незначительна. Од-
ной с дисперсией σin, в результирующий спектр нако при σreal = 10 − 20 км/с завышение диспер-
добавлялись шумы и дисперсия скоростей оце- сии скоростей может достигать 100%. Это критич-
нивалась обоими методами. Разница между по- но, например, в исследованиях кинематики ионизо-
лученными значениями (σout) и исходными (σin) ванного газа в областях звездообразования, когда
позволяет оценить ошибку измерения дисперсии необходимо выделить расширяющиеся оболочки
скоростей σerr. Для каждого фиксированного от- или области, где скорости хаотических движений
ношения сигнал-шум (S/N ) было получено по 1000 превышают скорость звука в межзвездной среде
независимых измерений. Аналогично оценивалась [10, 16]. В этих случаях необходимо использо-
ошибка измерения лучевой скорости. Расчеты про- вать оценки дисперсии, даваемые аппроксимаци-
водились для аппаратных контуров с шириной ей профилем Фойгта. Либо же, если по каким-

АСТРОФИЗИЧЕСКИЙ БЮЛЛЕТЕНЬ том 63 № 2 2008



ОБРАБОТКА ПЗС-НАБЛЮДЕНИЙ СО СКАНИРУЮЩИМ ИНТЕРФЕРОМЕТРОМ 199

Рис. 5. Моделирование ошибок измерения кинематических параметров (по уровню 1σ). Расчет проводился для IFP501.
Ромбики— аппроксимация гауссианой, черные кружки— профилемФойгта. (a) Зависимостьошибки измерениялучевой
скорости от уровня отношения сигнал-шум, средняя величина дисперсии скоростей составляла 50 км/c; (b) зависимость
ошибки измерения дисперсии скоростей от уровня отношения сигнал-шум при тех же условиях; (c) сравнение исходных
и измеренных дисперсий скоростей (для S/N = 20).

Рис. 6.Тоже, что на рис. 5, но для IFP235. Рисунки (a) и (b) построеныдля случая средней дисперсиискоростей 200 км/c.

то причинам авторы предпочитают использовать пакет программ IFPWID с многооконным дру-
гаусс-аппроксимацию, необходимо провести оцен- жественным интерфейсом (рис. 7). Тексты про-
ки систематических ошибок, аналогично тому, как грамм находятся в открытом доступе по адре-
это было сделано нами выше, и соответствующим су http://www.sao.ru/hq/moisav/soft. Ниже в
образом скорректировать оценки, полученные по этом разделе представлена основная последова-
формуле (3). тельность обработки данных с помощью этих про-

грамм. Мы не будем останавливаться на детальном
Отметим, что альтернативный метод учета влия- описании большинства используемых алгоритмов

ния аппаратного профиля ИФП, актуальный в слу- — калибровки шкалы длин волн, фотометриче-
чае многокомпонентных линий, предложен в работе ской коррекции, вычитания линий ночного неба и
[16], где авторы применяли методы восстановления т.п. (см. достаточно подробную статью [1]), только
(обратной свертки). Однако он применим только кратко перечислим исходные для обработки набо-
для спектров с относительно высоким отношением ры ПЗС-кадров:
сигнал-шум.

• OBJECT — интерферограммы исследуемого
объекта.

4. КРАТКОЕ ОПИСАНИЕ ПАКЕТА
ПРОГРАММ • NEON — изображения интерференционных

колец от эмиссионной линии, выделяемой
Для обработки наблюдений, получаемых сИФП узкополоснымфильтром из спектра встроен-

на SCORPIO, на языке IDL 6.X нами написан ной калибровочной лампы с He-Ne-Ar на-

АСТРОФИЗИЧЕСКИЙ БЮЛЛЕТЕНЬ том 63 № 2 2008



200 МОИСЕЕВ, ЕГОРОВ

Рис. 7.Интерфейс программы IFPWID. Слева— главное меню, справа— меню работы с откалиброванными кубами.

полнением. Обычно эта калибровка прово- процессе наблюдений. Поэтому пользователю до-
дится до и после наблюдательной ночи. статочно лишь выделить в меню галочками требу-

емые шаги обработки (см. верхнюю часть меню на
• FLAT — интерферограммы равномерной за- рис. 7) и нажать кнопку “запуск” (“run”). Кратко
светки “плоского поля” от встроенной лампы перечислим эти шаги (курсивом выделены их на-
непрерывного спектра, полученные с тем же звания в программе обработки):
узкополоснымфильтром, который использо-
вался при наблюдениях объекта.

• Поиск и усреднение кадров тока смеще-
• TEST — изображения колец от лампы ния, снятых в требуемом режиме считы-
линейчатого спектра в отдельных каналах вания ПЗС (MeanBias creation). Постро-
ИФП, получаемые вместе с накоплениями енный кадр superbias будет вычитаться из
объекта в том же положении телескопа. всех кадров накоплений объекта и калибро-
Используются для мониторинга точности вок. “Горячие” пиксели у применяемой ПЗС
сканирования и для контроля смещения практически отсутствуют, темновой ток мал,
центра колец из-за гнутий прибора. поэтому на экспозициях длительностью в

несколько минут им можно пренебречь.
4.1. Формирование кубов данных • Формирование кубов данных из отдель-

Первый этап обработки обычно не требует ис- ных кадров (Cubes creation). Вычитается
пользования специальных настроек, как правило, superbias, маскируются дефектные колонки.
достаточно указать лишь номер наблюдательной Дальше осуществляется обработка уже не
ночи, шаблоны для имен файлов и требуемый двумерных изображений, а трехмерных ку-
формат кадров (иногда при наблюдениях с ИФП бов (поканально собранных интерферограмм
считывается лишь фрагмент ПЗС). Всю осталь- объекта и калибровок). Кубы сохраняются в
ную необходимую информацию (параметры ИФП, стандартном формате FITS (NAXIS=3).
номера спектральных каналов и т.п.) программа
получает из дескрипторов соответствующих FITS- • Чистка следов космических частиц в кубах
файлов, которые заполняются автоматически в накоплений света от калибровочных ламп с

АСТРОФИЗИЧЕСКИЙ БЮЛЛЕТЕНЬ том 63 № 2 2008



ОБРАБОТКА ПЗС-НАБЛЮДЕНИЙ СО СКАНИРУЮЩИМ ИНТЕРФЕРОМЕТРОМ 201

линейчатым (NEON clean) и непрерывным • Коррекция неравномерности фона (2D
(FLAT clean) спектром. Используется про- gradient). При наблюдениях объектов в
стой σ-фильтр: отсчеты в спектре, отлича- некоторых узкополосных фильтрах в кубе
ющиеся от среднего на установленное по- объекта даже после деления на FLAT
роговое значение, заменяются полусуммой остается заметный градиент яркости фона,
отсчетов из соседних каналов. особенно если имела место дополнитель-

• ная подсветка от Луны. Скорее всего,
Построение карты фазового сдвига по дан- это вызвано остаточной неравномерностью
ным аппроксимации линий в кубе NEON засветки от лампы FLAT в комбинации с
профилем Лоренца (Phase map). При необ- особенностями интерференционных покры-
ходимости – коррекция неравномерности тий конкретных фильтров. Для коррекции
сканирования калибровочного куба, подроб- этого эффекта пользователь может задать
нее см. [1]. параметры двумерного распределения ярко-

• Проверка точности построения шкалы длин сти, на которое нормируется куб объекта.
волн (Phase test). Куб NEON корректиру-
ется за фазовый сдвиг, после чего в каждом • Создание маски для вычитания спектра ноч-
пикселе измеряется положение эмиссионной ного неба (Mask OH). За основу берется
линии лампы линейчатого спектра. изображение суммы каналов куба объекта,

области с яркостью меньше заданного пре-
• Определение поправок к построенной по ка- дела считаются “фоном”. При необходимо-
либровочному кубу шкале длин волн (Test сти полученную маску можно редактировать.
rings). Вычисляются смещения (по обеим
координатам в плоскости ПЗС и по длине • Задание параметров для вычитания фона
волны) накоплений ТEST относительно куба неба (SKY parameters). Применяемая нами
NEON (учет гнутий прибора и мониторинг методика вычитания неба изложена в статье
точности сканирования ИФП). [1]. Кратко ее суть заключается в том, что в

каждом канале куба OBJ эмиссия фона неба
• При необходимости — коррекция относи- усредняется по азимутальном углу в узких
тельных вариаций яркости лампы FLAT в кольцах, с центром на оптической оси ИФП,
течение сканирования калибровочного куба с учетом маски, построенной на предыдущем
(Flat norm). этапе обработки. Средний профиль яркости

вычитается из интерферограммы объекта.
• Измерение смещения между максимумами Пользователь может устанавливать различ-
пропускания узкополосного фильтра, изме- ные режимы такого вычитания, менять ши-
ренными по кубу FLAT и по спектрам вы- рину колец, в которых выполняется усредне-
бранных звезд в поле объекта (Flat Z-shift). ние, фиксировать центр колец или задавать
Обычно эта процедура необходима только автоматический поиск его в каждом канале.
при наблюдениях с IFP235, когда полушири- При необходимости усреднение можно про-
на узкополосного фильтра заметно меньше, водить в отдельных секторах (что полезно
чем спектральный диапазон между сосед- для учета вариаций аппаратного контура по
ними порядками интереференции. Обычно полю) и т.п.
смещение близко к нулю, но с некоторыми
фильтрами оно может достигать 2.0 − 3.5 Å. • Вычитание спектра ночного неба согласно

заданным выше параметрам (Sky remove).
• Деление куба объекта на плоское поле
(учет кривой пропускания узкополосного • Фотометрия звезд в каждом канале куба
фильтра), чистка следов космических частиц объекта (Channels preparation). Для звезд
(OBJ flat and clean). из предварительно созданного списка из-

меряются относительные смещения центра
4.2. Вычитание линий неба и приведение к шкале изображения, вариации FWHM и инте-

длин волн грального потока. Строятся усредненные
Далее следует набор процедур обработки, кото- зависимости этих параметров от номера

рые чаще, чем при сборке кубов, требуют вмеша- канала в кубе.
тельства пользователя. Им соответствуют кнопки
основного интерфейса (рис. 7a слева), перечис- • Фотометрическая коррекция куба объекта,
ленные ниже курсивом. Как правило, обработка на основании результатов поканальной фо-
выполняется в следующем порядке: тометрии звезд (Photo/Shift corrections).

АСТРОФИЗИЧЕСКИЙ БЮЛЛЕТЕНЬ том 63 № 2 2008



202 МОИСЕЕВ, ЕГОРОВ

Рис. 8.Интерфейс программы анализа профилей эмиссионных линий.

Делаются корректирующие смещения кана- волн, в котором максимально учтены все аппа-
лов, осуществляется учет вариаций атмо- ратные эффекты. В таком виде он может анали-
сферной прозрачности (умножение каналов зироваться с помощью различных программных
на рассчитанные коэффициенты) и качества средств, в зависимости от желания пользователя
звездных изображений (свертка с двумерны- и от поставленной задачи. Предусмотрена воз-
ми гауссианами). можность преобразования данных в формат попу-

• Перевод куба объекта в шкалу длин волн лярной системы обработки ADHOC2). Ниже мы
(Linearization). описываем последовательность работы с помощью

наших программных средств, целью которой явля-
• Вычитание бликов с использованием про- ется построение карт лучевых скоростей и диспер-
цедуры, описанной в разделе 2 (Ghosts сии скоростей в эмиссионных линиях.
remove).

На рис.7 (справа) показано меню работы с от-
4.3. Работа с откалиброванными кубами 2)Программный пакет ADHOC разработан by J. Boulesteix

Итогом вышеописанных этапов обработки яв- (Observatoire de Marseille) и доступен по адресу
ляется куб данных, переведенный в шкалу длин http://http://www.oamp.fr/adhoc/adhocw.htm).

АСТРОФИЗИЧЕСКИЙ БЮЛЛЕТЕНЬ том 63 № 2 2008



ОБРАБОТКА ПЗС-НАБЛЮДЕНИЙ СО СКАНИРУЮЩИМ ИНТЕРФЕРОМЕТРОМ 203

калиброванными кубами. Здесь выполняются сле- 5. ЗАКЛЮЧЕНИЕ
дующие процедуры (названия выделены курсивом): В данной работе приводится краткое описание

программ, которые в данный момент применяются
• Разворот куба к “правильной” ориентации для обработки наблюдений, выполняемых со ска-
изображений (север — вверху, восток — нирующим ИФП, работающим в составе прибо-
слева), поскольку наблюдения могут про- ра SCORPIO. Мы считаем, что представленный
водиться в произвольном (или специально программный комплекс полностью удовлетворяет
выбранном) позиционном угле (Rotation to требованиям тех научных задач, которые решаются
NE). Угол поворота вычисляется по дан- на 6-м телескопе САО РАН с помощью этого ме-
ным дескрипторов заголовка FITS-файла, тода наблюдений. Представляется, что дальнейшая
с точностью 0.1◦. Если требуется лучшая эволюция пакета обработки данных будет связа-
точность, необходимо выполнять астромет- на с реализацией в САО РАН проекта многоре-
рическую привязку по звездам поля. жимного редуктора светосилы нового поколения

SCORPIO-2. Прежде всего мы надеемся, что ис-
• Вычисление поправки лучевых скоростей пользование нового осветителя тракта калибровки

позволит отказаться от процедур коррекции оши-
за движение Земли вокруг Солнца (V- бок “плоского поля” (неравномерность остаточно-
heliocentric). Необходимая для расчетов го фона, сдвиг куба FLAT по шкале длин волн, на-
информация черпается из дескрипторов блюдаемый в некоторых узкополосных фильтрах и
заголовка FITS-файла. т. п.). Больший уровень автоматизации SCORPIO-

• 2 (по сравнению с современной версией прибо-
При необходимости вырезается фрагмент ра) позволит еще больше унифицировать процесс
куба, содержащий исследуемый объект получения наблюдательных данных с ИФП, отка-
(Sub-cube). Как правило, именно в таком ви- заться от “ручной” установки параметров в ряде
де обработанные ИФП-кубы представлены процедур, прежде всего это касается вычитания
в нашей базе данных ASPID [17]. спектра ночного неба. В этом случае будет доста-

точно просто построить систему автоматической
• Сглаживание кубов одномерной и двумер- потоковой (pipeline) обработки данных наблюдений
ной гауссианами заданной ширины соот- со сканирующим ИФП.
ветственно вдоль спектральной (Smoothing
along Z) и пространственных (Smoothing
along X) координат. БЛАГОДАРНОСТИ

Авторы считают необходимым поблагодарить
Для построения полей скоростей, карт диспер- А. А. Смирнову за помощь в работе над текстом

сии скоростей, монохроматических изображений в статьи. Работа выполнена при поддержке фонда
эмиссионной линии и в континууме применяется РФФИ (проект 06-02-16825) и гранта Президента
программа GAUS, основной интерфейс которой Российской Федерации (проект МК1310.2007.2).
показан на рис. 8. С помощью этой программы
можно проводить анализ индивидуальных профи-
лей в выбранных пикселях куба данных, приме- СПИСОК ЛИТЕРАТУРЫ
няя аппроксимации профилей эмиссионных линий 1. A. V. Moiseev, Bull. Spec. Astrophys. Obs. 54, 74
функциями Лоренца, Фойгта или Гаусса. В послед- (2002); astro-ph/0211104.
нем случае возможна многокомпонентная гаусс- 2. S. Gordon, B. Koribalski, S. Houghton, and K. Jones,
аппроксимация. Расчет интеграла в (5) проводится Monthly Notices Roy. Astronom. Soc. 315, 248
через стандартную функцию VOIGT языка IDL. (2000).
Главная задача, решаемая с помощью данной про- 3. O. Daigle, C. Carignan, O. Hernandez, et al., Monthly
граммы, — автоматическое отождествление эмис- Notices Roy. Astronom. Soc. 368, 1016 (2006).
сионных линий в кубе данных и их аппроксимация 4. В. Л. Афанасьев, А. В. Моисеев, Письма в Астрон.
теми или иными функциями для заданных парамет- журнал 31, 269 (2005).

5. J.-L. Gach, O. Hernandez, J. Boulesteix, et al., Publ.
ров. Это важно потому, что количество пикселей с Astronom. Soc. Pacific 114, 1043 (2002).
полезным сигналом в наших кубах данных может 6. J. Bland-Hawthorn, in Proceedings of IAU
достигать сотен тысяч, так что индивидуальный Colloquium 149 on Tridimensional Optical
подход к каждому спектру попросту невозможен. Spectroscopic Methods in Astrophysics,
Результатом такой процедуры являются двумерные Marseille, France, 1994, Eds. by G. Compte,
карты параметров профиля (доплеровские скоро- and M. Marcelin (ASP Conference Series, San
сти, поток в линии и т. д.). Francisco, 1995), p. 72.

АСТРОФИЗИЧЕСКИЙ БЮЛЛЕТЕНЬ том 63 № 2 2008



204 МОИСЕЕВ, ЕГОРОВ

7. D. H. Jones, P. L. Shopbell, J. Bland-Hawthorn, 13. M. Rozas, A. Zurita, J. E. Beckman, and D. Pérez,
Monthly Notices Roy. Astronom. Soc. 329, 759 Astronom. and Astrophys. Suppl. Ser. 142, 259
(2002). (2000).

8. Т. А. Лозинская, А. В. Моисеев, Н. Ю. Подорва- 14. C. Muñoz-Tuñón, V. Gavryusev, and H. O. Cas-
нюк, Письма в Астрон. журнал 29, 95 (2003). toneda, Astronom. J. 110, 1630 (1995).

9. Т. А. Лозинская, А. В. Моисеев, В. Ю. Авдеев, 15. K. Gebhardt, C. Pryor, T. B. Williams, and
О. В. Егоров, Письма в Астрон. журнал 32, 403 J. E. Hesser, Astronom. J. 107, 2067 (1994).
(2006). 16. M. Relaño, and J. E. Beckman, Astronom. and

10. I. Martínez-Delgado, G. Tenorio-Tagle, C. Muñoz- Astrophys. 430, 911 (2005).
Tuñón, et al., Astronom. J. 133, 2892 (2007). 17. I. Chilingarian, V. Afanasiev, F. Bonnarel, et al.,

11. T. A. Movsessian, T. Yu. Magakian, J. Bally, et al., in Proceeding of the conference on Astronomical
Astronom. and Astrophys. 470, 605 (2007). Data Analysis Software and Systems XVI, Tucson,

12. Т. А. Лозинская, А. В. Моисеев, Н. Ю. Подорва- USA, 2006, Eds. by R. A. Shaw, F. Hill, and
нюк, А. Н. Буренков, Письма в Астрон. журнал 34, D. J. Bell (ASP Conference Series, 2007), p. 271;
243 (2008). arXiv:0711.0341 [astro-ph].

REDUCTION OF CCD OBSERVATIONS MADE WITH THE FABRY-PEROT
SCANNING INTERFEROMETER. II. ADDITIONAL PROCEDURES

A. V. Moiseev, O. V. Egorov

We describe a software package used at the Special Astrophysical Observatory of the Russian Academy
of Sciences to reduce and analyze the data obtained with the Fabry-Perot scanning interferometer. We
already described most of the algorithms employed in our earlier paper [1]. In this paper we focus on
extra procedures required in the case of the use of a high-resolution Fabry-Perot interferometer: removal of
ghosts light and measurement of the velocity dispersion of ionized gas in galactic and extragalactic objects.

АСТРОФИЗИЧЕСКИЙ БЮЛЛЕТЕНЬ том 63 № 2 2008