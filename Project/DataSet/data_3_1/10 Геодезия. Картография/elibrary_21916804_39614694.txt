астрономия, гравиметрия и космическая геодезия

УДК 528.28; 528.2; 528:629.78

астрономия, гравиметрия и космическая геодезия

об адаптации глобальной модели геопотенциала  
к региональным особенностям (часть 2)

Профессор, доктор техн. наук Ю.м. нейман, доцент, кандидат физ.-мат. наук л.с. сугаипова
московский государственный университет геодезии и картографии

yuney@miigaik.ru
аннотация. Приведён алгоритм регионального моделирования гравитационного поля Земли (ГПЗ) с 
помощью радиальных базисных функций (РБФ). Численные эксперименты показали эффективность 
описания локальных особенностей ГПЗ с помощью РБФ по сравнению с традиционным использова-
нием сферических функций.
ключевые слова: регуляризация, неоднородное поле, радиальные базисные функции
Abstract. An algorithm of local modeling of the terrestrial gravitational field by means of radial basis functions 
(RBF) is given. Numerical experiments have shown effectiveness of RBF in comparison with spherical 
functions when describing local features of the gravitational field.
Keywords: regularization, inhomogeneous field, spherical radial basis functions

Нижеследующее представляет собой окон- следующем: 
чание статьи. Начало опубликовано в преды-
дущем номере журнала [1] и содержит поста-  α ≈10−m+µ ,  (2)
новку задачи и краткие сведения о построении где m характеризует ожидаемую относитель-
пространственно локализованных базисных ную погрешность результата, а µ = 2 или 3.
функций на сфере. В качестве матрицы регуляризации доста-

2.2.2. Регуляризация возможной неустой- точно взять единичную матрицу R = E, что со-
чивости. Возможная неустойчивость описан- ответствует тихоновской регуляризации нуле-
ного алгоритма обычно выражается в плохой вого порядка (гребневая регрессия). В общем 
обусловленности системы нормальных урав- случае выбор матрицы R и особенно параметра 
нений. В таком случае рекомендуется пользо- α зависит не только от свойств алгоритма вы-
ваться методом регуляризации. Суть дела со- числений, но и от сложности ГПЗ того района, 
стоит в том, что вместо стандартной системы исходные данные которого используются для 
нормальных уравнений следует решать систе- уточнения модели. Например, трудно пред-
му положить, что гравитационное поле в райо-
 (ATC−1A+αR)X = ATC−1l.  (1) не океана и в горном районе суши нуждается 

в одинаковой степени сглаживания и может 
σ2 быть регуляризовано одинаково. Региональное 

Здесь параметр регуляризации α = ∆ о л с -
σ2  с г а о построение глобальной модели, в отличие от 

T
вывает уровень случайных ошибок измерений традиционного подхода, позволяет реально 
с дисперсией детерминированного поля, а R учесть такую зависимость и, благодаря лока-
— некоторая положительно определённая ма- лизации базисных функций R, α выбирать для 
трица регуляризации. Разброс решений из-за каждого региона (или даже для отдельных об-
плохой обусловленности существенно умень- ластей региона) персонально.
шается, но появляется некоторая смещённость. В литературе описаны многие методы 
Поэтому параметр α должен быть достаточно практического выбора R и α. Например, диаго-
малым. Простейшая рекомендация состоит в нальную часть матрицы регуляризации часто 

3



известия высших учебных заведений. геодезия и аэрофотосъемка, № 4, 2014

стараются идентифицировать со степенными тов регуляризующей системы уравнений (1). 
дисперсиями реального поля (стабилизация Так как N = Nα −αR,  то можно доказать, что 
по Каула). Это объясняется тем, что (1) чис-
ленно эквивалентно несмещённой оценке X̂   N −1 1 ∞

= (αN −1
α )k .

α∑  (6)
методом наименьших квадратов, если матема- k=1

тическое ожидание M(X) = 0, а ковариационная Поэтому можно получить регуляризован-
2 ное и в то же время несмещённое решение ис-

матрица C σ
X = R. ходной системы в рекуррентном виде 

α
Полезно некоторую часть исходных дан- x 1

k+1 = y +αN −
α xk ; k = 0,1,2,...; x0 = 0.

ных l1q…lqq, не включённых в обработку, ис- Если эту рекуррентную формулу перепи-
пользовать для контроля адекватности полу- сать в виде 
чаемой модели. Соответствующую сумму 
квадратов уклонений можно использовать и x ( 1

1 )k
k+ = xk + αN −

α y; k = 0,1,2,...; x0 = 0,
для выбора из определённой последовательно- то получается следующий несколько более 
сти {αn} оптимального параметра регуляриза- простой алгоритм: 
ции по принципу x 1

0 = 0; y0 = N −
α b;

q
 arg min 1

α  ∑p l 2 = α − α  (3)
{α } i ( )(l ˆ

iq iq ( )) , y + = αN −1
k 1 α yk ; xk+1 = xk + yk ;

n q 
i=1   k = 0,1,2,  .(7)



где pi (α) = (1−Uii (α))−2 — вес уклонения Наиболее технологичным, пожалуй, яв-
vi (α) = l lˆir − ir (α). ляется предложение авторов работы [3], по-

В самом деле, пусть U — матри- зволяющее автоматизировать процесс регу-
ца влияния, то есть такая матрица, что ляризации и удобно вписаться в алгоритм, 
Ul = AXˆ = lˆ.  Следовательно, Ul = AN −1AT P∆l,  показанный на рис. 5 первой части статьи.
то есть U = AN −1AT P∆  и вектор уклонений Будем трактовать искомый вектор X как 
V = l − lˆ = l −Ul = (E −U )l.  Если P∆ = E, то очередную с номером m + 1 группу исходных 
матрица влияния U оказывается матрицей измерений количеством nm + 1 и с ковариацион-
проектирования и UT = U, U2 = U. Поэтому ной матрицей 1 R−1,  где α и R — параметр и 
ковариацонная матрица вектора уклонений α
C 2 матрица регуляризации, соответственно. Тогда 

V = σ (E −U ). Отсюда и следует, что вес 
уклонения vi равняется (1−Uii (α))2 ,  где Uii —  A 1

m+1X = X ; C−
m+1 = αR,  (8)

диагональный элемент матрицы проектирова-
ния U. где Am+1 = E  и поэтому N  

k ,k m + 1 = αR. Таким обра-
Удобнее вместо различных весов p зом, дисперсия единицы веса (m + 1)-й «группы 

i пользо-
ваться одним средним весом измерений» σ2

m+1 =1/ α.  В качестве начального 
−2 приближения для X можно взять нуль-вектор. 

 p  1
=  tr(E −U ) .  (4) Всё остальное происходит автоматически в 
 q  соответствии с блок-схемой алгоритма, надо 

В таком случае критерий (3) выглядит сле- только при составлении нормальных уравне-
дующим образом: ний NX = b суммирование по i выполнять не до 

 q q m, а до m + 1.
α = arg min (l lˆ 

iq − i (α))2 . В качестве матрицы регуляризации доста-
{α 

 t E q   
n} ( r( −U (α)))2 ∑ (5)

i=1  точно взять единичную матрицу R = E ,  что 
k ,k

Очень эффективен, на наш взгляд, не- соответствует тихоновской регуляризации ну-
заслуженно забытый метод Рилея [2]. левого порядка (гребневая регрессия).
Пусть N = ATC−1A  обозначает матрицу ко- Ранее отмечалось, что величина 
эффициентов нормальных уравнений, а r 1

m = nm − tr(N − Nm )  характеризует влияние 
Nα = (ATC−1A+αR)  — матрица коэффициен- m-й группы измерений на общий результат. 

4



астрономия, гравиметрия и космическая геодезия

В данном случае r 1
m+1 = k − tr(N − αE) = 0,  то 4 2

  
есть включение в обработку (m + 1)-й группы h(n) n − N1 2 n − N1 

= 
измерений носит чисто служебный характер. −  −   +1.

 N2 N1   N2 − N1 
Большое семейство методов регуляриза- Здесь N1 ≤ N ≤ N2, а n — текущая степень модели. 

ции задач, решаемых под условием наимень- 3. Создание регулярной сетки полюсов РБФ. 
ших квадратов, основано на сингулярном раз- 4. Выбор РБФ. Поскольку при удалении 
ложении матрицы коэффициентов уравнений низкочастотной референц-модели длинновол-
связи или матрицы нормальных уравнений. новые ошибки наземных данных остаются, 
При этом возможно получать надёжные реше- желательно выбирать такие РБФ, которые мало 
ния даже в случае неполного ранга. чувствительны к длинным волнам. Начальную 

3. Региональное моделирование. степень в рядах типа (7) (из первой части ста-
3.1. алгоритм регионального моделирова- тьи [1]) следует выбирать не меньше наиболь-

ния гПз. Будем исходить из того, что низко- шей степени референц-модели. Однако замет-
частотная часть ГПЗ уже надёжно определена но уменьшить длинноволновые ошибки можно 
и известны соответствующие гармонические только путём соответствующей фильтрации. 
CS-коэффициенты вплоть до некоторой сте- 5. Вычисление РБФ-коэффициентов и вы-
пени N. Требуется улучшить разрешающую бор параметров, одинаковых для всех РБФ. 
способность модели в заданной области с по- 6. Выявление необходимости локального 
мощью имеющейся там разного рода деталь- уточнения модели по следующим критери-
ной гравиметрической информации. Размер ям [3]: модуль уклонения в точке измерения 
области должен быть согласован с наивысшей превышает порог τ1; в окрестности радиуса ρ 
степенью N имеющейся низкочастотной моде- находятся, по крайней мере, q точек, модуль 
ли (точнее, с реальной разрешающей способ- уклонения в которых превышает порог τ2; сфе-
ностью референц-модели) и затем увеличен на рическое расстояние до ближайшего уже име-
1−2° с каждой стороны для уменьшения крае- ющегося полюса не меньше ξ0. Невыполнение 
вых эффектов на границе. Наземная гравиме- условий говорит об отсутствии необходимо-
трия, как правило, неоднородна в том смысле, сти в дополнительной РБФ в данной точке. 
что заметно различается по качеству и нагляд- Константы τ1, τ2, ρ, q, ξ0 являются параметрами 
но проявляет пространственную нестационар- алгоритма и могут изменяться от итерации к 
ность поля. Тем не менее, желательно, чтобы итерации. Параметр ξ0 рекомендуется полагать 
детальные данные равномерно покрывали об- равным двум−трём радиусам корреляции соот-
ласть предполагаемой параметризации и были ветствующей РБФ. 
бы, по возможности, однородными. Плотность 7. Последовательное добавление отдель-
данных должна быть согласована с шириной ных РБФ с индивидуальными параметрами и 
полосового фильтра планируемых базисных полюсами, расположенными всегда ниже точек 
функций. с исходной информацией. Глубина определяет 

Итак, предлагается следующий алгоритм ширину полосы соответствующего фильтра и 
регионального моделирования. подбирается по исходным данным в опреде-

1. Выбор размеров региона и референц-мо- лённой окрестности. 
дели. 8. Вычисление коэффициентов для всех 

2. Удаление из гравиметрической инфор- РБФ с учётом добавленных. При необходимо-
мации региона низкочастотной части поля, сти применяется регуляризация. 
содержащейся в избранной референц-модели. 9. Переход к шагу 5. Процедура заканчива-
При этом «резкое обрезание» модели после ется, когда необходимость локального уточне-
некоторой степени N приводит, как известно, ния исчерпана. 
к нежелательному появлению в спектре воз- Начальные пять пунктов будем условно на-
мущающих «лепестков». Чтобы ослабить этот зывать первым этапом регионального модели-
эффект, полезно, согласно [4], подвергнуть рования. Остальные пункты составляют второй 
данные модели фильтрации с частотной харак- этап регионального моделирования. На первом 
теристикой этапе выявляются и математически описы-

5



известия высших учебных заведений. геодезия и аэрофотосъемка, № 4, 2014

ваются основные особенности регионального высоты оставлены для контроля и оценивания 
гравитационного поля, а на втором этапе осу- точности результатов. Расположение контроль-
ществляется, при необходимости, персональная ных точек хаотично.
детализация локальных нерегулярностей. Вычисления проделаны в полном соответ-

3.2. численный эксперимент. Эксперимент ствии с алгоритмом [3, 5], описанным в разд. 
проделан в районе, геодезические координаты 2.3.1 «Совместное уравнивание нескольких 
B, L которого ограничены следующими кон- групп разнородных данных» [1]. Регуляризация 
стантами: Bmin = 56,0; Bmax = 60,0; Lmin = 102,0; выполнена методом Riley [2], параметр регуля-
Lmax = 108,0. Исходными данными послужили ризации выбирался по методу [3].
референц-модель GOCE_DIR240, полученная Первый этап моделирования проделан с 
по результатам спутниковой градиентометрии 779 полюсами, расположенными на регуляр-
GOCE прямым методом до 240-й степени, и ной сетке трапеции 6×8° сферы на глубине 
две группы разнородных наземных данных: 80 км. В качестве сферических радиальных 
аномалии силы тяжести в миллигалах на регу- базисных функций использованы вейвлеты 
лярной сетке 5,0×7,5′ (количество точек 2304) Пуассона 3-го порядка. В результате получена 
и аномалии высоты в метрах (количество точек следующая аппроксимирующая конструкция 
2401) на такой же сетке. Исходные данные и 
значения, полученные после удаления низко- 240 n 779

частотной части поля (модель GOCE_DIR240), T r GM   a  
( ,θ,λ) = ∑  Ynm (θ,λ) +∑bik Bik (r,θ,λ) .  (9)

r 
 n=2  r  i=1 

показаны на рис. 1, 2. 
В обработке приняли участие 2190 точек с 

аномалиями силы тяжести и 2275 точек с ано-
малиями высоты. Остальные 114 точек с анома-
лиями силы тяжести и 126 точек с аномалиями 

а б
рис. 3. остаточные значения после первого этапа 

моделирования на трапеции 4×6°:
а — аномалии силы тяжести (мГал); б — аномалии высоты (м)

а б
рис. 1. аномалии силы тяжести (мгал) 

на трапеции 4×6°:
а — исходные значения; б — после удаления низкочастотной 

части поля (модель GOCE_DIR240)

а б
рис. 2. аномалии высоты (м) на трапеции 4×6°: рис. 4. остаточные значения аномалии силы тя-

а — исходные значения; б — после удаления низкочастотной жести (мгал) после удаления модели EGM 2008 до 
части поля (модель GOCE_DIR240) 2160-й степени на трапеции 4×6°

6



астрономия, гравиметрия и космическая геодезия

Общее количество коэффициентов, ис- литература
пользованных для моделирования первого эта- 1. нейман Ю.м., сугаипова Л.с. Об адаптации глобаль-
па 2412 + 779 ≈ 59 000. Из исходных данных, т.е. ной модели геопотенциала к региональным особенностям 

(часть 1) // Изв. вузов «Геодезия и аэрофотосъемка». −2014. 
аномалий силы тяжести и аномалий высоты −№3. −С. 3‒12.
на сетке 5,0×7,5′ трапеции 4×6°, были вычте- 2. Riley J.D. Solving systems of linear equations with a 
ны значения тех же трансформант потенциала, positive definite, symmetric, but possibly ill-conditioned matrix. 

Mathematical Tables and Other Aids to Computation 9/51, 1955, 
вычисленные с помощью полученной комби- pp. 96–101. 
нированной модели (9) (рис. 3). Для сравнения 3. KleesR., TenzerR., PrutkinI., WittwerT. A data drive nap-
на рис. 4 показано остаточное поле аномалии proach to local gravity field modelling using spherical radial basis 

functions. Journal of Geodesy, 2008, 82, 457–471. 
силы тяжести в том же регионе, полученное 4. Barthelmes F. Low Pass Filtering of Gravity Field Models 
с помощью известной глобальной модели by Gently Cutting the Spherical Harmonic Coefficients of Higher 
EGM-2008 до 2160-й степени, содержащей бо- Degrees.

5. нейман Ю.м. К вопросу о математической обработке раз-
лее четырёх с половиной миллионов коэффи- нородных измерений // Изв. вузов «Геодезия и аэрофотосъем-
циентов. ка». −2008. −№2. −С. 7−21.

Принята к печати 17 дкеабря 2013 г. 
рекомендована кафедрой высшей математики миигаик

Экспериментальные исследования влияния ионосферных  
Эффектов на спутниковые определения

Профессор, доктор техн. наук а.а. майоров1, доктор техн. наук в.б. непоклонов1, 
профессор, кандидат техн. наук а.о. куприянов1, студент р.а. давлатов1,  

ведущий инженер е.л. мацкин2, инженер д.а. рождественский2

1московский государственный университет геодезии и картографии
2радиотехнический институт имени академика а.Л. минца (рти)
rozhdestvensky@rti-mints.ru, gnss@miigaik.ru, davlatov_r_a@mail.ru

аннотация. Статья посвящена вопросам учета влияния ионосферы на распространение радионави-
гационного сигнала в спутниковых измерениях. Кратко приведены основные методы учета ионосфе-
ры. Основная часть работы заключается в  экспериментальных исследованиях параметров ионосферы 
TEC, S4, 10S с мультисистемной спутниковой станцией GPStation-6 NovAtel,  рассмотрены  основные 
преимущества по сравнению с другими приемниками ГНСС, принцип калибровки. Представлены по-
лученные результаты экспериментальных измерений параметров ионосферы по сигналам ГЛОНАСС/
GPS, выработаны рекомендации по продолжению эксперимента.
ключевые слова: эксперимент, навигационный приемник, ГЛОНАСС, КА, ионосфера, ионосферных 
и тропосферных задержек сигналов ГНСС ГЛОНАСС/GPS/GALILEO, BEIDOW, QZSS, SBAS
Abstract. The article refers to the accounting effect of the ionosphere on the propagation of radio navigation 
satellite signal during the measurements. The main ionosphere accounting methods are  briefly shown. Most 
of the work lies in experimental studies of ionospheric parameters TEC, S4, 10S with multisystem satellite 
station GPStation-6, its basic advantages over other GNSS receivers are considered along with the calibration 
principle. The obtained results of experimental measurements of ionospheric parameters for GLONASS - GPS 
are presented, and it is recommended to continue the experiment.
Keywords: experiment, navigation receiver, GLONASS satellites, the ionosphere, the total electron content, 
ionospheric and tropospheric delays of GLONASS / GPS / GALILEO, BEIDOW, QZSS, SBAS

В последнее десятилетие интенсивное стью развернуты, дополняются и модернизи-
развитие спутниковых технологий и аппара- руются среднеорбитальные спутниковые си-
туры, работающей по сигналам глобальных стемы ГЛОНАСС (Российская Федерация) и 
навигационных спутниковых систем (ГНСС), GPS (США). Активно развивается китайская 
определило новые требования к точности, система BEODOW. В 2014 г. планируется за-
оперативности, защищенности определения пуск нескольких спутников европейской си-
координат. К настоящему времени полно- стемы GALILEO. Развиваются региональные 

7