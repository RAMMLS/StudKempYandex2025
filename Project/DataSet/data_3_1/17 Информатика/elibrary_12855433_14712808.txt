éîæïòíáôéëá é å¿ ðòéíåîåîéñ, 2008. ô. 2. ÷ÙÐ. 1. ó. 234

АРХИТЕКТУРА ПРОМЕЖУТОЧНОГО СЛОЯ ПРЕДМЕТНЫХ
ПОСРЕДНИКОВ ДЛЯ РЕШЕНИЯ ЗАДАЧ НАД МНОЖЕСТВОМ
ИНТЕГРИРУЕМЫХ НЕОДНОРОДНЫХ РАСПРЕДЕЛЕННЫХ
ИНФОРМАЦИОННЫХ РЕСУРСОВ В ГИБРИДНОЙ
ГРИД-ИНФРАСТРУКТУРЕ ВИРТУАЛЬНЫХ ОБСЕРВАТОРИЙ∗

Д. О. Брюхов1, А. Е. Вовченко2, В. Н. Захаров3, О. П. Желенкова4, Л. А. Калиниченко5,
Д. О. Мартынов6, Н. А. Скворцов7, С. А. Ступников8

Аннотация: Рассматривается архитектура промежуточного слоя предметных посредников для решения
научных задач над множеством интегрируемых неоднородных распределенных информационных ресур-
сов в гибридной грид-инфраструктуре виртуальной обсерватории (ВО). Архитектура реализована как
объединение системы поддержки ВО АстроГрид, разработанной в Великобритании, и средств поддержки
предметных посредников, созданных в ИПИ РАН. Реализован подход, при котором для класса при-
ложений формируется спецификация предметной области посредников независимо от существующих
информационных ресурсов. Создание прототипа гибридной архитектуры требует сопряжения исполни-
тельных механизмов двух инфраструктур (АстроГридa и предметных посредников), поэтому основное
внимание уделено проблемам переписывания запросов к посредникам в планы их реализации над
конкретными информационными ресурсами. Приведено краткое описание объединенной архитектуры
исполнительных механизмов АстроГрида и средств поддержки предметных посредников. Дан пример
реализации предметного посредника для решения задач поиска далеких галактик в гибридной архитек-
туре. Показаны отличия реализованного подхода от известных прототипов интеграции баз данных в ВО.
Разработанные средства планируется использовать при решении задач Российской ВО (РВО).

Ключевые слова: предметный посредник; каноническая информационная модель; виртуальная обсер-
ватория; унификатор информационных моделей; уточнение; переписывание формул; семантическая
интеграция неоднородных информационных ресурсов; регистрация ресурсов в посреднике; онтологи-
ческая модель; релевантные посреднику ресурсы; промежуточный слой; описание предметной области
задачи, движимое приложениями

1 Введение их естественной разнородности. Число организа-
ций, получающих данные наблюдений в отдель-

В различных областях науки наблюдается экс- ных областях науки в мире, велико. Разнообразие
поненциальный рост объема получаемых экспери- (информационная несогласованность) получаемой
ментальных (наблюдательных) данных. Напри- информации вызывается, в частности, не только
мер, в астрономии текущий и ожидаемый темп большим числом организаций, производящих на-
роста данных от наземных и космических теле- блюдения, и их независимостью, но и разнообрази-
скопов удваивается в течение периода от шести ем объектов наблюдения, непрерывным и быстрым
месяцев до одного года. Сложность использова- совершенствованием техники наблюдений, вызы-
ния таких данных увеличивается еще и вследствие вающим адекватные изменения структуры и со-

∗Работа выполнена при частичной финансовой поддержке РФФИ (гранты 06-07-08072-офи-a, 06-07-89188-a, 08-07-00157-a) и
программы ОИТВС РАН «Фундаментальные основы информационных технологий и систем» (проект 1-10).

1Институт проблем информатики Российской академии наук, brd@ipi.ac.ru
2Институт проблем информатики Российской академии наук, itsnein@gmail.com
3Институт проблем информатики Российской академии наук, vzakharov@ipiran.ru
4Специальная астрофизическая обсерватория Российской академии наук, zhe@sao.ru
5Институт проблем информатики Российской академии наук, leonidk@synth.ipi.ac.ru
6Институт проблем информатики Российской академии наук, domartynov@gmail.com
7Институт проблем информатики Российской академии наук, nskv@ipi.ac.ru
8Институт проблем информатики Российской академии наук, ssa@ipi.ac.ru

2



Архитектура промежуточного слоя предметных посредников для решения задач над множеством интегрируемых

держания накапливаемой информации. Это при- корпоративных информационных системах, созда-
водит к необходимости использования неоднород- ваемых для решения задач в разнообразных обла-
ной, распределенной информации, накопленной в стях государственного управления, производства,
течение значительного периода наблюдений техно- бизнеса. Достаточно назвать системы, конструи-
логически различными инструментами. руемые в рамках программ «Электронная Москва»,

Чрезвычайно быстро развивается также про- «Электронная Россия», системы для решения за-
граммный инструментарий, включающий много- дач правоохранительных органов, для инспекции
образные сервисы для поддержки различных видов безопасности дорожного движения, банковские
обработки информации при решении научных за- системы, системы управления транспортом и др.
дач и проведении исследований. Такие сервисы
производятся различными научными организация- Настоящая статья в качестве применений огра-
ми, их описания неоднородны и неполны. ничивается рассмотрением инфраструктур инфор-

Увеличивающийся разрыв между исследовате- мационных систем для науки, которые в послед-
лями и источниками данных и сервисов приводит нее время приобретают вид международных ВО.
к необходимости поиска новых путей создания ин- Виртуальные обсерватории, в свою очередь, могут
формационных систем, в которых особое внимание быть отнесены к классу корпоративных информа-
было бы сосредоточено на специальных средствах ционных систем, поэтому результаты настоящей
организации решения задач над множеством рас- работы применимы и к последним. Анализ ин-
пределенных информационных ресурсов (данных фраструктуры РВО для астрономии дан в ее аван-
и программ), накапливаемых в разнообразных на- проекте [1].Значительное внимание в нем занимает
учных центрах. Разработан (разрабатывается) ряд анализ состояния и решений наиболее продвину-
инфраструктур, которые технически способствуют тых в мире проектов ВО: проекта Национальной
организации решения задач в такой среде. Среди ВО (NVO) США, проекта АстроГрид Великобри-
них Веб-сервисы, Гриды данных, Семантический тании, проекта Европейской ВО Euro-VO. Коор-
Веб, инфраструктуры онтологического моделиро- динация проекта РВО с международными проек-
вания, интеграции информационных ресурсов, ин- тами — основная стратегическая линия развития
тероперабельные инфраструктуры промежуточно- РВО. Основной координирующей организацией
го слоя и др. Вместе с тем сложны и все еще далеки создания проектов ВО в различных странах мира
от решения проблемы семантики, возникающие является Альянс Международной ВО (IVOA) [2], в
при: который входит и Россия. Альянс Международ-
(1) определении понятий предметной области; ной ВО разрабатывает совокупность стандартов,

которые должны обеспечить совместимость ВО,
(2) отображении и интеграции контекстов пред-

создаваемых в различных странах мира. Техниче-
метных областей информационных ресурсов в

ски инфраструктура, продвигаемая IVOA, является
контекст предметной области задачи;

сервис-ориентированной. В стандартах различа-
(3) идентификации релевантных задаче информа- ются сервисы доступа к астрономическим данным,

ционных ресурсов и формировании их компо- вычислительные сервисы обработки данных, сер-
зиций; висы регистрации разнообразных сервисов, позво-

(4) доказательно правильном отображении инфор- ляющие публиковать и обнаруживать их. Подроб-
мационных моделей ресурсов в общую инфор- ный анализ разрабатываемых стандартов IVOA дан
мационную модель задачи; в [2, 3]. Слабым местом стандартов IVOA явля-

(5) интеграции схем ресурсов в схеме предметной ется недостаточность средств интеграции неодно-
области задачи и устранении разнообразных родных астрономических ресурсов для решения
конфликтов; над ними разнообразных научных задач. Поэто-

му в инфраструктуре РВО дополнительно к инфра-
(6) выявлении семантически подобных компонен-

структуре IVOA вводится концепция предметных
тов ресурсов в процессе интеграции схем;

посредников, позволяющих задавать определение
(7) адекватном преобразовании формул (запросов) прикладных областей для формулирования и ре-

программы решения задачи, выраженных в тер- шения классов научных задач в терминах понятий
минах схемы предметной области задачи, в фор- этих областей, структур информационных объек-
мулы, выраженные в схемах релевантных ресур- тов, декларативно объявляемых сервисов и про-
сов, и пр. цессов. Посредники располагаются между иссле-

Следует заметить, что аналогичные проблемы дователями, формулирующими задачи в терминах
создания и развития информационных систем воз- посредников, и разнообразными распределенны-
никают не только в научных применениях, но и в ми информационными ресурсами (данными, сер-

ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008 3



Д. О. Брюхов, А. Е. Вовченко, В. Н. Захаров и др.

висами, процессами), необходимыми для решения ва доказательства факта уточнения спецификации
задачи. некоторого компонента спецификацией другого

В итоге инфраструктура РВО определена мно- компонента (реализуемые на основе теоретико-мо-
гоуровневой [1] и включает (при движении снизу дельных нотаций и соответствующего инструмен-
вверх) уровень информационных ресурсов, проме- тария [4–6]) составляют фундамент применяемых
жуточный слой, обеспечивающий интероперабель- методов конструирования унифицирующих (кано-
ность ресурсов благодаря технической унификации нических) моделей представления информации в
их интерфейсов и введению дистанционных меха- посредниках. Каноническая информационная мо-
низмов обращения к ресурсам (адаптеры, осуще- дель служит в качестве общего языка, эсперанто,
ствляющие преобразование запросов, выраженных для адекватного выражения семантики разнород-
в канонической информационной модели посред- ных моделей представления информации, исполь-
ников, в их представление в информационной зуемых в разнообразных информационных ресур-
модели ресурса, включаются в состав промежу- сах, релевантных посреднику. Методы отображения
точного слоя), уровень предметных посредников, информационных моделей и синтеза расширяемых
каждый из которых создает спецификацию пред- канонических информационных моделей для слоя
метной области для решения некоторого класса предметных посредников подробно рассмотрены
задач, используя каноническую информационную в [7]. Там же предложена архитектура Унификатора
модель («эсперанто») для представления семанти- информационных моделей.
ки предметной области и унифицированного отоб- Задачей Унификатора моделей является унифи-
ражения разнообразных видов информационных кация множества информационных моделей (назы-
моделей ресурсов (моделей данных, сервисных мо- ваемых исходными), использующихся в различных
делей, онтологических моделей, процессных моде- информационных ресурсах некоторой информаци-
лей), уровень задач (приложений), формулируемых онной системы. Унификация исходной модели R
в терминах одного или нескольких посредников. есть приведение ее к канонической информаци-
Следует заметить, что посредники, в свою оче- онной модели C, т. е. создание такого расшире-
редь, могут рассматриваться как информационные ния E канонической модели (которое может быть
ресурсы для использования в посредниках более и пустым) и такого отображения M исходной мо-
высокого уровня. В такой инфраструктуре пред- дели в расширенную каноническую, что исходная
метные посредники играют ключевую роль для модель уточняет расширенную каноническую мо-
решения семантических проблем, перечисленных дель. Уточнение моделей означает, что для любой
выше. В частности, при интеграции неоднород- допустимой спецификации r модели R ее образ
ных ресурсов в посреднике нужно уметь семан- M(r) при отображении M уточняется специфика-
тически отождествлять объекты, представленные в цией r. Синтез канонической модели заключает-
различных информационных моделях, и семанти- ся в построении указанных расширений ядра ка-
чески правильно отображать схемы интегрируемых нонической модели для всех исходных моделей и
ресурсов в схему посредника. Поскольку в общем объединении таких расширений. В качестве ядра
случае ресурсы неоднородны (представлены в раз- канонической информационной модели применя-
личных моделях), при интеграции неоднородных ется язык СИНТЕЗ [8], который ориентирован на
ресурсов для однородного представления их семан- спецификацию предметных посредников и син-
тики требуется приведение различных информаци- тез канонических моделей. В настоящей работе
онных моделей к унифицированному виду в рамках Унификатор моделей предполагается входящим в
некоторой унифицирующей информационной мо- качестве неотъемлемой части слоя предметных по-
дели, которая называется канонической. средников. Его архитектура и подробности кон-

Для унификации разнородных спецификаций струирования определены в [7].
прежде всего требуется умение сопоставлять спе- Другой конкретной совокупностью семантиче-
цификации различных ресурсов друг с другом так, ских проблем создания посредников для ВО явля-
чтобы можно было отвечать на вопрос, можно ли ются проблемы (1), (2), (5) и (6) из приведенного
при реализации посредника использовать специ- выше списка. Эти проблемы должны решаться при
фикацию существующего ресурса вместо фрагмен- определении предметного посредника и регистра-
та спецификации посредника. Для этого достаточ- ции в нем релевантных посреднику информацион-
но доказать, что рассматриваемые спецификации ных ресурсов.
находятся в отношении уточнения. Говорят, что Спецификация предметного посредника для
спецификация A уточняет спецификацию D, если класса задач включает определения понятий пред-
A можно использовать вместо D так, что пользо- метной области, выражаемых соответствующими
ватель D не будет замечать этой замены. Средст- онтологическими спецификациями, специфика-

4 ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008



Архитектура промежуточного слоя предметных посредников для решения задач над множеством интегрируемых

ции классов объектов предметной области, спе- предметной области посредника или ресурса, и ка-
цификации типов экземпляров названных классов нонической модели, позволяющей формально опре-
и их методов, определяющих их поведение, специ- делять структуру и поведение объектов предметной
фикации процессов решения задач данного класса области посредника и информационных ресурсов.
как совмещенных во времени последовательностей Рассуждения в канонической и в онтологической
действий, реализуемых методами классов, сервиса- модели основаны на семантике канонической мо-
ми и другими процессами. Предполагается, что дели и средствах доказательства уточнения. При
такие спецификации преобразуются в специфи- этом в онтологической модели необходимо достичь
кации канонической модели, имеющей формаль- согласования понятийной семантики специфика-
ную семантику. Результат определения предметно- ций посредника и регистрируемых в нем ресурсов.
го посредника, выполняемого заинтересованным Рассуждения в модели метаданных являются эври-
научным сообществом, составляет спецификацию стическими на основе нефункциональных требова-
посредника, образуемую в результате достижения ний к нужным в классе задач ресурсам (к таковым
консенсуса в таком сообществе, а сама деятельность относятся, в частности, показатели качества дан-
по спецификации посредника называется перио- ных в ресурсах). Необходимые модели метаданных
дом его консолидации. и алгоритмы поиска составляют часть метода. В це-

Регистрация релевантных посреднику ресурсов лях проектирования спецификации посредника и
рассматривается как задача композиционного про- ресурсов задаются в однородном их представлении
ектирования систем [9, 10]. Регистрация ресур- в канонической модели, хотя для этого может по-
сов есть процесс целенаправленной трансформа- требоваться преобразование в такую модель из не-
ции спецификаций, включающий декомпозицию которого другого языка спецификаций, например
спецификаций посредника на непротиворечивые из UML1.
фрагменты, поиск среди спецификаций релевант- Сложной проблемой регистрации ресурсов в
ных ресурсов подходящих типов данных — канди- посреднике является согласование прикладных
датов для уточнения ими спецификаций типов по- контекстов посредника и конкретных ресурсов.
средника, построение выражений, определяющих В разработанном инструментарии регистрации [10]
классы ресурсов в виде композиции классов по- такое согласование осуществляется на основе
средника. Для подобного манипулирования спе- онтологического подхода. Онтологические специ-
цификациями разработано специальное исчисление фикации играют роль «клея» фрагментов специфи-
спецификаций [11]. В нем предложен принцип де- каций посредника и ресурсов для их семантическо-
композиции спецификаций типов в набор редук- го отображения и композиции. Онтологические
тов спецификаций типов, служащих основными определения аннотируют элементы спецификаций
единицами повторного использования и компози- посредника и спецификаций ресурсов (заданных
ции. Введена операция определения наибольшего в форме типов, классов, процессов). В действу-
общего редукта спецификаций типов ресурсов и ющем подходе используется вербальная (задавае-
посредника. На основе частично упорядоченного мая подобно определениям терминов в толковом
множества спецификаций типов определены также словаре) форма определения понятий. Вербальное
решетка и алгебра типов. Эти структуры послужи- представление онтологии дополняется более фор-
ли теоретической базой для разработки репозито- мальными спецификациями на основе абстрактных
рия метаинформации, хранящего спецификации типов данных канонической модели и техники до-
посредников, ресурсов, а также промежуточные казательства уточнения.
спецификации, возникающие в процессе отобра- Перечисленные подходы положены в основу
жения таких определений. разработанного прототипа средств идентификации

Принципиальным моментом в этой схеме и регистрации информационных ресурсов в посред-
является реализация доказательства уточнения нике [10]. При этом онтологические спецификации
фрагментов спецификаций посредника специфи- используются для идентификации классов посред-
кациями ресурсов в процессе построения отобра- ника, семантически релевантных классам ресурса.
жений таких спецификаций. Идентификация реле- Максимальное подмножество информации клас-
вантных ресурсов (предшествующая регистрации) са ресурса, релевантное классу посредника, уста-
основана на использовании трех моделей — модели навливается на основании максимального общего
метаданных, характеризующих свойства ресурсов, фрагмента спецификаций соответствующих типов
собранных в некотором реестре, онтологической мо- экземпляров этих классов. Конкретизирующие ти-
дели, позволяющей формально определять понятия пы, устраняющие возникающие конфликты (зна-

1UML — Unified Modeling Language — унифицированный язык моделирования.

ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008 5



Д. О. Брюхов, А. Е. Вовченко, В. Н. Захаров и др.

чений, структур данных и поведения) в названных Поскольку создание гибридной инфраструкту-
типах экземпляров, определяются так, чтобы тип ры касается, главным образом, сопряжения ис-
экземпляра класса посредника уточнялся бы типом полнительных механизмов двух инфраструктур, в
экземпляра класса ресурса. Основным результатом статье им и уделено основное внимание. Дальней-
регистрации является выражение, определяющее, шее изложение материала в статье структурировано
как класс ресурса выражается через посредство следующим образом. В разд. 2 рассматриваются
классов посредника. Архитектура и принципы по- основные виды предметных посредников и мето-
строения инструмента регистрации ресурсов в по- дология интеграции неоднородных ресурсов в них.
среднике, который является неотъемлемой частью В разд. 3 определена архитектура исполнительных
слоя посредников, определены в [10] и рассматри- механизмов предметных посредников. В разд. 4
ваться в деталях в настоящей статье не будут. особое внимание уделено переписыванию запросов

Существенным для данной работы является то к посредникам в планы их реализации над конкрет-
обстоятельство, что в Великобритании развивается ными информационными ресурсами. В разд. 5 рас-
система АстроГрид [12] как полная инфраструкту- сматриваются особенности инфраструктуры сис-
ра для создания систем решения научных задач в темы АстроГрид. В разд. 6 приведено краткое
астрономических ВО. Инфраструктура АстроГрида описание объединенной архитектуры АстроГрида
позволяет конструировать гибкие распределенные и средств поддержки исполнительного слоя пред-
структуры ВО, компонентами которых могут быть метных посредников. Пример реализации простого
разнообразные средства хранения данных и доступа предметного посредника для решения задач поиска
к ним, средства размещения и временного хранения далеких галактик в объединенной архитектуре дан
файлов в процессе решения задач группами пользо- в разд. 7. В разд. 8 дана краткая характеристика раз-
вателей, реестры метаданных, в которых регистри- вития методов интеграции неоднородных источни-
руются ресурсы ВО, средства программирования ков информации в инфраструктурах ВО. Наконец,
приложений и организации их интероперабельно- заключение статьи подводит итог обсуждению и
го исполнения, средства создания и исполнения намечает планы дальнейшего развития работы.
потоков работ, которые позволяют решать слож-
ные задачи в распределенной системе. Разнообраз-
ные подмножества такой совокупности компонен- 2 Виды предметных посредников
тов могут быть установлены на различных машинах.
Взаимодействие между компонентами основано на и методология интеграции
использовании технологии Веб-сервисов, а сами неоднородных ресурсов
компоненты являются Веб-приложениями. Ком-
поненты удовлетворяют стандартам IVOA там, где в посредниках
такие стандарты уже существуют. В случае, если
стандартов еще нет, АстроГрид предлагает проекты Одним из широко распространенных взглядов
стандартов для рассмотрения IVOA. на ВО является рассмотрение их как инфраструк-

По поддерживаемым функциям сервисы Астро- тур, предназначенных для интеграции данных и
Грида, в основном, соответствуют требуемым для сервисов в различных исследовательских центрах, с
реализации инфраструктуры РВО. АстроГрид уста- целью предоставления таким образом всем ученым
новлен в Москве для использования астрономами доступа к информации, необходимой для решения
в качестве Центра коллективного пользования [13]. задач. Виртуальная обсерватория может рассмат-
Вместе с тем, АстроГрид не предусматривает раз- риваться как специальная модель межорганизаци-
витых средств решения задач над множествами не- онного взаимодействия. Основным аспектом мо-
однородных информационных ресурсов, подобных делирования такой распределенной деятельности в
предметным посредникам, поэтому в 2006 г. при e-science, предусматривающей совместную работу
поддержке РФФИ был инициирован проект созда- организаций, является многообразие типов ресур-
ния гибридной архитектуры, объединяющей воз- сов для использования в процессе исследований и
можности АстроГрида с архитектурой предметных многообразие контекстов, в которых такие ресурсы
посредников. Целью настоящей статьи является могут рассматриваться. Часто такие ресурсы реали-
обзор достигнутых в этом проекте результатов раз- зуются как унаследованные приложения. Перспек-
вития такой гибридной архитектуры, акцентируя тивные подходы моделирования в e-science основа-
новые методы и средства определения предметных ны на фундаментальной стратегии интеграции, при
областей, информационных ресурсов и решения которой тот или иной фрагмент информации извле-
задач в гибридной инфраструктуре посредников и кается из некоторого исследовательского центра и
АстроГрида. помещается в иной контекст — контекст конкрет-

6 ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008



Архитектура промежуточного слоя предметных посредников для решения задач над множеством интегрируемых

ной задачи. Формирование и реализация нужного ники подхода, движимого информационными ре-
контекста задачи и моделирование интегрируемой сурсами.
информации в этом контексте являются основны- Другой подход (движимый приложениями)
ми проблемами определения посредников. предполагает создание предметного посредника,

Следующие соображения будут затронуты в ходе который поддерживает взаимодействие между при-
этого обсуждения. Различные приложения должны ложением и ресурсом на основе определения при-
поддерживаться ВО, каждое из них работает в соб- кладной области (определения посредника). Вто-
ственном, конкретном контексте (возможно, пе- рой подход имеет очевидные преимущества по
ресекающемся с контекстами других приложений), отношению к подходу, движимому информацион-
который должен быть определен семантически. Не- ными ресурсами. Процесс регистрации неодно-
однородные информационные ресурсы различных родных информационных ресурсов в предметном
видов (ресурсы данных, сервисные ресурсы, про- посреднике в подходе, движимом приложениями,
цессные ресурсы, онтологические ресурсы), реле- основан на технике GLAV, комбинирующей два
вантные ВО, должны использоваться в контексте подхода: LAV (Local as View) — когда локальная
конкретного приложения. Многие такие ресурсы схема ресурса является взглядом над схемой по-
автономны и эволюционируют во времени. Мно- средника — и GAV. Согласно LAV [15], схемы реги-
жество ресурсов, релевантных конкретному классу стрируемых ресурсов рассматриваются как матери-
задач, может изменяться весьма быстро. Техноло- ализованные взгляды над виртуальными классами
гии, применяемые к релевантным ресурсам, также посредника. В этом случае GAV взгляды слу-
быстро эволюционируют. Поэтому доказательно жат для разрешения различных конфликтов между
правильная идентификация ресурсов, релевантных спецификациями ресурсов и посредника и обес-
задаче, достижение семантической интеграции раз- печивают правила трансформации результатов за-
личных видов ресурсов в контексте конкретного проса от ресурса в представление в посреднике.
приложения, достижение стабильности специфи- Подобная техника регистрации обеспечивает ста-
кации проблемной области в быстро развивающем- бильность спецификации приложения ВО при из-
ся мире разнообразных ресурсов являются трудно- менении конкретных информационных ресурсов
разрешимыми задачами. Требуется создание новых и их фактического присутствия (удаление ресурса,
методов и средств разработки приложений ВО над добавление новых ресурсов и пр.), а также масшта-
множествами распределенных неоднородных ре- бируемость посредников по отношению к числу
сурсов. ресурсов, регистрируемых в них. В версии LAV,

Различаются два принципиально различных именуемой GLAV [16], голова определения правила
подхода к проблеме интегрированного представле- взгляда LAV может содержать произвольный запрос
ния описания предметной области задачи по от- над схемой ресурса и тем самым выразить случай,
ношению к множеству релевантных задаче инфор- когда схема ресурса используется для определения
мационных ресурсов: (1) двигаясь от ресурсов к составных частей глобальной схемы (GAV).
задачам (схема посредника образуется как интегри- Основными принципами разработки посредни-
рованная схема множества ресурсов независимо от ков ВО, движимых приложениями, над множе-
приложения) и (2) двигаясь от приложения к ре- ством неоднородных информационных ресурсов,
сурсам (описание предметной области приложения являются следующие:
образуется независимо от ресурсов (в терминах по- (1) независимость спецификации приложения
нятий, структур данных, функций, процессов), а (посредника) от существующих информацион-
затем релевантные приложению ресурсы отобража- ных ресурсов;
ются в это описание). Первый подход, движимый

(2) определение предметного посредника как ре-
информационными ресурсами, является немасшта-

зультата консолидации усилий соответству-
бируемым по отношению к числу ресурсов, не дает

ющего сообщества;
возможности достижения семантической интегра-
ции ресурсов в контексте конкретного приложе- (3) применение семантических канонических

ния, не ведет к доказательной идентификации ре- определений в спецификации посредника;

левантных приложению ресурсов, не способствует (4) независимость интерфейсов пользователя от
повышению стабильности спецификации посред- ресурсов, регистрируемых в посреднике; поль-
ника в процессе эволюции ресурсов, релевантных зователи должны только знать определение
приложению. Эти недостатки являются характер- предметной области (определение посред-
ными для подхода, при котором глобальная схема ника);
является взглядом (Global as View — GAV) [14, 15]. (5) независимость публикации вновь разработан-
Схема GAV может служить в качестве базовой тех- ных информационных ресурсов от посредни-

ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008 7



Д. О. Брюхов, А. Е. Вовченко, В. Н. Захаров и др.

ков (как результат такой публикации могут быть – один адаптер может работать с несколькими
инициированы действия по регистрации ресур- посредниками и с несколькими ресурсами;
сов в соответствующем посреднике); – адаптеры могут содержать собственную систему

(6) трехстадийная идентификация информаци- управления базами данных (СУБД) для выпол-
онных ресурсов, релевантных посреднику, нения сложных планов запросов;
обеспечивающая (а) релевантность ресурсов – связь между посредником и адаптерами обес-
нефункциональным требованиям, выражаемых печивается посредством SOAP1 протокола;
метаданными; (б) онтологическую релевант-
ность ресурсов; (в) структурную и поведенче- – база метаинформации посредников и вычисле-

скую релевантность ресурсов; ние остаточных запросов реализуются на СУБД
Oracle;

(7) семантическая интеграция релевантных неод-
– для задания запросов к посреднику пользова-

нородных информационных ресурсов в кано-
тель может использовать либо Веб-портал, либо

нической спецификации посредника;
специальный клиент.

(8) интегрированный доступ к информационным На рис. 1 показана общая архитектура исполни-
ресурсам, зарегистрированным в посреднике, тельных средств слоя посредников. Она содержит
на основе канонической модели и системы пе- следующие компоненты.
реписывания запросов;

(9) рекурсивная структура посредника: каждый по- Application Client. Клиентская программа, предо-
средник может быть зарегистрирован как но- ставляющая пользователю графический интерфейс
вый информационный ресурс. Такая способ- для работы с посредником, включающий:
ность посредника обеспечивает возможность – графические дружественные пользователю
интеграции различных приложений, что осо- средства, обеспечивающие поддержку приме-
бенно важно для разработки виртуальных орга- нения канонического языка запросов на уровне
низаций. посредников;

Принципы (1)–(8) определяют преимущества – поддержку запросов к посреднику на языке
разработки ВО на основе идеи посредников, при- Syfs2 [8];
меняя подход, движимый приложениями, по срав-

– услуги по удобному представлению выводимой
нению с подходом, движимым информационными

информации, включая сегментацию информа-
ресурсами.

ционных объектов, их агрегирование и слия-
Настоящая статья основана, главным образом,

ние.
на подходе, движимом приложениями.

Portal. Предоставляет доступ к посреднику через

3 Архитектура исполнительных Интернет. По набору функций эквивалентен обыч-
ному клиенту.

механизмов слоя предметных
посредников Run-time environment. Исполнительная среда слоя

посредников обеспечивает:

Основные решения реализации исполнитель- – обработку программ (запросов) пользователя;
ных средств слоя посредников заключаются в сле- – переписывание программ в запросы над заре-
дующем: гистрированными в посреднике ресурсами, от-

– предметный посредник представляет собой правку переписанных запросов на выполнение
Веб-сервис; соответствующим адаптерам;

– адаптеры неоднородных ресурсов, зарегистри- – получение результатов запросов от адаптеров;
рованных в посреднике, представляют собой – выполнение остаточного запроса и отправку
Веб-сервисы; результата запросов клиенту.

– посредники и адаптеры регистрируются в ре- Исполнительная среда включает следующие
естрах; компоненты:

1SOAP — Simple Object Access Protocol — протокол обмена структурированными сообщениями в распределенной вычислительной
среде.

2Syfs — подмножество языка формул в языке СИНТЕЗ.

8 ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008



Архитектура промежуточного слоя предметных посредников для решения задач над множеством интегрируемых

Рис. 1 Архитектура исполнительных средств слоя посредников

Supervisor является связующим компонентом по- SoapWrapper инкапсулирует детали физической ре-
средника и определяет его интерфейс. Supervisor ализации сервисов, которые используют компо-
обрабатывает запросы пользователя и для их вы- нент Supervisor и адаптеры. Таким образом, адапте-
полнения взаимодействует с другими компонента- ры могут быть реализованы как Веб-сервисы либо
ми посредника. Фактически код данного компо- как классы локальных программ.
нента реализует взаимодействие всех компонентов
в посреднике. Synth2Oracle реализует поддержку канонической

модели данных посредника над базой Oracle в пери-
Rewriter реализует функцию переписывания запро- од исполнения. Этот компонент позволяет загру-
са пользователя на языке Syfs над схемой посредни- жать и выгружать данные, которые в канонической
ка в запрос над зарегистрированными ресурсами, модели представляются как набор классов, пре-
который выражается на языке Asyfs1 и передается образованный в набор таблиц базы Oracle. Данные
компоненту Planner для дальнейшей обработки. загружаются и выгружаются в формате VOClass2.

Компонент Synth2Oracle реализует также поддерж-
Planner реализует функцию планирования запроса ку выполнения остаточных запросов на языке Asyfs,
над ресурсами. В результате планирования строится транслируя их в язык SQL.
распределенный запрос, состоящий из удаленных
запросов к отдельным ресурсам. Оптимизирован- Adapter. Адаптеры связывают посредник с конкрет-
ная последовательность выполнения удаленных за- ными ресурсами. В адаптерах происходит преобра-
просов определяет план, имеющий вид «дерева вы- зование запросов на языке посредника (Asyfs) в
полнения». язык конкретного ресурса и, наоборот, преобразо-

1Asyfs — алгебраический вариант языка Syfs.
2VOClasss — аналог представления таблиц в стандарте IVOA (в соответствии с XML Schema) для классов языка СИНТЕЗ.

ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008 9



Д. О. Брюхов, А. Е. Вовченко, В. Н. Захаров и др.

вание результата запроса, полученного в формате, используются только типизированные возможно-
выдаваемом ресурсом, в формат посредника. До- сти языка СИНТЕЗ. Обсуждение переписывания
полнительно, если это позволяет ресурс, адаптер запросов со слабоструктурированными (фреймо-
реализует возможность загрузки в базу ресурса про- выми) данными планируется в будущих работах.
межуточных классов периода выполнения запро- Множества в языке (наряду с мультимножества-
сов, которые используются в выполняемом адапте- ми, последовательностями) рассматриваются в ка-
ром запросе. честве общего механизма группирования значений

АТД. Класс рассматривается как подтип типа мно-
Metainformation and Data repository. Репозиторий жества. Поэтому эти, в общем, различные кон-
состоит из двух частей: репозиторий метаданных струкции могут использоваться единым образом:
и репозиторий данных. Репозиторий метаданных класс может использоваться везде, где может ис-
используется для хранения метаинформации по- пользоваться множество. Например, для формул
средника (такой как схема посредника, схемы заре- языка запросов исходные и результирующие дан-
гистрированных в посреднике ресурсов, правила, ные представляются множествами значений АТД
задающие соответствия между классами ресурсов (т. е. коллекциями) или множествами объектов (т. е.
и классами схемы посредника посредством GLAV), классами).
используемой при преобразовании запросов. Ре-
позиторий данных используется для хранения про-
межуточных результатов запросов, возвращаемых 4.1.1 Операции над спецификациями типов

ресурсами, и для выполнения остаточных запросов Семантика операций над классами в канониче-
над этими данными. ской модели объясняется в терминах композици-

онного исчисления спецификаций [11]. Действия в
исчислении включают декомпозицию специфика-

4 Методы переписывания ций типов в непротиворечивые фрагменты (редук-
ты), выделение общих фрагментов, композицию

запросов и планирования выделенных фрагментов в более сложные специ-
в предметных посредниках фикации соответствующих результирующих типов

SPJ (select, project, join) операций. Исчисление

4.1 Основные характеристики ядра использует следующие концепции и операции.
Сигнатура ›T спецификации типа T = 〈VT ,

канонической модели OT , IT 〉 включает множество операций OT , зада-
В настоящем проекте в качестве ядра кано- ющих типы аргументов и результатов операций, и

нической модели посредника выбран язык СИН- множество предикатов инвариантов типа IT . Конъ-
ТЕЗ [8], который является гибридной слабострук- юнкция всех инвариантов из IT формирует инвари-
турированной/объектной моделью [17]. В этом ант типа. Экстенсионал VT типа T (носитель типа)
разделе приводятся основные особенности языка, есть множество допустимых экземпляров типа.
необходимые для понимания примеров, демонст- Определение 1. Редукт типа. Сигнатура редук-
рирующих идеи переписывания запросов. та RT типа T определяется как подсигнатура ›′

T
Рассматриваемое композиционное исчисление сигнатуры типа›T , которая включает носитель VT ,

спецификаций [11] не зависит от какой-нибудь множество символов операций O′
T ⊆ OT , множе-

определенной информационной модели. Кано- ство символов инвариантов I ′T ⊆ IT .
ническая модель [8] предоставляет поддержку

Это определение легко можно расширить с уров-
широкого диапазона данных — от слабострукту-

ня сигнатур до уровня спецификаций таким обра-
рированных до строго типизированных данных.

зом, что тип редуктаRT может рассматриваться как
Типизированные данные являются экземплярами

подспецификация (с сигнатурой ›T ) специфика-
абстрактных типов данных (АТД). Спецификация

ции типа T . Спецификация RT должна формиро-
АТД включает имена и типы параметров операций,

ваться так, что RT становится супертипом типа T .
определяющих поведение типа. Операции опреде-

Предполагается, что только состояния, допусти-
ляются также предикативными спецификациями,

мые для типа, остаются допустимыми для редукта
описывающими смешанные пред- и постусловия.

этого типа (никакие другие состояния не являются
Абстрактные типы данных могут быть объектными

допустимыми). Таким образом, носитель редукта
и необъктными. Объектный тип является подтипом

предполагается равным носителю типа.
необъектного АТД с дополнительной операцией self
на своем интерфейсе, предоставляющей уникаль- Определение 2. Наиболее общий редукт R(T1, T2)
ные идентификаторы объектов. В данной статье для типов T1 и T2 — это редукт RT1 типа T1 такой,

10 ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008



Архитектура промежуточного слоя предметных посредников для решения задач над множеством интегрируемых

что существует редукт RT2 типа T2 такой, что RT2 только один раз. Общие элементы типов определя-
уточняет RT1 , и не существует другого редукта R′

T ются с помощью наиболее общих редуктовR(T1 , T2)1

такого, что R(T1, T2) является редуктом R′
T , R′

T не и R(T2, T1). Формально OT1|T определяется как
1 1 2

равен R(T1, T2), и существует редукт R′
T типа T ,
2 2 ( ) ( )

который уточняет R′
T . OT1|T = O \O

2 T1 R(T ∪
1,T2) OT2\OR(T2,T1) .

1

ТипC является уточнением типаR тогда и только
тогда, когда: Инвариант типа T определяется как конъюнк-

ция инвариантов операндов InvT1 ∧ InvT2 .
– существует биективное отображение Можно заметить, что если T2(T1) является под-
Ops: OR → OC ; типом типа T1(T2), то T2(T1) является результатом

– существует всюду определенная функция аб- операции соединения типов. Тип T помещается в
стракцииAbs: VC → VR; решетку типов как подтип типов операндов опера-

ции.
– для всех ν ∈ VC : InvC(ν) влечет InvR(Abs(ν)); Операции композиционного исчисления фор-
– для всех o ∈ OR, o уточняется Ops(o). мируют решетку типов [11] на основе отноше-

Операция o1 уточняет o2 тогда и только тогда, ния подтипа (как отношения частичного поряд-

когда предусловие операции pre(o2) влечет пред- ка). В языке СИНТЕЗ операции композиции типов

условие pre(o1) и постусловие post(o1) влечет пост- используются для формирования типовых выраже-

условие post(o2). Для сигнатур операций уточне- ний, которые в языке используются для определе-

ние означает, что сигнатуры совпадают с точностью ния типа. Типовые выражения включают следу-

до следующего отношения типов параметров: ти- ющие конструкции:

пы входных параметров операции o1 являются су- – указатель типа (T );
пертипами типов соответствующих входных пара-
метров операции o2 и типы выходных параметров – конструкция редукта (R[e1, . . . , en], гдеR— ука-
операции o1 являются подтипами типов соответст- затель типа, ei — элементы редукта);
вующих выходных параметров операции o2. – выражения (T ), T |S и T&S, где T и S — указа-

Основываясь на понятиях редукта и уточнения тели типов.
типов, можно установить меру общей информации
между типами в решетке типов T . Отношение под- Конструкция редукта имеет следующий вид:
типа определяется подобно уточнению, толькоOps R[e1, . . . , en], где R — исходный АТД, ei — элемен-
становится инъективным отображением. ты редукта, каждый из которых определяет атрибут

образуемого АТД. Редукт определяет также функ-
цию преобразования экземпляров исходного АТД

Определение 3. Операция пересечения типов. В об-
в экземпляры редукта. В общем случае элемент

щем случае тип T — результат операции T1&T2 —
редукта имеет следующий вид:

включает атрибуты, общие для типовT1 иT2. Общие
элементы типов определяются с помощью наиболее

a/T : t ,
общих редуктов R(T1, T2) и R(T2, T1). Формально
OT1&T2 определяется следующим образом: где a— идентификатор атрибута,T — тип, t— атри-

бутный путь (вида a1.a2. . . . .ak). Доступны следу-
OT1&T2 = OR(T1,T2) ∪OR(T2,T1) . ющие сокращенные формы элементов редукта:

Инвариант типа T определяется как дизъюнк- – a : t — сокращение для a/T : t, где T — тип тер-
ция инвариантов операндов InvT1 ∨ InvT2 . ма t (т. е. для пути a1. . . . .ak его типом является

Можно заметить, что если T2(T1) является под- тип атрибута ak);
типом типа T1(T2), то T1(T2) является результатом

– a/T и a — сокращения для a/T : a и a : a соот-
пересечения типов. Тип T помещается в решетку

ветственно.
типов как супертип типов операндов этой опера-
ции. Редукт R[a1/T1 : t1, . . . , an/Tn : tn] образует АТД

TR, который содержит атрибуты a1, . . . , an, типы
Определение 4. Операция соединения типов. В общем которых соответственно: T1, . . . , Tn. Функция пре-
случае типT — результат операции T1|T2— включа- образования экземпляров АТД R в экземпляры ре-
ет объединение спецификаций типов T1 и T2. дукта типа определяется следующим образом:

Общие элементы спецификаций типов T1 и T2
включаются в объединение (результирующий тип) P (x) = {y ∈ TR|y.a1 = x.t1, . . . , y.an = x.tn} .

ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008 11



Д. О. Брюхов, А. Е. Вовченко, В. Н. Захаров и др.

4.1.2 Подмножество языка запросов СИНТЕЗ C1(ν1/Tν1)& . . .&Cn(νn/Tνn)&

В статье рассматривается ограниченное под- F1(X1, Y1)& . . .&Fm(Xm, Ym)&B .
множество языка запросов СИНТЕЗ, ориентиро-
ванное на представление объединения конъюнк- Сначала выполняется соединение коллек-
тивных запросов с SPJ семантикой. ций, которые определяются предикатами классов

Для определения формулы запроса использу- Ci(νi/Tνi). Предикат класса C(ν/T ) формирует
ется разновидность типизированного (многосорт- результирующую коллекцию, которая строится на
ного) языка логики предикатов первого порядка. основе проекции класса C, где проекция опреде-
Предикаты в формуле соответствуют коллекциям ляется типом T . В общем случае T является ре-
(таким как множества и мультимножества необъ- дуктом R[a1/T1 : t1, . . . , an/Tn : tn], и к экземпля-
ектных экземпляров), классам, которые рассма- рам класса C применяется определяемая редуктом
триваются как множества объектных значений, и функция преобразования. Типом результирующей
функциям. Предикат класса (или предикат кол- коллекции является АТД RC(ν/T ) с атрибутами
лекции) всегда унарный предикат. Предикат функ- ν, a1, . . . , an, типы которых есть, соответственно:
ции F синтаксически имеет вид n-арного преди- T, T1, . . . , Tn.
ката F (X,Y ), где X — последовательность термов, Множество экземпляров результирующей кол-
соответствующих входным параметрам функции, лекции является следующим:
Y — последовательность типизированных резуль- {y ∈ RC(ν/T )|∃x ∈ C :
тирующих атрибутов (конструкция вида y/Y , где
Y определяет тип атрибута y), соответствующих y.ν = x , y.a1 = x.t1, . . . , y.an = x.tn} .
выходным параметрам функции (результирующие

Результатом соединения двух коллекций C
атрибуты принимают значения соответствующих 1 и

C2 с типами экземпляров T1 и T2, соответственно,
выходных параметров). В качестве термов мо-

является коллекция C1&C2, тип экземпляров кото-
гут выступать: переменные, константы, атрибу-
ты, функции (включая арифметические функции), рой равен T1|T2, и множество экземпляров опреде-

ляется следующей формулой:
конструкция взятия атрибута t.a, где t— терм и a—
атрибут из АТД, типизирующего t. Частным случа- C1&C2 = {x ∈ T1|T2|∃y1 ∈ C1 , y2 ∈ C2 :
ем функции является операция (метод), где первым
входным параметром передается экземпляр АТД, в x = y1 , x = y2)} .
котором определен метод. Затем по очереди вычисляются функции Fj, и к

результирующей коллекции присоединяются (are
Определение 5. Конъюнктивным запросом СИНТЕЗа appended) результирующие атрибуты.
(Synthesis Conjunctive Query, SCQ) является правило Вычисление функции выполняется для каждого
следующего вида экземпляра исходной коллекции. Значения атри-

бутов текущего экземпляра могут использоваться
q(ν/Tν) : −C1(ν1/Tν1)& . . .&Cn(ν/Tνn)& при вычислении значений термов, аргументов для

входных параметров функции, и текущий экзем-
F1(X1, Y1)& . . .&Fm(Xm, Ym)&B ,

пляр расширяется результирующими атрибутами
где q(ν/Tν), C1(ν1/Tν1), . . . , Cn(νn/Tνn) — пре- предиката функции.
дикаты коллекций (классов); F1(X1, Y1), . . ., После этого выбираются только те экземпляры
Fm(Xm, Ym)— предикаты функций,B — ограниче- результирующей коллекции, для которых выпол-
ние, представляющее собой конъюнкцию арифме- няется ограничение B. Результирующий класс q
тических предикатов. Каждый предикат Ci(νi/Tνi) формируется как проекция результирующей кол-
или Fj(Xj , Yj) называется подцелью. Подцели и B лекции тела, которую описывает редукт Tν в голове
называются телом правила, q(ν/Tν) называется го- правила.
ловой правила. Запрос SCQ также называется пра- Два запроса SCQs с головами q1(ν1/T1) и
вилом. Семантика SPJ тела SCQ будет приведена q2(ν2/T2)называются сравнимыми, если типT1 явля-
далее. ется подтипом типа T2. Для двух сравнимых за-

В языке Syfs допускаются правила, представля- просов q1 и q2 запрос q1 содержится в запросе q2
ющие собой объединение правил с SPJ cемантикой. (обозначается q1 ⊆ q2), если для любого экземпля-
Несколько правил на языке Syfs составляют про- ра базы данных все экземпляры результирующего
грамму. класса q1 являются экземплярами результирующе-

Общая схема вычисления результирующей кол- го класса q2, т. е. результирующий класс q1 является
лекции тела SCQ имеет следующий смысл: подклассом результирующего класса q2.

12 ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008



Архитектура промежуточного слоя предметных посредников для решения задач над множеством интегрируемых

4.2 Регистрация ресурсов в посреднике Инверсные правила определяют, как отдельные
и инверсные правила подцели класса, выраженные в терминах схемы по-

средника, могут быть переписаны в подцели, выра-
В предметном посреднике процесс регистрации женные в терминах взглядов GAV и схем ресурсов.

неоднородных информационных ресурсов основан Например, для того чтобы получить переписыва-
на подходе LAV/GLAV. Подход GLAV позволяет го- ние правила, которое содержит вхождения C(x/T ),
лове взгляда LAV содержать элемент, выраженный можно заменить вхождения C(x/T ) вхождениями
запросом над схемой ресурса, и таким образом вы- V ( /R), если при этом существует инверсное пра-
ражать случай, когда схемы ресурса используются вило C(x/T )) ← V ( /R) и редукты T и R задают
для определения конструкций глобальной схемы типы, связанные так, что R уточняет T .
(GAV). Подход GAV позволяет задавать функции В общем случае редукт R не включает все атри-
разрешения различных видов конфликтов между буты, которые определяются в теле взгляда, и по-
спецификациями ресурса и посредника. Он также этому редукт R должен быть расширен в процессе
позволяет задавать правила преобразования резуль- сколемизации. Так как в нашей информационной
татов запросов от ресурса в посредник. модели атрибуты определяются как соответству-

Таким образом, процесс регистрации заключа- ющие get-функции, мы рассматриваем get-функции
ется в конструировании множества взглядов GLAV, атрибутов, которые формируют расширение, как
которые имеют следующий вид: сколемовские функции (помечая их символом #).

– правило LAV Например, во взгляде

V (ν/Tν) :−Cm1(ν1/Tν1)& . . .&Cmn(νn/Tνn)& ν( /R[a, b]) : −p(x/Tp[a, b])&q(y/Tq[b, c])&f(x, z)

Fm1(X1, Y1)& . . .&Fmm(Xm, Ym)&Bm ;
редукт в голове не включает атрибуты x, y, c и z,

– правило GAV которые определяются в теле взгляда, поэтому ре-
дукт расширяется сколемовскими атрибутами #x,

V (ν/Tν) :− Cs1(ν1/Tν1)& . . .&Csn(νn/Tνn)& #y,#c и#z:

Fs1(X1, Y1)& . . .&Fsm(Xm, Ym)&Bs , R[a, b, x : #x, y : #y, c : #c, z : #z] .
гдеCmi — предикат класса посредника; Fmi —
предикат функции посредника; Cs Затем на основе сколемизированного взгляда

i — преди-
кат класса ресурса; Fsi — предикат функции строятся два инверсных правила:
ресурса или функция разрешения конфликтов;
Bm и Bs — ограничения. p(x/Tp[a, b])← ν( /R[a, b, x : #x])

Формально переписывание запросов основано и
на понятии инверсного правила (ИП). Рассматри- q(y/Tq[b, c])← ν( /R[b, y : #y, c : #c]) .
ваются два вида инверсных правил: инверсное пра-
вило класс в класс и инверсное правило функция Инверсные правила функция в функцию за-
в функцию. Инверсное правило класс в класс по- даются непосредственно в процессе регистрации.
лучается из взгляда LAV как пара головы взгляда и Инверсное правило функция в функцию является
подцели взгляда. Инверсное правило класс в класс формулой следующего вида:
имеет следующий вид:

all x1/T1, . . . , xn/Tn (F (t, y)← G(s, y)) ,
C(x/T )← V ( /R) ,

где x
где предикат 1, . . . , xn — переменные типов T1, . . . , Tn, t

C(x/T )— голова инверсного правила
и s — термы с вхождениями этих переменных, а

и V ( /R)— тело инверсного правила (символ под-
y — результирующий атрибут. Инверсное правило

черкивания обозначает анонимную переменную).
функция в функцию выражает отношение уточне-

Для взгляда
ния между двумя функциями таким образом, что
тело инверсного правила G(s, y) уточняет голову

V ( /R) :− C1(x1/T1)& . . .&Cn(xn/Tn)& инверсного правила F (t, y) как функций над пере-
F1(t1, y1)& . . .&Fm(tm, ym)&B менными x1, . . . , xn, y. Инверсные правила функ-

конструируются следующие инверсные правила ция в функцию используются для переписывания

класс в класс: подцелей функции аналогично тому, как инверсные
правила класс в класс используются для переписы-

C1(x1/T1))← V ( /R), . . . , Cn(xn/Tn))← V ( /R) . вания подцелей класса.

ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008 13



Д. О. Брюхов, А. Е. Вовченко, В. Н. Захаров и др.

4.3 Переписывание запросов где E = z1 = t1& . . .&zm = tm, s
′ получает-

ся из s посредством применения u, т. е. вхожде-
Для поддержки подхода GLAV был разработан

ния переменных x1, . . . , xn заменяются на термы
алгоритм переписывания запросов [18], состоящий

t′
из трех фаз: формальное переписывание и семанти- 1, . . . , t

′
n соответственно, и вхождения переменных

z1, . . . , zm заменяются на термы t1, . . . , tm соответ-
ческий анализ, реализующие подход LAV и третья

ственно. Например, инверсное правило функция
фаза — разворачивание взглядов GAV. Для нерекур-

в функцию all x/real (f(45, x, y) ← g(x, y)) мож-
сивных программ запроса, состоящих из несколь-

но унифицировать с предикатом функции f(a, b, c)
ких правил, переписывание применяется к каждо-

и с преобразованным телом инверсного правила:
му правилу в отдельности. Реализация подхода LAV

g(b, c)&a = 45.
основана на разновидности алгоритма инверсных
правил [19], расширенного для типизированного Для заданного правила

языка запросов [20]. К результатам фазы формаль-
ного переписывания применяется семантический Q( /R) : −C1(x1/T1)& . . .&Cn(xn/Tn)&

анализ, который выполняет проверку на выполни- F1(t1, y1)& . . .&Fm(tm, ym)&B
мость правил и устраняет вхождения сколемовских
функций. и набора инверсных правил такого, что уни-

Формальное переписывание применяется к телу фикация инверсного правила класс в класс с
правила. Для каждой подцели, которая не являет- подцелью Ci(xi/Ti) влечет преобразование тела
ся встроенным предикатом, выбирается такое ин- правила Vi( /Ri), а унификация инверсного пра-
версное правило, голова которого унифицируется вила функция в функцию с подцелью Fj(tj , yj)
с этой подцелью. Унификация головы инверсного влечет преобразование тела инверсного правила
правила с подцелью также влечет следующее пре- Gj(sj , yj)&Ej , формируется следующее переписы-
образование тела инверсного правила. вание:

Инверсное правило класс в класс
Q( /R) : −V1( /R1)& . . .&Vn( /Rn)&G1(s1, y1)& . . .

C(x/T [x1/T1 : t1, . . . , xn/Tn : tn])← . . .&Gm(sm, ym)&E1& . . .&Em&B .
← V ( /R[x/T : y , x1/T1 : y1, . . . , xn/Tn : yn]) , Построенное переписывание правила включа-

где t ется в исходное правило и таким образом форми-
1, . . . , tn — пути атрибутов, можно унифициро-

вать с подцелью рует подзапрос.

C′(z/T ′[z1/S1 : t1.s1, . . . , zk/Sk : tk.sk]) , 4.4 Семантический анализ
где k ≤ n, C — подкласс класса C′, Si — подтип Полученные в результате формального перепи-
типа Ti, а s1, . . . , s2 — пути атрибутов. сывания правила могут содержать сколемовские

Преобразованное тело инверсного правила функции и невыполнимые ограничения, поэто-
строится как следующий предикат класса: му необходимо применить дополнительный анализ
V ( /R[z/T : y, z1/S1 : y1.s1, . . . , zk/Sk : yk.sk]) .

для того, чтобы образовать правила, не содержащие
сколемовские функции, и отбросить невыполни-

Инверсное правило функция в функцию мые правила. В ходе данной фазы отслеживаются
атомарные значения всех термов из правила, кото-

all x1/T1, . . . , xn/Tn (F (t, y)← G(s, y)) рые привязываются к отдельным переменным.
Для терма t, который имеет не скалярный тип,

можно унифицировать с подцелью F (t′, z), если
такой как АТД с атрибутами a1, . . . , an, выполня-

унификация термов t и t′ может быть установлена
ется рекурсивно привязка к переменным термов

со следующим наиболее общим унификатором как
t.a1, . . . , t.an. Проекции и соединения транслиру-

подстановкой
ются во множество равенств над этими переменны-

u = {t′1|x ми. Предикаты функций транслируются в равен-
1, . . . , t

′
n|xn, . . . , t1|z1, . . . , tm|zm} ,

ства вида f(ν1, . . . , νn) = y.
где переменные zi имеют вхождения в терме t′, t′i — Например, для правила
подтермы терма t′, а ti — подтермы терма t. Пре-
образованное тело инверсного правила строится r( /T [a, b]) : −p( /T [a, b, c])&f(c, y)
как следующая конъюнкция:

атрибуты предиката головы привязываются к пе-
G(s′, z)&E , ременным ν1 и ν2, атрибуты в предикате класса —

14 ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008



Архитектура промежуточного слоя предметных посредников для решения задач над множеством интегрируемых

к переменным ν3, ν4, ν5, атрибут y — к перемен- независимо. Разворачивание взгляда GAV в под-
ной ν6. Правило транслируется в множество ра- цели правила выполняется как унификация головы
венств: ν1 = ν3, ν2 = ν4, f(ν5) = ν6. Для построения взгляда GAV с этой подцелью. Унификация влечет
конгруэнтных классов термов к множеству равенств преобразование тела взгляда GAV. Дополнительно,
применяется разновидность алгоритма конгруэнт- в качестве оптимизации, из преобразованного те-
ного замыкания [21]. Множество конгруэнтных ла взгляда GAV удаляются все предикаты функции,
классов предоставляет удобную форму для пред- результирующие атрибуты которых не используют-
ставления множества равенств с учетом свойства ся. Полученным телом взгляда GAV заменяется
транзитивности равенств. вхождение данной подцели. Для того чтобы при

Например, из множества равенств ν1 = ν3, подстановке тела взгляда замкнутые переменные
ν2 = ν4, f(ν5) = ν6 конструируется два конгру- и атрибуты (не встречающиеся в голове взгляда
энтных класса ν1, ν3 и ν2, ν4. Анализ правила и GAV) не вступали в конфликт с другими замкну-
взглядов LAV выполняется в терминах этого пред- тыми переменными правила, к идентификаторам
ставления. Конгруэнтные классы, получаемые из замкнутых атрибутов и переменных приписывает-
взглядов LAV, на которые имеются ссылки в правиле ся уникальный суффикс.
(посредством предикатов классов), представляют Например, рассмотрим следующие два взгляда
равенства, имплицируемые взглядами, и поэтому GAV:
они безопасно могут быть исключены из множе-
ства равенств правила. Затем по множеству ра- r1( /[a, b, c]) : −p1(x/[a, b, c])
венств восстанавливаются правила, которые уже не r2( /[a, b]) : −p2(x/[a, c])&p3(y/[b, c])
содержат сколемовские функции. Таким образом,
реализуется устранение сколемовских функций в и правило, для которого выполняется разворачива-
фазе семантического анализа. ние этих взглядов:

Наряду с устранением сколемовских функций
выполняется проверка выполнимости правил. До- r( /[a]) : −r1(/[a, c])&r2(/[a, b]) .
полнительно собираются все арифметические пре- Результат разворачивания взглядов GAV будет
дикаты, обнаруженные в ограничении правила и следующим:
в ограничениях, использующихся в правиле LAV
взглядов. Арифметические предикаты обрабатыва- r( /[a]) : −p1(x1/[a, b])&p2(x2/[a, c1])&p3(y1/[b, c1]).
ются в терминах привязки к переменным, и сле-
довательно, рассматриваются только переменные,
константы и арифметические предикаты. Рассмат- 4.6 Планирование распределенного
риваются арифметические предикаты <,≤,≥,>, и запроса
для проверки выполнимости конструируется граф
неравенств [22]. Также выделяется граф неравенств, В посреднике запрос переписывается в после-

который строится из арифметических предикатов, довательность запросов, выраженных в терминах

порождаемых взглядами, и используется для устра- ресурсов, зарегистрированных в посреднике. Так

нения арифметических предикатов, которые связа- как в реальности посредник имеет дело с удаленны-

ны со сколемовскими функциями. ми неоднородными ресурсами, доступ к которым
осуществляется посредством адаптеров к этим ре-
сурсам, возникает необходимость в решении задачи

4.5 Разворачивание взглядов GAV планирования распределенного запроса. В процес-
се планирования выделяются подзапросы к отдель-

Первые две фазы производят переписанные ным ресурсам, а также остаточный запрос, который
правила, которые могу ссылаться на взгляды GAV. будет выполняться в посреднике над результатами,
Для того чтобы получить переписывания правил, полученными от этих локальных ресурсов. В архи-
выраженные в терминах локальных схем, выполня- тектуре посредника поддерживаются ресурсы, ко-
ется разворачивание взглядов GAV. В нашем под- торые могут принимать внешние коллекции (т. е.
ходе проблема разворачивания взглядов GAV рас- предоставляют интерфейс для загрузки данных во
сматривается в контексте ограниченного случая, временное хранилище ресурса), и позволяют ис-
так как в результате процесса регистрации обра- пользовать загруженные коллекции в запросах к
зуются взгляды GAV, которые не имеют общих этим ресурсам (в примере, который рассматрива-
локальных функций и классов. Поэтому можно ется в данной статье, в качестве ресурса с такими
выполнять разворачивание каждого взгляда GAV возможностями выступает ресурс SDSS1). Поэтому

1SDSS — Sloan Digital Sky Survey — Цифровой обзор неба Слоан.

ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008 15



Д. О. Брюхов, А. Е. Вовченко, В. Н. Захаров и др.

в процессе планирования необходимо решить, ку- Community обеспечивает регистрацию и пер-
да передаются данные: от одного ресурса к другому сональную аутентификацию пользователей. Для
или в посредник. Подробнее этап планирования за- управления учетными записями пользователей
проса будет рассмотрен для примера задачи поиска предоставляется Веб-интерфейс. Учетная запись
далеких галактик. пользователя позволяет использовать компонент

АстроГрида MySpace, который может потребовать-
ся для решения научных задач.

5 АстроГрид как основа MySpace представляет собой виртуальное хра-
нилище данных, к которым могут иметь доступ все

инфраструктуры Российской сервисы системы АстроГрид. Компонент MySpace

виртуальной обсерватории используется для хранения и передачи файлов меж-
ду сервисами в рамках одной задачи и между зада-

Цель системы АстроГрид — поддержка инфра- чами, решаемыми при помощи ВО.

структуры для решения научных задач в астрономи- Common Execution Architecture (CEA — Об-
ческих ВО. Для решения научных задач АстроГрид щая исполнительная архитектура) определяет спо-
предоставляет средства доступа к астрономическим соб оформления приложения в сервис АстроГрида.
каталогам, цифровым обзорам и архивам изобра- Приложения могут быть трех видов: Веб-сервисы,
жений, а также к реестрам метаданных, в которых приложения командной строки unix, приложения
регистрируются ресурсы ВО. Система обеспечива- Java. Приложение, оформленное как CEA, обладает
ет размещение файлов и хранение промежуточных рядом преимуществ:
результатов в процессе решения задач группами – вызывается как из потоков работ, так и как на-
пользователей, средства доступа к реестрам мета- стольное приложение, при этом не требуется
данных, в которых регистрируются ресурсы ВО, изменения кода клиентских программ;
средства создания и исполнения потоков работ,
средства взаимодействия между различными внеш- – регистрируется и обнаруживается в реестрах
ними приложениями в распределенной среде ВО. АстроГрида;

Система АстроГрид построена на основе архи-
– приложение может считывать и записывать

тектуры Веб-сервисов. Каждый компонент систе-
данные в MySpace;

мы представляет собой Веб-сервис, который реа-
лизует определенную функцию. Веб-сервисы могут – может выполняться в асинхронном режиме, что
располагаться как на одном сервере, так и на раз- важно в случае продолжительных задач;
ных серверах, что позволяет добиться максималь-
ной гибкости и производительности. Далее рас- – приложение может быть защищено средствами
сматриваются основные компоненты АстроГрида. безопасности системы АстроГрид, если требу-

Registry (реестр) представляет собой коллекцию ется ограничить доступ к нему;
метаданных — XML-документов, описывающих ре- – приложение может использоваться без написа-
сурсы, которые могут использоваться при решении ния дополнительного кода: CEA предоставляет
задач с помощью ВО. Registry реализован на осно- Веб-сервис, в который встраивается приложе-
ве стандарта OAI PMH1 [23], специализированного ние.
IVOA для нужд ВО. Поиск в Registry осуществля-
ется по ключевым словам на этапе планирования DataSet Access (DSA) реализует подключение
и выполнения приложений. В качестве ресурсов базы данных к системе АстроГрид. Компонент
могут выступать приложения, сервисы, информа- DSA предоставляет два интерфейса доступа: CEA-
ционные ресурсы, компоненты АстроГрида, а со- приложение, которое выполняет запросы к базе
ответствующие им метаданные в Registry содержат данных; Cone Search, который позволяет произ-
сведения о том, где располагаются ресурсы, как они водить поиск в некоторой заданной области неба.
могут быть использованы, кем разработаны, для В настоящее время для использования баз данных
чего предназначены и т. д. Схемы для метаданных, в DSA поддерживаются следующие СУБД: Post-
хранящихся в Registry, а также интерфейсы сер- greSQL, MySQL, MS SQL Server, HSQLDB.
висов определены спецификациями IVOA. Registry Astro Runtime обеспечивает доступ к серви-
поддерживает функцию сбора информации о ре- сам и ресурсам ВО посредством простого про-
сурсах, зарегистрированных в других реестрах ВО граммного интерфейса, функции которого могут
(harvesting). быть вызваны из любых приложений. Библиотеки

1OAI-PMH — Open Archives Initiative Protocol for Metadata Harvesting — архивный открытый протокол сбора метаданных.

16 ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008



Архитектура промежуточного слоя предметных посредников для решения задач над множеством интегрируемых

для работы с Astro Runtime разработаны для ряда данных и ресурсно-интенсивный характер при-
языков. Таким образом, обеспечивается возмож- кладных задач ВО. Во многих случаях данные
ность создания новых приложений, взаимодейству- не существуют как удаленные, их еще нет во
ющих с ВО. время формулирования задач: они могут быть

PLASTIC (PLatform for Astronomical Tool Inter Co- извлечены из баз данных по запросам, форму-
operation) — это протокол, обеспечивающий взаи- лируемым при реализации задач;
модействие между средствами АстроГрида и внеш-
ними программными инструментами в среде ВО. – создание программ для большинства астроно-
Посредством PLASTIC приложения могут обмени- мических проектов является основной пробле-
ваться данными или управлять друг другом, на- мой при разработке и эволюции ВО, поэтому
пример одно приложение может попросить другое модульность архитектуры, способствующей по-
загрузить изображение некоторой области неба и вторному использованию и композиции про-
работать с полученным результатом запроса. Хо- грамм является основополагающим принци-
тя подобные операции достаточно просты, но они пом построения инфраструктуры РВО;
открывают дополнительные возможности для вза-
имодействия между приложениями в среде ВО. – учитывая существование тысяч астрономиче-

Workbench — это клиент системы АстроГрид, ко- ских архивов и каталогов в мире, формирование
торый позволяет работать с астрономическими ре- глобальной схемы базы данных для ВО явля-
сурсами. Workbench включает: ется не масштабируемым подходом. Поэто-

му основным принципом инфраструктуры ВО
– Task Launcher — позволяет запускать удален- является следование идее предметных посред-

ные приложения (CEA), реализующие запросы ников, обеспечивающих взаимодействие меж-
к астрономическим каталогам данных, и/или ду исследователями и релевантными ресурсами
их обработку, например СrossMatch; информации на основе спецификации пред-

– Workflow Builder — позволяет конструировать метной области для соответствующего класса
потоки работ, состоящие из шагов, которые мо- задач.
гут выполняться последовательно, параллельно
или в цикле; Анализ показывает, что использование Астро-

Грида в качестве основы РВОИИ позволяет ре-
– MySpace Browser — позволяет манипулировать ализовать перечисленные принципы, а именно:

пользовательскими данными, находящимися в поддержку грид-интероперабельных сервисов, мо-
MySpace; дульность архитектуры, возможность повторного

– LookOut — позволяет следить за выполняющи- использования и композиции сервисов, создание
мися задачами (или потоками работ), предо- многослойной архитектуры. Компоненты Астро-
ставляет возможности отмены, паузы или до- Грида являются непосредственно применимыми в
срочного завершения задачи; качестве ядра архитектуры РВОИИ:

– AstroScope — позволяет находить все ресурсы, – Registry — для поиска ресурсов в реестрах на
связанные с некоторым астрономическим объ- основе метаданных;
ектом;

– HelioScope — обеспечивает доступ к данным по – MySpace — для управления виртуальными
Солнцу. областями хранения данных совместного поль-

зования;
Согласно аванпроекту информационной ин-

фраструктуры РВО (РВОИИ) [1], основными прин- – Workbench — для интерфейса пользователя ВО
ципами построения инфраструктуры являются сле- и решения задач на основе потоков работ;
дующие:

– Community — для администрирования и управ-
– архитектура реализуется как иерархия взаимо-

ления доступом к данным ВО;
действующих между собой Веб-сервисов (во-
площаемых в грид-архитектуре по мере того,

– CEA — в качестве средства поддержки сети ин-
как такие архитектуры будут созревать и бу- тероперабельных сервисов;
дут окончательно стандартизированы мировым
сообществом); – DSA — в качестве средств хранения данных,

– приближение обработки к данным, мотивацией размещаемых на требуемом уровне реализации
для чего является большой объем накопленных системы (задачи).

ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008 17



Д. О. Брюхов, А. Е. Вовченко, В. Н. Захаров и др.

6 Гибридная архитектура на основе UCD (Unified Content Descrip-

АстроГрида и исполнительных tion) [2] — унифицированных дескрипторов
контента, широко используемых в астрономии.

средств поддержки слоя В данном разделе рассматриваются, в основном,
предметных посредников те компоненты гибридной архитектуры, которыми

дополняется система АстроГрид, а также исполни-
При разработке гибридной архитектуры во главу тельные средства слоя посредников (рис. 2). Ком-

угла ставилась задача обеспечения интероперабель- поненты самой системы АстроГрид и компоненты
ности компонентов слоя предметных посредников исполнительных средств слоя посредников описа-
и АстроГрида. В качестве необходимых были выде- ны ранее.
лены следующие возможности гибридной архитек- Посредник может регистрироваться в реестрах
туры: АстроГрида в двух вариантах: как CEA-приложение

– регистрация и поиск посредников в реестрах или как DSA-компонент. Стоит отметить, что один
АстроГрида; и тот же посредник может быть зарегистрирован

– просмотр пользователем схем посредников и одновременно как CEA и как DSA.
другой информации о посредниках; Посредник, зарегистрированный как CEA-при-

ложение, выполняет запрос на языке Syfs над объ-
– задание запросов к посредникам как на языке

Syfs, так и на языке ADQL1 [24]; ектной схемой посредника и возвращает результат
в формате VOClass. Для реализации этой возмож-

– использование программ посредников как ша-
ности разработан компонент M-CEA, который ин-

гов потоков работ в системе АстроГрид;
капсулирует конкретный посредник и может быть

– просмотр результатов программ посредников в зарегистрирован в реестре АстроГрида как CEA
среде АстроГрида. приложение.

В результате анализа архитектур средств под- Посредник, зарегистрированный как DSA, вы-
держки слоя посредников и АстроГрида выработа- полняет запрос на языке ADQL над уплощенной
ны следующие основные решения гибридной архи- схемой посредника и возвращает результат в фор-
тектуры: мате VOClass. Поскольку схема посредника объект-

– посредник реализуется как CEA-приложение ная, а ADQL — язык запросов к реляционной схеме,
и регистрируется в реестре АстроГрида при необходим специальный компонент посредника —
помощи сервера-адаптера приложений. Мета- преобразователь схем, который по объектной схе-
данные, которыми характеризуется регистри- ме посредника строит ее уплощение (реляционное
руемый посредник, расширяются схемой по- представление). Запрос на ADQL формулируется
средника; в терминах плоской схемы, а затем компонентом

ADQL2Syfs транслируется в запрос на языке Syfs к
– на интерфейсе посредника имеются методы

задания запросов на Syfs и на ADQL; исходной объектной схеме посредника. Преобразо-
ватель схем и ADQL2Syfs используются разработан-

– результаты запросов к посреднику представля-
ным компонентом M-DSA, который инкапсулирует

ются в формате VOClass, для которого формат
конкретный посредник и может быть зарегистри-

VOTable [2] является подмножеством, и сохра-
рован в реестре АстроГрида как DSA-приложение.

няются в MySpace;
Оформление посредника как DSA — важная осо-

– для подключения к посредникам DSA ресурсов, бенность, так как предоставляет пользователям
уже зарегистрированных в системе АстроГрид, АстроГрида возможность видеть посредник в при-
используется адаптер к DSA ресурсам; вычном виде как DSA-источник.

– для осуществления поиска по метаданным ре- В любом случае посредник оформляется в
сурсов или приложений в реестрах системы качестве CEA-приложения, которое может быть
АстроГрид используется адаптер к реестрам использовано как шаг потока работ или как само-
АстроГрида, реестр регистрируется в посредни- стоятельное приложение. Таким образом, обеспе-
ке как обычный ресурс; чивается возможность использования посредника

– в качестве клиентского интерфейса и приложе- в системе АстроГрид, а также возможность удобно-
ния используется Workbench; го просмотра схемы посредника прямо из клиента

– для поддержки астрономических онтологий, Workbench системы АстроГрид. Метаданные для ре-
принятых в системе АстроГрид, разрабаты- гистрации посредника генерируются на основании
ваются средства онтологической интеграции его схемы, определенной на языке СИНТЕЗ.

1ADQL — Astronomical Data Query Language — астрономический язык запросов, поддерживаемый IVOA. Основан на SQL 92.

18 ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008



Архитектура промежуточного слоя предметных посредников для решения задач над множеством интегрируемых

Рис. 2 Схема гибридной архитектуры АстроГрида и исполнительных средств слоя посредников

Адаптеры обеспечивают преобразование запро- сурсы, уже зарегистрированные в системе Астро-
сов на языке планов посредника (Asyfs) в запросы Грид, и использовать их для конструирования но-
на языке ресурса, получение результата запроса от вых посредников.
другого ресурса, а также преобразование объектов
результирующего множества в объекты схемы по-
средника. 7 Пример: реализация средств

В действующем прототипе разработаны адаптер
реляционных баз данных (Relational Wrapper), адап- поддержки задачи поиска
тер к астрономическому каталогу данных SDSS далеких галактик в гибридной
(SDSS Wrapper) с поддержкой возможности вы-
полнения XMatch на сервере SDSS, адаптер DSA архитектуре
ресурсов (DSA Wrapper) и адаптер реестров Астро-
Грида (Registry Wrapper). 7.1 Задача поиска далеких радиогалактик

Для обеспечения возможности использования В качестве примера класса задач для решения в
уже существующих ресурсов, зарегистрированных гибридной архитектуре слоя посредников и Астро-
в реестрах АстроГрида как DSA ресурсы, был разра- Грида рассматривается поиск далеких галактик.
ботан адаптер к DSA ресурсам. Этот адаптер играет Радиогалактики являются самыми массивными
одну из ключевых ролей по реализации гибридной звездными системами, наблюдаемыми на космо-
архитектуры, поскольку дополнительно обеспечи- логических расстояниях [25], но это достаточно
вается возможность конструирования посредников редкие объекты по сравнению с обычными (нор-
над многочисленными ресурсами системы Астро- мальными) галактиками. Далекая галактика, по-
Грид. рождающая мощное радиоизлучение, часто оказы-

Реестр регистрируется в посреднике как обыч- вается слабым объектом в оптическом диапазоне,
ный ресурс, к которому могут быть сформулиро- что существенно затрудняет ее спектрофотометри-
ваны запросы, что позволит идентифицировать ре- ческие исследования и, следовательно, определе-

ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008 19



Д. О. Брюхов, А. Е. Вовченко, В. Н. Захаров и др.

ние красного смешения. Усилия, которые были больших угловых размеров, поэтому учитыва-
предприняты для поиска радиогалактик на боль- лась феноменологическая зависимость разме-
ших красных смещениях, привели к обнаружению ров двойных радиогалактик от красного сме-
∼ 300 радиогалактик с Z > 2 (по данным из базы щения.
данных NED (http://nedwww.ipac.caltech.edu) для

С появлением в конце XX – начале XXI в. но-
красных смещений, определенных по спектрам),

вых больших по площади покрытия глубоких об-
но такого количества объектов недостаточно для

зоров неба в радиодиапазоне методика селекции
статистических исследований свойств далеких га-

по крутизне радиоспектра не теряет своей значи-
лактик. Известны разные техники селекции радио-

мости. Чтобы повысить эффективность изучения
источников для поиска далеких галактик. К ним

выборки радиоисточников с крутыми и ультракру-
относятся глубокая спектроскопия пустых полей,

тыми спектрами, часто используют дополнитель-
прямые снимки в узкополосных фильтрах, спек-

ные ограничения по показателю цвета [28] для
троскопия объектов вокруг радиогалактики с боль-

отождествленных объектов. Трудоемкость рабо-
шим красным смещением [26, 27], использование

ты с разнородными астрономическими каталогами
показателей цвета для выбора кандидатов (color-

и обзорами требует нового подхода при решении
dropouts) [28].

разных астрономических задач, в частности это от-
Один из часто применяемых методов селекции

носится и к задаче составления поисковых списков
кандидатов в далекие радиогалактики основан на

для дальнейших более детальных исследований.
корреляции наблюдаемой крутизны радиоспектра

Задача поиска далеких галактик была сформу-
с красным смещением [29]. Именно этот подход

лирована в контексте подхода, развиваемого на
использовался в программе «Большое Трио» [30],

основе программных средств ВО, а именно: как
которая в течение ряда лет проводилась в Специ-

последовательность типичных действий (выборка
альной астрофизической обсерватории (САО) РАН

данных, сравнение, визуализация) с астрономиче-
под руководством академика Ю. Н. Парийского.

скими данными, доступными в Интернете по про-
В начале 1990-х гг. были начаты работы по ис-

токолам IVOA. В качестве ресурсов, используемых
следованию SS (Steep Spectrum) выборки каталога

в задаче, были выбраны: каталог RC [30], получен-
RC. Наблюдения по этой программе выполнялись

ный на частоте 3,9 ГГц из наблюдательного матери-
на 3 крупных телескопах: РАТАН-600, БТА и VLA

ала глубокого обзора 20′ полосы неба, центрирован-
(NRAO, США). Каталог RC, полученный на основе

ной на склонение источника SS433, проведенного
материалов глубокого обзора «Холод» (РАТАН-600)

на радиотелескопе РАТАН-600; каталог и обзор не-
и радиокаталог UTRAO [31] использовались для

ба на частоте 1,4 ГГц FIRST [33]; обзор в оптическом
отбора объектов, определения спектров; радиоте-

диапазоне SDSS [34]. Отметим, что оптическое
лескоп VLA — для получения точных координат

отождествление радиоисточников простыми алго-
источников, радиоизображений, морфологии; 6-

ритмами кросс-мэтчинга, такими как ConeSearch
метровый оптический телескоп БТА — для отожде-

или XMatch, возможно, если каталог имеет высо-
ствления и глубокой спектроскопии радиоисточ-

кую точность координат и угловое разрешение (по-
ников.

рядка 1′′), для точечных источников. Каталог RC
При составлении SS выборки каталога RC так

имеет координатную точность ∼ 15′′ по прямому
же, как и в других группах, занимающихся поис-

восхождению RA и ∼ 45′′ по склонению DEC и не
ком далеких радиогалактик, в качестве основного

имеет данных по морфологии источников, поэто-
критерия отбора использовалась крутизна радио-

му необходимы дополнительные ограничения для
спектра и еще дополнительные условия [32]:

оптических объектов, попадающих в область поис-
– плотность потока (спектральная плотность по- ка, а именно, ограничения по показателю цвета.

тока излучения или плотность потока — коли- Высокое угловое разрешение и точность координат
чество электромагнитной энергии в единичном лучше уловой секунды при предельной чувстви-
интервале частот, протекающей через единич- тельности по плотности потока ∼ 1 мЯн обзора
ную площадку за единицу времени. FIRST позволяют сделать выбор из кандидатов на
Внесистемная единица измерения, при- оптическое отождествление.
меняемая в радиоастрономии, — Янский Поток работ для такой задачи может выглядеть
(1 Ян = 10−26 Вт/(м2Гц).); следующим образом:

– морфология объектов. Были отобраны двойные – найти радиоисточники, у которых значе-
радиоисточники; ние спектрального индекса (спектральный ин-

– угловые размеры. На больших красных сме- декс — показатель степени α в выражении
щениях не зарегистрировано объектов очень S(ν) ∼ ν−α, характеризующем изменение спек-

20 ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008



Архитектура промежуточного слоя предметных посредников для решения задач над множеством интегрируемых

тральной плотности потока излучения S(ν) размер области кросс-мэтчинга с оптическим ката-
у ряда космических объектов с изменением логом будет 45′′ × 45′′ (если мы используем утро-
частоты ν) находится в заданном диапазоне енную ошибку координат по склонению). По на-
[α1, α2]. Если этот параметр неизвестен, то шей оценке при средней плотности объектов SDSS
для его определения необходимо (∼ 7–8 на кв. угл. мин в полосе обзора «Холод») в

• область поиска для источников каталога RC (раз-
выбрать радиоисточники, для которых есть меры ее варьируются от 45′′ до 10′) попадает до
данные по плотности потока, по крайней тысячи объектов. Поскольку точность определения
мере, на двух заданных частотах ν1 и ν2; координат радиоисточников не позволяет выпол-
• вычислить спектральный индекс α для вы- нить оптическое отождествление по позиционному

бранных радиоисточников; совпадению, то нужна дополнительная селекция по

• выдать список радиоисточников, у которых свойствам объектов в оптическом диапазоне. Крас-

спектральный индекс α находится в диапа- ное смещение приводит к сдвигу спектрального

зоне распределения энергии (Spectral Energy Distribution
[α1, α2];

или SED) далеких галактик в более длинноволно-
– найти радиоисточники, у которых линейные вую область спектра по сравнению с близкими га-

размеры меньше заданного значения d и вели- лактиками. В оптическом диапазоне скачок в SED
чина потока s для заданной частоты лежит в для λ = 912 A для галактик с большимZ смещается
диапазоне [s1, s2]; из голубой в красную область спектра, т. е. дале-

кие объекты — более красные и более яркие в этой
– найти оптические объекты, совпадающие по

области спектра по сравнению с близкими галак-
координатам (с учетом ошибок координат и

тиками. Аналогично работает избыток излучения
размеров радиоисточников) с выбранными ра-

в линии водорода (свойство, присущее радиогалак-
диоисточниками;

тикам) Ly (λ = 1216 A). Используя звездные ве-
– выдать список радиоисточников, для кото- личины родительских галактик радиоисточников,

рых найдены соответствующие оптические можно определить показатель цвета или вторые
объекты; разности показателей цвета и использовать их для

– по запросу пользователя для выбранной па- выбора наиболее вероятного кандидата из числа
ры радио- и оптического источников показать объектов, попавших в область поиска. В качестве
изображение источника в оптическом диапазо- дополнительного селекционного правила исполь-
не с нанесенным контуром радиоизображения; зовались следующие ограничения:

– выдать запрос пользователю на подтверждение u+ r − g + i r + z
g > 1 ; − r > 1 ; − i > 1 ,

отождествления радио- и оптического изобра- 2 2 2
жений;

является наиболее вероятным кандидатом для
– найти значения потоков (звездных величин)

отождествления.
для указанных фильтров для оптических ис-

Для подтверждения отождествления отобран-
точников из сформированного списка;

ных источников из обзора FIRST извлекаются изоб-
– вычислить показатели цвета для оптических ис- ражения,по которым строятся контурные карты,

точников; накладываемые на оптические изображения, и от-
мечаются каталожные положения. По такому ри-

– выбрать источники, у которых показатели цве-
та c1 и c2 лежат в интервалах [a1, b1] и [a2, b

сунку исследователь принимает решение.
2]

соответственно; Таким образом, поток работ для задачи оконча-
тельно определяется выбранными ресурсами и для

– выдать список источников — кандидатов в да- набора: каталог RC, радиообзор FIRST и оптиче-
лекие галактики. ский обзор SDSS — выглядит следующим образом:

Выполнение описанной выше последователь- – извлечение из каталога RC источников, попада-
ности действий для составления поискового спис- ющих в область пересечения с обзорами FIRST
ка радиоисточников осложняется тем, что не всегда и SDSS;
требуемые данные имеются в выбранных катало-
гах, а также точностью определения параметров в – извлечение из обзора SDSS объектов, попада-

отдельно взятом ресурсе. ющих в эту же область;

Каталог RC имеет недостаточную для оптиче- – проведение кросс-идентификации двух выбо-
ского отождествления координатную точность, и рок;

ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008 21



Д. О. Брюхов, А. Е. Вовченко, В. Н. Захаров и др.

Рис. 3 Спецификация типов фрагмента схемы посредника

– вычисление для оптических объектов, попав- params:
ших в область поиска, центрированную на по- {+o/CatalogData,
ложение источника каталога RC, показателей +rad1/real,
цвета по звездным величинам в фильтрах u, g, +rad2/real,
r, i и z с учетом ошибок определения звездных -returns/boolean};
величин; };

– отбор из оптических объектов, удовлетворя- },
ющих одному из условий: (u + r)/2 − g > 1, {Magnitude; in: type;
(g + i)/2− r > 1, (r + z)/2− i > 1; magValue: real;

magError: real;
– показ по запросу пользователя для выбранной filter: string;

пары радио- и оптического источников изоб- },
ражения источника в оптическом диапазоне с {RadioCatalogData; in: type;
нанесенным контуром радиоизображения из supertype: CatalogData;
обзора FIRST; spIndex: real;

– занесение координаты оптического объекта в },
список при подтверждении отождествления. {OpticalCatalogData; in: type;

supertype: CatalogData;
7.2 Схема посредника colorIndexURG: real;

deltaColorIndexURG: real;
На рис. 3 приведен пример фрагмента схемы

magnitude: {set;
посредника для задачи поиска далеких галактик.

type_of_element: Magnitude;};
В языке СИНТЕЗ этому фрагменту соответствует

};
следующая спецификация (спецификации эле-

class_specification:
ментов схемы посредника объединены в модуль

{scienceData; in: class;
Mediator).

instance_section: ScienceData;
{Mediator; in: module; },
type: {catalogData; in: class;
{CoordEQJ; in: type; superclass: scienceData;

ra: real; instance_section: CatalogData;
de: real; },

}, {radioCatalogData; in: class;
{CatalogData; in: type; superclass: catalogData;

name: string; instance_section:
spatialCoord: CoordEQJ; RadioCatalogData;
matchCatalog: {in: function; },

22 ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008



Архитектура промежуточного слоя предметных посредников для решения задач над множеством интегрируемых

Рис. 4 Спецификация типов экземпляров классов фрагментов схемы SDSS (а), RC (б) и FIRST (в)

{opticalCatalogData; in: class; фрагмент схемы ресурса SDSS включает класс
superclass: catalogData; photoPrimary и функцию модуля xmatch. Функция
instance_section: xmatch представляет хранимую процедуру, доступ-

OpticalCatalogData; ную для выполнения в SDSS, которая выполняет
}; координатную кросс-идентификацию объектов ка-

} талога SDSS и объектов внешней коллекции. Фраг-
менты схем ресурсов RC, SDSS и FIRST приведены

В ней определены типы (снабжены стереотипом
на рис. 4.

“type”) и классы, соответствующие астрономиче-
В качестве примера дан следующий модуль спе-

ским наблюдениям, накапливаемым в различных
цификации фрагмента схемы ресурса SDSS:

радио- и оптических каталогах. Суперкласс Cata-
logData содержит объекты из обоих каталогов. Этот {SDSS; in: module, local;
класс содержит атрибут spatialCoord, который опре- type:
деляет координаты астрономического объекта, и {PhotoPrimary; in: type;
метод (предикат) matchCatalog(), который возвра- objID: integer;
щает истинное значение, считая два астрономиче- ra: real;
ских объекта тождественными, если они «близки» dec: real;
друг к другу в пространстве. u: real;

В текущем примере в посреднике были зареги- err_u: real;
стрированы следующие каталоги и обзоры неба: g: real;

– RC catalog — каталог радиоисточников, полу- err_g: real;
ченный из наблюдательного материала обзора i: real;
неба «Холод» на частоте 3,9 ГГц на радиотеле- err_i: real;
скопе РАТАН 600 [30]; r: real;

err_r: real;
– FIRST — обзор неба на частоте 1,4 ГГц, по- z: real;

лученный на радиотелескопе VLA; включает err_z: real;
коллекцию цифровых изображений и каталог };
радиоисточников [33]; function:

– SDSS — глубокий фотометрический (в филь- {xmatch; in: function;

трах u, g, r, i и z) и спектральный обзор неба в params: {

оптическом диапазоне [34]. +ra1/real, +de1/real,
+ra2/real, +de2/real,

В процессе регистрации RC и SDSS рассмат- +rad/real, -returns/boolean
риваемый фрагмент схемы ресурса RC включа- };
ет классы rcCatalog и coordEQJ ; рассматриваемый };

ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008 23



Д. О. Брюхов, А. Е. Вовченко, В. Н. Захаров и др.

class_specification: – IR2:
{photoPrimary; in: class; opticalCatalogData(x/[name,

instance_section: PhotoPrimary; ra: spatialCoord.ra,
}; de: spatialCoord.de, colorIndexURG,

} deltaColorIndexURG]) <-
В результате сопоставления элементов схемы v_SDSS_OData(_/[x:#x, name, ra, de,

посредника и схем ресурсов RC и SDSS в процессе colorIndexURG, deltaColorIndexURG])
регистрации были построены следующие взгляды. Дополнительно определяется следующее ин-
Взгляд для FIRST строится аналогично RC. версное правило отображения функции в функцию:

Взгляды для SDSS: – IR3:
– LAV1:

all x/CatalogData, y/CatalogData,
v_SDSS_OData(x/[name,ra,de, rad/real

colorIndexURG,deltaColorIndexURG]) matchCatalog(x, y, rad, rad, b) <-
:- opticalCatalogData(x/[name, xmatch(x.spatialCoord.ra,

ra: spatialCoord.ra, x.spatialCoord.de,
de: spatialCoord.de, y.spatialCoord.ra,
colorIndexURG,deltaColorIndexURG]) y.spatialCoord.de, rad, b)

– GAV1: Инверсное правило IR3 связывает метод match-
v_SDSS_OData(x/[name,ra,de, Catalog в схеме посредника c функцией кросс-мэт-

colorIndexURG,deltaColorIndexURG]) чинга xmatch в схеме ресурса SDSS.
:- SDSS.photoPrimary(x/[ra,de:dec,

objID,u,r,g,err_u,err_r,err_g])
& integerToString(objID, name) 7.3 Реализация примера поддержки
& id(((u + r)/2.0-g),colorIndexURG) решения задачи поиска далеких
& I_SDSS.deltaColorIndexURG(err_u, галактик в гибридной архитектуре

err_r,err_g, deltaColorIndexURG)
Выше был описан пример фрагмента посредни-

Во взгляде GAV1 используется функция разре- ка для поддержки решения задачи поиска далеких
шения конфликтов, которая вычисляет значение галактик. Этот посредник был оформлен как CEA-
атрибута deltaColorIndexURG на основе значений приложение, к которому реализуются запросы на
атрибутов err u, err r, err g из класса photoPrimary. языке Syfs. В системе АстроГрид был написан поток
Для функций разрешения конфликтов в по- работ с участием данного посредника (рис. 5) для
среднике определена их реализация посредством решения задачи поиска далеких галактик. Этот
PL/SQL. поток работ состоит из 3-х шагов: нахождение

Взгляды для RC: галактик-кандидатов, преобразование результата,
– LAV2: получение изображений.

v_RC_RData(_/[name, ra, de])
:- radioCatalogData(x/[name, 7.3.1 Первый шаг — поиск кандидатов в далекие

ra: spatialCoord.ra, галактики
de: spatialCoord.de])

На первом шаге происходит нахождение объек-
– GAV2: тов — кандидатов в далекие галактики. Этот шаг ре-

v_RC_RData(x/[name, ra, de]) ализуется посредником как CEA-приложение. Для
:- RC.rcCatalog(x/[name, catalog_id, нахождения кандидатов в далекие галактики зада-

coord_id]) ется запрос к посреднику, который на основании
& RC.coordEQJ(y/[ra, de, coord_id]) заданных условий и кросс-мэтчинга объектов из

двух радиокаталогов (RC и FIRST) с объектами
На основе взглядов LAV строятся следующие оптического каталога (SDSS) отбирает объекты —

инверсные правила отображения класса в класс: потенциальных кандидатов в далекие галактики.
– IR1: На рис. 5 изображен первый шаг потока работ, на

radioCatalogData(x/[name, котором видно, что используется CEA-приложение
ra: spatialCoord.ra, ipi.ac.ru/executeSyfsQuery, реализующее описанный
de: spatialCoord.de]) <- выше посредник. В качестве входного параметра

v_RC_RData(_/[x:#x, name, ra, de]) данному приложению передается содержимое фай-

24 ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008



Архитектура промежуточного слоя предметных посредников для решения задач над множеством интегрируемых

Рис. 5 Поток работ для задачи поиска далеких галактик

ла query.syfs, находящегося в виртуальном храни- Таблица 1 описывает переписывание, которое
лище пользователя MySpace. В файле содержится применяется к телу правила. Подцели правила пе-
следующий запрос на языке Syfs: речислены в первом столбце. Инверсные правила,

{{r(x/[ra, de, name, name1, ra1, de1]) подобранные для унификации с соответствующей

:-radioCatalogData(y/[name, подцелью, перечислены во втором столбце. Пре-

ra: spatialCoord.ra, образованные в результате унификации тела ин-

de: spatialCoord.de]) версных правил перечислены в третьем столбце.

& opticalCatalogData(x/[name1: name, После того как унификация и преобразова-

ra1: spatialCoord.ra, ние тел выбранных инверсных правил выполнены,

de1: spatialCoord.de, строится следующее переписывание правила:

colorIndexURG,deltaColorIndexURG]) r(_/[ra, de, name, name1, ra1, de1])
& matchCatalog(y, x, 45, 45, b) :- v_RC_RData(_/[y:#x, name, ra, de])
& b = true & v_SDSS_OData(_/[x:#x, name1: name,
& ra >= 120.0 & ra <= 255.0 ra1: ra, de1: de, colorIndexURG,
& de >= 4.39 & de <= 5.61 deltaColorIndexURG])
& ra1 >= 120.0 & ra1 <= 255.0 & xmatch(y.spatialCoord.ra,
& de1 >= 4.39 & de1 <= 5.61 y.spatialCoord.de,x.spatialCoord.ra,
& colorIndexURG > deltaColorIndexURG}} x.spatialCoord.de, 45, b)

Запрос состоит из одного правила и является & ra >= 120.0 & ra <= 255.0

частью решения задачи поиска далеких галактик. & de >= 4.39 & de <= 5.61

По запросу должны возвращаться астрономические & ra1 >= 120.0 & ra1 <= 255.0

объекты, найденные в радио и оптических катало- & de1 >= 4.39 & de1 <= 5.61

гах с применением функции кросс-мэтчинга, ко- & colorIndexURG > deltaColorIndexURG

торые имеют координаты в заданном диапазоне и Полученное правило содержит сколемовские
удовлетворяют специальному условию, ограничи- атрибуты #x во взгляде v SDSS OData и #x во
вающему значения атрибутов colorIndexURG и delta- взгляде v RC RData. Но в процессе семантического
ColorIndexURG. анализа устанавливается, что взгляд v SDSS OData

ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008 25



Д. О. Брюхов, А. Е. Вовченко, В. Н. Захаров и др.

Таблица 1 Переписывание подцелей правила

Подцель ИП Преобразованное тело ИП
radioCatalogData(y/[name, ra: spatialCoord.ra, IR1 v RC RData( /[y:#x, name, ra, de])
de: spatialCoord.de])
opticalCatalogData(x/[name1: name, IR2 v SDSS OData( /[x:#x, name1: name, ra1:ra,
ra1: spatialCoord.ra, de1:de, colorIndexURG, deltaColorIndexURG])
de1: spatialCoord.de, colorIndexURG,
deltaColorIndexURG])
matchCatalog(y, x, 45, 45, b) IR3 xmatch(y.spatialCoord.ra, y.spatialCoord.de,

x.spatialCoord.ra, x.spatialCoord.de, 45, b)

влечет равенство переменной, привязанной к тер- которая заменяется на преобразованное тело
му #x.spatialCoord.ra, и переменной, привязанной взгляда
к терму ra. Следовательно, с учетом того, что SDSS.photoPrimary(x1/[ra1:ra,de1:dec,
в правиле в проекции в подцели v SDSS OData objID,u,r,g,err_u,err_r,err_g])
приравниваются атрибуты x и #x, а также атри- & integerToString(objID, name1)
буты ra1 и ra, из правила можно удалить ра- & id(((u+r)/2.0-g), colorIndexURG)
венства x.spatialCoord.ra = ra1. Это факти- & I_SDSS.deltaColorIndexURG(err_u,
чески означает, что в правиле вхождения терма err_r,err_g, deltaColorIndexURG)
x.spatialCoord.ra заменяются термом ra1. Ана-
логично семантический анализ выполняется для

Аналогично для взгляда v RC RData соответству-
x.spatialCoord.de и de1, для y.spatialCoord.ra и ra,

ющая подцель заменяется преобразованным телом
для y.spatialCoord.de и de. В результате образуется

взгляда GAV
правило без вхождений сколемовских функций: 2:

RC.rcCatalog(x2/[name, catalog_id,
r(_/[ra, de, name, name1, ra1, de1]) coord_id])
:- v_RC_RData(_/[name, ra, de]) & RC.coordEQJ(y2/[ra, de, coord_id])
& v_SDSS_OData(_/[name1: name,
ra1: ra, de1: de, colorIndexURG, Результатом разворачивания взглядов GAV

deltaColorIndexURG]) является следующее правило, которое переписы-

& xmatch(ra, de, ra1, de1, 45, b) вает исходное правило, выражая его в терминах

& ra >= 120.0 & ra <= 255.0 схем ресурсов SDSS и RC:

& de >= 4.39 & de <= 5.61 r(_/[ra, de, name, name1, ra1, de1])
& ra1 >= 120.0 & ra1 <= 255.0 :-RC.rcCatalog(x2/[name, catalog_id,
& de1 >= 4.39 & de1 <= 5.61 coord_id])
& colorIndexURG > deltaColorIndexURG & RC.coordEQJ(y2/[ra, de, coord_id])

& SDSS.photoPrimary(x1/[ra1:ra,
de1:dec,objID,u,r,g,

Дальше выполняется разворачивание взглядов
err_u,err_r,err_g])

GAV (взгляда v RC RData и взгляда v SDSS OData).
& integerToString(objID, name1)

Голова взгляда GAV1 & id(((u + r) / 2.0 - g),
v_SDSS_OData(x/[name,ra,de, colorIndexURG)
colorIndexURG,deltaColorIndexURG]) & I_SDSS.deltaColorIndexURG(err_u,

:- SDSS.photoPrimary(x/[ra,de:dec, err_r,err_g, deltaColorIndexURG)
objID,u,r,g,err_u,err_r,err_g]) & xmatch(ra, de, ra1, de1, 45, b)

& integerToString(objID, name) & ra >= 120.0 & ra <= 255.0
& id(((u + r)/2.0 - g),colorIndexURG) & de >= 4.39 & de <= 5.61
& I_SDSS.deltaColorIndexURG(err_u, & ra1 >= 120.0 & ra1 <= 255.0
err_r,err_g, deltaColorIndexURG) & de1 >= 4.39 & de1 <= 5.61

унифицируется с подцелью & colorIndexURG > deltaColorIndexURG

v_SDSS_OData(_/[name1: name, ra1: ra, Аналогично переписывание с использованием
de1: de, colorIndexURG, взглядов для ресурса FIRST приводит ко второму
deltaColorIndexURG]), переписыванию исходного правила запроса:

26 ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008



Архитектура промежуточного слоя предметных посредников для решения задач над множеством интегрируемых

r(_/[ra, de, name, name1, ra1, de1]) цию на ресурсе SDSS. Дальше выполняется подза-
:-FIRST.firstCatalog (x2/[name: прос к ресурсу SDSS:

FieldName, ra: RA, de: DE]) sdss1(_/[ra, de, name, ra1, de1,
& SDSS.photoPrimary(x1/[ra1:ra,

objID, colorIndexURG])
de1:dec,objID,u,r,g,

:-rc1(_/[ra, de, name])
err_u,err_r,err_g])

& SDSS.photoPrimary(x1/[ra1:ra,
& integerToString(objID, name1)

de1:dec,objID,u,r,g,
& id(((u + r) / 2.0 - g),

err_u,err_r,err_g])
colorIndexURG)

& id(((u + r) / 2.0 - g),
& I_SDSS.deltaColorIndexURG(err_u,

colorIndexURG)
err_r,err_g, deltaColorIndexURG) & xmatch(ra, de, ra1, de1, 45, b)

& xmatch(ra, de, ra1, de1, 45, b)
& ra1 >= 120.0 & ra1 <= 255.0

& ra >= 120.0 & ra <= 255.0
& de1 >= 4.39 & de1 <= 5.61

& de >= 4.39 & de <= 5.61
& ra1 >= 120.0 & ra1 <= 255.0 Результат выполнения этого подзапроса пере-
& de1 >= 4.39 & de1 <= 5.61 дается адаптером SDSS в посредник. Подзапрос к
& colorIndexURG > deltaColorIndexURG ресурсу FIRST:

Полученный переписанный запрос состоит из first0(_/[ra, de, name])
двух правил, и результирующий класс r образуется :-FIRST.firstCatalog (x2/[name:
как объединение результирующих множеств этих FieldName, ra: RA, de: DE])
двух правил. Правила запросов обращаются к клас- & ra >= 120.0 & ra <= 255.0
сам трех ресурсов (RC, FIRST и SDSS), поэтому & de >= 4.39 & de <= 5.61
дальше необходим этап планирования, в результате Результаты выполнения этого подзапроса пере-
которого получается распределенный план запроса. даются адаптером ресурса FIRST в адаптер ресурса

Алгоритм планирования выделяет подзапросы, SDSS, который загружает их во временную коллек-
которые адресованы каждому ресурсу, и остаточный цию на ресурсе SDSS. Дальше выполняется подза-
запрос, который будет выполняться в СУБД посред- прос к ресурсу SDSS:
ника над результатами, полученными от ресурсов.
Также алгоритм выбирает, как данные с результа- sdss2(_/[ra, de, name, ra1, de1,
тами подзапросов передаются от одного ресурса к objID, colorIndexURG])
другому ресурсу или посреднику. В этом примере :-first0(_/[ra, de, name])
учитывается способность ресурса SDSS принимать & SDSS.photoPrimary(x1/[ra1:ra,
внешнюю коллекцию, которая затем участвует в вы- de1:dec,objID,u,r,g,
полнении запроса к SDSS, и то, что число объектов, err_u,err_r,err_g])
удовлетворяющих условиям запроса в RC во мно- & id(((u + r) / 2.0 - g),
го раз меньше, чем число объектов в SDSS (число colorIndexURG)
объектов в SDSS исчисляется сотнями миллионов, & xmatch(ra, de, ra1, de1, 45, b)
что делает невозможным выполнение прямого под- & ra1 >= 120.0 & ra1 <= 255.0
запроса к SDSS с последующей передачей резуль- & de1 >= 4.39 & de1 <= 5.61
татов в посредник). Поэтому строится следующий Результат выполнения второго подзапроса пере-
распределенный план (для простоты составляющие дается адаптером SDSS в посредник. В посредни-
плана даны в логическом языке Syfs, хотя в реаль- ке над полученными данными выполняется оста-
ной реализации план запроса представляется на точный запрос, вычисляющий конечный результат
алгебраическом языке Asyfs). рассматриваемого примера:

Подзапрос к ресурсу RC:
r(_/[ra, de, name, name1, ra1, de1])

rc0(_/[ra, de, name]) :- sdss1(_/[ra, de, name, name1,
:-RC.rcCatalog(x2/[name, catalog_id, ra1, de1, objID, colorIndexURG])

coord_id]) & integerToString(objID, name1)
& RC.coordEQJ(y2/[ra, de, coord_id]) & I_SDSS.deltaColorIndexURG(err_u,
& ra >= 120.0 & ra <= 255.0 err_r,err_g, deltaColorIndexURG)
& de >= 4.39 & de <= 5.61 & colorIndexURG > deltaColorIndexURG

Результаты выполнения этого подзапроса пе-
редаются адаптером ресурса RC в адаптер ресурса r(_/[ra, de, name, name1, ra1, de1])
SDSS, который загружает их во временную коллек- :- sdss2(_/[ra, de, name, name1,

ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008 27



Д. О. Брюхов, А. Е. Вовченко, В. Н. Захаров и др.

ra1, de1, objID, colorIndexURG]) Для оценки производительности работы по-
& integerToString(objID, name1) средника в гибридной архитектуре были проведены
& I_SDSS.deltaColorIndexURG(err_u, 10 тестовых запусков первого шага. Среднее время
err_r,err_g, deltaColorIndexURG) выполнения первого шага в АстроГриде составило

& colorIndexURG > deltaColorIndexURG 26 с, минимальное время — 19 с, максимальное вре-
В качестве выходного параметра указывается мя — 42 с. Подобная разница времени выполнения

адрес файла result.vot в виртуальном хранилище связана с географией расположения ресурсов, за-
пользователя MySpace, в который по завершению регистрированных в посреднике. Радиокаталог RC
работы посредника помещается результат в форма- представляет собой DSA источник системы Аст-
те VOTable. Результат работы первого шага (посред- роГрид, физически располагающийся на установ-
ника) представляется таблицей, каждая строчка ко- ке АстроГрида в ИПИ РАН. Радиокаталог FIRST
торой — кандидат в далекие галактики. Фрагмент представляет собой базу данных, физически распо-
таблицы в формате VOTable выглядит следующим лагающуюся на сервере в ИПИ РАН. Каталог SDSS
образом: располагается в США. В соответствии с планом,

данные из радиоисточников перемещаются в SDSS,
<?xml version=-1.0- encoding=-UTF-8-?> где выполняется кросс-мэтчинг, и далее результат
<votable xmlns="http:// возвращается в Москву, в MySpace АстроГрида в
www.ivoa.net/xml/VOTable/v1.1"> ИПИ РАН.
<resource>
<table name="r">
<field name="de" datatype="double" /> 7.3.2 Второй шаг

<field name="de1" datatype="double" /> На втором шаге происходит обработка результа-
<field name="name" datatype="char" та, чтобы на третьем шаге данные можно было пе-

arraysize="*" /> редать приложению, получающему изображения в
<field name="name1" datatype="char" цикле. Данный шаг состоит не из приложения CEA,

arraysize="*" /> а из скрипта на языке Groovy [35]. В этом скрипте
<field name="ra" datatype="double" /> происходит загрузка в память таблицы, полученной
<field name="ra1" datatype="double" /> на первом шаге. Затем по этой таблице строятся
<data><tabledata> три массива: массив координат ra (coords ra), мас-
<tr> сив координат dec (coords dec) и массив индексов

<td>5.0155554</td> (coords no). При построении массивов координат
<td>5.02104130192953</td> происходит их преобразование из вещественного
<td>RC 0819+0517</td> представления в формат H:M:S (час:мин:с).
<td>587734948577674422</td>
<td>120.183464</td> 7.3.3 Третий шаг
<td>120.179933980257</td> На третьем шаге используется астрономическое

</tr> приложение Aladin. Aladin — это атлас неба, обес-
<tr> печивающий визуализацию цифровых астрономи-

<td>5.0155554</td> ческих изображений; суперпозицию записей из
<td>5.02523423172066</td> астрономических каталогов и баз данных; доступ
<td>RC 0819+0517</td> в интерактивном режиме к астрономическим базам
<td>587734948577673600</td> данных Simbad, VizieR и др. Приложение обладает
<td>120.183464</td> как графическим пользовательским интерфейсом,
<td>120.179594574991</td> так и командной строкой. В командной строке при-

</tr> ложения команды задаются на скриптовом языке
... программы Aladin.
</tabledata></data> На третьем шаге в цикле вызывается разрабо-
</table> танное CEA-приложение, суть которого сводится к
</resource> выполнению в Aladin’e программы, написанной на
</votable> его скриптовом языке. Результатом работы прило-

Формат VOTable — это XML документ. Тэгами жения является стек Aladin’a, содержащий резуль-
field обозначаются столбцы таблицы, определяя ее таты запросов, выполняемых в программе. В стеке
структуру. Данные для одной строки заключаются в сохраняются данные из каталогов, изображения и
тэг tr, а внутри строки каждое значение заключается контуры изображений и т. д. Данные стека визуа-
в тэг td. лизируются программой Aladin.

28 ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008



Архитектура промежуточного слоя предметных посредников для решения задач над множеством интегрируемых

Рис. 6 Пример результата

На рис. 5 изображен вызов этого CEA-приложе- ные по радиоизображению. Результирующее изоб-
ния (ipi.ac.ru/submitAladinScript). В качестве вто- ражение радиооптика (рис. 6) предназначено для
рого и третьего входного параметра передаются ко- анализа специалистом.
ординаты ra и dec: i-е значение массивов coords ra[i]
и coords dec[i] соответственно. В качестве перво-
го входного параметра передается ссылка на файл 8 Состояние проблемы
aladinscript.al, находящийся в MySpace. Скрипт
является параметризованным двумя переменными: интеграции неоднородных
#Ra и#Dec. В качестве значения этих переменных информационных ресурсов
подставляются те значения, которые передаются
CEA-приложению вторым и третьим параметрами, в посредниках
соответственно. Таким образом, можно выполнять Цели введения предметных посредников. Отличи-
один и тот же скрипт для разных координат. тельной особенностью введения посредников в на-

Скрипт загружает изображения из оптического стоящей работе по сравнению с подходами, рас-
обзора SDSS и радиообзора FIRST. На оптическое сматриваемыми в литературе [15, 36, 37], является
изображение накладываются контуры, построен- их ориентация на решение задач над неоднородны-

ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008 29



Д. О. Брюхов, А. Е. Вовченко, В. Н. Захаров и др.

ми распределенными информационными ресурса- проекте для генерации компиляторов. Соответ-
ми [38–41] (интеграция информационных ресур- ствие элементов схемы ресурса схеме посредника
сов является лишь частью этой проблемы). Одним устанавливается онтологически [9, 10]. Релевант-
из следствий такой цели является то, что схема ная посреднику схема ресурса, выраженная в не-
посредника, наряду со спецификациями структур которой исходной модели, компилируется в кано-
данных, включает спецификации функций (мето- ническую схему. Схема ресурса уточняет схему в
дов) и процессов. Уточняющая реализация функ- канонической модели [45]. Уточнение, задавае-
ций посредника устанавливается в существующих мое отображением схем, может быть формально
ресурсах (сервисах) при их регистрации. проверено [47]. Отображение схем порождается

Унификатором моделей данных, подробно описан-
Отображение схем и определение взглядов. Отобра- ным в [7]. После этого, имея схемы, выраженные
жение схем является одним из критических момен- в одной и той же нотации (каноническая модель),
тов интеграции информационных ресурсов. Про- применяется регистрация схемы ресурса в схеме по-
ект Clio [42] интеграции данных и обмена данными средника согласно подходу LAV/GLAV, полагаясь
поддерживает генерацию отображения схем. Для на онтологические связи между элементами схем
пары схем средства установления соответствия ге- (типами, атрибутами, функциями, параметрами,
нерируют множество потенциальных соответствий классами). В результате, применяя исчисление ти-
схем (чисто синтаксических, основанных на отоб- пов [11], формируются правила отображения для
ражении термов, имен полей и пр.). Отображе- подхода LAV/GLAV, согласно описанному в разд. 4.
ние рассматривается как множество запросов из
исходной к целевой схеме, осуществляющих пре- Переписывание запросов. Обзор исследований в
образование данных ресурса в формат целевой схе- области ответа на запрос посредством взглядов, ко-
мы. Эти задачи являются интерактивными (полу- торые простираются от теоретических оснований
автоматическими). Clio поддерживает отображение до алгоритмов соответствующих систем и их реали-
реляционныж и иерархических XML схем [42]. зации, дан в [15]. Кроме того, оценки алгоритмов

В другом методе, AutoMed [43], предпринята переписывания запросов даны в работах [19, 36].
попытка поддержки трансформации схем для ин- Алгоритмы инверсных правил выделяются благода-
теграции данных, применяя подходы LAV, GAV и ря их концептуальной простоте, модульности и спо-
GLAV. При этом используются низкоуровневая ги- собности продуцировать максимально включенные
перграфовая модель данных и набор примитивных переписывания за время, полиномиальное отно-
преобразований схем в этой модели. Модели дан- сительно длины запроса и взглядов. Переписы-
ных более высокого уровня и преобразования в вание объединений конъюнктивных запросов при
них выражаются в терминах общей низкоуровневой использовании взглядов [19] на основе инверсных
модели. Допускаются композиции примитивных правил имеет преимущества по сравнению с из-
трансформаций. Этот синтаксический метод явля- вестными алгоритмами, в частности этот алгоритм
ется полуавтоматическим, его можно приспособить обобщает алгоритмы MiniCon [48] и Ujoin [49] и
для разных структурированных моделей данных. является более эффективным, чем алгоритм Buck-

Настоящая статья представляет совершен- et. Нахождение включаемого переписывания для
но иной, семантический подход к трансфор- запросов с объединением конъюнктивных запро-
мации информационных моделей. Во-первых, сов (когда как запрос, так и ограничения взгляда
для информационной интеграции вводится рас- могут содержать встроенные предикаты) является
ширяемая каноническая модель (в частности, важным свойством этого алгоритма [19]. В то же
ядро такой модели составляет гибридная объект- время исследования семантики объектных запро-
но-ориентированная/фреймовая информационная сов в типизированной среде не известны. Одним
модель [8]). Для любой модели ресурса (определяе- из вкладов настоящей работы является расшире-
мой синтаксисом и семантикой двух языков — язы- ние подхода к переписыванию запросов на основе
ка определения информации и языка манипулиро- взглядов в типизированной среде предметных по-
вания информацией) определяется отображение в средников. В противоположность [19], в [20] было
расширение канонической модели. Такое отобра- показано, как расширить конъюнктивные запросы
жение обычно конструируется реверсивно [44, 45] объектной SPJ семантикой, основанной на отноше-
и поддерживается соответствующим транслятором нии уточнения типов и типовом исчислении. При-
(который играет также полезную роль в процессе меняемый при этом подход LAV [20] показывает,
генерации адаптеров). Подход, основанный на пе- что уточнение типов экземпляров классов ресурса
реписывании термов, обеспечиваемый средствами является основным отношением, необходимым для
Meta Environment [46], применяется в настоящем достижения включения запросов в объектной сре-

30 ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008



Архитектура промежуточного слоя предметных посредников для решения задач над множеством интегрируемых

де. В настоящей статье, при сохранении типовой Предлагаемая в настоящей статье гибридная ар-
среды, показано, как подход LAV/GLAV приме- хитектура предметных посредников и АстроГрида
няется для реализации функций разрешения кон- отличается от известных прототипов применени-
фликтов, возникающих при отображении схем ре- ем расширяемой канонической объектной моде-
сурс/посредник. Головы правил определения LAV ли данных, применением движимого приложения-
взглядов могут содержать произвольный запрос в ми метода формирования предметных посредников
терминах схемы ресурса, разрешающий конфликт на основании LAV/GLAV подхода, использованием
при помощи конкретизирующего взгляда, выра- развитых методов переписывания запросов к по-
жаемого как GAV правило над соответствующим средникам в типизированной (объектной) среде.
ресурсом. Для завершения переписывания взгляд
над ресурсом должен быть разрешен в соответствии
с подходом GAV (см. разд. 4). 9 Заключение
Прототипы интеграции баз данных для ВО. Система
OpenSkyQuery [50] в NVO [51] обеспечивает интер- В настоящей статье рассматриваются первые ре-
фейс для выполнения распределенных запросов над зультаты создания промежуточного слоя предмет-
федерацией зарегистрированных астрономических ных посредников в гибридной грид-инфраструкту-
архивов. Доступ к каждой базе данных обеспечи- ре виртуальной обсерватории для решения научных
вается посредством Веб-сервиса SkyNode. Это ин- задач над множеством интегрируемых посредника-
терфейс SOAP, воспринимающий запрос на ADQL ми неоднородных распределенных информацион-
и возвращающий данные. Узлы в системе могут ных ресурсов (таких как базы данных, программные
быть вида Basic или Full. Только узлы Full могут сервисы, онтологические спецификации). Вве-
участвовать в операции XMatch. Возможности уз- дение такого промежуточного слоя призвано ре-
ла SkyNode Full включают: интерфейс QueryCost(), шить ряд семантических проблем взаимодействия
который выдает простой ADQL запрос для оценки ученого, решающего задачу в некоторой предмет-
плотности объектов в квадратном градусе в зависи- ной области, и разнообразных релевантных зада-
мости от условий запроса; возможность использо- че результатов наблюдений и средств их обработ-
вания сложных структур в запросах на ADQL, вы- ки. Гибридная архитектура ВО реализована как
полняющих кросс-мэтчинг между содержащимся в объединение инфраструктуры системы поддержки
базе обзором неба и таблицей в формате VOTable; ВО АстроГрид, разработанной в Великобритании,
реализацию метода ExecutePlan, который прини- и средств поддержки исполнительного слоя пред-
мает ExecPlan и передает релевантную часть плана метных посредников, созданных в ИПИ РАН. В ис-
следующему узлу. Все узлы должны быть зареги- следованной архитектуре предметных посредников
стрированы в Реестре ВО. Данные возвращаются реализован подход, движимый приложениями, при
обратно от каждого узла и над ними выполняется котором для класса приложений формируется спе-
кросс-мэтчинг. Наконец, результат возвращается цификация предметной области независимо от су-
клиенту. Система OpenSkyNode использует GAV ществующих информационных ресурсов. Далее
для интеграции схем баз данных. происходит идентификация ресурсов, релевантных

Другой прототип распределенной обработки за- задаче, и их регистрация в посреднике на оcнове
просов был разработан в Манчестерском универ- техники GLAV. В различных разделах статьи по-
ситете для гридовской архитектуры OGSA (Open казано, как, благодаря посредникам, могут быть
Grid Services Architecture). OGSA-DQP1 [52] явля- решены проблемы семантики, возникающие при
ется распределенным процессором запросов, вы- доказательно правильном отображении информа-
полненным по отношению к пользователю как ционных моделей ресурсов в каноническую инфор-
OGSA-совместимый Грид сервис. Этот сервис под- мационную модель посредников, при отображе-
держивает компиляцию и вычисление запросов над нии и интеграции контекстов предметных областей
множеством сервисов Грида. DQP применяет по- информационных ресурсов в контекст предметной
средник на основе GAV подхода к интеграции дан- области задачи, при идентификации релевантных
ных (объединение схем баз данных составляет гло- задаче информационных ресурсов и формирова-
бальную схему). OGSA-DQP поддерживает только нии их композиций, при интеграции схем ресурсов
такие Веб-сервисы, которые воспринимают прими- в схеме посредника и устранении разнообразных
тивные типы в качестве параметров и возвращают конфликтов, при адекватном преобразовании фор-
либо примитивные типы, либо массивы примитив- мул (запросов) программы решения задачи, вы-
ного типа. раженных в терминах схемы предметной области

1DQP — Distributed Query Processing.

ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008 31



Д. О. Брюхов, А. Е. Вовченко, В. Н. Захаров и др.

задачи, в формулы, выраженные в схемах релевант- braries RCDL2005 Proceedings. Yaroslavl, October 2005.
ных ресурсов. Показана важная роль уточнения P. 23–30.
как математически точного соотношения специфи- 4. Abrial J.-R. B-technology: Technical overview. — B-Core
каций при разрешении названных семантических (UK) Ltd., 1993.
проблем. 5. Abrial J.-R. The B-book: Assigning programs to mean-

Создание прототипа гибридной инфраструкту- ings. — Cambridge: Cambridge University Press, 1996.
ры касается главным образом сопряжения испол- 6. The B-toolkit online documentation. http://www.b-
нительных механизмов двух инфраструктур (Астро- core.com/ONLINEDOC/BToolkit.html.
Гридa и средств поддержки исполнительного слоя 7. Захаров В. Н., Калиниченко Л. А., Соколов И. А., Ступ-
предметных посредников). Поэтому в статье основ- ников С. А. Конструирование канонических инфор-
ное внимание уделено проблемам переписывания мационных моделей для интегрированных информа-
запросов к посредникам в планы их реализации ционных систем // Информатика и её применения,

над конкретными информационными ресурсами, 2007. Т. 1. Вып. 2. С. 15–38.

приведено краткое описание объединенной архи- 8. Kalinichenko L. A., Stupnikov S. A., Martynov D. O. SYN-

тектуры исполнительных механизмов АстроГрида и THESIS: A language for canonical information modeling

средств поддержки предметных посредников, дан and mediator definition for problem solving in hetero-
geneous information resource environments. — M.: IPI

пример реализации простого предметного посред-
RAS, 2007. 171 p.

ника для решения задач поиска далеких галактик в
9. Briukhov D. O., Kalinichenko L. A. Component-based in-

гибридной архитектуре.
formation systems development tool supporting the SYN-

Полученные результаты свидетельствуют о пер- THESIS design method // 2nd East-European Confer-
спективности исследованного подхода. Планирует- ence “Advances in Databases and Information Systems”
ся их использование при решении разнообразных Proceedings. — Berlin-Heidelberg: Springer-Verlag, 1998.
задач РВО. Вместе с тем планируется существен- P. 305–327.
ное развитие предложенного подхода в ряде на- 10. Briukhov D. O., Kalinichenko L. A., Skvortsov N. A. Infor-
правлений, включая увеличение гибкости идеи по- mation sources registration at a subject mediator as com-
средников введением комбинированного подхода positional development // East-European Conference
к их определению, движимому как приложения- “Advances in Databases and Information Systems” Pro-
ми, так и ресурсами; расширение средств языка ceedings. Lithuania, Vilnius, Springer, LNCS No. 2151,
формул, эффективно поддерживаемых совершен- 2001.

ствуемыми алгоритмами переписывания запросов; 11. Kalinichenko L. A. Compositional specification calcu-
дальнейшее развитие применения онтологического lus for information systems development // Confer-

моделирования в совокупности с развитием средств ence “Advances in Databases and Information Systems

семантической идентификации релевантных ре- (ADBIS’99)” Proceedings. Maribor, Slovenia, September
1999, Springer Verlag, LNCS.

сурсов и их регистрации в посредниках; развитие
эффективности архитектуры посредников введени- 12. AstroGrid. http://www.astrogrid.org.

ем средств оптимизации планов реализации запро- 13. RVO public utility center. http://synthesis.ipi.ac.ru/
сов в распределенной среде, совершенствованием synthesis/projects/RVOAG/.

адаптеров для повышения эффективности реализа- 14. Ullman J. D. Information integration using logical views //

ции запросов, более тесным сопряжением с Грид 6th International Conference on Database Theory
(ICDT’97) Proceedings, 1997.

архитектурами; расширение применения предмет-
ных посредников в других научных областях и раз- 15. Alon Y. Halevy. Answering queries using views: A survey //

VLDB J. 2001. Vol. 10. No. 4.
витие методологии решения задач на основе идеи
посредников. 16. Friedman M., Levy A., Millstein T. Navigational plans

for data integration // National Conference on Artificial
Intelligence (AAAI) Proceedings, 1999.

17. Kalinichenko L. A. Integration of heterogeneous
Литература semistructured data models in the canonical one //

1st Russian Conference on Digital Libraries RCDL’99
1. Briukhov D. O., Kalinichenko L. A., Zakharov V. N., et al. Proceedings. — St.-Petersburg: St.-Petersburg University,

Information infrastructure of the Russian Virtual Obser- 1999.
vatory (RVO). 2nd ed. — IPI RAN, 2005. 173 p.

18. Briukhov D. O., Kalinichenko L. A., Martynov D. O. Source
2. Virtual observatory architecture overview. Version 1.0, registration and query rewriting applying LAV/GAV tech-

IVOA Note 15 June 2004. niques in a typed subject mediator // Труды Девя-
3. Briukhov D., Kalinichenko L., Zakharov V. Diversity of do- той Всероссийской научной конференции «Элек-

main descriptions in natural science: Virtual observatory тронные библиотеки: перспективные методы и тех-
as a case study // 7th Russian Conference on Digital Li- нологии, электронные коллекции» RCDL, 2007. —

32 ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008



Архитектура промежуточного слоя предметных посредников для решения задач над множеством интегрируемых

Переславль-Залесский: Изд-во «Университет города 33. Becker R. H., Helfand D. J., White R. L., et al. The VLA
Переславля», 2007. C. 253–262. FIRST survey: Faint images of the radio sky at twenty-

19. Wang J., Maher M., Topor R. Rewriting unions of general centimeters. http://sundog.stsci.edu/top.html.
conjunctive queries using views // 8th International Con- 34. Sloan Digital Sky Survey, Data Release 6. http://www.
ference on Extending Database Technology, EDBT’02 sdss.org/dr6/.
Proceedings. Prague, Czech Republic, March 2002. 35. Groovy: An agile dynamic language for the Java Platform.

20. Kalinichenko L. A., Martynov D. O., Stupnikov S. A. Query http://groovy.codehaus.org/.
rewriting using views in a typed mediator environment // 36. Grant J., Minker J. A logic-based approach to data inte-
East-European Conference “Advances in Databases and gration // Theory and Practice of Logic Programming,
Information Systems” (ADBIS’04) Proceedings. Lec- 2002. Vol. 2(3). P. 293–321.
ture notes in Computer Science. — Hungary, Budapest:
Springer, 2004. Vol. 3255. 37. Lenzerini M. Data integration: A theoretical perspective //

ACM Symposium on Principles of Database Systems
21. Nieuwenhuis R., Oliveras A. Congruence closure with in-

(PODS) Proceedings. 2002.
teger offsets // 10th International Conference Logic for
Programming Proceedings. Artif. Intell. and Reasoning 38. Калиниченко Л. А., Ступников С. А., Земцов Н. А. Син-
(LPAR). LNAI. 2003. Vol. 2850. P. 78–90. тез канонических моделей для интеграции неодно-

22. Afrati F., Li C., Mitra P. Rewriting queries using views in родных источников информации. — М.: ИПИ РАН,

the presence of arithmetic comparisons // Theor. Comput. 2005.

Sci. 2006. Vol. 368. No. 1–2. P. 88–123. 39. Kalinichenko L. A., Stupnikov S. A., Vovchenko A. E., et

23. The open archives initiative protocol for metada- al. Russian Virtual Observatory Community Centre for

ta harvesting. Protocol Version 2.0 of 2002-06-14, scientific problems solving over multiple distributed infor-

Document Version 2004/10/12T15:31:00Z. http://www. mation sources // 18th Russian Conference on Digital Li-

openarchives.org/OAI/2.0/openarchivesprotocol.htm. braries RCDL2006 Proceedings. — Suzdal, Russia, 2006.
P. 120–129.

24. IVOA Astronomical Data Query Language Version 1.01.
http://www.ivoa.net/Documents/WD/ADQL/ADQL- 40. Kalinichenko L. Subject mediation approach for scientific
20050624.pdf. problem solving in Virtual Observatories // XXVI Gen-

25. eral Assembly of the International Astronomical Union.
Spinrad H., Dey A., Stern D., Dunlop J., Peacock J.,

Prague, August 14–25, 2006. P. 454–455.
Jimenez R., Windhorst R. LBDS 53W091: An Old, Red
Galaxy at z = 1.552. ApJ. 1997. Vol. 484. P. 581. 41. Kalinichenko L. A., Briukhov D. O., Martynov D. O.,

26. Venemans B. P., Ro ttgering H. J. A., Overzier R. A., Mi- Skvortsov N. A., Stupnikov S. A. Mediation framework
ley G. K., De Breuck C., Kurk J. D., van Breugel W., for enterprise information system infrastructures:
Carilli C. L., Ford H., Heckman T., McCarthy P., Pen- Application-driven approach // 9th International Con-
tericci L. Discovery of six Lyα emitters near a radio galaxy ference on Enterprise Information Systems ICEIS 2007
at z ∼ 5.2 // A&A. 2004. Vol. 424. P. L17–L20. Proceedings. V. Databases and Information Systems Inte-

27. gration. 2007. P. 246–251.
Overzier R. A., Miley G. K., Bouwens R. J. et al. Clustering
of star-forming galaxies near a radio galaxy at z = 5.2 // 42. Haas L. M., Hern‚andez M. A., Ho H., Popa M., Roth M.

AJ. 2006. Vol. 637. P. 58–73. Clio grows up: From research prototype to industrial

28. Madau P. Radiative transfer in a clumpy universe: The tool // ACM SIGMOD Conference Proceedings. — Bal-

colors of high-redshift galaxies // ApJ. 1995. Vol. 441. timore, Maryland, USA. June 14–16, 2005. P. 805–810.

P. 18–27. 43. Jasper E., Tong N., Mc.Brien P., Poulovassilis A. Gener-
29. Ro ttgering H. J. A., Lacy M., Miley G. K., Chambers K. C., ating and optimising views from both as view data inte-

Saunders R. Samples of ultra-steep spectrum radio gration rules // 6th Baltic Conference on Database and
sources // A&AS. 1994. Vol. 108. P. 79–141. Information Systems (DBIS’04) Proceedings. Riga, June

30. 2004.
Parijskij Yu., Goss W., Kopylov A., et al. Investigation
of RATAN-600 RC radio sources // Bulletin of Special 44. Kalinichenko L. A., Skvortsov N. A. Extensible ontological
Astrophys. Obs. 1996. Vol. 40. P. 5–124. modeling framework for subject mediation // 4th All-

31. Douglas J. N., Bash F. N., Torrence G. W., Wolfe C. The Russian Conference on Digital Libraries, RCDL’2002
Texas survey — Preliminary + 18DEG Strip // Publ. in Proceedings. Dubna, October 15–17, 2002.
Astronomy. University of Texas. 1980. Vol. 17. No. 1. 45. Kalinichenko L. A. Canonical model development tech-

32. Копылов А. И., Госс В. М., Парийский Ю. Н., Соболе- niques aimed at semantic interoperability in the heteroge-
ва Н. С., Желенкова О. П., Темирова А. В., Витков- neous world of information modeling // Open INTEROP
ский В. В., Наугольная М. Н., Верходанов О. В. Оптиче- Workshop “Enterprise modeling and ontologies for in-
ское отождествление подвыборки радиоисточников teroperability” Proceedings at the 16th Conference on
RC-каталога с крутыми спектрами с помощью 6-мет- “Advanced Information Systems Engineering (CAiSE).”
рового телескопа САО РАН. Требования к координат- Riga, Latvia, 7–11 June, 2004. P. 101–116.
ной точности и глубине изображения, наблюдения на 46. Van Den Brand M. G., Heering J., Klint P., Oliver P. A.
VLA и способы оценки фотометрического красного Compiling language definitions: The ASF + SDF com-
смещения // АЖ, 1995. Т. 72. № 4. С. 437–446. piler // ACM TOPLAS. 2002. Vol. 24. No. 4.

ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008 33



Д. О. Брюхов, А. Е. Вовченко, В. Н. Захаров и др.

47. Ступников С. А. Отображение спецификаций, выра- 49. Qian X. Query folding // International Conference on Da-
женных средствами ядра канонической модели, в ta Engineering (ICDE) Proceedings. New Orleans, LA,
язык AMN // Системы и средства информатики: 1996. P. 48–55.
Спец. вып. Формальные методы и модели в ком- 50. SkyQuery. http://www.skyquery.net.
позиционных инфраструктурах распределенных ин-
формационных систем / Под ред. И. А. Соколова. — 51. Hanisch R., Quinn P. The international virtual observatory.

М.: ИПИ РАН, 2005. C. 69–95. http://www.ivoa.net/pub/info/.

48. Pottinger R., Levy A. A scalable algorithm for answering 52. Alpdemir M. N., Mukherjee A., Gounaris A., Paton N. W.,

queries using views // International Conference on Very Watson P., Fernandes A. A.A_ , Fitzgerald D. J. OGSA-DQP:
Large Data Bases (VLDB) Proceedings, Cairo, Egypt, A service for distributed querying on the grid // Proceeed-
2000. ings of EDBT 2004, Springer, LNCS 2992, March 2004.

34 ИНФОРМАТИКА И ЕЁ ПРИМЕНЕНИЯ том 2 выпуск 1 2008