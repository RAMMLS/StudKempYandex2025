ПРИКЛАДНАЯ ДИСКРЕТНАЯ МАТЕМАТИКА

2022 Вычислительные методы в дискретной математике № 57

ВЫЧИСЛИТЕЛЬНЫЕ МЕТОДЫ
В ДИСКРЕТНОЙ МАТЕМАТИКЕ

УДК 519.81 DOI 10.17223/20710410/57/7
МЕДИАНА ДЛЯ НЕЧЁТНОГО ЧИСЛА ОТНОШЕНИЙ
ЛИНЕЙНОГО ПОРЯДКА И ЕЁ ИСПОЛЬЗОВАНИЕ

В ЗАДАЧАХ ГРУППОВОГО ВЫБОРА
В.Н. Нефедов

Московский авиационный институт, г. Москва, Россия

E-mail: nefedovvn@yandex.ru

Ищется медиана для нечётного числа отношений линейного порядка, заданных на
конечном множестве A, также являющаяся линейным порядком на A. К подобной
задаче приходим при исследовании некоторых задач группового выбора. В рас-
сматриваемом случае бинарное отношение ρ̃, имеющее минимальное суммарное
расстояние (по Хеммингу) до заданного набора бинарных отношений, является
медианой для этих отношений, и притом единственной. Однако эта медиана не
всегда является линейным порядком (или даже квазипорядком) и в этих случаях
не может быть взята в качестве решения поставленной задачи. Тем не менее би-
нарное отношение ρ̃ обязательно принадлежит множеству LA[n] (линейных асим-
метричных бинарных отношений на A), которому, в частности, принадлежат и
все линейные порядки на A. Исследуются некоторые свойства бинарных отноше-
ний из LA[n]. Вводятся понятия «почти оптимального» и ∆-оптимального отно-
шений, являющихся линейными порядками и одновременно точными решениями
поставленной задачи. Приводятся алгоритмы их нахождения, основанные на по-
лученных утверждениях относительно бинарных отношений из LA[n] и имеющие
полиномиальную вычислительную сложность. Рассматривается отношение экви-
валентности на множестве LA[n], позволяющее разбивать это множество на клас-
сы эквивалентности, количество которых Kn намного меньше числа элементов
в LA[n]. Например, |LA[5]| = 1024, K5 = 12. Таким образом, каждое бинарное от-
ношение из LA[n] эквивалентно в точности одному из Kn представителей классов
эквивалентности, а следовательно, обладает его основными свойствами. Но тогда
исследование широкого класса задач может быть сведено к рассмотрению срав-
нительно небольшого их набора. Процесс нахождения указанного набора предста-
вителей классов эквивалентности иллюстрируется для n = 2, 3, 4, 5. Приводится
также метод решения поставленной задачи, использующий представление бинар-
ных отношений в виде графов (метод выделения минимальных множеств пред-
ставителей контуров в медиане ρ̃), имеющий экспоненциальную вычислительную
сложность.

Ключевые слова: медиана отношений, отношение линейного порядка, линей-
ные отношения, асимметричные отношения, расстояние Хемминга, классы эк-
вивалентности, задача группового выбора.



Медиана для нечётного числа отношений линейного порядка 99

MEDIAN FOR AN ODD NUMBER OF LINEAR ORDER RELATIONS
AND ITS USE IN GROUP CHOICE PROBLEMS

V.N. Nefedov
Moscow Aviation Institute, Moscow, Russia

We consider the problem of constructing a median for an odd set of linear order rela-
tions defined on a finite set A = {a1, a2, . . . , an}, which is also sought in the class of
linear order relations. We arrive at a similar problem when considering some group
choice problems. The distance between binary relations is the Hamming distance
between their adjacency matrices. In the case under consideration, the binary rela-
tion ρ̃, which has the minimum total distance to the given set of binary relations, is
the median for these relations and, moreover, is unique. However, this median is not
always transitive (and in this case is neither linear order, nor even a quasi-order), and
therefore cannot be taken as a solution to a given problem. However, the median ρ̃
necessarily belongs to the set LA[n] (of linear asymmetric binary relations on A), to
which, in particular, all linear orders on A also belong. Some properties of binary re-
lations from LA[n] are investigated. The concepts of “almost optimal” and ∆-optimal
relations are introduced, which are linear orders and, at the same time, exact solutions
of the stated problem. Algorithms for finding them are given, based on the obtained
statements about binary relations from LA[n] and having polynomial computational
complexity. An equivalence relation on the set LA[n] is considered, which allows one
to divide this set into equivalence classes, the number of which Kn is much less than
the number of elements in LA[n]. For example, |LA[5]| = 1024, K5 = 12. Thus, each
binary relation from LA[n] is equivalent to exactly one of the Kn representatives of
the equivalence classes and, therefore, has its main properties. But then the study of
a wide class of problems can be reduced to considering a relatively small set of them.
The process of finding the specified set of equivalence class representatives is illus-
trated for n = 2, 3, 4, 5. A method for solving the problem posed is also given, using
the representation of binary relations in the form of graphs (the method of selecting
the minimum sets of contour representatives in the median ρ̃), which has exponential
computational complexity.

Keywords: median of relations, linear order relation, linear relations, asymmetric
relations, Hamming distance, equivalence classes, group choice problem.

Введение
Рассматривается задача нахождения медианы для нечётного числа отношений ли-

нейного порядка, которая ищется также в классе отношений линейного порядка. К по-
добной постановке приходим, например, при рассмотрении задачи группового выбора
[1 – 15], когда профиль экспертных предпочтений определяется бинарными отношени-
ями ρ1, . . . , ρm, заданными на конечном множестве альтернатив A = {a1, a2, . . . , an}.
В этом случае для обеспечения согласованности агрегированного отношения с про-
филем экспертных предпочтений часто ищется (см., например, [1 – 3]) бинарное отно-
шение ρ, которое имеет минимальное суммарное расстояние D(ρ) до бинарных отно-
шений, задающих экспертные предпочтения, и которое принято называть медианой
для этих отношений (точной медианой). Расстояние между бинарными отношения-
ми определяется в настоящей работе (аналогично [1]) по формуле Хемминга: сумма
модулей разности элементов матриц смежности этих отношений. При этом в случае,
когда экспертные предпочтения задаются линейными порядками при нечётном числе



100 В.Н. Нефедов

экспертов, медиана определяется однозначно по правилу «большинства» [1]. Тем не
менее часто медиана не обладает свойством транзитивности, т. е. не является ни ли-
нейным порядком, ни даже квазипорядком (т. е. не является строгой или нестрогой
ранжировкой). Но тогда в случае, когда агрегированное отношение ищется в виде
ранжировки, эта медиана не может быть взята в качестве окончательного решения.
Одним из возможных выходов из этой ситуации является нахождение линейно упо-
рядоченной медианы, которая соответствует случаю, когда минимальное суммарное
расстояние до бинарных отношений, задающих экспертные предпочтения, ищется не
на множестве всех возможных бинарных отношений, а на множестве отношений ли-
нейного порядка. Такой подход рассматривается во многих работах (см., например, [1]
вместе с ссылками на другие работы). И если при этом разница между двумя по-
лучаемыми таким образом минимальными суммарными расстояниями невелика, то
в качестве искомого агрегированного отношения можно взять линейно упорядоченную
медиану (или наиболее предпочтительную, если их несколько). Поскольку для нахож-
дения линейно упорядоченной медианы используется точная медиана и она в нашем
случае единственная, будем её обозначать через ρ̃. Следует оговориться, что в общем
случае используемый подход применим лишь при небольшом количестве альтернатив
(по-видимому, не больше 30), т. е. для достаточного узкого класса задач. В случаях,
когда агрегированное отношение ищется при более слабых предположениях (напри-
мер, в виде нестрогой ранжировки), следует рассматривать иные, более простые и
эффективные (для этих случаев) подходы, в частности представленные в [15].

Множество линейно упорядоченных бинарных отношений, т. е. рефлексивных, ан-
тисимметричных, транзитивных и с попарно сравнимыми элементами (линейных) на
конечном множестве, состоящем из n элементов, обозначим LO[n]. Как уже отмеча-
лось, в случае, когда ρ1, . . . , ρm ∈ LO[n] и m нечётно, бинарное отношение ρ̃ может
не принадлежать LO[n], однако обязательно принадлежит LA[n] —множеству всех
рефлексивных антисимметричных линейных бинарных отношений на n-элементном
множестве. Множество LA[n] является предметом детального исследования в п. 1–4.

Таким образом, основной задачей, рассматриваемой в работе, является нахожде-
ние отношений ρ ∈ LO[n], доставляющих минимум величине D(ρ) — сумме расстояний
от ρ до заданных ρ1, . . . , ρm ∈ LO[n], в частности задаваемых экспертами в случае
задачи группового выбора, где m нечётно. Такая задача может быть решена методом
простого перебора. Однако при больших n такой подход трудно реализуем. Чтобы
увеличить допустимое значение n, можно использовать метод ветвей и границ. Одна
из возможных схем применения этого метода указана в [13, с. 3]. В проведённых чис-
ленных экспериментах при использовании метода ветвей и границ удалось даже на
маломощном компьютере найти численное решение задачи при n = 26.

Возможен и другой подход, описанный в п. 2. В этом подходе исследуем множества
{ρ ∈ LO[n] : D(ρ) = D(ρ̃) + ∆} для значений ∆ ∈ {0, 2, 4, 6, . . .} (значение D(ρ) всегда
чётно) и ищем минимальное ∆, при котором множество не пусто. Решения, соответ-
ствующие этому ∆, в случае ∆ > 0 назовём ∆-оптимальными, а при ∆ = 2 — почти
оптимальными. Проверка выполнения условия {ρ ∈ LO[n] : D(ρ) = D(ρ̃)} 6= ∅ яв-
ляется алгоритмически простой, и в случае его выполнения ρ̃ ∈ LO[n], т. е. является
единственным решением поставленной задачи.

Следующий по важности случай соответствует выполнению условий ρ̃ ∈/ LO[n],
{ρ ∈ LO[n] : D(ρ) = D(ρ̃) + 2} 6= ∅. В этом случае существует бинарное отноше-
ние ρ, являющееся линейным порядком и удовлетворяющее условию D(ρ) = D(ρ̃) + 2,
т. е. имеющее «почти» минимальное суммарное расстояние до бинарных отношений



Медиана для нечётного числа отношений линейного порядка 101

ρ1, . . . , ρm, а именно с минимально возможным отклонением от D(ρ̃), равным 2. Этот
случай подробно рассматривается в п. 2. Приводятся легко проверяемые необходимые
и достаточные условия его выполнения, а также алгоритм выделения всех возможных
решений (с вычислительной сложностью O(n2)). Кроме того, описан простой алго-
ритм (с полиномиальной вычислительной сложностью) нахождения всех возможных
решений для каждого последующего множества {ρ ∈ LO[n] : D(ρ) = D(ρ̃) + ∆}, где
∆ = 4, 6, . . ., если предыдущие оказались пустыми.

Отметим: множество ∆-оптимальных решений даёт все множество Arg min D(ρ),
ρ∈LO[n]

т. е. является точным решением поставленной задачи. Термин «∆-оптимальность» го-
ворит об отклонении на ∆ величины min D(ρ) от D(ρ̃).

ρ∈LO[n]

Одним из двух необходимых условий для «почти оптимальности» отношения ρ̃ ∈/
∈/ LO[n] является условие ρ̃ ∈ LA(2)[n], где LA(2)[n] —множество всех бинарных отно-
шений из LA[n] \LO[n], имеющих расстояние по Хеммингу до ближайшего линейного
порядка, равное 2. В п. 2 и 3 приводятся утверждения о структуре множества LA(2)[n],
в частности получена формула для |LA(2)[n]|, дающая возможность определить долю
этого множества в LA[n] \ LO[n]. Например, |LA(2)[5]| = 480, |LA[5] \ LO[5]| = 904.

В п. 3 исследуется также структура множества LA[n]. Рассматривается отношение
эквивалентности на LA[n], позволяющее разбивать это множество на классы эквива-
лентности, количество которых Kn намного меньше числа элементов в LA[n]. Напри-
мер, |LA[5]| = 1024, K5 = 12. В частности, ρ̃ эквивалентно в точности одному из Kn

представителей классов эквивалентности, а следовательно, обладает его основными
свойствами. Таким образом, исследование широких классов бинарных отношений мо-
жет быть сведено к рассмотрению сравнительно небольшого набора их представителей.
Процесс нахождения указанного семейства представителей классов эквивалентности
иллюстрируется для n = 2, 3, 4, 5.

В п. 4 приводятся некоторые методы сведения исходной задачи к одной или несколь-
ким задачам меньшей размерности.

В п. 5 представлен метод решения поставленной задачи, использующий представ-
ление бинарных отношений в виде графов (метод выделения минимальных множеств
представителей контуров в медиане ρ̃) и имеющий экспоненциальную вычислительную
сложность.

Полученные результаты могут быть использованы при построении для единствен-
ного эксперта линейного порядка на множестве альтернатив, максимальным образом
учитывающего результаты их попарного сравнения. В [1, 12] приведён следующий
пример: изучались гастрономические предпочтения собаки на совокупности из ше-
сти видов пищи. Каждое утро перед собакой выставляли два вида пищи; считалось,
что она отдаёт предпочтение тому виду, с которого начинает завтрак. Результаты
сравнений можно свести в матрицу, являющуюся матрицей смежности некоторого би-
нарного отношения ρ1 ∈ LA[6]. Требуется найти Arg min D(ρ), где D(ρ) в данном

ρ∈LO[n]

случае совпадает с d(ρ, ρ1) —расстоянием Хемминга между ρ, ρ1. Эту задачу можно
обобщить на случай, когда исследуются предпочтения нечётного числа испытуемых,
для каждого из которых на основании попарных сравнений строится бинарное от-
ношение ρi ∈ LA[n], i = 1, . . . ,m. В этом случае, как и ранее, при решении задачи
группового выбора приходим к поиску Arg min D(ρ), где D(ρ) имеет тот же вид,

ρ∈LO[n]

что и в случае ρi ∈ LO[n]. Оказывается, что в случае ρi ∈ LA[n] также выполняется



102 В.Н. Нефедов

ρ̃ ∈ LA[n] и, более того, все изложенные в работе результаты переносятся и на этот
случай, что учитывается в условиях приводимых утверждений.

Замечание 1. Возможны и другие способы задания расстояния между бинар-
ными отношениями, например по формуле Кемени—Снелла [14, 15]. Эта формула
используется для нахождения расстояния между ранжировками. При этом в случае
линейных порядков (строгих ранжировок) значения расстояний по Хеммингу и по
Кемени—Снеллу совпадают (совпадение этих значений будет и в случае, когда отно-
шения принадлежат LA[n]).

Замечание 2. Условие нечётности m может показаться весьма ограничитель-
ным. Однако в случае чётного m, если, наприм∑ер, выбрать из ρ1, . . . , ρm бинарное

m
отношение ρi с минимальным значением Di(ρ) = d(ρi, ρt) (т. е. с минимальным сум-

t=1
марным расстоянием до остальных отношений) и продублировать его, то будем иметь
нечётное число отношений.

1. Основные понятия, определения и вспомогательные утверждения
Пусть A = {a1, a2 . . . , an}. Будем рассматривать бинарные отношения ρ на мно-

жестве A, т. е. множества упорядоченных пар ρ ⊆ A2, или кратко ρ ∈ 2A
2 . Матри-

цу смежности бинарного отношения ρ ∈ 2A
2 будем обозначать R(ρ) = [rij]n×n, где

′
rij = 1 ⇔ (ai, aj) ∈ ρ. Расстоянием (по Хеммингу) между отношениями ρ, ρ ∈ 2A

2

n
′ ∑∑n

назовём величину d(ρ, ρ ) = |rij −
′
rij|.

i=1 j=1

Пусть имеется набор бинарных отношений[ρ1, ]ρ2, . . . , ρm ∈ 2A
2 с матрицами смеж-

ности R(1), R(2), . . . , R(m), где (t)
R∑(t) = R (ρt) = rij , t = 1, 2, . . . ,m. Поставим ему

n×n
m

в соответствие матрицы P = R(t) =∑[pij]n×n, L = P − PT = [lij]n×n (T — операция
t=1

m
транспонирования∑матриц), т. е.

(t)
pij = rij , lij = pij − pji, i, j = 1, 2, . . . , n, а также

t=1
m

функцию D(ρ) = d (ρ, ρt), где ρ ∈ 2A
2 , R(ρ) = [rij]n×n.

t=1

Рассмотрим для данного набора бинарных отношений ρ1, ρ2, . . . , ρm ∈ 2A
2 мажо-

ритарное отношение ρ̃ ∈ 2A
2 , однозначно определяемое по «правилу большинства»

r̃ij = 1 ⇔ lij > 0, где R(ρ̃) = [r̃ij]n×n. Будем, кроме того, использовать нестрогий
мажоритарный граф G̃ = (A, ρ̃) с множеством вершин A и множеством дуг ρ̃. Мажо-
ритарный граф G̃ можно считать нагруженным, если поставить в соответствие каждой
дуге (ai, aj) ∈ ρ̃ вес lij. Определи{м матрицу весов C = [cij]n×n этого графа:

lij, если(ai, aj) ∈ ρ̃,
cij =

∞ в противном случае.

Нам понадобится
Теорема 1 [1]. Пусть ρ1, ρ2, . . . , ρm —произвольны∑е бинарные отношения на A =

m
= {a1, a2, . . . , an}. Тогда суммарное расстояниеD(q) = d(q, ρt) принимает минималь-

t=1

ное значение относительно всех бинарных отношений q ∈ 2A
2 тогда и только тогда,

когда для R(q) = [qij]n×n выполняется: qij = 1 ⇔ rtij = 1 не менее чем для m/2 зна-



Медиана для нечётного числа отношений линейного порядка 103

∑m
чений t ∈ {1, . . . ,m}, где i, j ∈ {1, . . . , n}. При этом в случае rtij = m/2 (т. е. при

t=1
чётном m) D(q) остаётся минимальным при любом выборе qij ∈ {0, 1}.

В настоящей работе предполагается, что ρt ∈ LA[n] (в частном случае ρt ∈ LO[n]),
t = 1, . . . ,m. Заметим в этой связи, что если ρ ∈ LA[n], R(ρ) = [rij]n×n, то из определе-
ния LA[n] следует, что

∀i, j ∈ {1, . . . , n} rii = 1, i 6= j ⇒ rij + rji = 1, (1)

а следовательно, в силу сделанного предположен∑ияm ( ) ∑m
∀ (t) (t)
i, j ∈ {1, . . . , n} i 6= j ⇒ pij + pji = rij+rji = 1 = m. (2)

t=1 t=1

Используя (1) и (2), нетрудно показать, что справедливо
Утверждение 1 [13]. Пусть ρ1, . . . , ρm ∈ LA[n] и m нечётно. Тогда для мажо-

ритарного отношения ρ̃ выполняется ρ̃ ∈ LA[n], при этом r̃ij = 1 ⇔ rtij = 1 для
большинства значений t ∈ {1, . . . ,m}.

Следствие 1. Пусть ρ1, . . . , ρm ∈ LA[n] и m нечётно. Тогда из теоремы 1 и утвер-
ждения 1 получаем, что мажоритарное отношение ρ̃ принадлежит LA[n], при этом
Arg min D(q) = {ρ̃}.

q∈2A
2

П)риведём некоторые вспомогательные утверждения (относительно LO[n], LA[n].
Из определений следует, что LO[n] ⊆ LA[n]; ∀ρ ∈ LA[n] ρ ∈ LO[n] ⇔ ρ транзитивно
на A . Кроме того, из определения LA[n] получаем

Утверждение 2. Пусть ρ1, ρ2 ∈ LA[n]. Тогда d(ρ1, ρ2) чётно.
Следствие 2. Пусть ρ1, . . . , ρm ∈ LA[n]. Тогда D(ρ) чётно для всех ρ ∈ LA[n].
Из утверждения 1 и следствий 1 и 2 получаем
Утверждение 3. Пусть ρ1, . . . , ρm ∈ LA[n] и m нечётно. Тогда min D(q) чётно.

q∈2A2

Приведём простое условие проверки того, что ρ ∈ LO[n], для ρ ∈ LA[n]. Для этого
понадобятся некоторые обозначения.

2 ∑n
Пусть n > 2, ρ ∈ 2A , R(ρ) = [rij]n×n. Обозначим κi(ρ) = rij —количество единиц

j=1

в i-й строке матрицы R(ρ), i ∈ {1, . . . , n}; I(ρ) = 〈i1, . . . , in〉, где 1 6 i1 6 . . . 6 in 6 n,
i1, . . . , in ∈ {κ1(ρ), . . . , κn(ρ)}, причём для всех j ∈ {1, . . . , n} компонента ij входит
в I(ρ) столько раз, в скольких строках количество единиц равно ij.

Пример 1. Пусть бинарные отношения ρ1, ρ2, ρ
A2

3 ∈ 2 при n = 4 заданы матри-
цами R(ρi), i =1, 2, 3:     

R(ρ 1 1 1 0 1 1 0
1 0  

1) = 1 1 1 0 
, R(ρ ) =  1  ) = 1 1 1 0

0 1 1 1 2 0 0 
, R(ρ

0 1 1 0 3 0 1 1 1
0 0 1 1 .

0 1 0 1 1 1 1 1 1 0 0 1

Тогда I(ρ1) = 〈2, 3, 3, 3〉, I(ρ2) = 〈1, 2, 3, 4〉, I(ρ3) = 〈2, 2, 3, 3〉, d(ρ1, ρ2) = 5. При этом
ρ1 ∈/ LA[4] (см. выделенные элементы в R(ρ1)), ρ2 ∈ LO[4], ρ3 ∈ LA[4] \ LO[4].

Нетрудно показать [13], что справедливо



104 В.Н. Нефедов

Утверждение 4. Пусть ρ ∈ LA[n]. Тогда ρ ∈ LO[n]⇔ I(ρ) = 〈1, 2, . . . , n〉.
Замечание 3. Условие I(ρ) = 〈1, 2, . . . , n〉, где ρ ∈ 2A

2 , проверяется сложени-
ем n элементов каждой из n строк матрицы R(ρ), т. е. имеет вычислительную слож-
ностьO(n2). Проверка условия ρ ∈ LA[n], которая сводится к проверке выполнения (1),
также имеет вычислительную сложность O(n2). Следовательно, проверка условия
ρ ∈ LO[n] имеет вычислительную сложность O(n2).

Таким образом, в случае, когда ρ1, . . . , ρm ∈ LA[n] иm нечётно, мажоритарное отно-
шение ρ̃, определяемое по «правилу большинства» из матриц P,L, принадлежит LA[n],
но может не принадлежать LO[n]. Поскольку мы ищем множество Arg min D(ρ), нас

ρ∈LO[n]

интересуют отношения ρ ∈ LO[n] со значениями D(ρ), имеющими минимальное от-
клонение от D(ρ̃). В связи с этим можно рассматривать два типа задач: «полную» и
«частичную». Решением «полной» задачи является безусловное (т. е. без дополнитель-
ных ограничений) нахождение множества всех отношений из Arg min D(ρ). Такая

ρ∈LO[n]

задача в общем случае является экспоненциально сложной. Некоторыми методами
её решения являются перебор, в том числе с использованием метода ветвей и границ
(см. введение), а также метод (см. п. 5), основанный на исследовании графа G̃ = (A, ρ̃).
«Частичная» задача заключается в предварительном выяснении существования для
заданного ∆0 ∈ {0, 2, 4, . . .} (см. следствие 2) отношения ρ ∈ LO[n] с D(ρ) 6 D(ρ̃)+∆0,
и только в случае положительного ответа — в нахождении Arg min D(ρ) (в случае

ρ∈LO[n]

отрицательного ответа считаем, что приемлемого отношения не существует). Как по-
казано далее, такая задача является п∑олиномиально сложной.

m
Замечание 4. Функцию D(ρ) = d(ρ, ρt) можно модифицировать, добавив ко-

t=1
эффициенты при d(ρ, ρt). Возможный часто используемый подход заключается в сле-
дующем: в рассмотрение вводятся величины D(ρt), t = 1, . . . ,m. В случае задачи вы-
бора эти величины характеризуют «согла[сованность» i-го эксперта с другими экспер-
тами: чем эта величина больше, тем «хуже∑» согласов]аннос

n −1 ∑ть. Далее рассматриваются
m

коэффициенты µt = µ/D(ρt), где µ = 1/D(ρi) ∑, µt = 1. Таким образом,
i=1 t=1

m
наряду с D(ρ) можно использовать функцию D̃(ρ) = µtd(ρ, ρt). Можно рассматри-

t=1

вать D̃(ρ) как основную функцию (вместо D(ρ)), минимизация которой обеспечивает
согласованность агрегированного отношения с профилем экспертных предпочтений,
либо как вспомогательную— в случае неоднозначности выбора из Arg min D(ρ) (для

ρ∈LO[n]

двухэтапной минимизации). Существует также немало процедур, позволяющих зада-
вать коэффициенты предпочтительности αi для альтернатив (процедура Коупленда и
др. [5 – 8]), с учётом которы∑х приходим к функции ещё о

m ∑m ∑n ∑n ∣∣дного вид

∣ ∣
(t)∣ а:

D˜̃ (ρ) = µtd̃(ρ, ρt) = µt αiαj rij − rij ∣ .
t=1 t=1 i=1 j=1

2. Условия существования и алгоритмы нахождения всех
«почти оптимальных» решений

Получим сначала необходимое и достаточное условие существования «почти опти-
мального» (или 2-оптимального) отношения ρ ∈ LO[n].

Теорема 2. Пусть ρ1, . . . , ρm ∈ LA[n] и m нечётно, ρ̃—мажоритарное отношение,
R(ρ̃) = [r̃ij]n×n, ρ̃ ∈/ LO[n]. Тогда для существования «почти оптимального» отношения



Медиана для нечётного числа отношений линейного порядка 105

необходимо и достаточно, чтобы для некоторого λ ∈ LO [n] выполнялись следующие
условия:

1) R(λ) = [rλij]n×n, d(λ, ρ̃) = 2, т. е. существуют такие i0, j0 ∈ {1, . . . , n}, что i0 6=
6= j0, rλi , r̃ 〉 ∈ J

0,j
= 1 i0,j0 = 0, rλj 0, r̃

0,i
=

0 j0,i0 = 1, rλij = r̃ij при всех 〈i, j 0 =
0

= {1, 2, . . . , n}2 \ {〈i0, j0〉, 〈j0, i0〉};
2) pi0,j0 = (m− 1)/2, pj0,i0 = (m+ 1)/2.
Пример 2. Пусть n = 4, m = 5, ρ1 = ρ2 : a3 ≺ a2 ≺ a1 ≺ a4, ρ3 : a1 ≺ a2 ≺ a4 ≺ a3,

ρ (t) (t)
4 : a1 ≺ a4 ≺ a3 ≺ a2, ρ5 : a2 ≺ a1 ≺ a4 ≺ a3. Тогда R = R(ρt) = [rij ]n×n,
t = 1, 2, 3, 4, 5, имеют следующий вид:

  
1 0 0 1 1 1 1

1 0 1 1 1 1 1  
R(1) = R(2) = 1  , R(3) = 

1 1 1 1 0 1 1 1 1

  0
, R(4) 0 1 0

=   ,
0 0 1 0 0 1 1 0

0 0 0 1  0 0 1 1 0 1 1 1

 
1 0 1 1

1
R(5) 1 1

=  1  ;
0 0 1 0

 0 0 1 1

∑ 
5 2 3 5 1 1

5  
3 5 2 4


1 0 1

P = R(t) = [p   
, R(ρ̃) = [r̃ 1 0

ij]4×4 = 
t=1 2 3 5 2 ij]4×4 = 1 

1 .
0 1 0

0 1 3 5   0 0 1 1


Пусть ≺ a 1 0 1 1

4 ≺ a3, [rλij]4×4 = R(λ) = 1 1 1 1
λ : a 

2 ≺ a1 . Тогда при i
0 0 1 0 0 = 2,
0 0 1 1

j0 = 3 условия 1 и 2 теоремы 2 выполняются (для наглядности элементы rλ2,3, r̃2,3,
rλ3,2, r̃3,2, p2,3, p λ

3,2 выделены): r2,3 = 1, r̃2,3 = 0, rλ3,2 = 0, r̃3,2 = 1; rλij = r̃ij при всех
〈i, j〉 ∈ J0 = {1, 2, 3, 4}2 \ {〈2, 3〉, 〈3, 2〉}; p2,3 = (m − 1)/2 = 2, p3,2 = (m + 1)/2 = 3, при
этом D(ρ̃) = 18, D(λ) = 20 = D(ρ̃) + 2.

Для доказательства теоремы 2 используется
Утверждение 5 [13]. Пусть ρ, . . . , ρm ∈ LA[n] и m нечётно, ρ̃—мажоритарное

отношение, R(ρ̃) = [r̃ij]n×n, ρ ∈ LA[n], R(ρ) = [rij]n×n, Jρ = {〈i, j〉 ∈ {1, . . . , n}2 : r̃ij 6=
6= rij}. Тогда ∑ ∑

D(ρ) = D(ρ̃) + (max{pij, pji} −min{pij, pji}) = D(ρ̃) + 2 cij >
〈i,j〉∈Jρ 〈i,j〉∈Jρ,cij 6=∞ (3)

> D(ρ̃) + |Jρ| = D(ρ̃) + d(ρ, ρ̃).

Приведем также следующее
Утверждение 6 [13]. Пусть ρ ∈ LA[n]. Тогда ρ ∈ LO[n] в том и только в том

случае, когда в графе G(ρ) = (A, ρ), рассматриваемом без петель, нет контуров.
Следствие 3. Пусть, в условиях теоремы 2, для некоторого λ ∈ LO[n] выполня-

ются условия 1 и 2 этой теоремы. Тогда ci0,j0 =∞, cj0,i0 = 1 и дуга 〈ai0 , aj0〉 входит во
все контуры графа G(ρ̃) = (A, ρ̃).



106 В.Н. Нефедов

Доказательство. Поскольку ρ̃ ∈/ LO[n], то в силу утверждения 6 в G̃ имеется
контур. В λ в силу того же утверждения контуров нет и λ получается из ρ̃ заменой
одной дуги 〈ai0 , aj0〉 на противоположную, поэтому эта замена должна «разрушить»
все контуры в G̃, т. е. эта дуга входит во все контуры графа G̃.

Утверждение 6 и следствие 3 позволяют выяснить геометрический смысл «почти
оптимального» решения. Оно существует тогда и только тогда, когда в нагруженном
графе G(ρ̃) = (A, ρ̃) (рассматриваемом без петель) найдётся дуга 〈ai, aj〉 минимально
возможной длины cij = 1, замена которой на противоположную приводит к графу без
контуров. На рис. 1 представлен граф G̃ = (A, ρ̃) для ρ̃ из примера 2; замена дуги
〈a3, a2〉 на 〈a2, a3〉 «разрушает» все три контура в G̃.

Рис. 1

Используя теорему 2 и следствие 3, опишем простой алгоритм 1 определения суще-
ствования «почти оптимального» решения и нахождения всех таких решений.

Алгоритм 1. Нахождение всех «почти оптимальных» решений
1: Находим в нагруженном графе G̃ все дуги длины 1.
2: Для каждой из найденных в п. 1 дуг рассматриваем граф, полученный из G̃ заме-

ной этой дуги на противоположную. Если в полученном графе отсутствуют конту-
ры, то одно из возможных «почти оптимальных» решений найдено. Действуя так,
получим их все.

3: Если после перебора в п. 2 всех дуг длины 1 не нашли ни одного «почти оптималь-
ного» решения, то такого решения не существует.

Алгоритм 1 использует полиномиально сложную процедуру проверки графа на на-
личие контуров, применяемую не более n(n − 1)/2 (количество дуг в G̃, отличных от
петель) раз, т. е. также имеет полиномиальную сложность вычислений. Проверку гра-
фа ′ ′

G̃ = (A, ρ̃ ) на наличие контуров, где ′
ρ̃ ∈ LA[n] — бинарное отношение, полученное

заменой одной из пар в ρ̃ длины 1 на противоположную, можно в силу утверждения 6
заменить на проверку ′

ρ̃ ∈ ′
LO[n], равносильную проверке I(ρ̃ ) = 〈1, 2, . . . , n〉 (см.

утверждение 4), имеющей сложность O(n2). Таким образом, алгоритм 1 имеет вычис-
лительную сложность O(n4).

Если дуг длины 1 в G̃ много, а дуг, входящих в контуры, сравнительно мало, то
можно воспользоваться также алгоритмом 2.

Алгоритм 2. Нахождение всех «почти оптимальных» решений
1: Находим в G̃ все дуги, входящие в контуры. Выделяем среди них дуги длины 1.
2: Далее действуем согласно пп. 2 и 3 алгоритма 1.



Медиана для нечётного числа отношений линейного порядка 107

Если ∆-оптимального решения при ∆ = 2 не оказалось, то можем попытаться
найти его при ∆ = 4 (это имеет смысл делать, если величина 4/D(ρ̃) достаточно мала).
В этом случае, согласно второму равенству в (3), проверяем на наличие контуров
графы, полученные из G̃ заменой на противоположные ровно двух дуг длины 1.

Если ∆-оптимального решения при ∆ ∈ {2, 4} не оказалось, то можем попы-
таться найти его при ∆ = 6 (это имеет смысл делать, если величина 6/D(ρ̃) до-
статочно мала). В этом случае, согласно второму равенству в (3), проверяем на на-
личие контуров графы, полученные из G̃ заменой на противоположные ровно трёх
дуг длины 1 или ровно одной дуги длины 3 (очевидно, что если cij 6= ∞, i 6= j, то
cij = pij − pji ∈ {1, 3, 5, . . . ,m}), и т. д. При этом алгоритм остаётся полиномиальным,
если ограничиваем величину ∆ сверху некоторой константой.

Опишем процедуру проверки ρ̃ на «почти оптимальность», использующую про-
стой подсчёт количества единиц в строках матрицы R(ρ̃) (подобно условию I(ρ) =
= 〈1, 2, . . . , n〉 для проверки ρ̃ ∈ LO[n]). Кроме того, выясним структуру множества
всех ρ̃ ∈ LA[n], для которых выполняется условие 1 теоремы 2.

Из определения LA[n] следует, что для всех ρ ∈ LA[n] для I(ρ) = 〈i1, . . . , in〉 вы-
полняется

1 6 i1 6 . . . 6 in 6 n, i1 + . . .+ in = n(n+ 1)/2. (4)
Замечание 5. Отметим, что не всякому целочисленному решению 〈i1, . . . , in〉 си-

стемы (4) соответствует некоторое ρ ∈ LA[n], для которого I(ρ) = 〈i1, . . . , in〉. Напри-
мер, вектор 〈1, 1, 4, 4〉 является решением системы (4) при n = 4, но не существует
ρ ∈ LA[4] с I(ρ) = 〈1, 1, 4, 4〉. Действительно, существование в R(ρ) строки с некото-
рым номером j ∈ {1, . . . , n} с одной единицей (на главной диагонали) приводит к то-
му, что в j-м столбце будут только единицы, а следовательно, в R(ρ) не может быть
ещё одной строки с одним единичным элементом. Таким образом, из множества цело-
численных решений системы (4), соответствующих 〈i1, . . . , in〉 = I(ρ), где ρ ∈ LA[n],
следует удалить все решения с i1 = i2 = 1 и (по аналогичным соображениям) все
решения с in−1 = in = n. Этим не исчерпываются ограничения на целочисленные ре-
шения системы (4) для I(ρ) = 〈i1, . . . , in〉, где ρ ∈ LA[n]. Например, как будет видно из
дальнейшего, не существует ρ ∈ LA[6] с I(ρ) = 〈1, 2, 2, 5, 5, 6〉, хотя для этого вектора
условия (4) при n = 6 выполняются.

Обозначим для всех n > 2:

Jn = {〈i1, . . . , in〉 : ∃ρ ∈ LA[n] (I(ρ) = 〈i1, . . . , in〉)},
∀〈i1, . . . , in〉 ∈ Jn LA〈i1,...,in〉[n] = {ρ ∈ LA[n] : I(ρ) = 〈i1, . . . , in〉}.

Для каждого ρ ∈ LA[n] введём в рассмотрение вектор

I(ρ) = I(ρ)− 〈1, 2, . . . , n〉 = 〈i1 − 1, i2 − 2, . . . , in − n〉
и множество Jn = Jn − 〈1, 2, . . . , n〉 = {I(ρ) : ρ ∈ LA[n])}. Нам понадобится следующее
множество Vn целочисленных векторов с элементами из {0, 1,−1}, где n > 3:

Vn={〈︸0, .︷.︷. , 0︸, 1, 0︸, .︷.︷. , 0︸,−1, ︸0, .︷.︷. , 0︸〉 ∈ {0, 1,−1}n: s1 > 0, s2 > 1, s3 > 0, s1+s2+s3 =n−2}.
s1 s2 s3

Например,

V3 = {〈1, 0,−1〉}, V4 = {〈1, 0,−1, 0〉, 〈1, 0, 0,−1〉, 〈0, 1, 0,−1〉},
V5={〈1, 0,−1, 0, 0〉,〈1, 0, 0,−1, 0〉,〈1, 0, 0, 0,−1〉,〈0, 1, 0− 1, 0〉,〈0, 1, 0, 0,−1〉,〈0, 0, 1, 0,−1〉}.



108 В.Н. Нефедов

Утверждение 7 [13]. |Vn| = (n− 1)(n− 2)/2.
Далее покажем, что для всех ρ ∈ LA[n] \ LO[n] для существования λ ∈ LO[n],

такого, что d(λ, ρ) = 2, необходимо выполнение условия I(ρ) ∈ Vn. Нам потребуются
некоторые свойства векторов из Jn. Справедливо

Утверждение 8 [13]. Пусть n > 3, ρ ∈ LA[n] \ LO[n]. Тогда I(ρ) содержит не
менее двух ненулевых компонент, первая из которых положительная, а последняя—
отрицательная. Кроме того, после положительной компоненты не может сразу следо-
вать отрицательная (между ними должна быть хотя бы одна нулевая компонента).

Доказательство утверждения 8 основано на рассуждениях, аналогичных приведён-
ным в замечании 3.

Введём в рассмотрение два преобразования бинарных отношений ρ на A, которые
не выводят из LA[n]. Пусть Sn —множество всех биективных отображений (подста-
новок) вида π : {1, . . . , n} → {1,{. . . , n}. Обозначим для A = {a1, a2, . . . , an}, ρ ∈ 2A

2 ,
π ∈ Sn }

πρ = 〈aπ(i), aπ(j)〉 : 〈ai, aj〉 ∈ ρ
(π-преобразование бинарного отношения ρ на A), а в случае A = {1, 2, . . . , n}

πρ = {〈π(i), π(j)〉 : 〈i, j〉 ∈ ρ} .
Пример 3. Пусть n = 4, ρ = {〈a1, a1〉, 〈a1, a2〉, 〈a1, a3〉, 〈a2, a4〉, 〈a3, a4〉}, π =

= (1, 2, 4) ∈ S4. Тогда πρ = {〈a2, a2〉, 〈a2, a4〉, 〈a2, a3〉, 〈a4, a1〉, 〈a3, a1〉}.
При таком определении, очевидн(о, выполняется следующее условие:

∀ρ, ρ1 ∈ 2A
2 )
∀π, π1, π2 ∈ Sn (π1π2)ρ = π1(π2ρ), ρ1 = πρ⇒ ρ = π−1ρ1 ,

где (π1π2)(i) = π1(π2(i)), i ∈ {1, . . . , n}. Заметим далее, что для всех ρ ∈ 2A
2 для

R(ρ) = [rij]n×n справедливо ( )
∀π ∈ Sn R(πρ) = [r̃ij]n×n ⇒ r̃ij = rπ−1(i),π−1(j) ,

т. е. если в i-й строке матрицы R(ρ) содержится l единиц и n − l нулей, где i, l ∈
∈ {1, . . . , n}, то в π(i)-й строке матрицы R(πρ) также содержится l единиц и n − l
нулей. Следовательно, справедливо

Утверждение 9. Пусть n > 2 , 〈i1, . . . , in〉 ∈ Jn , ρ ∈ LA〈i1,...,in〉[n]. Тогда для всех
π ∈ Sn выполняется πρ ∈ LA〈i1,...,in〉[n].

Будем{ использовать ещё одно п}реобразование. Обозначим для всех ρ ∈ 2A
2 и

〈i0, j0〉 ∈ 〈i, j〉 ∈ {1, 2, . . . , n}2 : i < j

δi0,j0ρ = {〈ai, aj〉 ∈ ρ : 〈i, j〉 ∈/ {〈i0, j0〉, 〈j0, i0〉}}∪
∪{〈ai0 , aj0〉 : 〈aj0 , ai0〉 ∈ ρ} ∪ {〈aj0 , ai0〉 : 〈ai0 , aj0〉 ∈ ρ} .

В соответствии с этим{ определением для всех ρ ∈ 2A
2 для R(ρ) = [rij]n×n выполня-

ется }
∀〈i0, j0〉 ∈ 〈i, j〉 ∈ {1, . . . , n}2 : i < j R(δi0,j0ρ) = [r′ij]n×n,

где r′i0,j = rj0,i0 ; r′j = r
0 0,i0 i0,j0 ; ∀〈i, j〉 ∈ {1, . . . , n}

2 \ {〈i0, j0〉, 〈j0, i0〉} (r′ij = rij), т. е.
преобразование δi0,j0 меняет ровно два элемента ri0,j0 , rj0,i0 местами. Из определения
этого преобразования сл{едует, что если ρ ∈ LA[n], т}о

∀〈i0, j0〉 ∈ 〈i, j〉 ∈ {1, 2, . . . , n}2 : i < j ρ′ = δi0,j0ρ ∈ LA[n],



Медиана для нечётного числа отношений линейного порядка 109

и при этом вектор I(ρ)− I(ρ′) содержит ровно один элемент «1», ровно один элемент
«−1» и n − 2 элементов «0», т. е. I(ρ) 6= I(ρ′), а следовательно, ρ′ ∈/ LA〈i1,...,in〉[n], где
〈i1, . . . , in〉 = I(ρ).

Утверждение 10. П{усть ρ ∈ LA[n] \ LO[n], d(ρ}, LO[n]) = 2. Тогда существуют
такие λ ∈ LO[n], 〈i0, j0〉 ∈ 〈i, j〉 ∈ {1, 2, . . . , n}2 : i < j , что верны следующие условия:

1) ρ = δi0,j0λ, λ = δi0,j0ρ;
2) I(ρ) ∈ Vn, т. е. в векторе I(ρ) ровно две ненулевые компоненты 1 и −1, находя-

щиеся в v1-й и v2-й позициях соответств{енно, где v1 6 v2−2 (см.∑утверждение 8
n });

3) i0 = {min {i′0, j′0}, j0 = max{i′0, j′0}, i′∑ 0 ∈ i ∈
n }{1, . . . , n} : κi(ρ) = rij = v1 + 1 ,

j=1

j′0 ∈ i ∈ {1, . . . , n} : κi(ρ) = rij = v2 − 1 , ri′0,j′ = 1, r
0 j′0,i

′ = 0.
0

j=1

Утверждение 10 является очевидным следствием того, что:
а) по его условиям для некоторого λ ∈ LO[n] матрицы R(ρ) = [rij]n×n, R(λ) =

= [rλij]n×n имеют различие ровно в двух позициях (симметричных относительно
главной диагонали, поскольку ρ, λ ∈ LA[n]): 〈i0, j0〉 и 〈j0, i0〉, где i0 < j0;

б) I(λ) = 〈1, 2, . . . , n〉, а следовательно, в силу свойства а, I(ρ) ∈ Vn (поскольку
в R(ρ) по сравнению с R(λ) в i0-й строке на одну единицу меньше (или больше),
а в j0-й строке соответстве∑нно на одну единицу больше (или меньше));

n ∑n
в) если rλi0,j = 0, то для v1 = rλi0,j, v2 = rλj0,j в векторе I(ρ) ∈ Vn компоненты 1

0
j=1 j=1

и −1 находятся в v1-й∑и v2-й позици
n ∑ях соответственно, а если rλi0,j = 1, то это

0
n

выполняется для v1 = rλj , v =
0,j 2 rλi0,j.

j=1 j=1

Замечание 6. Условия 1–3 утверждения 10, очевидно, являются достаточными
для существования для некоторого ρ ∈ LA[n] \LO[n] бинарного отношения λ ∈ LO[n],
такого, что d(ρ, λ) = 2.

Используя утверждение 10, нетрудно описать следующий алгоритм 3.

Алгоритм 3. Нахождение для ρ ∈ LA[n]\LO[n] всех λ ∈ LO[n], таких, что d(ρ, λ) = 2
1: Находим по матрице R(ρ) = [rij]n×n векторы I(ρ) = 〈i1, i2, . . . , in〉, I(ρ) = I(ρ) −
−〈1, 2, . . . , n〉. Проверяем выполнение I(ρ) ∈ Vn. Если это условие не выполняется,
то в силу утверждения 10 искомых λ ∈ LO[n] не существует и работа алгоритма
заканчивается. В противном случае переходим к п. 2.

2: Находим номера v1, v2 компонент вектора I(ρ) ∈ Vn, равных 1 и −1 соответственно.
Тогда{v1 6 v2 − 2. Определяем мн∑ожест

n }ва { ∑n }
I1 = i∈{1, . . . , n} : v1 + 1 = iv1= rij , I2 = i∈{1, . . . , n} : v2 − 1 = iv2= rij ,

j=1 j=1

где iv1 , iv2 —компоненты вектора I(ρ) = 〈i1, . . . , in〉.
3: Находим все упорядоченные пары 〈i0, j0〉, такие, что i0 ∈ I1, j0 ∈ I2, i0 6= j0,
ri0,j0 = 1. Если таких пар нет, то в силу утверждения 10 искомого λ ∈ LO[n] не
существует и работа алгоритма заканчивается. В противном случае для каждой
найденной пары 〈i0, j0〉 одним из искомых линейных порядков в случае (i0 < j0)
является λ = δi0,j0ρ, а в случае (j0 < i0) — λ = δj0,i0ρ.



110 В.Н. Нефедов

Замечание 7. Очевидно, что на шаге 2 алгоритма 3, если v1 = v2 − 2 (т. е. в
векторе I(ρ) ∈ Vn ровно один нуль между 1 и −1), то I1 = I2 и |I1| = |I2| = 3 (например,
в случае I(ρ) = 〈0, 1, 0,−1, 0〉 выполняется I(ρ) = 〈1, 3, 3, 3, 5〉), а если v1 6 v2 − 3 (т. е.
в векторе I(ρ) ∈ Vn более одного нуля между 1 и −1), то I1 ∩ I2 = ∅ и |I1| = |I2| = 2
(например, в случае I(ρ) = 〈0, 1, 0, 0,−1〉 выполняется I(ρ) = 〈1, 3, 3, 4, 4〉). В первом
случае для любого n > 3 на шаге 3 проверяем шесть элементов ri0,j0 , где i0, j0 ∈
∈ I1 = I2, i0 6= j0, для трёх из которых ri0,j0 = 1, т. е. всегда имеем ровно три решения.
Во втором случае проверяем четыре элемента ri0,j0 , где i0 ∈ I1, j0 ∈ I2 (т. е. решений
в этом случае не более четырёх, и как показано ниже, оно единственное). Нетрудно
видеть, что вычислительная сложность алгоритма 3 равна O(n2) (аналогично проверке
выполнения условия I(ρ) = 〈1, 2, . . . , n〉).

Пример 4. Применим алгоритм 3 к ρ1, ρ2 ∈ LA[5]\LO[5], заданными матрицами
(1)

R(ρ1) = [ ij ]5×5,
(2)

r R(ρ2) =[rij ]5×5:

   
1 1 1 1 0 1 1 1 1 0

0 1 1 1
R(ρ  1

1) = 0 0 1 1 1 , R(ρ )
0 0 0 1 1 2 = 0 1 1 1 1

 
0 0 1 1 0 .0 0 0 1 1

1 0 0 0 1 1 0 1 0 1

Заметим, что

I(R(ρ1)) = I(R(ρ2)) = 〈2, 2, 3, 4, 4〉, I(R(ρ1)) = I(R(ρ2)) = 〈1, 0, 0, 0,−1〉 ∈ V5.

Рассмотрим сначала ρ1. Согласно п. 2 алгоритма 3, определяем v1 = 1, v2 = 5,
iv1 = 2, iv2 = 4, { ∑5 }

(1)
I1 = {i ∈ {1, 2, 3, 4, 5} : v1 + 1 = iv1 = 2 = rij = {4, 5} ,

j∑=1

5 }
I2 = i ∈ {1, 2, 3, 4, 5} : v2 − (1)

1 = iv2 = 4 = rij = {1, 2} .
j=1

Далее перебираем все значения (1)
ri0,j , где i0 ∈ I1 = {4, 5}, j0 ∈ I0 2 = {1, 2} (выделены

в матрице (1) (1) (1)
R(ρ1)): r4,1 = 0, r5,1 = 1, r4,2 = 0, (1)

r5,2 = 0. Таким образом, нашлась един-
ственная пара 〈 (

5, 1〉, такая, что 1)
r5,1 = 1, а следовательно, существует единственный

линейный порядок λ1 = δ1,5ρ, такой, что d(ρ1, λ1) = 2:

 
1 1 1 1 1

0 1 1 1 1
R(λ1) =  

0 0 1 1 1
0 0 0 1 1 .
0 0 0 0 1

Рассмотрим ρ2.{Согласно п. 2 алгоритма 3, определяем v1 =

∑5 }1, v2 = 5, iv1 = 2, iv2 = 4,

(1)
I1 = {i ∈ {1, 2, 3, 4, 5} : v1 + 1 = iv1 = 2 = rij = {3, 4} ,

j∑=1

5 }
I2 = i ∈ {1, 2, 3, 4, 5} : v2 − (1)

1 = iv2 = 4 = rij = {1, 2} .
j=1



Медиана для нечётного числа отношений линейного порядка 111

Далее перебираем все значения (2)
ri j , где i0 ∈ I1 = {3, 4}, j0 ∈ I = 2} (выделены

0, 0 2 {1,
в матрице (2) (2) (2) (

R(ρ2)): r3,1 = 0, r4,1 = 0, r3,2 = 0, 2)
r4,2 = 0. Не нашлось ни одной пары 〈i0, j0〉,

такой, что ∈ (2)
i0 ∈ I1, j0 I2, ri ,j = 1, а следовательно, в силу утверждения 10, искомого

0 0

λ ∈ LO[5] с d(ρ2, λ) = 2 не существует и работа алгоритма заканчивается. Нетрудно
показать, что ближайшим к ρ2 линейным порядком также является λ1, но при этом
d(ρ2, λ1) = 4.

Цель да{льнейших рассуждений— показать, чт}о множество бинарных отношений
LA(2)[n] = ρ ∈ LA[n] \ LO[n] : min d(λ, ρ) = 2 является достаточно широким, а

λ∈LO[n]

также описать структуру этого множества. Далее установлено, что в случае n = 4 вы-
полняется LA(2)[4] = LA[4] \ LO[4], но уже для n = 5 ситуация меняется и множество
LA(2)[5] составляет лишь некоторую (хотя и достаточно широкую) часть множества
LA[5]\LO[5]. Проиллюстрируем рассуждения для )

n = 5. Пусть (n
λ1 —линейный поря-

док, определяемый условиями a1 ≺ a2 ≺ ае (5)

. . . ≺ an (в случ n = 5 с матрицей R(λ1 )):

1 1 1 1 1
0 1 1

(5)
R(λ 

1 ) =  1 1
 

0 0 1 1 1 .
0 0 0 1 1
0 0 0 0 1

Перечислим все возможные (n)
ρ ∈ LA[n] \ LO[n], такие, что d(λ1 , ρ) = 2. Очевидно, что

любое из таких бинарных отношений получается из (n)
λ1 заменой ровно одной пары

с разными элементами на противоположную, т. е. является бинарным отношением вида
(n)

ρ = δi,jλ1 , где 〈i, j〉 ∈ {〈i, j〉 ∈ {1, . . . , n}2 : i < j}. Исключением являются случаи
с j = i + 1, поскольку (n)

δi,i+1λ1 (где i = 1, 2, . . . , n − 1) — линейные порядки вида
)

a1 ≺ a2 ≺ . . . ≺ ai−1 ≺ ai+1 ≺ ai ≺ ai+2 ≺ . . . ≺ an. Например,
(5) (5
λ2 = δ1,2λ1 : a2 ≺ a1 ≺

≺ a3 ≺ a4 ≺ a5, 1 0 1 1 1

(5)
R(λ 

2 ) = 1 1 1 1 1
 

0 0 1 1 1
0 0 0 1 1 .
0 0 0 0 1

Во всех остальных (n − 1)(n − 2)/2 случаях (их шесть при n = 5) получаем попарно
различные бинарные отношения из LA(2)[n]. В случае n = 5 имеем

(5) (5) (5) (5)
ρ1,3 = δ1,3λ1 , I(ρ1,3) = 〈1, 2, 4, 4, 4〉, I(ρ1,3) = 〈0, 0, 1, 0,−1〉;

(5) (5) (5) (5)
ρ1,4 = δ1,4λ1 , I(ρ1,4) = 〈1, 3, 3, 4, 4〉, I(ρ1,4) = 〈0, 1, 0, 0,−1〉;

(5) (5) (5) (5)
ρ1,5 = δ1,5λ1 , I(ρ1,5) = 〈2, 2, 3, 4, 4〉, I(ρ1,5) = 〈1, 0, 0, 0,−1〉;

(5) (5) (5)
ρ2,4 = δ2,4λ1 , I(ρ2,4) = 〈1, 3, 3, 3, 5〉 (5)

, I(ρ2,4) = 〈0, 1, 0,−1, 0〉;
(5) (5) (5) (5)
ρ2,5 = δ2,5λ1 , I(ρ2,5) = 〈2, 2, 3, 3, 5〉, I(ρ2,5) = 〈1, 0, 0,−1, 0〉;

(5) (5) (5) (5)
ρ3,5 = δ3,5λ1 , I(ρ3,5) = 〈2, 2, 2, 4, 5〉, I(ρ3,5) = 〈1, 0,−1, 0, 0〉.



112 В.Н. Нефедов

Матрица (5)
R(ρ1,3) имеет следующий вид: 

1 1 0 1 1
1 1 1 1

(5)
R(ρ1,3) = 0

 
1 0 1 1 1
0 0 0 1 1 .
0 0 0 0 1

В общем случае с произвольным n > 5:
(n)

I(δl,kλ1 ) = 〈0︸, .︷.︷. , 0︸, 1, 0︸, .︷.︷. , 0︸,−1, 0︸, .︷.︷. , 0︸〉, l = 1, . . . , n− 2, k = l + 2, . . . , n. (5)
n−k k−l−1 l−1

Зная (n) n)
I(δl,kλ1 ), можно легко найти (n) (

I(δl,kλ1 ) = I(δl,kλ1 ) + 〈1, 2, . . . , n〉.
Обозначим (n)

Λ(n) = {δl,kλ1 : l = 1, . . . , n − 2, k = l + 2, . . . , n}. Из (5) следует, что
элементы в Λ(n) попарно различны. Таким образом, справедливо

Утверждение 11. Пусть n > 3. Тогда
(n) (n)

Λ(n) = {δl,kλ1 : l = 1, . . . , n− 2, k = l + 2, . . . , n} = {ρ ∈ LA[n] \ LO[n] : d(λ1 , ρ) = 2}.

Найденный набор бинарных отношений вида (n)
δl,kλ1 , l = 1, . . . , n−2, k = l+2, . . . , n,

из искомого множества LA(2)[n], содержащий (n− 1)(n− 2)/2 попарно различных би-
нарных отношений, на самом деле является набором представителей попарно не пе-
ресекающихся подмножеств этого множества, совокупность которых является разбие-
нием LA(2)[n]. Для описания этого разбиения понадобятся некоторые дополнительные
свойства рассмотренных ранее π-преобразований бинарных отношений на A.

Назовём бинарные отношения ρ A2
1, ρ2 ∈ 2 π-эквивалентными, если ρ1 = πρ2 для

некоторой подстановки π ∈ Sn (пишем ρ1 ∼ ρ2). Очевидно, что это бинарное отно-
шение на 2

2A является рефлексивным, симметричным и транзитивным, т. е. является
отношением эквивалентности на всём множестве 2

2A , а следовательно, и на любом его
подмножестве.

Для любого бинарного отношения 2
ρ ∈ 2A обозначим Πρ = {πρ : π ∈ Sn},

H(ρ) = {h ∈ Sn : hρ = ρ}—подгруппа группы Sn. Очевидно, что Πρ—класс эквива-
лентности бинарного отношения ρ относительно π-эквивалентности. Цель ближайших
рассуждений— доказать равенство ⋃

LA(2)[n] = {ρ ∈ LA[n] \ LO[n] : min d(λ, ρ) = 2} = ρ∈Λ(n) Πρ,
λ∈LO[n]

где Πρ1 ∩ Πρ2 = ∅ для любых неравных ρ1, ρ2 ∈ Λ(n). Кроме того, докажем ут∑вержде-
ния, позволяющие определять |Πρ|, где ρ ∈ LA[n], а тем самым и |LA(2)[n]| = |Πρ|.

ρ∈Λ(n)

Утверждение 12 [13]. Пусть ρ A2
1, ρ2 ∈ 2 , π ∈ Sn. Тогда d(ρ1, ρ2) = d(πρ1, πρ2).

Пусть 2
ρ ∈ 2A . Заметим, что π1ρ 6= π2ρ⇔ π1H(ρ)∩π2H(ρ) = ∅ для всех π1, π2 ∈ Sn,

т. е. количество попарно различных бинарных отношений в Πρ совпадает с количе-
ством левых смежных классов группы Sn по подгруппе H(ρ). Таким образом, спра-
ведливо

Утверждение 13. Для всех 2
ρ ∈ 2A

| n!
Πρ| |Sn|

= |Sn/H(ρ)| = = .
|H(ρ)| |H(ρ)|



Медиана для нечётного числа отношений линейного порядка 113

Для дальнейшего потребуются некоторые свойства подгруппы H(ρ).
Утверждение 14 [13]. Пусть ρ ∈ LA[n], π ∈ Sn и в разложении π в произведение

независимых циклов присутствует хотя бы один цикл чётной длины. Тогда πρ 6= ρ, т. е.
π ∈/ H(ρ).

Утверждение 15. Пусть 2
n > 2, ρ ∈ 2A , π ∈ H(ρ), i, j ∈ {1, 2, . . . , n}, i 6= j,

π(i) = j. Тогда в i-й и j-й строках матрицы R(ρ) одинаковое число единиц (нулей),
т. е. κi(ρ) = κj(ρ).

Для удобства применения утверждения 15 воспользуемся следующими обозначе-
ниями. Пусть 2

n > 2, ρ ∈ 2A . Введем в рассмотрение множества

A1(ρ) = {ai ∈ A : κi(ρ) = 1}, . . . , An(ρ) = {ai ∈ A : κi(ρ) = n}.

Они образуют разбиение множества A. Из утверждения 15 следует
Утверждение 16. Пусть 2

n > 2, ρ ∈ 2A , π ∈ H(ρ) и σ = (i1, i2, . . . , ik) —цикл
длины k > 2 из разложения подстановки π в произведение независимых циклов. Тогда
найдётся номер j ∈ {1, . . . , n}, такой, что {ai1 , ai2 , . . . , ai } ⊆ A

k j(ρ).
Следствие 4. Из утверждений 14 и 16 получаем, что если ρ ∈ LA[n] и |Aj(ρ)| 6 2

для j = 1, . . . , n, то H(ρ) = {e}, где e— тождественная подстановка.
Используя следствие 4, а также утверждения 4, 9 и 13, получаем
Утверждение 17. Пусть n > 2, λ ∈ LO[n]. Тогда H(λ) = {e}, Πλ = {πλ : π ∈

∈ Sn} = LO[n].
Теперь можем показать,что справедлива ⋃
Теорема 3. LA(2)[n] = {ρ ∈ LA[n] \ LO[n] : min d(λ, ρ) = 2} = Πρ и для

λ∈LO[n] ρ∈Λ(n)

всех (n)
ρ1, ρ2 ∈ Λ(n) = {δl,kλ1 : l = 1, . . . , n − 2, k = l + 2, . . . , n} если ρ1 6= ρ2, то

Πρ1 ∩ Πρ2 = ∅.
Доказательство.⋃ ⋃
1) Докажем, что Πρ ⊆ LA(2)[n]. Пусть ρ ∈ Πρ′. Тогда ρ = πρ′ для

ρ∈Λ(n) ρ′∈Λ(n)

некоторых ρ′ ∈ n), ∈ ределению ем (n)
Λ( π Sn. По оп Λ(n) име ρ′ = δl.kλ1 для некоторых

(n)
l ∈ {1, . . . , n − 2}, k ∈ {l + 2, . . . , n}. Но тогда d(ρ′, λ1 ) = 2, и в силу утверждений 9,
12 и 17 получаем (n) (n) (n)

ρ = πρ′ ∈ LA[n] \ LO[n], πλ1 ∈ LO[n], d(ρ, πλ1 ) = d(πρ′, πλ1 ) =
(n)

= d(ρ′, λ1 ) = 2, т. е. ρ ∈ LA(2)[n]. ⋃
2) Докажем, что LA(2)[n] ⊆ Πρ. Пусть ρ ∈ LA(2)[n]. Тогда ρ ∈ LA[n] \ LO[n]

ρ∈Λ(n)

и найдётся λ ∈ LO[n], такое, что d(λ, ρ) = 2. Из утверждения 17 получаем, что
существует )

π ∈ Sn, для⋃которой (n
πλ = λ1 , откуда по утверждению⋃12 следует

(n)
d(πρ, λ1 ) = d(πρ, πλ) = d(ρ, λ) = 2, а значит (см.утверждение 11), πρ = ρ′ ∈ Λ(n),
ρ = π−1ρ′ ∈ Πρ′ и ρ ∈ Πρ′. Таким образом, равенство LA(2)[n] = Πρ уста-

ρ′∈Λ(n) ρ∈Λ(n)

новлено и для завершения доказательства осталось воспользоваться равенством (5) и
утверждением 9.

3. Система представителей классов π-эквивалентности из LA[n]
В п. 2 выделена система представителей классов π-эквивалентности из LA(2)[n],

т. е. множество (n)
Λ(n) = {δl,kλ1 : l = 1, . . . , n − 2, k = l + 2, . . . , n}, состоящее из



114 В.Н. Нефедов

(n − 1)(n − 2)/2 элементов. Они конструктивным образом определяются и их срав-
нительно немного. Более того, далее приведено утверждение (лемма 1 «о редукции»),
в силу которого при каждом новом n существует единственный класс π-эквивалент-
ности из LA(2)[n], несводимый к соответствующему (редуцированному) классу экви-
валентности из LA(2)[n − 1]. Представителем нового класса является (n) (n)

ρ1,n = δ1,nλ1 ,
где (n)

I(ρ1,n) = 〈 (
2, 2, 3, . . . , n − 2, n − 1, n − 1〉, n)

Ī(ρ1,n) = 〈1, 0, . . . , 0,−1〉 ∈ Zn. При этом
при n > 5 справедливо (n)

Πρ1,n 6= LA (n) [n], т. е. выполнение для некоторого ρ ∈ LA[n]
I(ρ1,n)

условия Ī(ρ) = 〈1, 0, . . . , 0,−1〉 не гарантирует выполнение ρ ∈ LA(2)[n], но требует
дополнительной проверки (например, с помощью алгоритма 3).

При небольших n > 2 можно найти систему всех представителей классов π-экви-
валентности для всего множества LA[n]. Оценим их количество Kn снизу. Поскольку
в каждом классе эквивалентности не более n! элементов, количество классов эквива-
лентности больше или равно |LA[n]|/n! = 2n(n−1)/2/n!. Как будет видно из дальней-
шего, K2 = 1, K3 = 2, K4 = 4, K5 = 12 и, исходя из приведённой нижней оценки,
K6 > 215/720 ' 46, K7 > 221/5040 ' 416, K8 > 228/40320 ' 53261 и т. д. С учётом ре-
дукции (см. лемму 1) для каждого очередного n «новых» представителей (несводимых
к представителям меньшей размерности) будет меньше. Например, при n = 5 из 12
представителей «новых» только 6.

Таким образом, системой представителей классов π-эквивалентности для множе-
ства LA[n] является конечный набор ρ (n)

⋃ i ∈ LA[n], i = 1, . . . , Kn, такой, что
Kn

(n)
Πρi = LA[n]; i 6= j ⇒ (n) n

Πρi ∩
( )

Πρj = ∅. (6)
i=1

Одним из таких представителей будет любой линейный порядок из LO[n], напри-
мер (n)

λ1 , при этом (n)
Πλ1 = LO[n] (см. утве⋃рждение 17). Другие примеры предста-

вителей — (
ρ ∈ Λ(n) = { n)

δl,kλ1 : l = 1, . . . , n − 2, k = l + 2, . . . , n}. Интересен ответ на
вопрос, какую долю составляет LA(2)[n] = Πρ от всего множества LA[n]. Далее

ρ∈Λ(n)

получены системы представителей для LA[n] при n = 2, 3, 4, 5, а также описан подход
к получению этих систем, восходящий от достигнутого n к n+ 1.

Прежде чем сформулировать необходимую для дальнейшего лемму 1, рассмотрим
следующий пример:

Пример 5. Пусть ρ1,ρ2, ρ3 ∈ LA[5] заданы матрицами смежности

   
    

1 1 1 1 1 1

0 1 1 0 1 0 1 1 0 1
R(ρ1) =  

0 0 1 1 0 1 0 1 1 1 
0 1 0 1 1

1 1 0 0

, R(ρ 
2) =   1 1 1 1 1

, R(ρ3) = 0 1 1 0 1
 
0 0 1 1 1 .

1 1 0 1 1 0 1 0 1 1
0 0 1 0 1 0 0 0 0 1 0 0 0 0 1

Тогда I(ρ1) = 〈2, 2, 3, 3, 5〉, при этом подматрица матрицы R(ρ1), полученная вы-
чёркиванием первой строки и первого столбца, соответствует бинарному отношению
ρ′1 ∈ LA[4], где I(ρ′1) = 〈2, 2, 3, 3〉, которое естественно назвать отношением, редуциро-
ванным из бинарного отношения ρ1:  

R(ρ′ 1 1 0 1

1) 0 1 1 0
=  .1 0 1 1

0 1 0 1



Медиана для нечётного числа отношений линейного порядка 115

Это связано с тем, что последней компонентой в I(ρ1) = 〈2, 2, 3, 3, 5〉 является n = 5,
следовательно, в матрице R(ρ1) присутствует строка из единиц и симметричный ей
столбец из нулей (за исключением диагонального элемента). В общем случае это
i-я строка и i-й столбец, где i ∈ {1, . . . , 5}, вычеркивая которые, получаем подматри-
цу, соответствующую редуцированному из исходного отношения из LA[5] отношению
из LA[4]. В случае произвольного n > 2 подобная редукция возможна для любого
ρ ∈ LA[n] при I(ρ) = 〈i1, . . . , in−1, n〉. При этом для ρ′ ∈ LA[n − 1], редуцированного
из ρ, выполняется I(ρ′) = 〈i1, . . . , in−1〉.

Аналогичная ситуация возникает, когда I(ρ) = 〈1, i2, . . . , in〉. Этот случай иллю-
стрируют ρ2 и ρ′2:

 
1 1 0 0

R(ρ′ 0 1 1 0
2) =  .1 0 1 1

1 1 0 1

Редуцированное бинарное отношение получаем вычеркиванием столбца из единиц (он
может быть только единственным, см. замечание 5) и симметричной ему строки из
нулей (за исключением диагонального элемента). Для отношения ρ′ ∈ LA[n−1], реду-
цированного из отношения ρ ∈ LA[n], выполняется I(ρ′) = 〈i2−1, . . . , in−1〉. Например,
I(ρ2) = 〈1, 3, 3, 4, 4〉, I(ρ′2) = 〈2, 2, 3, 3〉.

Наконец, в случае, когда I(ρ) = 〈1, i2, . . . , in−1, n〉, возможна редукция размерности
сразу на 2. Для отношения ρ′ ∈ LA[n − 2], редуцированного из отношения ρ ∈ LA[n],
выполняется I(ρ′) = 〈i2−1, . . . , in−1−1〉. Например, I(ρ3) = 〈1, 3, 3, 3, 5〉, I(ρ′3) = 〈2, 2, 2〉:

1 1 0
R(ρ′3) = 0 1 1 .

1 0 1

В общем случае справедлива
Лемма 1 (о редукции). Пусть n > 3, ρ ∈ LA[n], k, l ∈ {0, 1, . . . , n−2}, k+l 6 n−3,

I(ρ) = 〈1, 2, . . . , k, ik+1, . . . , in−l−1, in−l, n − l + 1, . . . , n〉, ik+1 > k + 2, in−l 6 n − l − 1.
Пусть, далее, Ak(ρ) = {av1}, . . ., A1(ρ) = {av }, An(ρ) = {aj1}, . . ., An−l+1(ρ) = {aj },k l

A′ = A \ {av1 , . . . , av , aj1 , . . . , aj }, ρ′ = ρ ∩ (A′)2. Тогда ρ′ ∈ 2(A′)2 , ρ′ ∈ LA[n − k − l],
k l

I(ρ′) = 〈ik+1 − k, . . . , in−l − k〉 и матрица R(ρ′) является результатом вычёркивания
из R(ρ) строк и столбцов с номерами v1, . . . , vk, j1, . . . , jl (предполагается, что остав-
шиеся элементы в A′ расположены в том же порядке, что и в A).

Как и ранее, отношение ρ′ ∈ LA[n − k − l] из леммы 1 будем называть редуциро-
ванным из отношения ρ ∈ LA[n].

Замечание 8. Заметим, что в условиях леммы 1, если A′ = {aι1 , . . . , aι }
n−k− =

l

= A \ {av1 , . . . , av , aj1 , . . . , aj } и λ′ —линейный порядок на A′ вида aι1 ≺ . . . ≺ a
k l ιn−k− ,

l

то для линейного порядка

λ : aj1 ≺ . . . ≺ aj ≺ a︸ι1 ≺ . . .︷︷≺ aιn−k−︸ ≺ av1 ≺ . . . ≺ a
l l vk

λ′

выполняется d(λ, ρ) = d(λ′, ρ′), т. е. множество Arg min d(λ, ρ) легко определяется по
λ∈LO[n]

Arg min d(λ′, ρ′) и количества элементов в этих множествах совпадают. Действи-
λ′∈LO[n−k−l]

тельно, элементы матриц R(λ), R(ρ) могут отличаться только на множествах своих



116 В.Н. Нефедов

элементов, находящихся на пересечении строк и столбцов, соответствующих A′, т. е.
на элементах матриц R(λ′), R(ρ′). Кроме того, нетрудно показать [13], что, в условиях
леммы 1, H(ρ) = H(ρ′), |Πρ| = n!/|H(ρ)| = n!/|H(ρ′)|.

Используем эти результаты для рекурсивного нахождения системы представите-
лей (n)

ρi ∈ LA[n], i = 1, . . . , Kn, классов π-эквивалентности для множества LA[n], из
систем представителей при меньших значениях n: последовательно получим системы
представителей, начиная с минимально возможного n.

С л у ч а й n = 2: |LA[2]| = 2n(n−1)/2 = 21 = 2, |LO[2]| = 2! = 2, т. е. LA[2] = LO[2],
а следовательно, представителем единственного класса π-эквивалентности для мно-
жества является линейный порядок (2)

LA[2] λ1 , соответствующий последовательности
a1 ≺ a2 (очевидно, что для второго линейного порядка (2)

λ2 , соответствующего после-
довательности )

a2 ≺ a1, выполняется
(2) (2
λ2 = (1, 2)λ1 ).

С л у ч а й n = 3: |LA[3]| = 2n(n−1)/2 = 23 = 8, LO[3] = 3! = 6. Единственным
представителем класса π-эквивалентности является линейный порядок (3)

LO[3] λ1 , со-
ответствующий последовательности a1 ≺ a2 ≺ a3. Для оставшихся отношений (3), (3)

ρ1 ρ2

приведём матрицы (3) (3)
R(ρ1 ), R(ρ2):  

1 1 0 1 0 1
(3) (3)

R(ρ = 0 1 1


1 ) , R(ρ ) = 2 1 1 0 .
1 0 1 0 1 1

Заметим, что (3) (3) (3) (3)
I(ρ1 ) = I( 〈 〉, (3) (3)

) { ρ2 ) = 〈2, 2, 2〉, I(ρ1 ) = I(ρ2 ) = 1, 0,−1 ρ2 = (1 2)(ρ1 )
(т. е. (3 (3)

ρ2 ∈ Πρ1 ), при этом (3) (3)
ρ1 = δ1,3λ1 является ед}инственным элементом множе-

ства ) 3)
Λ(n) (n

= δl,kλ1 : l = 1, . . . , n− 2, k = l + 2, . . . , n = Λ(3) = { (
δ1,3λ1 }. Заметим

также: (3) (3)
(1, 2, 3)ρ1 = ρ1 , а следовательно, (3)

H(ρ1 ) = 〈(1, 2, 3)〉 = {e, (1, 2, 3), (1, 3, 2)},
| (3) ( ) (
H(ρ1 )| = 3, | 3

Πρ1 | 2 = 3!/| 3)
= H(ρ1 )| = 6/3 (в силу утверждения 14, разложение

любой подстановки из (3)
H(ρ1 ) в произведение независимых циклов может содержать

единственный цикл длины 3). Таким образом, имеем систему из двух представите-
лей классов π-эквивалентности для (3) (3) (3) (3)

LA[3]: λ1 , ρ1 , при этом LA[3] = Πλ1 ∪ Πρ1 ,
(3) (3) (3) (3)

Πλ1 = LO[3], Πρ1 = LA[3] \ LO[3] = LA(2)[3], |Πλ1 | = 6, |Πρ1 | = 2.
С л у ч а й n = 4: |LA[4]| = 2n(n−1)/2 = 26 = 64, |LO[4]| = 4! = 24, |LA[4] \ LO[4]| =

= 64− 24 = 40. Единственным представителем класса π-эквивалентности LO[4] явля-
ется линейный порядок (4)

λ1 , соответствующий последовательности a1 ≺ a2 ≺ a3 ≺ a4.
Для перечисления представителей классов π-эквивалентности из LA(2)[4] ⊆ LA[4] \
\ LO[4] воспользуемся множеством Λ(4)  (4) (4) (4) (4) (4)

= {ρ1,3 = δ1,3λ1 , ρ1,4 = δ1  (4)
,4λ1 , ρ2,4 = δ2,4λ1 }:

    
1 0 

(4) (4) 0 1 1 1
R(ρ 1 1 0 1

1 1 
1,3) = 0 1

(ρ 
1 0 1 1 , R 1,4) = 1 1

0 0 1 1 
(4)

, R(ρ 1 1 1 1

2,4) = 0 1 1 0
0 0 1 1 .

0 0 0 1 1 0 0 1 0 1 0 1

При этом (4) (4) (4)
I(ρ1,3) = 〈1, 3, 3, 3〉, Ī(ρ1,3) = 〈0, 1, 0,−1〉, (4)

I(ρ1,4) = 〈2, 2, 3, 3〉, Ī(ρ1,4) =
(4)

= 〈1, 0, 0,−1〉, I(ρ2,4) = 〈2, 2, 2, 4〉, (4)
Ī(ρ2,4) = 〈1, 0,−1, 0〉. Поскольку (4)

I(ρ1,3) = 〈1, 3, 3, 3〉,
выполнены условия леммы 1. Редуцированным отношением для (4)

ρ1,3 является отно-
шение (3)

ρ1 (после вычёркивания в (4)
R(ρ1,3) столбца с единицами и симметричной ему

строки получаем (3)
R(ρ1 )), а следовательно, в силу утверждения 13 и замечания 8,



Медиана для нечётного числа отношений линейного порядка 117

| (4) (3) (4) (4)
H(ρ1,3)| = |H(ρ1 )| = 3, |Πρ1,3| = 4!/|H(ρ1,3)| = 24/3 = 8. Аналогично, редуцирован-
ным отношением для (4) ляется (3) | (3) 4

ρ2,4 яв ρ1 , откуда | (4)
H(ρ2,4)| = H(ρ1 )| = 3, | ( )

Πρ2,4| = 8.
Поскольку (4) следствия 4, | (4) ( )

I(ρ1,4) = 〈2, 2, 3, 3〉, то, в силу H(ρ1,4)| = {e} ⇒ | 4
Πρ1,4| = 24. Та-

ким образом, | (4)| (4) ( )
Πρ1,3 +|Πρ1,4|+|

4
Πρ2,4| = 8+24+8 = 40 = |LA[4]\LO[4]|, а следовательно,

(4) 4) (4) (4)
LA[4]\ (4)

LO[4] = Πρ1,3∪
(

Πρ1,4∪Πρ (2)
2,4 = LA [4], Πρ1,3 = LA〈1,3,3,3〉[4], Πρ1,4 = LA〈2,2,3,3〉[4],

(4)
Πρ2,4 = LA〈2,2,2,4〉[4], т. е. имеем систему из четырёх представителей классов π-экви-
валентности для (4) (4)

LA[4]: λ1 ∈ LO[4], ρ1,3 ∈ Λ(4), (4)
ρ1,4 ∈

4)
Λ(4), (

ρ 4)
2,4 ∈ Λ( . Тогда в силу

теоремы 3 справедливо LA[4]\LO[4] = LA(2)[4], а следовательно, для любого ρ ∈ LA[4]
либо ρ ∈ LO[4], либо существует λ ∈ LO[4], такое, что d(λ, ρ) = 2. Как увидим далее,
при n > 5 подобное свойство не выполняется.

С л у ч а й n = 5: |LA[5]| = 2n(n−1)/2 = 210 = 1024, |LO[5]| = 5! = 120, |LA[5] \
\ LO[5]| = 1024 − 120 = 904. Единственным представителем класса π-эквивалентно-
сти LO[5] является, например, линейный порядок (5)

λ1 : a1 ≺ a2 ≺ a3 ≺ a4 ≺ a5. Для пе-
речисления представителей классов π-эквивалентности из LA(2)[5] ⊆ LA[5]\LO[5] вос-
пользуемся множеством (5) (5) (5) (5) (5) (5) (5) (5)

Λ(5) = {ρ1,3 = δ1,3λ1 , ρ1,4 = δ1,4λ1 , ρ1,5 = δ1,5λ1 , ρ2,4 = δ2,4λ1 ,
(5) (5) (5) (5)
ρ2,5 = δ2,5λ1 , ρ3,5 = δ3,5λ1 }, где

(5) (5) (5)
I(ρ1,3) = 〈1, 2, 4, 4, 4〉, Ī(ρ1,3) = 〈0, 0, 1, 0,−1〉, I(ρ1,4) = 〈 1, 3, 3, 4, 4〉,

(5) (5) (5)
Ī(ρ1,4) = 〈0, 1, 0, 0,−1〉, I(ρ1,5) = 〈2, 2, 3, 4, 4〉, Ī(ρ1,5) = 〈1, 0, 0, 0,−1〉,

(5) (5) (5)
I(ρ2,4) = 〈1, 3, 3, 3, 5〉, Ī(ρ2,4) = 〈0, 1, 0,−1, 0〉, I(ρ2,5) = 〈2, 2, 3, 3, 5〉,

(5) (5)
Ī(ρ2,5) = 〈 (5)

1, 0, 0,−1, 0〉, I(ρ3,5) = 〈2, 2, 2, 4, 5〉, Ī(ρ3,5) = 〈1, 0,−1, 0, 0〉.

Приведёмматрицы, соответствующие некоторым отношениям:

 
1 1 0 1 1 1 1 1 1 1

0 1 1 1 1  
1 1 1 1 1
0 1 1 0 1




(5) (5)
R(ρ1,3) = 1 0 1 1 1 R(ρ  

2,4) =  0 1 1 1 1
0 0 0 1 1 , 0 0 1 1 1 

(5)
, R(ρ 

3,5) =
0 1 0 1 1  

0 0 1 1 0
0 0 0 1 1 .

0 0 0 0 1 0 0 0 0 1 0 0 1 0 1

Поскольку (5)
I(ρ1,3) = 〈1, 2, 4, 4, 4〉, выполнены условия леммы 1. Редуцированным отно-

шением для (5)
ρ1,3 является (3)

ρ1 , а следовательно, в силу утверждения 13 и замечания 8,
| (5) (3)
H(ρ1,3)| = |H(ρ1 )| = 3, | (5)

Πρ1,3| = 5!/3 = 40. Аналогично, редуцированным отношением
для (5) (5) ) (5)

ρ2,4, ρ3,5 также является (3)
ρ1 , а следовательно, | (5

Πρ2,4| = |Πρ3,5| = 5!/3 = 40.
Поскольку (5) (5)

I(ρ1,4) = 〈1, 3, 3, 4, 4〉, (5)
I(ρ1,5) = 〈2, 2, 3, 4, 4〉, I(ρ2,5) = 〈2, 2, 3, 3, 5〉, в силу

следствия 4 получаем (5) (5) (5)
H(ρ1,4) = H(ρ1,5) = H(ρ2,5) = {e}, а следовательно (см. утвер-

ждение 13), | (5) (5) (5) (5) (5)
H(ρ1,4) = |H(ρ1,5)| = |H(ρ2,5)| = 1, |Πρ1,4| = |

(5)
Πρ1,5| = |Πρ2,5| = 5! = 120.

Таким образом, |LA(2)[n]| = 120·3+40·3 = 480. Поскольку |LO[n]|+|LA(2)[n]| = 120+
+480 = 600, остаётся ещё 404 отношения из множества LA[5]\{LO[5]∪LA(2)[5]}. Кроме
того, ниже показано, что (5) (5)

LA〈1,2,4,4,4〉[5] = Πρ1,3, LA〈1,3,3,4,4〉[5] = Πρ1,4, LA〈1,3,3,3,5〉[5] =
(5) (5)

= Πρ2,4, LA〈2,2,3,3,5〉[5] = Πρ2,5,
(5)

LA〈2,2,2,4,5〉[5] = Πρ3,5 (только (5)
LA〈2,2,3,4,4〉[5] 6= Πρ1,5).



118 В.Н. Нефедов

Рассмотрим другие возможные случаи для ρ ∈ LA[5]. Для I(ρ) = 〈3, 3, 3, 3, 3〉 имеем
(5

I(ρ) = 〈2, 1, 0,−1,−2〉 и, например, I(ρ )1 ) = 〈3, 3, 3, 3, 3〉, где

 
1 1 1 0 0

(5)
R(ρ1 ) = 0 1 1 1 0

0 0 1 1 1
1 0 0 1 1 .
1 1 0 0 1

Нетрудно доказать, что (5)
H(ρ1 ) = 〈σ〉 = {e, σ, σ2, σ3, σ4}, где σ = (1, 2, 3, 4, 5), от-

куда (см. утверждение 13) | (5)
Πρ1 | = 5!/5 = 24. Кроме того, далее показано, что

(5) 5)
LA〈3,3,3,3,3〉[5] = Πρ1 , т. е. (

ρ1 может служить единственным представителем класса
LA〈3,3,3,3,3〉[5].

Рассмотрим случай I(ρ) = 〈2, 3, 3, 3, 4〉, I(ρ) = 〈1, 1, 0,−1,−1〉. Пусть i, j ∈ {1, 2,
3, 4, 5}, A ′

2(ρ) = {ai}, 〈ai, aj〉 ∈ ρ, i 6= j. Если ρ = (j, 4)(i, 5)ρ, то R(ρ′) имеет следующий
вид (элементы матрицы R(ρ′), соответствующие знаку −, определяются далее с учётом
того, что ρ′ ∈ LA〈2,3,3,3,4〉[5]):  

1 − − − 1
R(ρ′) = − 1 − − 1

− − 1 − 1
− − − 1 0 .
0 0 0 1 1

Три возможных вариантадля R(ρ′) в случае ρ′ ∈ LA〈2,3,3,3,4〉[5] следующие:

1 0 1 0 1

(5)
R(ρ 

2 ) = 1 1 0 0 1 1 0 1 1 1
1 1 0 0 1

 
   1 0 0 1 1

0 1 1 0 1  1 1 0 0 1
(5)

, R(ρ4 ) = 1 1 1 0 1
1 1 1 1 0


(5)

, R(ρ 
3 ) = 0 1 1 0 1

0 1 1 1 0 0 1 1 1 0 .
0 0 0 1 1 0 0 0 1 1 0 0 0 1 1

Нетрудно показать [13], что (5) (5) (5) (5) (5) (5)
Πρ2 ∩ Πρ3 = ∅, Πρ2 ∩ Πρ4 = ∅, Πρ3 ∩ Πρ4 = ∅;

далее установим, что (5) (5)
LA〈2,3,3,3,4〉[5] = Πρ2 ∪ Πρ3 ∪

(5)
Πρ4 .

Заметим, что если для некоторого π ∈ S5 выполняется (5) (5)
πρ2 = ρ2 , то, в силу

утверждения 15, π(4) = 4, π(5) = 5, т. е. π действует на множестве {1, 2, 3}, откуда
π ∈ S3, и из матрицы (5)

R(ρ2 ) видно, что (5) (5) (3) (3)
πρ2 = ρ2 ⇔ πρ2 = ρ2 (см. случай n = 3),

т. е. (5) (3)
H(ρ2 ) = H(ρ2 ) = 〈(1, 2, 3)〉, следовательно, | (5)

Πρ2 | = 5!/3 = 40.
Если для некоторого π ∈ S5 выполняется (5) (5)

πρ3 = ρ3 , то, в силу утверждения 15,
π(1) = 1, π(5) = 5 (поскольку первая строка матрицы (5)

R(ρ3 ) — единственная с четырь-
мя единицами, а пятая— единственная с двумя единицами). Далее из первой строки
матрицы (5)

R(ρ3 ) заключаем, что π(3) 6= 2, π(4) 6= 2, откуда π(3), π(4) ∈ {3, 4}, и по-
скольку случай π = (3, 4) невозможен (см. утверждение 14), то π = e. Таким образом,

(5) (5)
H(ρ3 ) = {e}, а следовательно, |Πρ3 | = 5!/1 = 120. Аналогично доказывается, что

(5) (5)
H(ρ4 ) = {e}, |Πρ4 | = 5!/1 = 120.

Рассмотрим теперь случай I(ρ) = 〈2, 2, 3, 4, 4〉, I(ρ) = 〈1, 0, 0, 0,−1〉. Заметим,
что (5)

ρ1,5 ∈ LA〈2,2,3,4,4〉[5], т. е. один из возможных представителей классов π-эквива-
лентности из LA〈2,2,3,4,4〉[5] уже найден. Покажем, что он не является единственным,



Медиана для нечётного числа отношений линейного порядка 119

т. е. что (5)
Πρ1,5 6= LA〈2,2,3,4,4〉[5]. Мы уже сталкивались с подобной ситуацией в случае

LA〈2,3,3,3,4〉[5], где оказалось три класса π-эквивалентности. Рассмотрим бинарное от-
ношение (5) (5)

ρ5 с R(ρ5 ): 1 1 0 1 1
0 1 1 1 1

(5)
R(ρ ) = 5 1 0 1 1 0

0 0 0 1 1 .
0 0 1 0 1

Тогда (5)
ρ5 ∈ LA〈2,2,3,4,4〉[5]. Нетрудно показать [13], что не существует λ ∈ LO[5], такого,

что (5)
d(ρ5 , λ) = 2, и тем самым (5)

ρ5 ∈
(5)

/ Πρ (2)
1,5 ⊂ LA [5]. В силу следствия 4, (5)

H(ρ5 ) = {e},
а следовательно, | (5)

Πρ4 | = 5!/1 = 120.
Перечислим всех найденных представителей классов π-эквивалентности для LA[5]:
1) (5) 5) (5)

λ1 ∈ LO[5], (
Πλ1 = LO[5], |Πλ1 | = |LO[5]| = 5! = 120;

2) (5) (5) 5)
ρ 5)

1,3 = δ1,3λ1 ∈ Λ( , (5)
I(ρ1,3) = 〈1, 2, 4, 4, 4〉, (5)

Πρ1,3 ⊆ LA〈1,2,4,4,4〉[5], | (
Πρ1,3| = 40;

3) (5) (5) ) 5)
ρ1,4 = δ1,4λ

5)
1 ∈ Λ( , (5

I(ρ1,4) = 〈1, 3, 3, 4, 4〉, (5)
Πρ1,4 ⊆ LA〈1,3,3,4,4〉[5], | (

Πρ1,4| = 120;
4) (5) (5)

ρ (5) (5) (5)
1,5 = δ1,5λ1 ∈ Λ , (5)

I(ρ1,5) = 〈2, 2, 3, 4, 4〉, Πρ1,5 ⊂ LA〈2,2,3,4,4〉[5], |Πρ1,5| = 120;
5) (5) (5) (5) (5) (5)

ρ2,4 = δ2,4λ1 ∈ Λ(5), I(ρ2,4) = 〈1, 3, 3, 3, 5〉, Πρ2,4 ⊆ LA〈1,3,3,3,5〉[5], |Πρ2,4| = 40;
6) (5) (5) (5) ) (5)

ρ2,5 = δ2,5λ1 ∈ Λ(5), I(ρ2,5) = 〈 (5
2, 2, 3, 3, 5〉, Πρ2,5 ⊆ LA〈2,2,3,3,5〉[5], |Πρ2,5| = 120;

7) (5) (5) (5) 5) (5)
ρ3,5 = δ3,5λ1 ∈ Λ(5), I(ρ3,5) = 〈2, 2, 2, 4, 5〉, (

Πρ3,5 ⊆ LA〈2,2,2,4,5〉[5], |Πρ3,5| = 40;
8) (5) (5) 5) (5)

ρ1 ∈ LA〈3,3,3,3,3〉[5], I(ρ1 ) = 〈2, 1, 0,−1,−2〉, (
Πρ1 ⊆ LA〈3,3,3,3,3〉[5], |Πρ1 | = 24;

9) (5) (5)
ρ2 ∈ LA〈2,3,3,3,4〉[5], I(ρ2 ) = 〈1, 1, 0,−1,−1〉, (5)

Πρ2 ⊂ LA〈2,3,3,3,4〉[5], | (5)
Πρ2 | = 40;

10) (5) (5) (5) (5)
ρ3 ∈ LA〈2,3,3,3,4〉[5], I(ρ3 ) = 〈1, 1, 0,−1,−1〉, Πρ3 ⊂ LA〈2,3,3,3,4〉[5], |Πρ3 | = 120;

11) (5) (5) ) 5)
ρ4 ∈ LA〈2,3,3,3,4〉[5], I(ρ4 ) = 〈1, 1, 0,−1,− (5

1〉, Πρ4 ⊂ LA〈2,3,3,3,4〉[5], | (
Πρ4 | = 120;

12) (5) (5)
ρ5 ∈ LA〈2,2,3,4,4〉[5], I(ρ5 ) = 〈1, 0, 0, 0,−1〉, (5)

Πρ5 ⊂ LA〈2,2,3,4,4〉[5], | (5)
Πρ5 | = 120.

Таким образом, получены представители классов π-эквивалентности для LA[5], при
этом
| (5) (5) 5) (5) (5) ) 5)
Πλ1 |+ |Πρ1,3|+ |

(
Πρ1,4|+ |Πρ1,5|

(5)
+ |Πρ2,4|+ |Πρ2,5|+ |

(5) (5
Πρ3,5|+ |Πρ1 |+ |

(
Πρ2 |+

(5) (5)
+|Πρ (7)

3 |+ |Πρ4 |+ |
(5)

Πρ5 | = 120 + 40 + 120 + 120 + 40 + 120 + 40+
+24 + 40 + 120 + 120 + 120 = 1024 = |LA[5]|,

следовательно, найденная система представителей является полной.
Нам понадобится следующее очевидное
Утверждение 18. Пусть X —конечное непустое множество, |X| = N > 2,

X1, . . . , Xk —непустые множества, образующие разбиение множества X. Пусть, далее,
Y∑1, . . . , Yk —конечные множества, такие, что Y1 ⊆ X1, . . . , Yk ⊆ Xk. Тогда в случае
k
|Yi| = N выполняется: Y1 = X1, . . . , Yk = Xk.

i=1

Используя утверждение 18, из (7), учитывая классы эквивалентности 1–12, полу-
чаем

(5) (5) (5) (5)
Πλ1 = LO[5], Πρ1,3 = LA〈1,2,4,4,4〉[5], Πρ1,4 = LA〈1,3,3,4,4〉[5],Πρ1,5 = LA〈2,2,3,4,4〉[5],

(5) (5) (5)
Πρ2,4 = LA〈1,3,3,3,5〉[5], Πρ2,5 = LA〈2,2,3,3,5〉[5], Πρ3,5 = LA〈2,2,2,4,5〉[5],

(5) (5) 5) (5) (5) 5)
Πρ1 = LA〈3,3,3,3,3〉[5], Πρ2 ∪

(
Πρ3 ∪ Πρ4 = LA〈2,3,3,3,4〉[5], Πρ1,5 ∪

(
Πρ5 = LA〈2,2,3,4,4〉[5].



120 В.Н. Нефедов

Результаты для ρ ∈ LA[n] при n = 3, 4, 5 позволяют с помощью леммы1 сформули-
ровать некоторые свойства для произвольного n > 3. Особенно просто они получаются
для ρ ∈ LA(2)[n]. Например, для всех ρ ∈ LA(2)[n] можно по вектору Ī(ρ) ∈ V(n) (см.
утверждение 10) определить:

1) количество элементов в Arg min d(λ, ρ), которое равно 1 или 3 (см. утвержде-
λ∈LO[n]

ние 20);
2) количество элементов в Πρ: |Πρ| = n!/3 либо |Πρ| = n! (см. утверждение 20);
3) точную формулу для |LA(2)[n]| (см. следствие 5);
4) случаи выполнения равенства LAI(ρ)[n] = Πρ для ρ ∈ Λ(n)(см. утверждение 21);
5) множеcтво V̄(n) ⊆ V(n) (масксимально широкое), такое, что при любом ρ ∈ LA[n]

выполняется: I(ρ) ∈ V̄ (2)
(n) ⇒ ρ ∈ LA [n] (см. утверждение 22).

Для этого понадобятся следующие утверждения:
Утверждение 19. Пусть (n) (n)

n > 4, ρ λ (n)
1,n = δ1,n 1 ∈ Λ . Тогда

(n) ( )
I(ρ1,n) = 〈2, 2, 3, . . . , n− 2, n− 1, n− 1〉 n

, Ī(ρ1,n) = 〈1, 0, . . . , 0,−1〉 ∈ Vn,

1) Arg (n) (n)
min d(λ, ρ1,n) = {λ1 };

λ∈LO[n]

2) для всех ρ ∈ LA(2)[n] в случае Ī(ρ) = 〈1, 0, . . . , 0,−1〉 ∈ Vn выполняется
|Arg min d(λ, ρ)| = 1, H(ρ) = {e};

λ∈LO[n]

3) в случае ) (n) (n) (n)
n > 5 для (n) (n

ρ∗ = δ3,nδ1,3λ1 верно: min d(λ, ρ∗ ) = d(λ1 , ρ∗ ) = 4,
λ∈LO[n]

(n) )
Ī(ρ∗ ) = 〈1, 0, . . . , 0,−1〉, а следовательно, (n) ( (n)

ρ∗ ∈ n
/ Πρ1,n, LA (n) [n] 6= Πρ .

I(ρ1,n) 1,n

Доказательство.
1) Заметим, что (n)

min d(λ, ρ1,n) = 2, и при n > 4, в отличие от n = 3 (см. (3)
ρ1 =

λ∈LO[n]
(3)

= δ1,3λ1 ), имеем единственную возможность для δi,j, где i < j, i, j ∈ {1, . . . , n}, чтобы
(n)

δi,jρ1,n ∈ LO[n], а именно: δi,j = δ1,n (например, в случае (4) (4)
ρ1,4 = δ1,4λ1 ); другие δi,j не

приводят (n)
ρ1,n к линейному порядку.

2) Следует из п. 1, а также того, что из условий ρ ∈ LA(2)[n], I(ρ) = 〈1, 0, . . . ,
0,−1〉 ∈ Vn, в силу теоремы 3, получаем, что найдётся подстановка π ∈ Sn, такая,
что (n)

ρ = πρ1,n, откуда Arg (n)
min d(λ, ρ) = {πλ1 } (см. утверждение 12). Равенство

λ∈LO[n]

H(ρ) = {e} получаем из следствия 4.
3) Доказательство несложно провести для (5)

ρ5 : заметим, что (5) (5)
ρ5 = δ3,5δ1,3λ1 ,

(5)
Ī(ρ5 ) = 〈1, 0, 0, 0,−1〉. В общем случае рассуждения аналогичны.

Утверждение 20. Пусть n > 4, ρ ∈ LA(2)[n],

Ī(ρ) = 〈0, . . . , 0, 1, 0︸, .︷.︷. , 0︸,−1, 0, . . . , 0〉 ∈ Vn, s > 1.
s

Тогда
1) если s = 1, то |Arg min d(λ, ρ)| = 3, |Πρ| = n!/3;

λ∈LO[n]

2) если s > 2, то H(ρ) = {e}, |Arg min d(λ, ρ)| = 1, |Πρ| = n!.
λ∈LO[n]

Доказательство. Для s = 1, используя лемму 1, получаем, что редуцированное
бинарное отношение принадлежит (3) (3)

LA〈2,2,2〉[3] = {ρ1 , (1, 2)ρ1 } (см. случай n = 3), а



Медиана для нечётного числа отношений линейного порядка 121

следовательно, имеет ровно три линейных порядка, удалённых на расстояние 2 от него
(см. (3)

R(ρ1 )), что в силу замечания 8 переносится и на само бинарное отношение ρ.
Воспользовавшись замечанием 8, а также равенством | (3) (3

H(ρ1 )| = | )
H((1, 2)ρ1 )| = 3,

получаем второе равенство в п. 1. В случае s > 2 для редуцированного отношения
выполняются условия утверждения 19, из которого следуют равенства в п. 2.

Следствие 5. Пусть выполнены услови︸я утверждения 20. Тогда в случае s = 1
имеем n − 2 варианта для Ī(ρ) = 〈0, . . . , 0, 1, 0, .︷.︷. , 0︸,−1, 0, . . . , 0〉 ∈ Vn, в случае s = 2

s
имеем n− 3 варианта и т. д., в случае s = n− 2 — один вариант, следовательно, в силу
утверждения 20, справедлива формула

|LA(2)[n]| = (n− 2)n!/3 + [(n− 2)(n− 3)/2]n! = (n− 2)(3n− 7)n!/6.

Например, при n = 5 по этой формуле имеем LA(2)[5] = 3 · 8 · 120/6 = 480, что
совпадает с полученным ранее результатом.

Используя лемму 1, свойства отношений из LA[3], LA[4], а также утверждение 19,
нетрудно показать [13], что справедливы следующие утверждения:

Утверждение 21. Пусть n > 4, ρ∗ ∈ Λ(n),

Ī(ρ∗) = 〈0, . . . , 0, 1, 0︸, .︷.︷. , 0︸,−1, 0, . . . , 0〉 ∈ Vn, s > 1.
s

Тогда если s ∈ {1, 2}, то LAI(ρ∗)[n] = Πρ∗, а если s > 3, то LAI(ρ∗)[n] 6= Πρ∗.
Утверждение 22. Пусть n > 4, ρ ∈ LA[n], Ī(ρ) ∈ Vn, при этом Ī(ρ) = 〈0, . . . ,

0, 1, 0,−1, 0, . . . , 0〉 или Ī(ρ) = 〈0, . . . , 0, 1, 0, 0,−1, 0, . . . , 0〉. Тогда ρ ∈ LA(2)[n].

4. Методы сведения исходной задачи к задаче меньшей размерности
Приведём некоторые методы сведения исходной задачи нахождения Arg min D(ρ)

ρ∈LO[n]

в случае, когда ρ1, . . . , ρm ∈ LO[n] и m нечётно, к задаче меньшей размерности, осно-
ванные на использовании леммы1, а также на разбиении графа G̃ = (A, ρ̃) на компо-
ненты сильной связности, где ρ̃—мажоритарное отношение, введённое в п. 1. Для опи-
сания метода, основанного на лемме 1, понадобятся следующие обозначения:

J(n) = {〈i, j〉 : i, j ∈ {∑1, . . . , n}, i < j},
m

∀〈i, j〉 ∈ J(n), ρ ∈ 2A
2 | (t) ∑m

rij − rij |+ | (t)
Dij(ρ) = rji − rji |.

t=1 t=1

Тогда для всех 〈i, j〉 ∈ J(n), ρ ∈ LA[n], используя то, что rij + rji = 1, pij + pji = m,
получаем следующее равенство [13]:

Dij(ρ) = 2 min{pij,m− pij} + 2|rij − r̃ij|[max{pij,m− pij} −min{pij,m− pij}] =
(8)

= 2 min{pij,m− pij}+ 2|rij − r̃ij|[m− 2 min{pij,m− pij}].
∑ ∑m

Для J ⊆ {1, . . . , n}2 обозначим |rij − (t)
DJ(ρ) = rij |. Пусть выполнены

〈i,j〉∈J t=1

условия леммы 1 и ρ′t = ρt ∩ (A′∑)2, t = 1, . . . ,m, I1 = {v1, . . . , vk, j1, . . . , jl}, I ′ =
m

= {ι1, . . . , ιn−k−l} = I \ I1, D′(ρ) = d(ρ ∩ (A′)2, ρ′t) = D(I′)2(ρ). Тогда, учитывая (8),
t=1



122 В.Н. Нефедов

для всех ρ ∈ LO[n] имеем ∑
D(ρ) = D(I′)2(ρ) +D{1,...,n}2\(I′)2(ρ) = D′∑ (ρ) + 2 min{pij,m− pij}+

〈i,j〉∈J(n)\(I′)2
(9)

+ 2|rij − r̃ij|[max{pij,m− pij} −min{pij,m− pij}].
〈i,j〉∈J(n)\(I′)2

Из равенства (9) следует (см. далее замечание 9), что

Arg min D(ρ) = {ρ : ρ ∩ (A′)2 ∈ Arg min D′(λ′),
ρ∈LO[n] λ′∈LO[n−k−l]

rij = r̃ij, 〈 i, j〉 ∈ {1, . . . , n}2 \ (I ′)2},

при этом min D(ρ) = min D′
∑

(λ′) + 2 min{pij,m − pij}, т. е. исходную
ρ∈LO[n] λ′∈LO[n−k−l] 〈i,j〉∈J1

(n)

задачу свели к задаче меньшей размерности — (n− k − l).
Замечание 9. В выражении в правой части равенства (9) второе слагаемое яв-

ляется постоянной величиной, а минимизацию первого и третьего можно проводить
независимо. При этом если минимум первого слагаемого достигается на некотором ли-
нейном порядке λ′ : aι1 ≺ . . . ≺ aιn−k− , т. е. при ρ∩ (A′)2 = λ′, где A′ = {aι1 , . . . , al ιn− }

k− ,
l

то выполнение rij = r̃ij, 〈i, j〉 ∈ {1, . . . , n}2 \(I ′)2, приведёт, с одной стороны, к точному
минимуму, равному 0, третьего (неотрицательного) слагаемого в (9), а с другой — к то-
му, что получаемое таким образом бинарное отношение ρ будет линейным порядком
вида aj1 ≺ . . . ≺ aj ≺ a︸ι1 ≺ . . .

l ︷︷≺ aιn−k−︸ ≺ a
l v1 ≺ . . . ≺ av .

k

λ′

В другом подходе используется разложение G̃ = (A, ρ̃) на компоненты сильной
связности. Этот подход использован в [1] для решения более общей задачи, в усло-
виях которой не гарантировано выполнение ρ̃ ∈ LA[n]; в нашем случае это условие
будет использовано. Под сильной связностью графа понимается взаимная достижи-
мость любых двух его вершин. Под компонентой сильной связности графа понимается
его максимальный сильносвязный подграф (т. е. не являющийся собственным подгра-
фом никакого другого сильносвязного подграфа). Задача выделения указанных ком-
понент имеет полиномиальную вычислительную сложность. Пусть G̃1 = (Ã1, ρ̃1), . . . ,
G̃p = (Ãp, ρ̃p) —компоненты сильной связности графа G̃ = (A, ρ̃), где {Ã1, . . . , Ãp}—
разбиение множества A. Рассмотрим для G̃ = (A, ρ̃) «граф конденсации» G0 = (A0, ρ0),
в(ершинами к)оторого являются компоненты G̃1, . . . , G̃p (т. е. A0 = {G̃1, . . . , G̃p}) с ду-
гами, определяемыми по следующему правилу: 〈G̃i, G̃j〉 ∈ ρ0 ⇔ ∃a′ ∈ Ãi, a

′′ ∈ Ãj
〈a′, a′′〉 ∈ ρ̃ . Тогда из условия ρ̃ ∈ LA[n] следует, что для бинарных отношений
ρ0 ∈ 2A

2
0 , ρ̃1 ∈ 2Ã

2
1 , . . . , ρ̃p ∈ 2Ã

2
p справедливо: ρ0 ∈ LO[p], ρ̃1 ∈ LA[n1], . . . , ρ̃p ∈ LA[np],

где n1 = |Ã1|, . . . , np = |Ãp|, n1 + . . . + np = n. Пусть для простоты обозначений для
линейного порядка ρ0 выполняется Ã1 ≺ Ã2 ≺ . . . ≺ Ãp. Тогда для нахождения всех
линейных порядков λ ∈ Arg min D(ρ) составляем всевозможные линейные порядки

ρ∈LO[n]

вида λ1 ≺ λ2 ≺ . . . ≺ λp (это условие с учётом транзитивности однозначно определяет
линейный порядок на A), где λi ∈ Arg min DI2(ρ), Ii = {i ∈ {1, . . . , n} : ai ∈ Ãi}.

ρ∈LO[ni]
i

Таким образом, произведена декомпозиция исходной задачи на p аналогичных задач
меньшей размерности. Нетрудно видеть, что метод, основанный на лемме 1, является
следствием этого более общего метода.



Медиана для нечётного числа отношений линейного порядка 123

5. Использование методов теории графов для точного решения задачи
Из п. 4 следует, что для решения поставленной задачи достаточно ограничиться

случаем, когда G̃ = (A, ρ̃) — сильносвязный граф. Всюду далее рассматриваем графы
без петель.

Приведём сначала общие утверждения относительно произвольного сильносвязно-
го графа G = (A, ρ), где ρ ∈ 2A

2 . Пронумеруем все пары (дуги графа G), входящие в ρ,
т. е. пусть ρ = {x1, . . . , xN}. Пусть η1, . . . , ηk —множество всех простых контуров (че-
рез каждую вершину в простом контуре проходим ровно один раз) в G, записываемых
в виде последовательностей (слов) вида xi1xi2 . . . xi , перечисленных в лексикографиче-

l

ском порядке (в этом порядке их алгоритмически легче перечислить). Если дуга x ∈ ρ
входит в контур η, то кратко пишем x ∈ η. Множество дуг U ⊆ ρ назовём множеством
представителей контуров η1, . . . , ηk, если ∀η ∈ {η1, . . . , ηk} ∃x ∈ U (x ∈ η). Оно назы-
вается минимальным, если отбрасывание любой дуги из U приводит к множеству дуг,
не являющемуся множеством представителей контуров η1, . . . , ηk. Одним из возмож-
ных методов нахождения семейства минимальных представителей контуров η1, . . . , ηk
является известный метод Магу. Пусть U —некоторое множество дуг графа G. Вве-
дём булевы переменные Xi, соответствующие дугам xi, i = 1, . . . , N : Xi = 1⇔ xi ∈ U .
Тогда для того, чтобы U являлось множеством представителей контуров η1, . . . , ηk,
необходимо и достаточно, чтобы

∧ (k ∨ )
F (X1, . . . , XN) = Xj = 1. (10)

i=1 xj∈ηi

Cогласно методу Магу, для нахождения семейства минимальных представите-
лей контуров η1, . . . , ηk приводим F (X1, . . . , XN) к дизъюнктивной нормальной фор-
ме (днф), а затем к сокращённой днф F1(X1, . . . , XN), используя «закон поглоще-
ния» C ∨ (C&D) ≡ C (пока это возможно). Тогда каждому дизъюнктивному члену
Xi1& . . .&Xis из F1(X1, . . . , XN) соответствует {xi1 , . . . , xis}—минимальное множество
представителей контуров η1, . . . , ηk. Действуя таким образом, полу чаем их все.

1 1 1 0

0 1 1 1Пример 6. Пусть G = (A, ρ), ρ ∈ LA[4], R(ρ) = 
0 0 1 1. Тогда (без учёта
1 0 0 1

рефлексивных пар) ρ ⊇ {x1 = 〈a1, a2〉, x2 = 〈a1, a3〉, x3 = 〈a2, a3〉, x4 = 〈a2, a4〉, x5 =
= 〈a3, a4〉, x6 = 〈a4, a1〉}. Перечислим контуры в G (в лексикографическом порядке):
η1 = x1x3x5x6, η2 = x1x4x6, η3 = x2x5x6. Составим формулу F (X1, . . . , X6), соглас-
но (10):

F (X1, . . . , X6) = (X1 ∨X3 ∨X5 ∨X6)&(X1 ∨X4 ∨X6)&(X2 ∨X5 ∨X6) ≡
≡ X6 ∨X1X2 ∨X1X5 ∨X2X3X4 ∨X4X5

(преобразуем, заменяя & на · и используя равносильность C ∨ (D&E) ≡ (C ∨D)&(C ∨
∨ E)). Таким образом, семействами минимальных представителей контуров η1, η2, η3

являются множества дуг {x6}, {x1, x2}, {x1, x5}, {x2, x3, x4}, {x4, x5}.
Утверждение 23. Пусть U —минимальное множество(представителей контуров

η1, . . . , ηk. Тогда для всех x ∈ U существует контур η(x) ∈ η1, . . . , ηk, такой, что x—
единственный представитель в η(x) из U , т. е. ∀x′ x′

)
∈ U \ {x} ∈/ η(x) .



124 В.Н. Нефедов

Доказательство. Если предположить( противное, то для некоторого x ∈ U
имеет место: ∀η ∈ η1, . . . , ηk ∃x′(η) ∈ U \ {x} x′

)
(η) ∈ η , откуда U \ {x}—множество

представителей контуров η1, . . . , ηk, а это противоречит минимальности U .
Утверждение 24. Пусть x = 〈ai, aj〉 ∈ ρ, ai 6= aj, U = {x} — минимальное мно-

жество представителей контуров η1, . . . , ηk. Тогда граф G′, получаемый из G заменой
дуги 〈ai, aj〉 на противоположную— 〈aj, ai〉, является бесконтурным.

Доказательство. Пусть для простоты обозначений x = 〈a1, a2〉. Предположим,
что в G′ имеется контур η. Не теряя общности, считаем, что он простой. Заметим, что
〈a2, a1〉 ∈ η, так как в противном случае η—контур в G, в который не входит дуга
x = 〈a1, a2〉, что противоречит условиям. Заметим, что η1 —контур в G, проходящий
через x = 〈a1, a2〉. Заменяя в η1 дугу 〈a1, a2〉 на цепь a1, ai1 , . . . , ai , a2, получаемуюk

из η удалением дуги 〈a2, a1〉 (очевидно, являющуюся простой цепью в G), получаем
контур в G, из которого, в свою очередь, можно выделить простой контур, в который
не входит дуга x = 〈a1, a2〉, что противоречит условиям.

Утверждение 25. Пусть U = {xi1 , . . . , xis}—минимальное множество предста-
вителей контуров η1, . . . , ηk. Тогда граф G′, получаемый из G заменой всех дуг из U
на противоположные, является бесконтурным.

Доказательство. Обозначим для xi ∈ U через x′i дугу, противоположную xi,
U ′ = {x′i , . . . , x′i }. Предположим, что в G′ имеется контур η. Не теряя общности, счи-

1 s

таем, что он простой. Заметим, что η содержит по крайней мере одну дугу из U ′, так
как в противном случае η—контур в G, в который не входят дуги из U , что противоре-
чит условиям. Поэтому в η входит по крайней мере одна дуга из U . Случай, когда эта
дуга является единственной, рассмотрен при доказательстве утверждения 24. Случай,
когда их несколько, рассматривается аналогично с использованием утверждения 23,
из которого следует, что мы можем последовательно заменять в η дуги x′i из U ′ на
соответствующие цепи, получающиеся из контуров η(xi) ∈ {η1, . . . , ηk}, в каждый из
которых входит дуга xi и не входят другие дуги из U , и в результате получить контур
в G, в который не вошла ни одна дуга из U , т. е. прийти к противоречию с тем, что
U —множество представителей всех контуров графа G.

Из приведённых рассуждений получаем следующий алгоритм 4.

Алгоритм 4. Нахождение множества Arg min D(ρ)
ρ∈LO[n]

1: Находим все простые контуры η1, . . . , ηk в мажоритарном графе G̃ = (A, ρ̃). Для од-
нозначности перечисляем их в лексикографическом порядке.

2: Определяем U1, . . . , UT —минимальные множества представителей контуров (на-
пример, методом Магу).

3: Для каждого U = {xi1 , . . . , xis} ∈ {U1, . . . , UT} определяем c(U) = c(xi1)+. . .+c(xis).
Замена в G̃ = (A, ρ̃) всех дуг из U на противоположные приводит к бесконтурному
графу (см. утверждение 25) GU = (A, ρU) (и к бинарному отношению ρU ∈ LO[n],
такому, что D(ρU) = D(ρ̃) + 2c(U) (см. утверждение 5)).

4: Находим cmin = min{c(Ui) : i = 1, . . . , T}. Тогда

Arg min D(ρ) = {ρU : U ∈ {U1, . . . , UT}, c(U) = cmin}.
ρ∈LO[n]



Медиана для нечётного числа отношений линейного порядка 125

Замечание 10. Если (n−1)
λ1 ∈ LO[n−1] —линейный порядок вида a1 ≺ a2 ≺ . . . ≺

≺ an−1, то для (n−1)
ρ = λ1 ∪ {〈an, a1〉, 〈a2, an〉, 〈a3, an〉, . . . , 〈an, an〉} выполняется: ρ ∈

∈ LA[n] и граф G = (A, ρ) содержит все контуры вида

〈a1, ai1〉, 〈ai1 , ai2〉, . . . , 〈ai , a
k− i 〉, 〈a , a , 〉

k i , a a
k n〉 〈1 n 1 ,

где 2 6 i1 < i2 < . . . < ik 6 n− 1. Их столько же, сколько непустых подмножеств мно-
жества {2, 3, . . . , n−1}, т. е. 2n−2−1. Кроме того, в сильносвязном графе все дуги входят
в контуры. Таким образом, для формулы (10), по которой определяется F (X1, . . . , XN)
в методе Магу для примера 4, имеем k = 2n−2 − 1, N = (n − 1)(n − 2)/2, что приво-
дит к очень громоздкому при больших n выражению. Эта же величина k = 2n−2 − 1
фигурирует и в алгоритме 4, что говорит об ограниченной применимости рассмат-
риваемого в настоящем пункте метода (в отличие, например, от метода нахождения
∆-оптимального решения при фиксированном ∆ в п. 2).

Заключение
Перечислим основные вопросы, затронутые в работе.
1. Исследуется класс бинарных отношений LA[n]. К этому классу, в частности,

приводят некоторые задачи группового выбора. Изучается задача построения меди-
аны для нечётного числа отношений линейного порядка (т. е. из LO[n], или, в более
общем случае, — из LA[n]), которая также ищется в классе отношений линейного по-
рядка. Рассматриваются два типа задач: «полная» и «частичная». Решением «полной»
задачи является безусловное (т. е. без каких-либо дополнительных ограничений) на-
хождение множества всех отношений из Arg min D(ρ). Такая задача в общем случае

ρ∈LO[n]

является экспоненциально сложной. Некоторыми методами её решения являются пере-
бор, в том числе с использованием метода ветвей и границ, а также метод, основанный
на исследовании графа G̃ = (A, ρ̃) (п. 5). «Частичная» задача заключается в предва-
рительном выяснении существования для заданного ∆0 ∈ {0, 2, 4, . . .} (следствие 2)
отношения ρ ∈ LO[n] с D(ρ) 6 D(ρ̃) + ∆0 и только в случае положительного ответа
на этот вопрос — в нахождении Arg min D(ρ) (в случае отрицательного ответа счи-

ρ∈LO[n]

таем, что приемлемого отношения не существует). Эта задача имеет полиномиальную
сложность. В любом случае ищется точное множество Arg min D(ρ).

ρ∈LO[n]

2. Подробно рассматривается случай (достаточно частый), когда ∆0 = 2. Дока-
зывается теорема о необходимом и достаточном условии существования решений и
приводится простой алгоритм их нахождения, вычислительная сложность которого
составляет O(n2).

3. При решении основной задачи часто возникает вспомогательная задача, заклю-
чающаяся в определении для некоторого ρ ∈ LA[n]/LO[n] наличия «рядом» с ρ какого-
нибудь линейного порядка λ(ρ) ∈ LO[n], находящегося на минимально возможном рас-
стоянии (равном 2) от ρ, и нахождении этого «ближайшего» к ρ линейного порядка
(или всех таковых). Множество всех ρ, для которых указанное λ(ρ) существует, обозна-
чается LA(2)[n]. Приводятся необходимое и некоторые достаточные легко проверяемые
условия для выполнения ρ ∈ LA(2)[n], а также алгоритм нахождения соответствую-
щих λ(ρ).

4. Рассматривается задача разбиения LA[n] на классы π-эквивалентности (аналог
изоморфизма в графах). Для LA(2)[n] эта задача решается исчерпывающим образом и
описывается алгоритм перечисления всех представителей классов π-эквивалентности



126 В.Н. Нефедов

для этого множества. Для случаев n = 3, 4 и 5 эта задача также решается полностью.
Приведены утверждения (см. лемму 1, а также п. 4), позволяющие при решении задачи
перечисления для каждого очередного n использовать решения для предыдущих n.
Знание системы представителей позволяет некоторые исследования, проводимые для
ρ ∈ LA[n] (в частности, при использовании ρ̃ в методе из п. 5), сводить к нахождению
представителя класса π-эквивалентности, которому принадлежит ρ (при условии, что
свойства этого представителя уже изучены).

5. Получен ряд результатов для классов π-эквивалентности множества LA(2)[n] (ко-
личество элементов в этих классах, число ближайших линейных порядков для заданно-
го ρ ∈ LA(2)[n] и некоторые другие). Выведена формула |LA(2)[n]| = (n−2)(3n−7)n!/6,
показывающая, что при больших n число |LA(2)[n]| во много раз превышает |LO[n]|.
Например, |LA(2)[10]| ≈ 29,95|LO[10]|, |LA(2)[15]| ≈ 82,33|LO[15]|.

ЛИТЕРАТУРА
1. Миркин Б. Г. Проблема группового выбора. М.: Наука, 1974. 256 с.
2. Мулен Э. Кооперативное принятие решений: Аксиомы и модели. М.: Мир, 1991. 464 с.
3. Young H.P. Condorcet’s theory of voting // Amer. Political Sci. Rev. 1988. No. 82. P. 1231–

1244.
4. Осипова В.А., Подиновский В.В., Яшина Н.П. О непротиворечивом расширении отно-

шений предпочтения в задачах принятия решений // Журн. вычисл. матем. и матем.
физ. 1984. Т. 24. №6. С. 831–839.

5. Schulze M. A new monotonic, clone-independent, reversal symmetric, and Condorcet-con-
sistent single-winner election method // Social Choice and Welfare. 2011. No. 36. P. 267–303.

6. Нефедов В.Н., Осипова В.А., Смерчинская C.О., Яшина Н.П. Непротиворечивое агре-
гирование отношений строгого порядка // Изв. вузов. Математика. 2018. №5. С. 71–85.

7. Нефедов В.Н., Смерчинская C.О., Яшина Н.П. Непротиворечивое агрегирование отно-
шений квазипорядка // Прикладная дискретная математика. 2019. №45. С. 113–126.

8. Жуков М.С., Орлов А.И. Задача исследования и итогового ранжирования мнений груп-
пы экспертов с помощью медианы Кемени // Научный журнал КубГАУ. 2016. №122.
С. 784–805.

9. Алексеев Н.С., Осипова В.А. Методика построения полной порядковой классификации
при наличии информации о сравнительной важности критериев // Научно-технич. вест-
ник Поволжья. 2020. №11. С. 7–11.

10. Смерчинская C.О., Яшина Н.П. Агрегирование предпочтений с учетом важности кри-
териев // Труды МАИ. 2015. №84. https://mai.ru/upload/iblock/c72/smerchinskaya_
yashina_rus.pdf.

11. Smerchinskaya S.O. and Yashina N.P. An algorithm for pairwise comparison of alternatives
in multi-criteria problems // Intern. J. Modeling Simulation Scientific Computing. 2018. V. 9.
No. 1. https://www.worldscientific.com/doi/10.1142/S179396231850006X.

12. Берж К. Теория графов и ее применение. М.: ИЛ, 1962.
13. Нефедов В.Н. Некоторые свойства линейно упорядоченной медианы для нечетного числа

линейных асимметричных отношений. МАИ. Деп. в ВИНИТИ. №62–В2021 от 08.11.2021.
50 с.

14. Кемени Дж., Снелл Дж. Кибернетическое моделирование. М.: Сов. радио, 1972.
15. Корнеенко В.П. Методы многокритериального оценивания объектов с многоуровневой

структурой показателей эффективности. М.: МАКС Пресс, 2018. 296 с.



Медиана для нечётного числа отношений линейного порядка 127

REFERENCES
1. Mirkin B.G. Group Choice. V.H. Winston and Sons Publ., 1979. 252 p.
2. Moulin E. Axioms of Cooperative Decision Making. Cambridge, Cambridge University Press,

1988.
3. Young H.P. Condorcet’s theory of voting. Amer. Political Sci. Rev., 1988, no. 82, pp. 1231–

1244.
4. Osipova V.A., Podinovskiy V.V., and Yashina N.P. On non-contradictory extension of

preference relations in decision-making problems. USSR Comput. Math. and Math. Physics,
1984, vol. 24, iss. 3, pp. 128–134.

5. Schulze M. A new monotonic, clone-independent, reversal symmetric, and Condorcet-con-
sistent single-winner election method. Social Choice and Welfare, 2011, no. 36, pp.267–303.

6. Nefedov V.N., Osipova V.A., Smerchinskaya S.O., and Yashina N.P. Non-contradictory
aggregation of strict order relations. Russian Math., 2018, vol. 62, pp. 61–73.

7. Nefedov V.N., Smerchinskaya S.O., and Yashina N.P. Neprotivorechivoe agregirovanie
otnosheniy kvaziporyadka [Non-contradictory aggregation of quasi-order relations].
Prikladnaya Diskretnaya Matematika, 2019, no. 45, pp. 113–126. (in Russian)

8. Zhukov M. S. and Orlov A. I. Zadacha issledovaniya i itogovogo ranzhirovaniya mneniy gruppy
ekspertov s pomoshch’yu mediany Kemeni [The problem of research of final ranking for group
of experts by means of Kemeny median]. Scientific J. KubSAU, 2016, vol. 122, pp. 784–805.
(in Russian)

9. Alekseev N. S. and Osipova V.A. Metodika postroeniya polnoy poryadkovoy klassifikatsii pri
nalichii informatsii o sravnitel’noy vazhnosti kriteriev [Methodology for building a full order
classification with information about comparative importance of criteria]. Nauchno-Tekhnich.
Vestnik Povolzh’ya, 2020, no. 11, pp. 7–11. (in Russian)

10. Smerchinskaya S.O. and Yashina N.P. Agregirovanie predpochteniy s uchetom vazhnosti
kriteriev [Aggregation of preferences taking into account the importance of criteria].
Proc. MAI, 2015, no. 84. https://mai.ru/upload/iblock/c72/smerchinskaya_yashina_
rus.pdf. (in Russian)

11. Smerchinskaya S.O. and Yashina N.P. An algorithm for pairwise comparison of alternatives
in multi-criteria problems. Intern. J. Modeling Simulation Scientific Computing, 2018, vol. 9,
no. 1. https://www.worldscientific.com/doi/10.1142/S179396231850006X.

12. Berge C. Theorie des Graphes et ses Applications. Paris, DUNOD, 1958.
13. Nefedov V.N. Nekotorye svoystva lineyno uporyadochennoy mediany dlya nechetnogo chisla

lineynykh asimmetrichnykh otnosheniy [Some properties of a linearly ordered median for
an odd number of linear asymmetric binary relations]. MAI. Dep. VINITI no. 62–B2021,
08.11.2021. 50 p. (in Russian)

14. Kemeny J. and Snell J. Mathematical Models in the Social Sciences. N.Y., Blaisdell Publ.
Comp., 1963.

15. Korneenko V.P. Metody mnogokriterial’nogo otsenivaniya ob”ektov s mnogourovnevoy
strukturoy pokazateley effektivnosti [Methods for Multi-Criteria Evaluation of Objects with a
Multi-Level Structure of Performance Indicators]. Moscow, MAKS Press , 2018. (in Russian)