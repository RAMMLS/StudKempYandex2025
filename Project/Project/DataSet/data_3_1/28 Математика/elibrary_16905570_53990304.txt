152 ТРУДЫ МФТИ. — 2010. — Том 2, № 4
УДК 519.6

Я.А. Холодов, А.С. Холодов, А.В. Гасников, И.И. Морозов, В.Н. Тарасов
Московский физико-технический институт (государственный университет)

Моделирование транспортных потоков — актуальные проблемы
и перспективы их решения

Работа посвящена математическому моделированию транспортных потоков, описанию про-
блем, которые при этом возникают, и возможностей их решения. Предложена оригиналь-
ная макроскопическая модель для описания автомобильного движения на сложном гра-
фе транспортной сети. Макроскопическая модель основана на гидродинамическом подходе,
где транспортный поток описывается уравнениями течения сжимаемой многокомпонентной
жидкости с мотивацией. В качестве компоненты рассматриваются автомобили, объединён-
ные общими характеристиками. Разработан также оригинальный алгоритм построение си-
стем уравнений в узлах графа транспортной сети — перекрестках. Результаты численных
расчётов при сравнении с экспериментальными данными показывают работоспособность
предлагаемой модели.

Ключевые слова: автомобильное движение, гидродинамический подход, граф транспорт-
ной сети, многокомпонентные транспортные потоки.

зависимости коэффициентов распределения пото-
I. Введение ков на перекрестках — матрицы перемешивания

вместе с матрицей корреспонденций для заданной
Транспортные проблемы современных мегапо- транспортной сети.

лисов хорошо известны и достаточно актуальны. Транспортный поток может моделироваться
Решение этих проблем не всегда очевидно и уж в зависимости от плотности и скорости дорож-
точно всегда требует времени, при этом никто ного движения разными способами. Начиная от
не гарантирует, что в процессе решения текущих простейших макроскопических моделей, исполь-
проблем не возникнут новые. В этой связи воз- зуемых в основном для однополосного беззатор-
никает вопрос: как можно облегчить жизнь непо- ного движения автомобильного транспорта, и за-
средственным участникам дорожного движения, канчивая моделированием движения в многопо-
а именно водителям. Ответ на этот вопрос не од- лосной пробке на основе гидродинамического при-
нозначен, поскольку требует комплексного подхо- ближения, когда транспортный поток уподобля-
да и глубокого понимания существующих на сего- ется сжимаемой многокомпонентной жидкости с
дняшний день проблем. Реально складывающая- мотивацией, учитываемой через уравнение состо-
ся дорожно-транспортная ситуация требует ком- яния транспортного потока. Ключевым моментом
плексных решений не только в сфере развития и также является алгоритм построение систем урав-
оптимизации транспортной инфраструктуры, но нений в узлах графа транспортной сети — пере-
и в повседневном управлении транспортной си- крестках. Данные системы уравнений обеспечи-
стемой для обеспечения надежности её функци- вают связь моделируемых величин на всем гра-
онирования и безопасности её участников как в фе транспортной сети путем задания корректных
штатных, так и в кризисных ситуациях. При этом граничных условий для всех его ветвей, входящих
важно учитывать не только текущую дорожную и выходящих в каждый из его узлов.
обстановку, но и иметь детальный ситуативный
прогноз на всю транспортную систему с учетом Отдельно встает задача о выборе оптимально-
временных и количественных затрат реализации го маршрута для каждого из водителей, которую
различных сценариев развития. Для этого необ- можно рассматривать как задачу принятия реше-
ходима корректная вычислительная математиче- ния. А именно, путем исследования множества до-
ская модель, которая будет осуществлять данный стижимости куда и с какими характеристиками
прогноз по всей транспортной сети мегаполиса. можно доехать, например, из заданной точки за
Прежде всего следует определить модель и данное время. При этом важно учитывать не толь-

её параметры, с которыми предстоит работать. ко текущую дорожную обстановку, но и иметь де-
В разрабатываемой модели следует учесть все воз- тальный прогноз на всю траекторию движения с
можные факторы, такие как периодически обнов- учетом временных затрат по маршруту. Мыслен-
ляемые данные о текущем состоянии дорожной но себе это можно представлять как исследование
ситуации, правила движения по полосам на пере- растекания жидкости из вершины по транспорт-
крестках, расписания и алгоритмы работы свето- ному графу.
форов, локальные перекрытия на участках дороги В основу предлагаемой технологии положен
и т.д. Модель также должна включать временные имеющийся опыт использования сетевых вычис-



ТРУДЫ МФТИ. — 2010. — Том 2, № 4 153
лительных моделей, основанный на решении со- бой дифференциальные законы сохранения (из-
ответствующих краевых задач для уравнений в менения) «массы» и «импульса» на автодорогах
частных производных на графах [1, 2]. Данный (по аналогии с гидродинамикой) и в дивергентной
опыт показывает, что при современном уровне фо
развития вычислительной математики и вычисли- {рме записывается в виде (см., например, [6]):
тельной техники, особенно с появлением высоко- ∂ρk/∂t+ ∂(ρkvk)/∂xk = f0k,

производительных вычислительных платформ и ∂(ρkvk)/∂t+ ∂(ρkv2
k + p(ρk))/∂xk = (1)

f1k.

решений, такой подход позволяет эффективно ре- Здесь
шать достаточно сложные «глобальные» задачи p = p(ρk) (2)
данного класса [3].

есть замыкающее систему (1) уравнение состоя-
II. Сетевая модель интенсивного ния (зависимость давления от плотности, рис. 2),
дорожного движения в мегаполисе f0k — возможные источники или стоки «массы»

(въезжающие на дорогу автомобили из не учиты-
Для макромоделирования автомобильного ваемых явно элементов уличной сети, останавли-

движения используются различные математиче- вающиеся или начинающие движение автомоби-
ские модели, в том числе основанные на диффе- ли и т.п.), f1k — возможные внешние импульсы,
ренциальных уравнениях в частных производных действующие на систему (1). В таких моделях ос-
и, в частности, гидродинамические модели, ана- новной проблемой является построение адекват-
логичные уравнениям течения сжимаемой много- ного действительности уравнения состояния (2),
компонентной жидкости с мотивацией (см. [4--11] конкретный вид которого, как и для всякой фе-
и др.). Ниже также рассматривается вычислитель- номенологической модели, должен быть опреде-
ная математическая модель интенсивного улично- лен из экспериментальных измерений (возможно
го движения в мегаполисе, основанная на реше- с использованием параметрических решений си-
нии соответствующих краевых задач для урав- стемы (1), (2)). Представленные на рис. 3, 4, 5,
нений в частных производных гиперболического 6 для движения на одной (левой) полосе высоко-
типа. скоростной автострады экспериментальные зави-
Будем представлять уличную сеть мегаполи- симости потока от плотности из [12--15] показы-

са в виде перекрестков (узлов графа с номера- вают (отмечены точками и соединяющими их от-
ми резками прямых), что предельная величина пото-

l = 1, ..., L), связанных между собой доро-
гами с длиной Xk (ребрами графа с номерами

ка (определяемая пропускной способностью доро-
ги, техническими характеристиками автомобилей

k = 1, ..., K, 0  xk  Xk) (см., например,
рис. 1). Введем следующие обозначения для ис- и правилами дорожного движения) много больше
пользуемых в модели параметров: реально реализуемой максимальной его величи-

ρk(xk,t) — плот-
ность автомобильного потока (количество автомо- ны (free)

qfs = qmax и реально реализуемое движение
билей на единицу длины дороги с номером k); в фазовой плоскости {ρs,qs} (номер ветви графа
v k далее опущен) имеет своей границей параболу
k(xk,t) — средняя по сечению дороги линейная
скорость потока автомобилей на k-й ветви графа (кривая № 1 на рис. 3–6):
в точке xk в момент времени t; qk(xk,t) = ρkvk — qs(ρs) = ρs(qfs/ρfs + cfs(1 − ρs/ρfs)),
поток автомобилей.

ρs  ρfs (3)
при плотности одной полосы дороги, меньшей
критической ρs < ρfs (область «свободного пото-
ка»). Здесь cfs — аналог скорости звука при кри-
тической плотности, s — номер полосы движения
(1  s  S), S — число полос заданной автодоро-
ги.

Рис. 1. Пример направленного графа для перекрестка

II.1. Система уравнений автомобильного
движения на ребре графа транспортной

сети

Гиперболическая система уравнений, описыва-
ющая автомобильное движение, представляет со- Рис. 2. Примеры уравнения состояния p(ρ)



154 ТРУДЫ МФТИ. — 2010. — Том 2, № 4
области реализуемых значений при ρs > ρfs (пря-
мая № 2 на рис. 3–6):

qs(ρs) = c∗s(ρ∗s − ρs), qs(ρfs) = c∗s(ρ∗s − ρfs) =

= dsqfs, ρs > ρfs (5)
с обращающимся в ноль при максимальной плот-
ности ρs = ρ∗s потоком и с возможным его разры-
вом в случае ds < 1 при критической плотности
ρs = ρfs, коэффициент разрыва ds определяетсяРис. 3. Аппроксимация экспериментальных данных из измеренных данных:

из [13]
ds = c∗s(ρ∗s − ρfs)/qfs  1. (6)

Здесь ρ∗s — предельно допустимая плотность по-
тока автомобилей (пропускная способность одной
полосы дороги), соответственно c∗s — аналог ско-
рости звука при этой плотности.

Рис. 4. Аппроксимация экспериментальных данных
из [13]

Рис. 6. Аппроксимация экспериментальных данных
из [14]

Зависимости qs = qs(ρs) из (3), (5) или анало-
гичных аппроксимаций измеренных данных вме-
сте с первым уравнением из (1) (при f0k = 0 диф-

Рис. 5. Аппроксимация экспериментальных данных ференциальным законом сохранения числа авто-
из [14] мобилей), так же как и система уравнений (1)--(2),
Однако при дальнейшем увеличении плотно- могут непосредственно использоваться для моде-

сти до значений ρs > ρfs такой однозначной лирования дорожного движения. В этом случае
зависимости, как в (3), из представленных экс- движение автомобилей описывается одним нели-
периментальных данных не наблюдается вслед- нейным уравнением переноса для плотности (см.,
ствие взаимодействия волн разгона и торможе- например, [4, 5]):
ния при интенсивном (с закритической плотно-
стью ∂

ρs > ρfs) автомобильном движении. Ско-
q

∂ρs/∂t+ ∂qs(ρs)/∂x = ∂ρs/∂t+ s(ρs)
∂ρs/∂x =

рость свободного движения потока автомобилей ∂ρs

vs0(0) = (∂qs(ρs)/∂ρs)0 определяется правилами = 0. (7)
дорожного движения, техническими характери-
стиками автомобилей и стилем вождения участ- Скорость vs всегда может быть вычислена с ис-
ников дорожного движения и обеспечивает связь пользованием рассчитанных из (7) значений ρs и
этого параметра со значениями qfs,ρfs,cfs: известной фундаментальной диаграммы qs(ρs):

v vs(x,t) = qs(ρs(x,t))/ρs(x,t). (8)
s0 = vs(0) = qfs/ρfs + cfs. (4)

Предполагая существование аналогичной (3) од- В данной работе ставится тем не менее другая за-
нозначной зависимости потока от плотности так- дача — получить из известного вида фундамен-
же и при ρs > ρfs, будем полагать ее линейной в тальной диаграммы аналог уравнения состояния



ТРУДЫ МФТИ. — 2010. — Том 2, № 4 155
(зависимость давления от плотности) для задан-
ной полосы автодороги ps = ps(ρs) и использовать ps(ρs) = c2fsρ

3
s/(3ρ

2
fs) при ρs  ρfs, (13)

для решения системы (1). Использование одного
уравнения не является достаточным для коррект-
ного описания всех фаз (состояний) транспортно- ps(ρs) = pfs + ρ2

∗sc
2
∗s(1/ρfs − 1/ρs),

го потока, наблюдаемых на рис. 3--6 (см. [11]). Сде-
лать это можно, если воспользоваться хорошо из- pfs = c2fsρfs/3 при ρs > ρfs. (14)
вестным дифференциальными преобразованиями Здесь и далее мы полагаем вектор правой
законов сохранения (см., например, [16]). Умно- части f = 0 из следующих соображений. За-
жим (7) на ∂qs/∂ρs: висимости потока от плотности, показанные на

рис. 3--6, получены от датчиков, которые нахо-
∂qs ∂qs ∂qs

∂ρ дились в левой полосе автобана на существен-
s/∂t+ ∂qs/∂x = ∂qs/∂t+ ∂qs/∂x =

∂ρs ∂ρs ∂ρs ном расстоянии от каких-либо дорожных развя-
зок (см. [13--14]), соответственно там не было ни-

= 0 (9) каких возможных источников или стоков «массы»
и воспользуемся следующими дифференциальны- автомобилей. Все остальные параметры, которые
ми соотношениями: исследователи обычно так любят включать в пра-

вую часть системы уравнений (1) (см. [4--10] и
∂qs/∂t = ∂(ρsvs)/∂t = vs∂ρs/∂t+ ρs∂vs/∂t, др.), учитываются автоматически через получен-

ный вид фундаментальной диаграммы для этих
∂qs/∂x = ∂(ρsvs)/∂x = vs∂ρs/∂x+ ρs∂vs/∂x, измерений и в правую часть не входят.

подставим их в (9), откуда получим Вблизи предельных значений плотности
ρs ≈ ρ∗s движение является слабосжимаемым,

∂qs(ρs) поэтому для обеспечения бесстолкновительного
∂vs/∂t+ ∂vs/∂x = 0. (10)

∂ρs движения в области сильных заторов бралось
ρ∗s  ρs  ρε = ρ∗s(1 − ε), ε ∼ 0,1 − 0,01, соответ-

Итак, вместо системы уравнений (1) получен ана- ственно уравнение состояния (14) модифицирова-
лог этих законов сохранения в виде системы урав- л
нений (7), (10) в недивергентной форме с нулевой ⎧ось следующим образом:
правой ча{стью: ⎨ p p (ρ

⎩ s(ρs) = ( εs + (ρs − ρεs)(B + C s + ρεs))),
C = ((∂p/∂ρ)∗s − (∂p/∂ρ)εs)/(ρ∗s − ρε),

∂ρ (ρs) B = (∂p/∂ρ)
s/∂t+

∂qs ∗s − 2Cρ∗.
∂ρ ∂ρs/∂x = 0,

s 1) (15)
∂v q (1

s(ρs)
s/∂t+ ∂

∂ρ ∂vs/∂x = 0.
s Выбором значений ρε и (∂p/∂ρ)= 2

εscεs можно также
Из сопоставления уравнений (10) и второго обеспечить приемлемый шаг интегрирования по
уравнения в (1), записанного в недивергент- времени в области автодороги, где плотность при-
ной форме, можно получить вид уравнения со- ближается к своему предельному значению ρ∗s, а
стояния (2). Для этого в (10) добавим и вы- значение (∂p/∂ρ)∗s начинает неограниченно рас-
чтем член ти.

vs∂vs/∂x и воспользуемся следстви-
ем второго дифференциального соотношения: Чтобы перейти в системе уравнений (1)--(2) от

многополосного к усредненному представлению
∂vs/∂x = (∂qs/∂ρs− qs/ρs)(∂ρs/∂x)/ρs. Тогда (10)
приводится к виду: дороги, для ветви графа с номером k = 1, ..., K

в (1)--(2) аналогично многокомпонентной односко-
(q ростной модели баротропного газа будем полагать
s/ρs − ∂qs/∂ρs)2

∂vs/∂t+vs∂vs/∂x+ ∂ρs/∂x = 0.
ρs ∑Sk 1 ∑Sk

ρk = Skρ̃k = ρsk, vk = vsk,
Сравним это уравнение с недивергентной S
формой второго уравнения системы (1) для
одной полосы с нулевой правой частью: ∑ s=1 k s=1

Sk ∑Sk

q
∂v 1 ∂ps k = Skq̃k = qsk, pk = Skp̃k = psk. (16)

s/∂t + vs∂vs/∂x + ρ ∂ρ ∂ρs/∂x = 0, получим
s s

соотношение, связывающее производную, давле- s=1 s=1

ние ∂p Переход (16) удобен тем, что его можно осуществ-
s/∂ρs, аналог скорости звука cs, поток qs и

плотность ρ лять как в прямую, так и в обратную сторону
s:

в любом участке дороги при возникновении та-
∂p 2 2

s/∂ρs = c кой необходимости. Индекс s можно связывать не
s = (qs/ρs − ∂qs/∂ρs) . (12)

только с номером полосы дороги, но и с маршру-
Интегрируя (12), можно найти функцию ps(ρs) по том водителя, типом автомобиля, стилем вожде-
заданной функции qs(ρs), если последняя описы- ния или опытностью водителей и т.д.
вает достаточно широкий класс дорожного движе- При этом для различных участников движе-
ния. ния, имеющих существенно отличающиеся друг
Для qs(ρs) из (3), (5) имеем от друга константы в уравнениях состояния (13),



156 ТРУДЫ МФТИ. — 2010. — Том 2, № 4
(14), в дополнение к системе (1), (2), как это при-
нято, можно ввести в рассмотрение их концентра-
ции: ∑Sk ∑Sk

Csk = ρsk/ ρsk, Csk = 1 (17)
s∑=1 s=1

в такой равновесной или неравновесной, односко-
ростной (vk = 1 Sk

S s=1 vsk) или многоскорост-k
ной смеси и в простейшем случае для определе-
ния этих концентраций использовать соответству-
ющие уравнения конвективно-диффузионного пе-
реноса (в том числе между разными полосами до-
роги):
∂Csk ∂C 2C

+ sk ∂ k
vsk = s

μ +f(C1k, ..., CSk), (18)
∂t ∂x ∂x2

где μ — «коэффициент диффузии», а Рис. 8. ds = 0.5: предельные зависимости потока от
f(C1k, ..., CSk) определяет, например, процессы плотности — кривые № 1, 2; ударные адиабаты —
перестроений и т.п. сплошные кривые без номеров; характеристики пер-
Имея замкнутую систему уравнений (1)--(2) вого семейства — штриховые линии

(хорошо известную систему уравнений Эйлера Вводя в рассмотрение векторы V = {ρk,vk},
для сжимаемого баротропного газа), можно най- U(V ) = {ρk,ρkvk}, F (V ) = {ρkvk,ρkv2

k + p(ρk)},
ти уравнения характеристик и соответствующие f = {f0k,f1k}, систему уравнений (1) можно запи-
условия совместности этой системы уравнений ги- сать в векторной дивергентной форме:
перболического типа, соотношения на разрывах,
возникающих при переходе от докритического ∂U(V )/∂t+ ∂F (V )/∂xk = f(V,xk,t), (21)
(«сверхзвукового») движения к закритическому
(«дозвуковому») в волнах торможения и т.д. Ин- или в недивергентной форме:
тегрируя (1), (2) по замкнутому контуру в плоско-
сти {x,t}, содержащему фронт разрыва движуще- ∂V/∂t+A(V )∂V/∂xk = f̃ = (∂U/∂V )−1f
гося со скоростью D, можно получить соотноше-
ния на разрывах, в частности, уравнение ударной с матрицей Якоби:
адиабаты, связывающее параметры перед фрон-
том разрыва (в докритическом потоке с ρ1k  ρ A = (∂U/∂V )−1

{ (∂F/∂V}) =
fk,

кривая № 1 на рис. 3, 4, 5, 6, 7, 8) и за фронтом
разрыва (в закритическом потоке с ρ2k > ρfk, пря- = vk ρk

( . (22
мая № 2 на рис. 3--8): ∂p/∂ρk)

)
/ρk vk

(p1k(ρ1k)−p2k(ρ2k))(1/ρ2k−1/ρ1k)− (v1k−v2k)2 = Собственные числа матр√ицы ЯкобиA : λ1 = vk+ck,
λ2 = vk − ck, ck = ∂p/∂ρk всегда действи-

= 0, (19) тельные и различные (∂p/∂ρk = c2k > 0) —
а также скорость движения фронта разрыва: система (21) строго гиперболического типа,

а левые собственные векторы: ω1 = {ck,ρk},
D = (ρ1kv1k − ρ2kv2k)/(ρ1k − ρ2k) = ω2 = {{ck, − ρk} линейно независимы. Т. е. мат-

= (q1k − q2k)/(ρ1k − ρ2k). (20) рица со стро}ками{из левых со}бственных векторов
ω1 c

Ω = = k ρk
Эти соотношения и, в частности, вполне измеряе- неособенная, так

ω2 ck −ρk
мую величину D можно использовать для опреде- как detΩ = −2ρkck = 0 при ненулевых плотности
ления констант в уравнении состояния (13)--(14), ρk и «скорости звука» ck. Для упрощения выкла-
как это делается при построении уравнений состо- док в дальнейшем будем полагать вектор правой
яния сложных физических сред. части f = 0.

Эквивалентная (1) характеристическая форма
уравнений совместности вдоль характеристик пер-
вого (верхний знак, индекс № 1) и второго (ниж-
ний знак, индекс № 2) семейств

dx = λidt = (vk ± ck)dt, i = 1, 2 (23)

Рис. 7. cfs = 0.1[м/с]: предельные зависимости потока им{еет видот плотности — кривые № 1, 2; ударные адиабаты —
сплошные кривые без номеров; характеристики перво- ωi · dVdt = ck(ρk)dρk/dti ± ρkdvk/dti = 0,

i

го семейства — штриховые линии d (
dt = ∂

i ∂t + λ ∂ 24)
i ∂x , i = 1, 2.

k



ТРУДЫ МФТИ. — 2010. — Том 2, № 4 157
Каждое из уравнений (24) является, по сути, Н⎧а рис. 5:обыкновенным дифференциальным уравнением
вдоль i-й характеристики (23). Для уравнения со- ⎪⎪⎪⎨ ρfs = 0,0213[АТС/м],
стояния (13)--(14) условия совместности (24) инте- q

⎪ fs = 0,6[АТС/с], cfs = 22,4[м/с],
грируются аналитически, что позволяет получить ⎪⎪ ds = 0,9,

⎩ (31)
вид инвариантов Римана ri, постоянных вдоль со- ρ∗s = 0,21[АТС/м], c∗s = 2,9[м/с],
ответствующих характеристик λi, i = 1, 2: vs0 = 50,6[м/с].

⎧На рис. 6:ri(ρk,vk) = cfsρk/(Sρfs) ± vk = const , ⎪⎪⎪⎪⎨ ρfs = 0,0213[АТС/м],
при ρk  Sρfs; (25) q

⎪ fs = 0,6[АТС/с], cfs = 22,4[м/с],

⎪⎪⎪ ds = 0,9, (32)

⎩ ρ∗s = 0,21[АТС/м], c∗s = 3,17[м/с],
vs0 = 50,6[м/с].

ri(ρk,vk) = −(c∗sρ∗sS/ρk) ± vk = const ,
Соответствующие им граничные зависимости

при ρk > Sρfs. (26) потока от плотности (3), (5) показаны сплошными
В фазовой плоскости {ρ,q} кривые (25), (26) линиями 1, 2 на рис. 3–8. Для этих же значений

имеют вид констант уравнения состояния (13), (14) представ-
лены на рис. 2. Кривые a, b, c, d соответствуют
константам из (29), (30), (31) и (32).

qk(ρk) = ±ρk(ri − cfsρk/(Sρfs)) = const , i = 1.2 На рис. 3--6 сплошными линиями без номеров
показаны ударные адиабаты (19) для ряда значе-

при ρk  Sρfs; (27) ний ρ1k,v1k = q1k/ρ1k, принадлежащих кривым
(3), а штриховыми линиями показаны инвариан-
ты Римана первого семейства (27), (28), i = 1.

q Инварианты Римана второго семейства i = 2 сим-
k(ρk) = ±(riρk + c∗sρ∗sS) = const , i = 1.2

метричны первому семейству относительно оси
при ρk > Sρfs. (28) абсцисс. Отдельно стоит обратить внимание на

рис. 5. Здесь мы видим, что переход из докритиче-
Характеристическая форма уравнений (24) ского («сверхзвукового», кривая № 1) движения к

или ее модификации с использованием инвариан- закритическому («дозвуковому», прямая № 2) осу-
тов Римана (25), (26) (если удается найти точное ществляется через ударную волну сжатия и коэф-
решение (24)), так же как соотношения на разры- фициент разрыва ds < 1. Таким образом, данный
вах (19), (20), необходимы при построении эффек- процесс не является адиабатическим. Это приво-
тивных разностных схем для численного решения дит к тому, при возвращении назад в ту же точку
системы (1)--(2) (см., например, [17]), а в гранич- на кривую № 1 с прямой № 2 через волну разре-
ных точках они используются для замыкания кра- жения невозможно.
евых условий. Для оценки влияния констант в уравнении со-
Для представленных на рисунках эксперимен- стояния (13), (14) на поведение давления в ва-

тальных данных из [13] (рис. 3—4) и из [14] рианте (30) более существенно, чем в (29), (31)
(рис. 5–6) (точки и соединяющие их отрезки пря- и (32), были изменены коэффициенты c
мых) константы fs,ds. На

ρfs,qfs,cfs,ds,ρ∗s,c∗s в уравнени- рис. 7 для случая c
ях (3), (5), аппроксимирующих границы обла- fs = 0,1 [м/с] и на рис. 8 для

ds = 0,5 представлены аналогичные описанным
сти реализуемых движений автомобилей, прини- выше зависимости параметров: предельные зави-
мались следующими. симости потока от плотности — кривые № 1, 2;

⎧На рис. 3:⎪ ударные адиабаты — сплошные кривые без номе-

⎪⎪⎨ ρ ров; характеристики первого семейства — штри-
fs = 0,0243[АТС/м],
q

⎪ fs = 0,656[АТС/с], cfs = 15,8[м/с], ховые линии. Соответствующие зависимости для

⎪ давления показаны на рис. 2 (кривые e и f). Вид-

⎪ d

⎩ s = 1, (29)
ρ∗s = 0,21[АТС/м], c∗s = 3,53[м/с], но, что существенное отличие параметра ds от 1
v приводит к заведомо неправильному поведению
s0 = 42,8[м/с].

ударных адиабат (увеличение скорости при пере-

⎧ На рис. 4: ходе от докритического режима к закритическому

⎪⎨ в волне торможения и т.п.). Из сравнения кривых
ρfs = 0,0243[АТС/м], a и e на рис. 2 видно также, что аппроксимация

⎪⎪ qfs = 0,656[АТС/с], cfs = 27[м/с], ds = 1, в (3) докритической ветви qs(ρs) даже линейной⎩ ρ∗s = 0,21[АТС/м], c∗s = 3,53[м/с], функцией (cfs ≈ 0) влияет на уравнение состо-
vs0 = 54[м/с]. яния сравнительно слабо. Сопоставление кривых

(30) a и c на рис. 2, для которых ∂qs(ρfs)/∂ρs > 0,



158 ТРУДЫ МФТИ. — 2010. — Том 2, № 4
с кривыми b и d, для которых ∂qs(ρfs)/∂ρs = 0, В точках ветвления графа (во внутренних узлах
показывает, что равенство нулю ∂qs(ρfs)/∂ρs = 0 или на перекрестках) постановка граничных усло-
дает более гладкое сопряжение докритической и вий существенно зависит от организации движе-
закритической ветвей ps(ρs) и обеспечивает прин- ния (учитывается ли многополостное движение
ципиальную возможность перехода в закритиче- на дороге или рассматривается осредненное по
ский режим движения без экстренного торможе- направлению движение, учитывается ли наличие
ния (аналог адиабатического безударного сжатия светофоров или рассматриваются более длитель-
потока в газовой динамике). В этом случае закри- ные временные масштабы и т.д.).
тическая ветвь зависимости потока от плотности В каждом внутреннем узле графа дополни-
(5) (прямая № 2 на рис. 6) является слабой вол- тельной искомой величиной, помимо значений
ной торможения (19) (при переходе через которую векторов Vl1, Vl2, ..., VlM в окончаниях входящих
параметры непрерывны, а разрывными являются в узел l и выходящих из него m = 1, ..., M вет-
нормальные производные) и при этом остается од- вей, является «давление» узла pl(t). При расчете
ной из характеристик семейства № 1. таких граничных точек в зависимости от знаков

собственных чисел λ1,λ2 матрицы A для различ-
II.2. Система уравнений автомобильного ных связанных с узлом l ветвей m = 1, ..., M воз-
движения в узлах графа транспортной можны различные ситуации. При λ1 > 0,λ2 < 0,

сети то есть при |vlk| < clk (закритическое движение),
в дополнение к условиям совместности (24) (или

Число граничных условий на свободных кон- (25), (26)) вдоль направленных внутрь области ин-
цах ветвей графа дорожной сети (входах xk = 0 тегрирования характеристик (23) в качестве гра-
и выходах xk = Xk) зависит от знаков собствен- ничных условий использовались соотношения
ных чисел матрицы Якоби A (22). Их количество
на входах может быть равным двум при положи- ψlm(t,pl,Vlm) = plm − pl −Rlmρlmvlm = 0. (36)
тельных λ1,λ2 > 0, что полностью определяет па-
раметры такого узла, одному при λ1 > 0,λ2 < 0 Здесь Rlm  0 — коэффициент сопротивления
или нулю при отрицательных λ1,λ2 < 0. На выхо- окончания m-й ветви, входящей в l узел (или вы-
дах их число может быть равным нулю при поло- ходящей из него), plm = p(ρlm) — «давление» в
жительных λ1,λ2 > 0, единице при λ1 > 0,λ2 < 0 примыкающем к узлу l конце ветви m, связанное
или двум при отрицательных λ с плотностью ρlm в этой точке уравнением состо-1,λ2 < 0.
В соответствии с этим на входах–выходах из яния (2) (или (13), (14)). С помощью коэффици-

дорожной сети в качестве граничных условий мо- ентов Rlm(t,ρlm,vlm), в частности, можно воспро-
гут быть заданы как функции времени значение изводить правила проезда нерегулируемых пере-
плотности потока автомобилей ρk(t) или величи- крестков, работу светофоров и т.п.
на линейной скорости vk(t) (при λ1 > 0,λ2 < 0), Помимо аналогов закона Ома (36) или анало-
для расчета таких узлов в качестве второго урав- гичной формулы Пуазейля для течений в трубах,
нения привлекается одно из условий совместности для расчета внутренних узлов графа использует-
(24) или (25), (26) вдоль идущих внутрь области ся равенство нулю алгебраической суммы потоков
интегрирования характеристик. Если необходимо автомобилей:
задавать два граничных условия, обе эти пере- ∑M
менные задаются одновременно. Также возможна ϕl(t,Vl1, ..., VlM ) = βlmρlmvlm = 0. (37)
ситуация, когда граничные узлы рассчитывают- m=1
ся через значения во внутренних точках дороги,
тогда задавать граничные условия не требуется. В (37) коэффициенты βlm = 1 для входящих в
Вместо плотности или линейной скорости может узел ветвей и βlm = −1 для выходящих из узла
задаваться величина автомобильного потока ветвей.

Таким образом, M дифференциальных усло-
qk(t) = ρkuk. (33) вий совместности (24) (или ((25), (26)) и M + 1

нелинейных алгебраических граничных условий
На выходах иногда используют неотражающие (36), (37) позволяют (после их аппроксимации раз-
граничные условия нулевые производные ностными соотношениями) найти 2M+1 искомых

параметров Vl1 = {ρl1,vl1}, ..., VlM = {ρlM ,vlM},
(∂qk/∂xk) = 0, (∂uk/∂xk) = 0, (34) pl(t). Для решения получившейся нелинейной си-

стемы уравнений можно воспользоваться каким-
что, вообще говоря, является корректным лишь либо итерационным методом. Например, аппрок-
при положительных λ1,λ2 > 0. симируя (24) (или ((25), (26)) по какой-либо явной
Помимо граничных условий, для системы (1), схеме:

(2) необходимо задать также некоторые началь-
ные условия: ϕlm(Vlm) = ωnilm(V n+1

lm − V nkm) = cnlm(ρn+1
lm − ρnkm)±

ρk(xk,0) = ρk0(xk), vk(xk,0) = vk0(xk). (35) ±ρnlm(vn+1
lm − vnkm) = 0, m = 1, ..., M. (38)



ТРУДЫ МФТИ. — 2010. — Том 2, № 4 159
В (38) V nkm является значением сеточной век- является неособенной, поскольку
тор-функции в точке пересечения характеристи-
ки (23), приходящей в рассчитываемую точку вре- det(∂Z(Y jl )/∂Y jl ) = 0.
менного слоя t = tn+1, со слоем t = tn для k-го В том случае, когда в ближайшем к узлу
ребра. Эта величина определяется интерполяци-

l конце xm = Xm какой-либо из входящих в
ей по данным вектор-функции V nk в узлах сетки этот узел ветвей m поток автомобилей является
на слое t = tn. В целом, вместо (23) предпочти- докритическим («сверхзвуковым»), то есть при
тельнее использовать разностную аппроксимацию

v
соответствующего инварианта Римана (25), (26), lm > clm (λ1 > 0,λ2 > 0) искомые параметры

Vlm = {ρlm,vlm} в таких окончаниях ветви m мо-
обеспечивающую более высокую точность расче- гут быть рассчитаны так же, как и в (36)--(38),
тов. однако условия совместности (24) следует заме-
Обозначив вектор неизвестных как нить разностной аппроксимацией ударной адиаба-

Y ты (19):
l = {ρl1, vl1, ..., ρlM , vlM , pl},

получаем систему нелинейных уравнений: ϕlm(vlm) = (pnlm(ρnlm) − pn+1
lm (ρn+1

lm ))×
×(1/ρn+1

lm − 1/ρnlm) − (vnlm − vn+1
lm )2 = 0, (41)

Zl(Yl) = {ϕl(Vl1, ..., VlM ), ϕl1(Vl1), ..., ϕlM (VlM ),
так как при приближении к точкам ветвления

ψl1(pl,Vl1),ψlM (pl,VlM )}T = 0 (39) обычно происходят многочисленные затормажи-
и, задав некоторое начальное приближение Y 0

l (по
вающие поток междуполосные перестроения и пе-

данным предыдущего шага по времени реход движения в закритический режим движе-
t = tn)

для последующих итераций в методе Ньютона из ния. Аналогичным образом следует поступать при
(36)--(38), имеем линейную относительно v

Y j+1 lm > clm (λ1 > 0,λ2 > 0), xm = 0 для выходящей
l си-

стему из 2M + 1 урав(нений:
из узла ветви, так как при интенсивном движе-

) нии маловероятным является докритический ре-
жим движения непосредственно на выезде из пе-

∂Z(Y j
−1

Y j+1
l = Y jl − l )

Z(Y j), рекрестка (во внутренних узлах графа). В этом
∂Y j

l
l случае использование (41) неявно предполагает

допустимость разрывных волн ускорения («удар-
j = 0, 1, ..., J. (40) ных волн разрежения»), что требует специальных

В данн{ом случае имеем } исследований. Впрочем, возникновение таких си-
туаций на перекрестках (узлах графа) с интенсив-

∂ϕlm ∂ϕlm ∂ϕlm ным движением маловероятно. Это замечание (об
, , = {clm,± ρlm,0},

∂ρlm {∂vlm ∂pl } использовании (41) вместо условий совместности
(24)) относится также к условиям замыкания гра-

∂ψlm ∂ψlm ∂ψlm ничных условий на входах в уличную сеть.

{ , , =
∂ρlm ∂vlm ∂pl } III. Численная реализация модели

∂p
= lm −Rlmvlm,−Rlmρlm,− 1 = и результаты расчетов

∂ρlm

{ = {c2lm −Rlmv}lm,−Rlmρlm,− 1}, Трудность реализации предлагаемой модели
связана прежде всего со сложной структурой гра-

∂ϕl ∂ϕl ∂ϕl
, , = {βlmvlm,βlmρlm,0}, фа уличной сети, значительной неопределенно-

∂ρlm ∂vlm ∂pl стью определяющих параметров, констант «урав-
и непосредственной проверкой можно убедиться, нения состояния» и процессов регулирования
что для нелинейной системы (36)--(38) её матрица (многопараметричность задач), поэтому полно-
Якоби ∂Z(Y jl )/∂Y jl : масштабная их реализация требует значительных

вычислительных ресурсов и усилий по идентифи-
∂Z(Y jl ) кации определяющих параметров («калибровка

=
∂Y j⎧ модели»). Структура искомого решения в таких

l

⎪⎪ системах может иметь очень сложный характер

⎪⎪ ⎫
⎪⎪ c

⎪ l1 ±ρl1 0 0 ... 0 0 0 ⎪ из-за взаимодействия многочисленных волн раз-

⎪ ⎪
⎪⎪ 0 0 c

⎪ l2 ±ρl2 ... 0 0 0 ⎪⎪⎪
⎪ ⎪
⎨ ⎪ гона — торможения друг с другом и с узлами гра-

... ... ... ... ... ... ... ... ⎪⎪⎪ фа, в том числе иметь разрывный характер. Это
0 0 0 0 ... clM ±ρlM 0 ⎪⎪⎬ требует специальных исследований и предъявля-

= ⎪⎪⎪⎪ (c2 ет очень жесткие требования к выбору численных

⎪ l1 −Rl1vl1) −Rl1ρl1 0 0 ... 0 0 −1

⎪⎪⎪ 0 0 (c2l2 −Rl2vl2) −Rl2ρl2 ... 0 0 −1 ⎪⎪
⎪ ⎪
⎪ ⎪
⎪ ⎪ методов, пригодных для решения данного класса

⎪ ... ... ... ... ... ... ... ... ⎪
⎩ ⎪⎪ задач.

0 0 0 0 ... (c2lM −RlMvlM ) −RMρM −1 ⎪⎪⎪⎪
βl1vl1 βl1ρl1 βl2vl2 βl2ρl2 ... βlMvlM βlMρlM 0 ⎭ Составляющая основу данной модели система

уравнений в частных производных (1), (2) име-



160 ТРУДЫ МФТИ. — 2010. — Том 2, № 4
ет гиперболический тип и для численного реше- В одном из серии расчетов планарный дорож-
ния таких уравнений существует достаточно мно- ный граф состоял из двух участков, на входе пер-
го разнообразных по своим качествам численных вого участка задавался поток как возрастающая
методов. Однако отмеченные выше особенности функция времени (33) (в соответствии с экспери-
потребовали специальных исследований и разра- ментальным данными), а на выходе второго участ-
ботки новых монотонных схем высокого порядка ка в качестве граничных условий задавались ну-
аппроксимации ([17] и др.). левые производные от плотности и скорости (34)
Описанная выше математическая модель бы- (неотражающие условия, так как движение на вто-

ла реализована в виде комплекса программ с ис- ром участке соответствовало режиму «свободно-
пользованием указанных численных методов и от- го потока). Во внутреннем узле графа одной из
тестирована на ряде задач. Эти тестовые расчеты констант расчетной модели является коэффици-
показали высокую эффективность методов и ра- ент сопротивленияRlm  0 (36), который варьиро-
ботоспособность модели. вался в довольно широких пределах: от нуля (ко-

гда такая граничная точка ничем не отличается
Определяющими функционирование описан- от внутренних узлов разностной сетки) до очень

ной выше динамической модели уличного движе- больших его значений (соответствующих полному
ния параметрами прежде всего являются характе- запиранию потока в этом месте).
ристики графа уличной сети и уравнения состоя-
ния (2). Для оценки влияния неопределенности в На рис. 9 для одного из вариантов расчета в
их выборе (по имеющимся в литературе экспери- фазовой плоскости {q,ρ} с координатами xk чер-
ментальным данным) были проведены тестовые ными точками нанесены значения зависимостей
расчеты автомобильного движения, примерно со- q(t,xk) от ρ(t,xk), полученные в узлах разност-
ответствующего условиям экспериментальных из- ной сетки первого участка дороги с координата-
мерений [13, 14] с использованием уравнений со- ми xk в различные моменты времени t, то есть
стояния (13), (14) с константами из (29)--(32) (кри- параметры, которые нанесены в виде эксперимен-
вые a–d на рис. 2). Точное воспроизведение пред- тальных точек на рис. 4. Темно-серыми точка-
ставленных в [13, 14] условий автодвижения прин- ми (постепенно сливающимися в линию) нанесены
ципиально невозможно из-за наличия на исследу- аналогичные данные для второго участка, на ко-
емых участках пересечений с поперечными доро- тором реализуется свободный («сверхзвуковой»)
гами, по которым не приведено никаких данных, поток. Тонкими черными линиями нанесены те
хотя их влияние на измеряемые параметры оче- же, что и на рис. 4, характеристики первого се-
видно и может быть достаточно существенным, мейства, а более толстыми светло-серыми лини-
так как в местах пересечений обычно интенсивно ями — ударные адиабаты для использовавшего-
происходят межполосные перестроения, что при- ся в расчетах уравнения состояния с константа-
водит к замедлению потоков, их уплотнению и да- ми из (30), поскольку сеточных узлов было 100,
же к образованию заторов. Тем не менее по пред- а моментов времени несколько тысяч, то разли-
ставленным в этих работах данным на входе (без чить можно лишь отдельные траектории в фа-
учета участников движения с поперечных автодо- зовой плоскости (самые толстые — черные ли-
рог) были проведены расчеты и получены данные, нии). Однако четко просматриваются движения
качественно сопоставимые с экспериментальными потока как близкие характеристическим направ-
данными на выходном измерительном пункте. лениям (с «безударным» режимом торможения),

так и движения с переходом от докритическо-
го («сверхзвукового») режима к закритическому
(«дозвуковому») вдоль ударных адиабат. Для рас-
сматриваемого здесь примера зависимость плот-
ности автомобилей (черная кривая № 1), отне-
сенной к ее максимально допустимым значениям
(пропускной способности первого участка), от ко-
ординаты xk, а также аналогичные распределе-
ния скорости (светло-серая кривая № 2) и пото-
ка (темно-серая кривая № 3) в один из момен-
тов времени показаны на рис. 10. Эти два рисун-
ка отчетливо демонстрируют, что закритический
(«синхронизированный») режим движения возни-
кает в рассматриваемой здесь сугубо детерминист-

Рис. 9. Черными точками 1 показаны зависимости ской модели в результате взаимодействия много-
q(t,xk) от ρ(t,xk), полученные в различные моменты численных волн разгона–торможения, возникаю-
времени t. Темно-серыми точками 2 показаны те же за-
висимости для участка дороги, на котором реализует- щих и распространяющихся на участках дороги
ся свободный («сверхзвуковой») поток. Тонкие светло- между локальными, замедляющими поток источ-
серые линии 3 характеристики первого семейства, никами (сужения дороги, пересечения с попереч-
темно-серые 4 — ударные адиабаты ными дорогами, различные замедляющие поток



ТРУДЫ МФТИ. — 2010. — Том 2, № 4 161
маневры, неоднородность состава автотранспорт- на входах в Садовое кольцо задавались постоян-
ных средств и стилей вождения и т.д.). ные значения потоков (33), полученные из данных

экспериментальных замеров, сделанных в 2005 г.
в центральной части г. Москвы, на выходах за-
давались неотражающие граничные условия (34).
В результате расчетов были получены стационар-
ные распределения потоков и скоростей движе-
ния автомобилей за 3-часовой интервал с момен-
та начала движения. Затем граф данной транс-
портной системы перестраивался так, чтобы дви-
жение по Садовому кольцу становилось односто-
ронним против часовой стрелки, и расчет про-
водился заново, стартуя с аналогичных исходных
данных по значениям транспортных потоков на
входах в транспортную сеть. В результате был по-

Рис. 10. Зависимости величин, отнесенные к макси- лучен эффект увеличения пропускной способно-
мальным значениям, от координаты xk: плотности сти транспортной сети на 30%, что может быть
автомобилей (черная кривая № 1); скорости (светло-
серая кривая № 2); потока (темно-серая кривая № 3) вполне объяснимо, если исходить из того, что ши-

рина дорог выросла в два раза при том, что сред-
ний пробег между любыми двумя точками увели-
чился меньше, чем вдвое из-за хорошей связности
графа транспортной сети внутри Садового коль-
ца. Результаты рассчитанных значений потоков
[АТС / с] приведены на рис. 12 слева для двусто-
роннего движения и справа для одностороннего.
Довольно подробный обзор по гидродинамиче-

ским моделям транспортных потоков имеется, на-
пример, в главах 2, 3 учебного пособия [18].
Работа поддержана грантами РФФИ

№ 10-07-00620-а, 08-01-00959-а, 08-07-00501-а,
08-07-00158-а, 10-07-00620-а, 11-01-00494-а, РГНФ
№ 08-02-00347, ПФИ ОМН РАН № 3, ПФИ Прези-
диум РАН П-2. Работа проведена в рамках реали-
зации ФЦП «Научные и научно-педагогические
кадры инновационной России» на 2009--2013 го-
ды.

Литература

Рис. 11. Граф Садового кольца г. Москвы: 105 узлов; 1. Kholodov A.S., Kholodov Y.A. Computational
212 ребер models on graphs for the nonlinear hyperbolic system

of equations // Proceedings of ASME 2004PVP
Conference. — 2004. — V. 476. — P. 161--167.
2. Kholodov Y. A, Kholodov A.S., Kovshov N.V.,

Simakov S.S., Severov D.S., Bordonos A.K.,
Bapaev A.Z. Computational models on graphs
for nonlinear hyperbolic and parabolic systems
of equations // Proceedings of the III European
Conference on Computational Mechanics. — 2006. —
P. 2279.1--2279.19.
3.Морозов И.И., Холодов Я.А.Моделирование

динамики транспортных потоков // Труды 51-й
Рис. 12. Результаты рассчитанных значений потоков научной конференции МФТИ «Современные про-
[АТС / с] на Садовом кольце г. Москвы: слева для блемы фундаментальных и прикладных наук». —
двустороннего движения; справа для одностороннего 2008. — Т. 2. — С. 128--129.
Для проверки работоспособности разработан- 4. Уизем Дж. Линейные и нелинейные вол-

ной вычислительной модели были сделаны чис- ны. — М.: Мир, 1977.
ленные расчеты поведения транспортной системы 5. Payne H.J. Models of freeway traffic and
города Москвы внутри графа Садового кольца, control. Mathematical Models of Public Systems //
имеющего 105 узлов и 212 ребер и представлен- Simulation Council Proc. 28. — 1971. — V. 1. —
ного на рис. 11. В начальный момент времени P. 51--61.



162 ТРУДЫ МФТИ. — 2010. — Том 2, № 4
6. Helbing D. Improved fluid: dynamic model for 14. Kerner B.S. and H. Rehborn. Experimental

vehicular traffic // Phys. Rev. E. — 1995. — V. 51. — Properties of Phase Transitions in Traffic Flow
P. 3163--3169. // Phys. Rev. Let. — 1997. — V. 79, N. 20. —
7. Aw A., Rascle M. Resurrection of «second P. 4030--4033.

order» models of traffic flow // SIAM Journal 15. Kerner B.S. Experimental Features of
of Applied Mathematics. — 2000. — V. 60. — Self–Organization in Traffic Flow // Phys. Rev.
P. 916–938. Let. — 1998. — V. 81, N. 20.
8. Greenberg J.M . Extensions and amplifications 16. Годунов С.К., Роменский Е.И. Элементы

of a traffic model of Aw and Rascle // SIAM J. Appl. механики сплошных сред и законы сохранения. —
Math. — 2001. — V. 62, N. 3. — P. 729--745. М.: Наука, 1998.
9. Zhang H.M. A non-equilibrium traffic model 17. Холодов А.С., Холодов Я.А. О критери-

devoid of gas-like behavior // Transp. Res. B. — ях монотонности разностных схем для уравнений
2002. — V. 36. — P. 275--290. гиперболического типа. // Журнал выч. матема-
10. Siebel F., Mauser W. Synchronized flow and тики и мат. физики. — 2006. — Т. 46, № 9. —

wide moving jams from balanced vehicular traffic // С. 1560--1588.
e-print arXiv: physics /0509124 v2, 2006. 18. Гасников А.В., Кленов С.Л., Нурмин-
11. Kerner B.S. Introduction to modern traffic ский Е.А., Холодов Я.А., Шамрай Н.Б. Введе-

flow theory and control. The long road to three — ние в математическое моделирование транспорт-
phase traffic theory. — Springer, 2009. ных потоков; учебное пособие. С приложениями
12. Kerner B.S. and H. Rehborn. Experimental Бланка М.Л., Гасниковой Е.В., Замятина А.А. и

features and characteristics of traffic jams // Phys. Малышева В.А., Колесникова А.В., Райгородско-
Rev. E. — 1996. — V. 53, N. 2. го А.М. — М.: МФТИ, 2010.
13. Kerner B.S. and H. Rehborn. Experimental

properties of complexity in traffic flow // Phys. Rev.
E. — 1996. — V. 53, N. 5. Поступила в редакцию 15.10.2010.