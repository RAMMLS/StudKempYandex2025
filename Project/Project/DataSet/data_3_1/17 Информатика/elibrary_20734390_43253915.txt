МАТЕМАТИЧЕСКИЕ МЕТОДЫ СИСТЕМНОГО АНАЛИЗА 
И УПРАВЛЕНИЯ

УДК 621.397: 004.032.26

МЕТОДЫ РАСПОЗНАВАНИЯ ЭЛЕМЕНТОВ ЗЕРНОВЫХ СМЕСЕЙ 
ПО РЕЗУЛЬТАТАМ ИЗМЕРЕНИЯ СПЕКТРАЛЬНЫХ 

ХАРАКТЕРИСТИК В СИСТЕМАХ СЕПАРАЦИИ 
РЕАЛЬНОГО ВРЕМЕНИ

Э. К. Алгазинов, М. А. Дрюченко, Д. А. Минаков, А. А. Cирота, В. А. Шульгин

Воронежский государственный университет

Поступила в редакцию 5.05.2013 г.

Аннотация. Рассматривается задача распознавания элементов зерновых смесей на основе 
измерения спектров люминесценции в интересах повышения эффективности потоковых сис-
тем фотосепарации. Для реализации процедур распознавания предложено использовать ней-
росетевые алгоритмы, а также алгоритмы, реализованные на основе машины опорных векторов. 
Исследуются характеристики эффективности распознавания с использованием предложенных 
алгоритмов.
Ключевые слова: методы распознавания образов, системы фотосепарации, нейросетевые ал-
горитмы распознавания, характеристики спектров люминесценции.
Annotation. The article considers the problem of recognition of elements of grain mixtures on the 
basis of measurements of the spectra of luminescence in the interests of increasing the efficiency 
of flow systems fotoseparation. For the realization of procedures of recognition is proposed to use 
a neural network algorithms and algorithms implemented on the basis of support vector machines. 
Explores the characteristics of efficiency of recognition using the proposed algorithms.
Keywords: recognition techniques, the system fotoseparation, neural network algorithms to rec-
ognize the characteristics of the luminescence spectra.

Введение и постановка задачи. Решение торах. Разделение объектов осуществляется на 
задачи распознавания и сортировки элементов основе анализа отраженного от их поверхности 
зерновых смесей в ходе обработки потока семян излучения в одном, двух или трех цветовых 
различного качества в системах сепарации ре- диапазонах. Наибольшую эффективность сепа-
ального времени возможно путем интеграции рации дает анализ отраженного света в несколь-
новейших достижений в области компьютерных ких цветовых диапазонах. В этом плане перс-
технологий, электроники, высокоскоростной пективные технологии сепарации могут быть 
регистрации и обработки видеоизображений. созданы при использовании оптического волок-
Одним из перспективных подходов для решения на для суммирования излучения различных 
указанной задачи является использование ме- лазерных источников. Заложенные в таком 
тодов глубокого спектрального анализа в соче- решении возможности управления спектраль-
тании с современными методами обработки ным составом зондирующего излучения сущес-
регистрируемых данных. Технология сепарации твенно расширяет функциональные возмож-
зерновых культур по их цветам реализована в ности фотосепараторов. 
так называемых «традиционных» фотосепара- Вместе с тем, в ряде случаев удаление чуже-

родных объектов-примесей в общем обрабаты-
© Алгазинов Э. К., Дрюченко М. А., Минаков Д. А., ваемом потоке зернового материала вызывает 

Cирота А. А., Шульгин В. А., 2013 затруднения, поскольку их цвет совпадает с 
Работа выполнена при поддержке гранта Минобрна- цветом объектов [1,2]. В этом случае можно 

уки РФ по программе «Развитие кооперации российских 
вузов и производственных предприятий» (Постановление расширить анализируемый спектральный диа-
Правительства № 218 от 09.04.2010 г. – 3 очередь, № 02. пазон либо в ИК область (преимущественно до 
G25.31.0002) 2,5 мкм), либо в рентгеновский диапазон элек-

ВЕСТНИК ВГУ, СЕРИЯ: СИСТЕМНЫЙ АНАЛИЗ И ИНФОРМАЦИОННЫЕ ТЕХНОЛОГИИ, 2013, № 2 9



Э. К. Алгазинов, М. А. Дрюченко, Д. А. Минаков, А. А. Cирота, В. А. Шульгин

тромагнитного излучения. Однако использова- на ячменя. Во второй группе хорошими объек-
ние спектральных особенностей объектов в ИК тами были зерна обрушенного овса, а плохими 
или в рентгеновском диапазоне сопряжено с – зерна необрушенного овса. При этом зерновки 
рядом трудностей, и, прежде всего, необходи- в каждой группе практически не отличаются по 
мостью привлечения существенно более доро- цвету.
гостоящей техники. Спектры люминесценции измерялись с ис-

Поэтому в этих случаях, по нашему мнению, пользованием экспериментальной установки, 
целесообразно применять метод люминесцент- созданной на базе волоконно-оптического 
ной спектроскопии. Действительно, например, спектрометра USB4000-VIS-NIR (350 – 
в работах [3,4] показана возможность разделе- 1050 нм) фирмы Ocean Optics; схема экспери-
ния здоровых семян сои от зараженных вирусом ментальной установки приведена на рис. 1. 
семян (вирусная мозаика сои). Оказалось, что Данная установка предназначена для регист-
интенсивность люминесценции белков, поли- рации люминесценции различных объектов 
фенолов и других веществ существенно зависит (твердых тел, порошков, растворов), и в том 
от их концентрации. А любое заболевание вы- числе семян и зерновых культур. Реализация 
зывает аномальное изменение структуры и данной оптической схемы [5,6] приводит к 
биохимического состава органических веществ существенному снижению потерь при прохож-
семян. Возможны перспективы применения дении излучения от источника люминесценции 
этого метода и для других зерновых культур. до спектрометра.
Таким образом, исследование спектров люми- В качестве источников возбуждения люми-
несценции позволит в ряде случае сформиро- несценции использовали лазерный диод, излу-
вать информативные признаки, на основе ко- чающий на длине волны 405 нм. Плотность 
торых возможно будет осуществить распозна- мощности излучения не превышала 20 мВт/
вание элементов здоровых и пораженных зер- см2, для того, чтобы исключить повреждение 
новых культур в видимом диапазоне в случае, зерновок. Для доставки возбуждающего излу-
если цвет хороших и дефектных элементов зер- чения и сбора сигнала люминесценции исполь-
новых смесей не отличается. зовалось кварцевое оптоволокно диаметром 

Целью работы является сравнительный 600 мкм (QP600, Ocean Optics). Возбуждающее 
анализ возможностей различных методов и люминесценцию излучение лазерного диода 
алгоритмов распознавания элементов зерновых вводилось в волокно с помощью коллиматора, 
смесей на основе измерения характеристик фокусирующей линзы и зеркальной поверх-
спектров люминесценции. Для проведения ности 4 призмы 1. Конструкция призмы 1 вы-
сравнительного анализа в ходе исследования полнена таким образом, чтобы минимизиро-
рассматривались нейросетевые алгоритмы рас- вать потери при разделении возбуждающего 
познавания и алгоритмы, реализующие метод излучения и излучения люминесценции. На 
машин опорных векторов, которые представля- передней части коллиматора устанавливались 
ют два базовых подхода для построения распоз- светофильтры Bandpass, вырезающие длинно-
нающих систем на основе обучения с «учите- волновую область излучения лазерных диодов. 
лем» по «прецендентам» (при отсутствии ста- Коллимированное излучение лазерного диода, 
тистической модели данных). после прохождения фокусирующей линзы 

Методика и результаты спектрального ана- проходит через плоскую грань внутрь делитель-
лиза. В качестве метода исследования объектов ной призмы 1 и отражается от зеркальной по-
зерновых смесей в данной работе использован верхности 4, нанесенной на ее светоотражаю-
метод люминесцентной спектроскопии. Для щую поверхность, размещенную внутри при-
управления спектральным комплексом исполь- змы. Отраженное от зеркальной поверхности 
зовалась лицензионная программа SpectraSuite, излучение выходит из призмы через плоскую 
которая представляет собой модульную про- грань и фокусируется на торце волновода 2.
граммную платформу для спектроскопии, осно- Введенное в волновод 2 излучение распро-
ванную на технологии Java. В качестве объектов страняется по нему и на выходе поглощается 
исследования были выбраны две группы зерно- исследуемой областью зерновки 3, контактиру-
вых смесей. В первой группе «хорошими» объек- ющей с торцом волновода. При этом излучение 
тами были зерна пшеницы, а «плохими» – зер- люминесценции зерновки вводится в тот же 

10 ВЕСТНИК ВГУ, СЕРИЯ: СИСТЕМНЫЙ АНАЛИЗ И ИНФОРМАЦИОННЫЕ ТЕХНОЛОГИИ, 2013, № 2



Методы распознавания элементов зерновых смесей...

самый волновод 2. Площадь облучения зерно- (QP600, Ocean Optics), для которого апертур-
вки и, следовательно, исследуемая область оп- ный угол является относительно большим. 
ределялась площадью сечения волновода и Вследствие этого на грань призмы попадает 
составляла 600 мкм. Геометрия оптической широкоапертурный пучок излучения люминес-
схемы экспериментальной установки выбрана ценции, который затем вводится в волновод 5 с 
таким образом, чтобы апертурный угол опти- помощью линзы и почти без потерь поступает 
ческого волновода 2, и, соответственно, аперту- на вход спектрофотометра 6, сопряженного с 
ра пучка излучения люминесценции в области компьютером 7. Часть излучения теряется 
делительной призмы 1 была существенно боль- вследствие отражения от зеркальной области 4, 
ше апертурного угла и апертуры светового но поскольку ее площадь минимальна по отно-
пучка в области призмы, вводимого в волновод шению к площади, ограниченной апертурой 
стимулирующего люминесценцию излучения. пучка люминесценции, проходящего через 
При этом апертура зеркального покрытия 4, призму, то эта составляющая незначительна. 
соответствующая апертуре пучка стимулирую- Таким образом, создана относительно простая, 
щего излучения, создана минимальной, что но в тоже время высокочувствительная компак-
позволяет лишь незначительной части энергии тная система, позволяющая регистрировать 
пучка люминесценции отразиться от зеркаль- спектры люминесценции с очень малых облас-
ной поверхности и не попасть в спектрометр. В тей в реальном масштабе времени.
результате излучение люминесценции анали- Измерения проводились в темноте в отсутс-
зируемых областей объектов вводится в волно- твие источников рассеянного света. По каждо-
вод с максимальной эффективностью и дости- му экземпляру зерновки было зафиксировано 
гается минимизация потерь излучения люми- около 200 спектров люминесценции. На рис. 2,а 
несценции. представлены усредненные спектры люминес-

Наряду с излучением люминесценции, по ценции зерен пшеницы и ячменя. Анализ всех 
волноводу 2 возвращается и часть стимулиру- спектров люминесценции свидетельствует о том, 
ющего излучения, отраженного от объекта 3. что интенсивность люминесценции зерен пше-
Эта составляющая излучения поглощается ницы варьируется в большем диапазоне по 
фильтрами Longpass, которые при этом пропус- сравнению с зернами ячменя, что говорит о 
кают излучение люминесценции исследуемых большей не однородности зерен пшеницы.
зерновок. Излучение люминесценции попадает На рис. 2,б. представлены усредненные 
на грань призмы, апертура которой согласована спектры люминесценции обрушенного и необ-
с апертурным углом волновода. Нами был вы- рушенного овса. Из рисунка видно, что спектры 
бран многомодовый оптический волновод люминесценции обрушенного (кривая 1) и 

Рис. 1. Экспериментальная установка для изучения спектров люминесценции

ВЕСТНИК ВГУ, СЕРИЯ: СИСТЕМНЫЙ АНАЛИЗ И ИНФОРМАЦИОННЫЕ ТЕХНОЛОГИИ, 2013, № 2 11



Э. К. Алгазинов, М. А. Дрюченко, Д. А. Минаков, А. А. Cирота, В. А. Шульгин

MLP (многослойный персептрон). Сеть имеет 
слой входных контактов, количество которых 
n  соответствует количеству используемых при-
знаков распознавания, формируемых на основе 
компонентов спектров люминесценции, полу-
ченных в ходе экспериментальных исследова-
ний. Использовалась сеть, имеющая два слоя 
нейронов, один из которых является скрытым 
и один – выходным слоем. Количество нейронов 
в скрытом слое m1  выбиралось из диапазона 
значений n £ m1 £ 2n + 1.  Поскольку рассмат-
ривались двухальтернативные задачи распоз-
навания объектов выходной (второй) слой со-
стоит из одного нейрона m2 = 1 , который фор-
мирует решение в виде rec = sign(y - 0.5),  где 
значения переменной rec , равные +1, соответс-
твуют первому классу объектов, а значения, 
равные –1, соответствуют второму классу объ-
ектов. Для обеспечения инвариантности обра-
ботки исходных данных – измеренных спектров 
люминесценции первоначально проводилась 
их нормировка по следующей формуле 

Ê N -1
ˆ

st = st¢ si¢ =
ËÁÂ ,  t 1,N ,  где st¢  – изначально 

i=1 ¯̃
регистрируемые значения спектральных ком-

 понентов; N  – количество спектральных ком-
понентов (N ª 3600 ), получаемы на установке 

Рис. 2. Спектры люминесценции пшеницы рис. 1.
(кривая 1) и ячменя (кривая 2) – (a). В рассматриваемой задаче распознавания 

Спектры люминесценции обрушенного овса использование всех 3600 спектральных состав-
(кривая 1) и необрушенного овса (кривая 2) ляющих, измеренных по каждому объекту яв-
и кончика обрушенного овса (кривая 3) – (б) ляется нецелесообразным. Более того, приме-

нение спектральных измерений для систем се-
необрушенного овса (кривая 2) представляют парации реального времени требует минимиза-
собой также составные полосы. Анализ всех ции размерности используемого набора спект-
спектров люминесценции свидетельствует о том, ральных признаков. Поэтому для снижения 
что интенсивность люминесценции зерен обру- размерности N  выполнялось «прореживание» 
шенного овса выше, чем необрушенных. Кроме исходных данных путем усреднения соседних 
того, для зерен необрушенного овса обнаруже- спектральных участков и формирование нового 
но, что люминесценция по всей площади зерна массива спектральных компонент sp  с исполь-
неоднородна. зованием полученных средних значений:

Исследование нейросетевых алгоритмов D s
s t

распознавания. С учетом анализа возможных p = Â , p = 1,n,
t=ind D

принципов применения нейронных сетей для Ê N ˆ
построения алгоритмов распознавания объек-  ind = floor p -

ËÁ
( 1) + 1,  (1)

тов, во многих случаях можно говорить о воз- n ¯̃
можности замены оптимальных статистических Ê ˆ

D = N
floor

ËÁ
p,

решающих правил их нейросетевыми эквива- n ¯̃
лентами. [7-12]. Для решения задачи распоз- где n < N  – итоговое количество спектральных 
навания объектов зерновых смесей в работе участков; floor()  – операция округления в 
использовалась нейронная сеть (НС) класса меньшую сторону.

12 ВЕСТНИК ВГУ, СЕРИЯ: СИСТЕМНЫЙ АНАЛИЗ И ИНФОРМАЦИОННЫЕ ТЕХНОЛОГИИ, 2013, № 2



Методы распознавания элементов зерновых смесей...

Обучающие и тестовые множества для НС- X = {x (a),x(a), ...,x (a)
m ,x (b)

1 2 1 , ...,x (b)
m }  и  Z = {z (a)

1 ,
классификатора формировались на основе по- z (a), ...,z (a)

m ,z (b), ...,z (b)
2 1 m },  где x (a)

i = (a
лученных нормированных и усредненных на- i,d +1,ai,d +2, ...,

a ( )
i,K ),x b

i = (b
боров измерений спектров люминесценции для i,d +1,bi,d +2, ...,bi,K ), x (b)

i = (bi,d +1,bi,d +2, ...,

«хороших» и «дефектных» экземпляров зерно- bi,K ),  i = 1,m;  z (a)
i = (+1.0,… + 1.0),  z (b)

i = (-1.0,…
вок, соответствующих двум классам исследуе-
мых зерновых смесей. Наборы измерений для - 1.0),  i = 1,m;  (K - d)  – длина вектора xi  и 

«хороших» и «дефектных» зерен обозначим как zi . Получаемые на выходе НС данные обозна-

A = {A чались как Y = {y1 ,y2 , ...,ym ,ym+1, ...,y2m}.  Сум-
1 ,A2 ,…Am}  и  B = {B1 ,B2 ,…Bm},  где 

A марная вероятность ошибки распознавания 
i = (a T

i,1,ai,2 …ai, )  и  Bi = (bi,1,bi,2 …b T
K i,K ) ,

объектов зерновой смеси для всех измерений 
i = 1,m  – векторы, каждый элемент которых вычислялась путем сравнения значений 
a = (s(a) y

1,s
(a)

2,…(a) T (
i,j i,j, i,j, si,j,n ) ,  b s b) s b b T

i,j = (i,j, , 
( )

1 i,j,2,…s( )
i,j,n ) ,  i = (yi,1,yi,2,…yi,K -d ),  i = 1, 2m  с соответствую-

щими значениями из целевого набора Z  по 
j = 1,K  содержит последовательность значений формуле
нормированных и усредненных спектров лю- Q
минесценции, измеренных для i -го образца ÂPi
каждого набора; K  – количество измерений для P = i=1

ош ,
одного образца (в рассматриваемой задаче Q
K = 300 ).  ÏÔ1, yi,j - zi,j < 1

Матрица обучающих данных НС определя- P =  
i Ì ,

лась в виде X = {x (a),x (a), ...,x (a),x (b) x (b) ÔÓ0, yi,j - zi,j ≥ 1
1 2 m 1 ,… m },  где 

x (a)
i = (ai,1,ai,2, ...,ai,d )  и  x (b)

i = (bi,1,bi,2, ...,bi,d ),  i = 1,2m; j = 1,K - d,

i = 1,m;  d  – длина вектора xi  (выбиралась Q = 2m(K - d).
равной K / 3 ). Значения векторов xi  далее На рис. 3а приведены зависимости вероят-
подавались на входы НС. Значения, ожидаемые ности ошибки распознавания объектов в зерно-
на выходе сети, определялись компонентами вых смесях «обрушенный – необрушенный 
целевой матрицы Z = {z (a), (a), ..., (a), (b) .. , (b)

1 z2 zm z1 , . zm },  овес» и «пшеница – ячмень» от количества ана-
г д е  z (a) (

i = (+1.0,… + 1.0),  z b)
i = (-1.0,… - 1.0),  лизируемых спектральных участков n . С уве-

i = 1,m.  Длина вектора zi  равна d . личением числа спектральных участков, учас-
Входные и целевые данные для тестирова- твующих в обучении НС, ошибка распознава-

ния обученной НС формировались в виде ния для смесей обоих типов значительно 

Рис. 3. Зависимость вероятности ошибочного распознавания объектов в зерновых смесях двух типов 
от количества анализируемых спектральных участков: 

a) – алгоритм на основе MLP; б) – алгоритм на основе SVM

ВЕСТНИК ВГУ, СЕРИЯ: СИСТЕМНЫЙ АНАЛИЗ И ИНФОРМАЦИОННЫЕ ТЕХНОЛОГИИ, 2013, № 2 13



Э. К. Алгазинов, М. А. Дрюченко, Д. А. Минаков, А. А. Cирота, В. А. Шульгин

уменьшается. Однако при этом возрастает ко- ральных участков. Так, для n = 50  НС, обучен-
личество используемых спектральных призна- ная для распознавания объектов в смеси «обру-
ков, что может отрицательно отразиться на шенный – необрушенный овес», позволяет 
пропускной способности системы распознава- обеспечить вероятность распознавания объек-
ния. Приемлемые значения количества анали- тов в присутствии искажений (СКО s = 0.1 ) с 
зируемых спектральных участков должны оп- ошибкой менее 0.25 %. В то же время, для сме-
ределяться на компромиссной основе с учетом си «пшеница – ячмень» существенного сниже-
практической реализуемости датчика и обеспе- ния вероятности ошибки при увеличении числа 
чения требуемой вероятности ошибки распоз- спектральных участков не наблюдается, что 
навания. связано с худшей сепарабельностью исходных 

Для исследования устойчивости нейросе- данных соответствующей зерновой смеси. На 
тевого алгоритма распознавания к возможному рис. 4,б вероятность ошибки для пшеницы в 
искажению входных данных проводилось ис- несколько раз больше чем для овса на не зашум-
кусственное «зашумленние» тестовых наборов ленных данных, так как форма усредненных 
спектральных участков X  путем добавления спектров люминесценции пшеницы-ячменя 
к ним гауссовских возмущений с заданной практически идентичная (на рис. 2 они разли-
СКО s. чаются в основном по уровню). Однако для 

На рис. 4 а,б представлены зависимости разных образцов зерна эти уровни меняются 
вероятности ошибочного распознавания объек- достаточно существенно. В этих условиях вы-
тов в смесях двух типов от количества анализи- полняемая предварительная нормировка может 
руемых спектральных участков n  и СКО искус- даже несколько ухудшить результат распозна-
ственно вносимых гауссовских искажений s . вания. Поэтому можно предложить рассмотреть 
С увеличением СКО искажения s  возрастает возможность использования в качестве обуча-
процент ошибочно распознанных объектов – в ющих и тестовых данных данные, получаемые 
большей степени для смеси «обрушенный – не- в поддиапазоне заданной ширины, например, 
обрушенный овес» (с 0.0025 до 0.034 при для смеси «пшеница-ячмень» l = 480…580,  для 
n = 10 ), и в меньшей для смеси «пшеница – яч- смеси «овес» l = 480…630.
мень» (с 0.033 до 0.086 при n = 10 ). В рамках Анализ полученных результатов позволяет 
предложенного подхода к распознаванию сделать вывод о том, что нейросетевые алгорит-
уменьшить влияние возмущений можно путем мы позволяют потенциально обеспечить доста-
увеличения количества анализируемых спект- точно высокую достоверность распознавания с 

Рис. 4. Зависимость вероятности ошибочной распознавания объектов в зерновых смесях 
«обрушенный – необрушенный овес» (а) и «пшеница – ячмень» (б) 

от количества анализируемых спектральных участков и СКО вносимых возмущений

14 ВЕСТНИК ВГУ, СЕРИЯ: СИСТЕМНЫЙ АНАЛИЗ И ИНФОРМАЦИОННЫЕ ТЕХНОЛОГИИ, 2013, № 2



Методы распознавания элементов зерновых смесей...

вероятностями ошибки порядка 0.1 % и 0.5 % строит классифицирующую функцию F  в виде 
для зерновых смесей первого и второго типа F(s) = sign ( w,s + b0 ).  Объекты, для которых 
соответственно. Для учета возможных неспеци- F(s) = 1  попадают в один класс, а объекты с 
фических особенностей, возникающих в изме- F(s) = -1  – в другой.
ренных спектрах люминесценции, связанных с Пусть s-  и s+  – две точки из различных 
естественной изменчивостью объектов в рамках классов, имеющие наименьшее расстояние от 
одной или нескольких выборок, возможно осу- разделяющей гиперплоскости до ближайшей 
ществить процедуру дообучения НС с исполь- точки соответствующего одноименного класса. 
зованием новых данных или обучить другую НС Считается, что s-  и s+  лежат на границе «раз-
без принципиального изменения схемы работы деляющей» полосы, ширина которой определя-
самого алгоритма распознавания. ется как (s- + s+) . Задача оптимального разде-

Исследование алгоритмов распознавания ления в этом случае сводится к поиску «опор-
на основе машин опорных векторов. Альтер- ных» векторов и гиперплоскостей, ближайших 
нативным подходом к распознаванию объектов, к опорным векторам двух классов и параллель-
который рассматривался в рамках данного ис- ных оптимальной разделяющей гиперплоскос-
следования, является использование метода ти. Несложно показать, что эти гиперплоскости 
машин опорных векторов (SVM, support vector могут быть описаны уравнениями:
machine). Метод SVM часто позволяет обеспе-

 w,si + b
чить хорошее качество распознавания, работая 0 = 1  

(3)
с абстрактной векторной моделью представле- для ki = +1  и w,si + b0 = -1  дляki = -1.  
ния данных [13].

В случае если обучающая выборка линейно 
Будем рассматривать задачу распознавания 

разделима, то гиперплоскости выбираются та-
элементов зерновых смесей как бинарную: т.е. 

ким образом, чтобы между ними не лежала ни 
каждый распознаваемый объект принадлежит 

одна точка обучающей выборки, а затем рассто-
только одному из двух классов – «нормальных» 

яние между гиперплоскостями (разделяющая 
и «дефектных» зерновок. Объекты, как и ранее, 

полоса M  на рис. 5) максимизируется. Для 
описываются измеренными спектрами люми-

векторов принадлежащих различным классам 
несценции и представляются как векторы (точ-

справедливы следующие ограничения:
ки) в n -мерном пространстве. В простейшем 
случае задача разделения векторов по прина-  w,si + b0 ≥ +1  

(4)
длежности к одному из двух классов сводится к для ki = +1 , w,si + b0 £ -1  для ki = -1  
задаче поиска разделяющей гиперплоскости 
(размерности n - 1). Очевидно, что вариантов Точки, удовлетворяющие неравенству (4), 
таких гиперплоскостей может быть много, поэ- лежат на границе полосы H1  с нормалью w  и 
тому при реализации метода SVM полагают, что перпендикуляром из начала координат 
максимизация зазора между классами способс- 1 - b0 / w ,  а точки, удовлетворяющие нера-
твует более уверенной классификации. Такая венству (5), лежат на границе полосы H2  с 
гиперплоскость называется оптимальной раз- противоположной нормалью w  и перпендику-
деляющей гиперплоскостью. Обозначим обуча- ляром из начала координат -1 - b0 / w .  Таким 
ющие данные в виде {s образом, s- = s+ = 1 / w  и ширина полосы 

i ,ki },  i = 1,n,  ki Œ{-1, +1},  
si   – элементы массива усредненных спектраль- разделения равна 2 / w  [13]. Построение оп-
ных компонент из (1). Предположим, что име- тимальной разделяющей гиперплоскости сво-
ется гиперплоскость, разделяющая данные двух дится к задаче квадратичного программирова-
классов (положительные и отрицательные). ния, т.е. минимизации квадратичной формы 
Точки s при n  ограничениях-неравенствах относитель-

i , лежащие на гиперплоскости, удовлет-
воряют условию но переменных w , b0 :

 w,s + b0 = 0,  (2) ÏÔ w,w Æ min
где w  – перпендикуляр к разделяющей гипер-  Ì  (5)

ÓÔki ( w,si - b0 ) ≥ 1, i = 1,n.
плоскости, ,  – скалярное произведение, b0  – 
вспомогательный параметр, b0 / w  – перпен- По теореме Куна–Таккера [14] эта задача 
дикуляр к гиперплоскости, опущенный из на- эквивалентна двойственной задаче поиска сед-
чала координат. Метод опорных векторов ловой точки функции Лагранжа:

ВЕСТНИК ВГУ, СЕРИЯ: СИСТЕМНЫЙ АНАЛИЗ И ИНФОРМАЦИОННЫЕ ТЕХНОЛОГИИ, 2013, № 2 15



Э. К. Алгазинов, М. А. Дрюченко, Д. А. Минаков, А. А. Cирота, В. А. Шульгин

Рис. 5.

ÏL(w,b0, l) = 0.5 w,w + мизацией суммарной ошибки. Функция Лаг-
Ô ранжа для данной задачи имеет вид

n
Ô
Ô+Â li (ki ( w,si - b0 ) - 1) Æ min max, L(w,b0,x, l,h) = 0.5 w,w -

w,b l
i=1 0

Ô n
 Ì li ≥ 0, i = 1,n,  (6)  -Â l

Ô i (ki ( w,si - b0 ) - 1) -  
i=1

Ô li = 0 8; 8 ki ( w,si - b0 ) = 1, i = 1,n, n

Ô -Âxi (li + hi -C ),
Ô i=1
Ó где h = (h1,…hn )  – вектор переменных, двойс-

где l = (l твенных к x = (x1,…xn ).1,…ln )  – вектор двойственных пере-
менных [14]. Еще один путь решения линейно неразде-

На практике случаи линейной разделимости лимых задач заключается в следующем. Все 
данных гиперплоскостью достаточно редки. элементы обучающей выборки вкладываются в 
Чаще приходится классифицировать линейно пространство H  более высокой размерности с 
неразделимые объекты, (и анализируемые зер- п о м о щ ь ю  с п е ц и а л ь н о г о  о т о б р а ж е н и я 

j : Rn
новые объекты здесь не являются исключени- Æ H .  Если пространство H  имеет доста-
ем). Для обобщения алгоритма SVM на случай точно высокую размерность, то высока вероят-
линейной неразделимости, вводится допущение ность, что в нем выборка окажется линейно 
появления незначительного количества ошибок разделима. В пространстве H  вектора призна-
на обучающих объектах, что позволяет смягчить кового описания объектов si  заменяются на 
ограничения (4,5). Задается набор дополни- вектора j(si ) , а само построение машины опор-
тельных переменных xi ≥ 0,  характеризующих ных векторов проводится аналогично описан-
величину ошибки на классифицируемых объ- ному выше [15]. Классифицирующая функция 
ектах si , i = 1,n . Если xi = 0 , то на si  ошибки F  п р и  э т о м  п р и н и м а е т  в и д 
нет, если 0 < xi < 1,  значит объект si  попадает F(s) = sign( w,j(s) + b0).  В ы р а ж е н и е 
внутрь разделяющей полосы но корректно клас- krnl(s,s¢) = j(s),j(s¢)  называется ядром клас-
сифицируется машиной опорных векторов, если сификатора. С математической точки зрения 
же xi > 1 , то считается, что на объекте si  допус- ядром может служить любая положительно 
кается ошибка [15]. С введенными допущени- определенная симметричная функция двух 
ями система (7) перепишется в виде: переменных. Положительная определенность 

Ï n необходима для того, чтобы соответствующая 
Ô0.5 w,w +CÂx функция Лагранжа в задаче оптимизации была 

i Æ min,
Ô w,b

i 1 0 ,x
Ô = ограничена снизу, т.е. задача оптимизации была 

 Ìki ( w,si - b0 ) ≥ 1 - xi , i = 1,n,  бы корректно определена. От выбора ядра зави-
Ô
Ôxi ≥ 0, i = 1,n сит точность классификатора. На практике 

ÓÔ
чаще всего используютj  следующие ядра: 
krnl(s,s¢) = ( s,s¢ + const )  – полиномиальные 

где C  – «управляющий» параметр метода, ко- 2 2
- s-s¢ 2s

торый позволяет находить компромисс между и krnl(s,s¢) = e rbf , srbf > 0  – радиальные 
максимизацией разделяющей полосы и мини- базисные функции.

16 ВЕСТНИК ВГУ, СЕРИЯ: СИСТЕМНЫЙ АНАЛИЗ И ИНФОРМАЦИОННЫЕ ТЕХНОЛОГИИ, 2013, № 2



Методы распознавания элементов зерновых смесей...

При проведении экспериментальных иссле- модели с большим srbf  будут плохо распозна-
дований алгоритмов распознавания элементов вать объекты даже по обучающей выборке, в то 
в зерновых смесях двух типов по алгоритму время как слишком сложные модели, хорошо 
SVM использовались встроенные функции распознающие обучающие данные, будут с 
пакета технических вычислений Matlab R2010 большими ошибкам отрабатывать на тестовых 
svmtrain() и svmclassify(). На рис. 3б приведе- выборках. Характер приведенных на рис. 3б 
ны зависимости вероятности ошибочного рас- зависимостей для метода SVM существенно 
познавания объектов методом опорных векторов отличается от зависимостей, полученных для 
в смесях «обрушенный – необрушенный овес» нейросетевого алгоритма.
и «пшеница – ячмень» от количества анализи- Для srbf = 0.5  минимальные вероятности 
руемых спектральных участков n . Измерения ошибки распознавания (порядка 0.3 % для 
были выполнены по «прореженным» спектрам обеих зерновых смесей) наблюдаются при 
люминесценции. На данном графике приведены n = 5 . Увеличение n  приводит к резкому уве-
по две кривые для зерновой смеси каждого типа, личению процента ошибок распознавания. Так, 
полученные при различных значениях пара- при n = 30  вероятность ошибочного распозна-
метра функции ядра – srbf .  Сразу следует отме- вания элементов в смеси «обрушенный – необ-
тить, что изменение данного параметра оказы- рушенный овес» превышает 3 %, а для смеси 
вает непосредственное влияние на сложность «пшеница – ячмень» – 4 %. Для SVM модели с 
формы получаемой разделяющей границы. меньшим числом опорных векторов (srbf = 1 ) 
В общем случае увеличение srbf  сопровождает- при n £ 30  средняя вероятность ошибочного 
ся уменьшением числа опорных векторов и распознавания составляет порядка 0.3 % и 
упрощением модели, уменьшение же srbf  уве- 0.2 % для смесей «обрушенный – необрушен-
личивает количество опорных векторов и ус- ный овес» и «пшеница – ячмень» соответствен-
ложняет модель. Работа с реальными данными но. Дальнейшее увеличение размерности при-
спектров зерновых объектов разной степени знакового описания снижает общую достовер-
однородности предполагает некоторый компро- ность распознавания. Сравнение точности 
мисс между сложностью модели и качеством распознавания объектов при различных значе-
классификации данных. Слишком простые ниях n  для НС и SVM дает следующие резуль-

Рис. 6. Зависимости вероятности ошибочного распознавания объектов в зерновых смесях 
«обрушенный – необрушенный овес» (а) и «пшеница – ячмень» (б) от количества анализируемых 
спектральных участков, СКО вносимых гауссовских возмущений и параметра функции ядра srbf

ВЕСТНИК ВГУ, СЕРИЯ: СИСТЕМНЫЙ АНАЛИЗ И ИНФОРМАЦИОННЫЕ ТЕХНОЛОГИИ, 2013, № 2 17



Э. К. Алгазинов, М. А. Дрюченко, Д. А. Минаков, А. А. Cирота, В. А. Шульгин

таты. Для смеси «обрушенный – необрушенный нейронных сетей всегда существует возможность 
овес» при n £ 20  метод опорных векторов осуществления процедуры их дообучения с ис-
( srbf = 1 )  о к а з ы в а е т с я  э ф ф е к т и в н е е  с пользованием новых данных или обучения новой 
Pош ª 0.2% , при n > 20  лучшую эффективность сети без принципиального изменения схемы 
показывает нейросетевой алгоритм с Pош < 0.1% . работы самого алгоритма распознавания. Также 
Для смеси «пшеница – ячмень» при n £ 35  следует отметить возможность повышения ка-
метод опорных векторов (srbf = 1 ) оказывается чества распознавания объектов по измеренным 
эффективнее с Pош ª 0.25% , при n > 35  луч- спектрам за счет увеличения размерности пред-
шую эффективность показывает нейросетевой ставления входных данных.
алгоритм с Pош < 0.3% . При исследовании применимости метода 

Для исследования устойчивости алгоритма SVM в качестве его преимущества по сравнению 
распознавания на основе метода опорных век- с нейросетевым подходом является возможность 
торов к возможному искажению входных дан- достижения малых ошибок при небольшой 
ных, аналогично проводилось искусственное размерности исходного признакового про-
«зашумленние» тестовых наборов спектральных странства. В тоже время следует отметить отно-
участков. Результаты оценки вероятности сительно более существенное снижение досто-
ошибки распознавания объектов в смесях двух верности распознавания на основе SVM при 
типов в присутствии гауссовских искажений возникновении шумовых искажений.
приведены на рис. 6. С увеличением количества СПИСОК ЛИТЕРАТУРЫ
анализируемых спектральных участков в при-

1. Satake S., Ito T., Ikeda N. Cereal grain color 
сутствии искусственных искажений наблюда- sorting apparatus // US Patent 5,638,961. Jun. 17, 
ется неприемлемый рост процента ошибок 1997.
распознавания (при s = 0.01  Pош > 20%  для 2. Satake S., Ito T., Ikeda N. Color sorting appara-
смеси «обрушенный – необрушенный овес» и tus for grains // US Patent 5,779,058. Jul. 14, 1998.
Pош > 15%  для смеси «пшеница – ячмень»), 3. Трубицын А.Г. Способ выделения здоровых 
обуславливаемый прежде всего характером семян сои // Патент RU №1205330. 1994 г.
исходных данных (схожестью признаковых 3. Трубицын А.Г. Устройство для отбора здоровых 
описаний для объектов различных классов, семян сои // Патент RU №1695840.
полученных по усредненным спектрам люми- 5. Сарычева И.Н., Янушевич О.О., Минаков Д.А. 

несценции). и др. // Российская стоматология. – 2012. – № 3. – 
С. 50–56.

Вне зависимости от числа анализируемых 6. Сарычева И.Н. Янушевич О.О., Минаков Д.А. 
спектральных участков и значения параметра и др. // РФ Патент №: 2464549. – 2011. – С. 1–6.
функции ядра srbf , приемлемые вероятности 7. Ефименко В.С. Применение нейронных сетей 
ошибки распознавания фиксируются алгорит- в задачах оптимальной фильтрации / В.С. Ефимен-
мом лишь в отсутствие искусственно вносимых ко, В.Н. Харисов, Е.Г. Стребков // Радиотехни-
возмущений, из чего можно сделать вывод о ка. – 2000, № 7. – С. 56–61.
нецелесообразности использования данного 8. Сирота А.А. Нейросетевые и статистически 
алгоритма распознавания возможности появ- оптимальные алгоритмы принятия решений в зада-
ления существенных помеховых искажений чах высокоточной координатометрии и обработки 

данных спектральных измерений. изображений / А.А. Сирота, Э.А. Кирсанов, 
О.В. Маслов // Сборник трудов III Международной 

В целом анализ полученных результатов конференции «Идентификация систем и задачи 
позволяет сделать вывод о том, что рассмотрен- управления» – М.: Институт проблем управления 
ные алгоритмы позволяют потенциально обес- им. В.А. Трапезникова РАН, 2004. – С. 1629–1652.
печить достаточно высокую достоверность рас- 9. Кирсанов Э.А. Обработка информации в про-
познавания элементов в исследованных зерно- странственно-распределeнных системах радиомони-
вых смесях. Достоинством нейросетевого алго- торинга: статистичекий и нейростевой подходы / 
ритма является его большая устойчивость к Э. А. Кирсанов, А.А. Сирота. – М.: ФИЗМАТЛИТ, 
возможным неспецифичным изменениям харак- 2012, 344 c.
тера входных данных спектров люминесценции 10. Татузов А.Л. Нейронные сети в задачах ра-

и отражения, связанных с естественной измен- диолокации / А.Л. Татузов. – М.: Радиотехника, 
2009. – 432 с.

чивостью объектов в рамках одной или несколь- 11. Перов А.И. Особенности синтеза устройств 
ких выборок. При использовании искусственных обнаружения и оценки параметров сигнала нейро-

18 ВЕСТНИК ВГУ, СЕРИЯ: СИСТЕМНЫЙ АНАЛИЗ И ИНФОРМАЦИОННЫЕ ТЕХНОЛОГИИ, 2013, № 2



Методы распознавания элементов зерновых смесей...

сетевыми методами / А.И. Перов, Г.Г. Соколов // 13. Ларин Р.М. Методы оптимизации. Примеры 
Радиотехника. – 2001, № 7. – С. 22–29. и задачи / Р.М. Ларин, А.В. Плясунов, А.В. Пяткин 

12. Фролов И.И. Построение классификатора на // Учеб. пособие. Новосиб. ун-т., 2003, – 115 с.
основе машины опорных векторов для распознава- 14. Scholkopf B. Advances in Kernel Methods. Sup-
ния символов / И.И. Фролов, Р.Х. Садыхов. // До- port Vector Learning / B. Scholkopf, C.J.C. Burges, 
клады БГУИР . – 2008, № 1. – С. 103–108. A.J. Smola // MIT Press, Cambridge, USA, 1998, – 

376 p.

Алгазинов Э. К. – д. ф.-м. н., профессор, Algazinov E. K. – doctor of Physics-math. 
заведующий кафедрой Информационных сис- Sciences, Professor of the dept. of the Information 
тем, факультета компьютерных наук, Воронеж- Systems, Voronezh State University, Tel. 
ский государственный университет. Тел. (4732)208-724. Email: algazinov@cs.vsu.ru
(4732)208-724. Тел. (4732)208-724. Email: al-
gazinov@cs.vsu.ru 

Dryuchenko M. A. – Candidat of Technical 
Дрюченко М. А. – к. т. н., ассистент кафед- Sciencies, Assistant Professor, Chair of 

ры технологий обработки и защиты информа- Information Processing and Security Technologies, 
ции ВГУ. Email: m_dryuchenko@mail.ru Voronezh State  University.  Email :  m_

dryuchenko@mail.ru

Минаков Д. А. – к. ф.-м. н., доцент кафедры Minakov D. A. – Candidat of Physics-math. 
физики и химии, Военный учебно-научный Sciences, Associate Professor, Department of 
центр Военно-воздушных сил «Военно-воздуш- Physics and Chemistry, MESC of the Air Force 
ная академия имени профессора Н.Е. Жуковс- «Force Academy named after Professor Zhu-
кого и Ю.А. Гагарина» (г. Воронеж). kovsky and Gagarin».

Сирота Александр Анатольевич – д. т. н., Sirota A. A. – Doctor of Technical Sciencies, 
профессор, заведующий кафедрой Технологий Professor, Department of Processing technology 
обработки и защиты информации, факультета and information security, Voronezh State 
компьютерных наук, Воронежский государс- University. E-mail:sir@cs.vsu.ru
твенный университет. E-mail: sir@cs.vsu.ru

Шульгин В. А. – к. т. н., старший научный Shulgin V. A. - Senior Researcher, Chair of 
сотрудник кафедры информационных систем Information Systems, Voronezh State University.
ВГУ.

ВЕСТНИК ВГУ, СЕРИЯ: СИСТЕМНЫЙ АНАЛИЗ И ИНФОРМАЦИОННЫЕ ТЕХНОЛОГИИ, 2013, № 2 19