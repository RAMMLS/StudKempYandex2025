http://www.computeroptics.ru http://www.computeroptics.smr.ru 

Сравнение алгоритмов выделения области интереса  
на компьютерных томограммах легких 

Т.А. Пашина 1, А.В. Гайдель 1,2, П.М. Зельтер 3, А.В. Капишников 3, А.В. Никоноров 1,2 
1 Самарский национальный исследовательский университет имени академика С.П. Королёва, 

443086, Россия, г. Самара, Московское шоссе, д. 34, 
2 ИСОИ РАН – филиал ФНИЦ «Кристаллография и фотоника» РАН,  

443001, Россия, г. Самара, ул. Молодогвардейская, д. 151, 
3 ФГБОУ ВО «Самарский государственный медицинский университет» Минздрава России, 

443099, Россия, г. Самара, ул. Чапаевская, д. 89 

Аннотация 

Рассматривается автоматическое создание масок для выделения лёгких на компьютерных 
томограммах с помощью трёх подходов: метода Оцу, простой свёрточной нейронной сети, 
состоящей из 10 одинаковых слоёв, и свёрточной нейронной сети U-Net. Произведено иссле-
дование и сравнение используемых методов автоматического выделения области интереса на 
реальных изображениях компьютерной томографии лёгких, полученных в Клиниках СамГ-
МУ. Решение данной задачи актуально, так как она является первым этапом при автоматизи-
рованном поиске патологических изменений на изображениях компьютерной томографии. 
Предложен алгоритм постобработки изображений, основанный на поиске контуров, который 
позволяет повысить качество сегментации. Сделан вывод о том, что U-Net выделяет область 
интереса, относящуюся к легкому, несколько лучше, чем два других подхода. При этом про-
стая свёрточная нейронная сеть обеспечивает достоверность сегментации 97,5 %, что лучше 
достоверности сегментации 96,7 %, достигнутой с помощью метода Оцу, и лучше достовер-
ности сегментации 96,4 %, достигнутой с помощью нейронной сети U-Net. 

Ключевые слова: обработка изображений, сегментация, компьютерная томография лёг-
ких, пороговая обработка, свёрточные нейронные сети, U-Net. 

Цитирование: Пашина, Т.А. Сравнение алгоритмов выделения области интереса на ком-
пьютерных томограммах лёгких / Т.А. Пашина, А.В. Гайдель, П.М. Зельтер, А.В. Капишни-
ков, А.В. Никоноров // Компьютерная оптика. – 2020. – Т. 44, № 1. – С. 74-81. – DOI: 
10.18287/2412-6179-CO-659. 

Citation: Pashina TA, Gaidel AV, Zelter PM, Kapishnikov AV, Nikonorov AV. Automatic 
highlighting of the region of interest in computed tomography images of the lungs. Computer Op-
tics 2020; 44(1): 74-81. DOI: 10.18287/2412-6179-CO-659. 

Одним из важных этапов автоматизированного 
Введение 

анализа медицинских изображений является выделе-
В настоящее время в медицине широко использу- ние области интереса (сегментация). Довольно часто 

ются такие методы лучевой диагностики, как компь- требуется отделить некоторые участки или объекты 
ютерная томография и магнитно-резонансная томо- на медицинских изображениях, представляющие ин-
графия для исследования состояния внутренних орга- терес, от других частей изображения для более де-
нов человека. С помощью таких методов врачи могут тального исследования. Следовательно, анализ выде-
получать довольно большой объём информации в ви- ленной области во многом зависит от того, насколько 
де изображений или даже видеопотоков, который по- точно была произведена сегментация. 
могает сделать более точный и качественный анализ Сейчас написано достаточное количество работ о 
полученных данных о пациенте. сегментации, однако сравнение работы нейронной 

Компьютерная томография лёгких с высокой точ- сети с более традиционными методами выделения 
ностью визуализирует структуры, которые не разли- области интереса на изображениях компьютерной 
чаются при флюорографии и рентгенографии лёгких. томографии лёгких не проводилось. Например, в [2] 
Она позволяет определять наличие и распространён- был разработан метод автоматического выделения 
ность опухолей, патологию внутригрудных лимфо- области интереса на изображениях компьютерной 
узлов, патологические изменения в плевральной по- томографии лёгких, при которой лучше всего рабо-
лости и лёгочной ткани, а также состояние сосудов, тает последующая классификация изображений, а в 
трахеи и бронхов. Такие результаты достигаются бо- [3, 4] представлены алгоритмы автоматической сег-
лее высоким пространственным разрешением, в ре- ментации долей лёгкого. В [4] для этой же задачи 
зультате чего можно делать мультипланарные рекон- был достигнут результат достоверности сегментации 
струкции, и возможностью измерения плотности [1].  в 74 – 80 %. 

74 Computer Optics, 2020, Vol. 44(1) DOI: 10.18287/2412-6179-CO- 659 



Сравнение алгоритмов выделения области интереса на компьютерных томограммах легких Пашина Т.А. и др. 

В работе [5] рассматривается проблема автомати- Чтобы определить нужное значение порога для 
ческого выделения лёгких на изображениях компью- каждого изображения, в данной работе используется 
терной томографии при наличии патологий, искажа- метод Оцу. Применяемый метод базируется на дан-
ющих границы лёгких и нарушающих резкость этих ных гистограммы исходного изображения. 
границ. Авторы работы предлагают алгоритм выде- Имеется два класса – объект и фон. Суть данного 
ления паренхимы лёгкого, основанный на пороговой метода заключается в том, чтобы минимизировать 
обработке с итеративным подбором порога, однако внутриклассовую дисперсию 2

(t)  [11], вычисляе-
количественные показатели эффективности предло- мую по формуле (2):  
женного подхода в работе не приводятся. 

2 2 2
В [6] предлагается использовать нейронную сеть (t)  q1(t)1 (t)q2 (t)2 (t) , (2) 

U-Net для этой же задачи, что позволяет авторам до- где  
стичь F-меры качества сегментации в 95 %. В [7] ав-
торы предлагают для той же задачи подход, основан- t I n

q1 P(i); q2 (t)   P(i); P(i)  i ;  
ный на модели активных контуров, что позволяет им i1 it1 N
получить 99 % процентов достоверности сегментации t iP(i) I iP(i)
на изображениях из открытой базы LIDC-IDRI [8]. 1(t)  ; 2(t)   ;

Целью данной работы является исследование и i1 q1(t) it1 q2(t)
 

t
2 2 P(i) I

сравнение некоторых методов автоматического выде- 2 2 P(i)
1 (t) [i 1(t)] ; 2(t)  [i 2(t)] ;

ления области интереса на изображениях компьютер- i1 q1(t) it1 q2(t)
ной томографии лёгких, полученных в Клиниках Са-
марского государственного медицинского универси- ni – число пикселей с яркостью i, N – общее число 
тета, так как для исследования различных алгоритмов пикселей, I – максимальное значение яркости. 
автоматизированной диагностики медицинским ра- Свёрточные нейронные сети 
ботникам приходится вручную выделять область ин-
тереса, что занимает много времени. Например, в ра- В настоящее время большую популярность наби-
боте [9] предлагается метод автоматизированной диа- рают свёрточные нейронные сети. Входными данны-
гностики эмфиземы по компьютерным томограммам ми свёрточной нейронной сети в данной работе яв-
лёгких, однако область лёгкого на первом этапе рабо- ляются изображения. Сеть состоит из некоторой по-
ты предложенного метода предлагается выделять следовательности слоёв, которые, в свою очередь, 
вручную. Таким образом, сегментация объектов явля- состоят из нейронов, расположенных в трёх измере-
ется важной и актуальной технологией для систем ав- ниях: ширине, высоте и глубине. Для создания 
томатизированной медицинской диагностики. нейронной сети в работе использовалось три типа 

слоёв: свёрточный слой, слой пулинга и полносвяз-
1. Методы сегментации ный слой. 
Пороговая обработка Известны различные архитектуры нейронных се-

Задача сегментации заключается в разбиении тей. Особого внимания для рассматриваемой задачи 
множества отсчётов изображения на несколько под- достойны SegNet, CardiacNet и U-Net. В работе [12] 
множеств, соответствующих определённым сегмен- с помощью данных нейронных сетей была произве-
там изображения. В качестве такой характеристики, дена сегментация различных медицинских изобра-
которой отличаются сегменты изображения, может жений. Самой популярной на данный момент архи-
выступать средняя яркость. Самым простым и часто тектурой для сегментации медицинских изображе-
применяемым видом сегментации является бинарная ний является U-Net. 
сегментация, когда имеется только два типа однород- U-Net была создана специально для сегментации 
ных участков: объект и фон. биомедицинских изображений [13]. Данная архитек-

В этом случае для выделения области интереса ис- тура позволяет достичь высоких результатов, исполь-
пользуется пороговая обработка. Пороговая обработка зуя малое количество данных, что идеально подходит 
ориентирована на работу с изображениями, отдельные для задачи данной работы. 
однородные участки которых различаются средней яр- Архитектура сети U-Net состоит из двух частей. 
костью. Суть данного способа заключается в использо- Первая часть состоит из линейной последовательно-
вании такого порога t, что каждый пиксель изображения сти слоёв свёртки с функцией активации ReLu (3): 
x (i1, i2) преобразовывается в y (i1, i2) по правилу [10]: 

f (x)  max(0, x),  (3) 
y , приx(i ,i )  t,

y(i 0 1 2
1,i2 )    (1) 

y , приx(i ,i )  t. и следующего за ними слоя пулинга, который умень-
1 1 2

шает размерности сформированных карт признаков в 
По формуле (1), в зависимости от значения пикселя два раза. Полученный результат каждого блока со-
изображения, пиксель относят либо к фону y0, либо к храняется с целью подачи этих карт признаков на 
объекту y1. вход второй части свёрточной нейронной сети. Вто-

Компьютерная оптика, 2020, том 44, №1 DOI: 10.18287/2412-6179-CO-659 75 



http://www.computeroptics.ru http://www.computeroptics.smr.ru 

рая часть состоит из последовательности слоёв об- 3. Выделение области интереса  
ратной свёртки, объединения, свёртки, и слоя актива- с помощью метода Оцу 
ции с функцией ReLu (3). Следует обратить внима-

Сегментация лёгких является сложной задачей 
ние, что в данной части происходит объединение карт 

ввиду наличия объектов, сложных для выявления на 
признаков только одного размера. В конце добавляет-

изображении. К таким объектам относятся неодно-
ся слой, который выполняет свёртку по каналам для 

родности в области лёгких и лёгочные структуры с 
каждого отсчёта. В итоге, на выходе свёрточная 

одинаковыми плотностями (артерии, вены, бронхи и 
нейронная сеть выдаст матрицу значений функции 

бронхиолы) [15]. После нахождения порога с помо-
активации на выходном слое. 

щью метода Оцу и пороговой обработки изображения 
2. Предварительная обработка изображений по формуле (1) получается неоднородная маска с точ-

ками и лишними частями на ней, не являющимися 
В качестве исходных данных используется выбор-

лёгкими (рис. 2). 
ка, состоящая из 143 изображений x (i  

1, i2) отдельных 
Можно заметить, что края маски не гладкие, а 

двумерных слоёв компьютерной топографии лёгких с 
лёгкое не является односвязным. Для того, чтобы ис-

различными разрешениями, не превосходящими 
править это, были использованы операции математи-

200 × 300 пикселей. Допустим, изображение x (i1, i2) ческой морфологии [16]. Для этого сначала была ис-
определено на конечном множестве D  

x Z2 с количе-
пользована операция закрытия, а затем открытия мас-

ством отсчётов | Dx |, где Z – множество целых чисел. 
кой W в виде матрицы 4×4. Операция закрытия 

Перед тем как работать с данными изображениями, 
применяет к изображению сначала дилатацию 

следует привести их к определённому виду, а именно 
стандартизировать изображение с помощью формулы y i1,i2   max x i  j i
(4) [14].   1 1, 2  j2  , (5) 

j1 , j2 W

а затем эрозию 
  xi ,i  

z i 1
1,i

2
2  ,  (4) 

 y i1,i2   min x i1  j1,i2  j2  , (6) 
 j1 , j2 W

где  – математическое ожидание: 
а операция открытия применяет сначала эрозию (6), а 

1
   xi после дилатацию (5). Данная последовательность опе-

1,i2  , 
Dx i1 ,i2 Dx раций позволяет выравнивать контуры, также стира-

ются элементы, которые по размеру меньше, чем ис-
 – стандартное отклонение: пользуемая маска, и возможно восстановление разо-

1 рванных линий. Но, как можно заметить на рис. 2, 
2    xi

 1,i2  2
. 

D операции математической морфологии не всегда мо-
x 1 i1 ,i2 Dx гут закрасить точки в лёгком и не помогут избавиться 

Данное преобразование необходимо в случае воз- от лишних частей, не относящихся к лёгкому. 
можных поэлементных искажений. Например, таких 
как засветка снимка. 

Также важным шагом является подготовка выбор-
ки изображений для сравнения полученного резуль-
тата с ожидаемым. Для каждого изображения компь-
ютерной томографии специалистом вручную была 
получена маска, а именно чёрно-белое изображение, а)  б)  в)  
на котором лёгкое выделено и закрашено белым цве- Рис. 2. Получение маски: исходное изображение (а);  

маска после пороговой обработки (б); маска  
том, а всё остальное вокруг него – чёрным. Пример после операций математической морфологии (в) 
маски показан на рис. 1. 

Чтобы избавиться от лишних частей на изображе-
ниях компьютерной томографии лёгких, были ис-
пользованы контуры. Первым делом с помощью ал-
горитма, описанного в [17], находятся все внешние 
замкнутые контуры, которые присутствуют на изоб-
ражении, затем среди них находится самый большой 
контур, и вся область внутри него считается областью 
лёгкого и закрашивается белым цветом. Вся осталь-
ная часть изображения считается фоном и закрашива-
ется чёрным. Таким образом, получается конечная 

   маска. Результаты работы всего алгоритма целиком 
Рис. 1. Исходное изображение и его маска представлены на рис. 3. 

76 Computer Optics, 2020, Vol. 44(1) DOI: 10.18287/2412-6179-CO- 659 



Сравнение алгоритмов выделения области интереса на компьютерных томограммах легких Пашина Т.А. и др. 

4. Выделение области интереса с помощью U-Net 

Для обучения свёрточной нейронной сети U-Net 
было выбрано 43 изображения компьютерной томо-
графии лёгких, а оставшиеся 100 изображений вошли 

      в контрольную выборку, по которой производилась 
оценка эффективности работы сети. Данные изобра-
жения были приведены к одинаковому размеру 
256 × 256. В качестве функции потерь была использо-
вана бинарная кросс-энтропия (10): 

      
Рис. 3. Исходные изображения и полученные для них маски  H p (q) 

Для исследования эффективности данного алго- 1 N  (10) 
   yi  log  pi   1 yi   log 1 pi  ,

ритма были вычислены такие показатели, как досто- N i1
верность сегментации a (7), чувствительность b (8) и 
специфичность c (9) [18]. где N – количество отсчётов на изображении, yi – 

класс i-го отсчёта, pi – выходное значение свёрточной 
n  n

a  TP TN , (7) нейронной сети для i-го отсчёта. 
nTP  nTN  nFP  nFN Свёрточная нейронная сеть обучалась 50 эпох в 

n течение суток. После обучения нейроны на выходном 
b  TP , (8) 

n слое выдают значения от 0 до 1 в зависимости от то-
TP  nFN

n го, насколько соответствующий отсчёт походит на 
c  TN , (9) отсчёт из искомой области интереса. Отдельной зада-

nTN  nFP чей является подбор порога для этих значений таким 
где nTP – число верно определённых отсчётов объекта образом, чтобы получить наивысшее значение досто-
на изображении, nTN – число верно определённых от- верности сегментации (7). Порог выбирается по мас-
счётов фона, nFP – число отсчётов, ошибочно отне- кам, полученным на обучающей выборке, таким обра-
сённых к объекту, nFN – число отсчётов, ошибочно зом, чтобы достигалась наилучшая достоверность сег-
отнесённых к фону. ментации. Выбранное значение порога используется в 

Средняя достоверность сегментации (7) по всем дальнейшем для исследования эффективности всего 
изображениям составила 96,7 %, средняя чувстви- подхода на изображениях контрольной выборки. 
тельность (8) – 94 % и средняя специфичность (9) – На рис. 6 представлен график средней достовер-
99,5 %. Худшее значение достоверности сегментации ности сегментации для разных порогов обработки по-
в данной выборке изображений составило 86,8 % лученных изображений. С помощью полученного по-
(рис. 4), а лучшее значение составило 97,9 % (рис. 5). рога можно будет определить, относится ли исследу-

емый отсчёт к лёгкому или к фону. 

а)  б)  в)  
Рис. 4. Маска с худшим значением достоверности 

сегментации: исходное изображение (а);   
полученная маска (б); реальная маска (в) Рис. 6. График зависимости средней достоверности 

сегментации от разных порогов для свёрточной  
нейронной сети U-Net 

Исходя из графика на рис. 6, можно отметить, что 
наилучшим пороговым значением является 1. 

U-Net может устранять некоторые части, не явля-
ющиеся лёгкими, и закрашивать дыры в самом лёг-

а)  б)  в)  ком. Но не всегда полученные с помощью свёрточной 
Рис. 5. Маска с лучшим значением достоверности нейронной сети U-Net маски являются односвязными. 

сегментации: исходное изображение (а);  Иногда на них присутствуют лишние части. Поэтому, 
полученная маска (б); реальная маска (в) чтобы улучшить маску, используется та же методика, 

Компьютерная оптика, 2020, том 44, №1 DOI: 10.18287/2412-6179-CO-659 77 



http://www.computeroptics.ru http://www.computeroptics.smr.ru 

основанная на контурах, как и для выделения области то качество работы такой сети будет крайне низким. 
интереса с помощью метода Оцу. Результат её ис- Для обучения и контроля работы сети использова-
пользования представлен на рис. 7. лись те же обучающая и контрольная выборки, что и 

для сети U-Net. Данная сеть обучалась 50 эпох, что 
составило по времени примерно 3 часа. Также, как и 
для U-Net, требуется выбрать порог вероятности, при 
котором достоверность сегментации обучающей вы-
борки будет лучше. Исходя из графика на рис. 10, по-
рог для данной свёрточной нейронной сети составил 
0,1. Отсчёты, у которых выходное значение нейрона 

а)  б) больше или равно пороговому значению, относятся к 
  

Рис. 7. Улучшение маски: маска, полученная с помощью  лёгкому, а все остальные – к фону. 
U-Net (а); маска после использования контуров (б) 

Средняя достоверность сегментации до выделения 
объекта с помощью контуров составляла 96,3 %, чув-
ствительность была равна 99,5 %, а специфичность – 
92,8 %. После улучшения средняя достоверность сег-
ментации составила 96,4 %, средняя чувствитель-
ность – 99,6 % и средняя специфичность – 92,9 %. 
Легко заметить, что улучшение не сильно повлияло 
на точность, что показывает хорошую работу U-Net. 
Худшее значение достоверности сегментации в дан-
ной выборке изображений составило 93,6 % (рис. 8), а  
лучшее равно 97,5 % (рис. 9). Рис. 10. График зависимости средней достоверности 

сегментации от разных порогов для простой  
свёрточной нейронной сети 

Пример маски, которая была предсказана простой 
свёрточной нейронной сетью, представлена на рис. 11. 
Данная свёрточная нейронная сеть не справляется с 

а)  б)  в)  лишними частями и не делает лёгкое односвязным. 
Рис. 8. Маска с худшим значением достоверности При этом достоверность сегментации составляет 91 %, 

сегментации: полученная маска (а); реальная маска (б); чувствительность – 90,5 %, а специфичность – 91,6 %. 
исходное изображение (в) 

а)  б)  в)  
Рис. 9. Маска с лучшим значением достоверности 

сегментации: полученная маска (а); реальная маска (б); 
исходное изображение (в) 

  
5. Выделение области интереса  Рис. 11. Исходное изображение компьютерной 

с помощью простой свёрточной нейронной сети томографии и маска, полученная с помощью простой 
свёрточной нейронной сети 

Данная свёрточная нейронная сеть состоит из десяти 
следующих друг за другом одинаковых свёрточных 
слоёв с размером, равным приведённому размеру изоб-
ражения компьютерной томографии лёгких, а именно 
256 × 256. Первые восемь слоёв используют функцию 
активации сигмоид (11), а последующие два слоя ReLu 
(3). Стоит отметить, что по результатам экспериментов, 
предварительно проведённых авторами, если использо-
вать на всех слоях функцию активации сигмоид 

1
   

(x)  , (11) 
1 e x Рис. 12. Маска, полученная с помощью свёрточной 

нейронной сети и улучшенная маска 

78 Computer Optics, 2020, Vol. 44(1) DOI: 10.18287/2412-6179-CO- 659 



Сравнение алгоритмов выделения области интереса на компьютерных томограммах легких Пашина Т.А. и др. 

С применением описанного ранее подхода, осно- Исходя из табл. 1, можно заключить, что лучший 
ванного на выделении контуров, точность была результат показал третий способ. Однако следует от-
улучшена. При этом достоверность сегментации ста- метить, что данная сеть может предсказать маску с 
ла равна 97,5 %, чувствительность – 94,7 %, а специ- точностью ниже 90 %. В то же время U-Net позволяет 
фичность – 99,7 %. На рис. 12 представлен результат получить маску с минимальной точностью в 93 %, что 
улучшения маски. гораздо лучше подходит для выделения области ин-

В итоге, лучшая достоверность сегментации соста- тереса. Также стоит обратить внимание, что чувстви-
вила 99,1 % (рис. 13), а худшая равна 85 % (рис. 14). тельность U-Net составляет 99,6 %, что означает, что 

свёрточная нейронная сеть U-Net лучше остальных 
способов определяет отсчёты лёгкого. Специфич-
ность данного способа является самой низкой, так как 
при предсказании данная свёрточная нейронная сеть 
захватывает лишние отсчёты вокруг лёгкого и отно-

а)  б)  в)  сит их к маске. Можно увидеть на рис. 15, что белые 
Рис. 13. Маска с лучшим значением  границы предсказанной маски выступают за область, 
достоверности сегментации:  выделенную серым, которая является оригинальной 
исходное изображение (а);  маской. За счёт этого маска лёгкого будет содержать 

полученная маска (б); реальная маска (в) 
в себе больше реальных отсчётов, относящихся к лёг-
кому, тем самым предсказывая нахождение лёгкого 
более точно. 

а)  б)  в)  
Рис. 14. Маска с худшим значением  
достоверности сегментации:  
исходное изображение (а);  

полученная маска (б); реальная маска (в) 

6. Сравнение результатов работы  
алгоритмов выделения области интереса 

 
В табл. 1 приведены сводные показатели эффек- Рис. 15. Серая реальная маска находится  

тивности исследованных подходов. внутри белой предсказанной маски 

Табл. 1. Сравнение полученных результатов 

Чувстви- Специфич-
Способ выделения области Достоверность сегментации 

тельность ность 
интереса 

Среднее Худшее Лучшее   
Метод Оцу 96,7% 86,8% 97,9% 94% 99,5% 
U-Net 96,4% 93,6% 97,5%  99,6% 92,9% 
Простая свёрточная нейронная 

97,5% 85% 99,1% 94,7% 99,7% 
сеть 

 

Результаты, полученные с помощью первого и мографии лёгкого. Это можно заметить исходя из по-
третьего методов, довольно похожи. Области, выде- лученных результатов. Все три способа выдают худ-
ленные с помощью простой свёрточной нейронной шие результаты на размытых изображениях, на кото-
сети, всегда требуют дальнейшей обработки, как и рых трудно определяется нахождение лёгкого, и хо-
первый способ, основанный на пороговой обработке. рошие результаты на изображениях, где чётко видно 
Данная сеть не может сама предсказывать маску, не лёгкое. 
содержащую дыры и лишние части, в то время как Таким образом, лучшим способом является выде-
маскам, предсказанным с помощью U-Net, только ление области интереса с помощью свёрточной 
иногда нужно дополнительно применять обработку с нейронной сети U-Net, которая позволяет получать 
помощью контуров, именно поэтому дополнительная хороший результат более стабильно и требует мень-
обработка полученных масок незначительно отрази- шей дополнительной обработки, чем другие два спо-
лась на подсчитанных показателях. соба. Вторым по эффективности является способ вы-

Также точность предсказанной маски зависит от деления области интереса с помощью простой свёр-
качества исходного изображения компьютерной то- точной нейронной сети, которая показывает 

Компьютерная оптика, 2020, том 44, №1 DOI: 10.18287/2412-6179-CO-659 79 



http://www.computeroptics.ru http://www.computeroptics.smr.ru 

отличный результат на изображениях компьютерной 3. Lassen, В. Automatic segmentation of the pulmonary lobes 
томографии, где чётко видны границы лёгкого. from chest CT scans based on fissures, vessels, and bronchi 

/ B. Lassen, E.M. van Rikxoort, M. Schmidt, S. Kerkstra, 
Заключение B. van Ginneken, J.-M. Kuhnigk // IEEE Transactions on 

В данной работе были рассмотрены три способа Medical Imaging. – 2013. – Vol. 32, Issue 2. – P. 210-222. 
4. Van Rikxoort, E.M. Automatic segmentation of pulmonary 

выделения легкого на изображении компьютерной segments from volumetric chest CT scans / E.M. van 
томографии: с помощью метода Оцу, простой свёр- Rikxoort, B. de Hoop, S. van de Vorst, M. Prokop, B. van 
точной нейронной сети и U-Net.  Ginneken // IEEE Transactions on Medical Imaging. – 

При использовании операций математической 2009. – Vol. 28. – P. 621-630. 
морфологии и выделения контуров для обеспечения 5. Memon, N.A. Segmentation of lungs from CT scan images 
связности фона и лёгкого способ, использующий по- for early diagnosis of lung cancer / N.A. Memon, A. Mirza, 

A. Gilani // Proceedings of World Academy of Science, En-
роговую обработку методом Оцу, показал неплохие gineering and Technology. – 2006. – Vol. 14. – P. 228-233. 
результаты.  Исходя из значений показателей данного 6. Skourt, B.A. Lung CT image segmentation using deep neu-
способа, рассчитанных в работе, а именно достовер- ral networks / B.A. Skourt, A.E. Hassani, A. Majda // Pro-
ности сегментации – 96,7%, чувствительности – 94% cedia Computer Science. – 2018. – Vol. 127. – P. 109-113. 
и специфичности – 99,5%, можно отметить, что дан- 7. Nithila, E.E. Segmentation of lung from CT using various 
ный метод довольно прост и эффективен для выделе- active contour models / E.E. Nithila, S.S. Kumar // Biomed-

ical Signal Processing and Control. – 2019. – Vol. 47. – 
ния областей интереса. Однако не во всех случаях P. 57-62. 
данный алгоритм работает хорошо. 8. Armato III, S.G. The Lung Image Database Consortium 

Свёрточная нейронная сеть, состоящая из 10 свёр- (LIDC) and Image Database Resource Initiative (IDRI): A 
точных слоёв, показала лучшее значение средней до- completed reference database of lung nodules on CT scans / 
стоверности сегментации в 97,5%. При этом чувстви- S.G. Armato III, G. McLennan, L. Bidaut, et al. // Medical 
тельность равна 94,7%, а специфичность – 99,7%, что Physics. – 2011. – Vol. 38. – P. 915-931. 

очень похоже на значения показателей у способа, ис- 9. Гайдель, А.В. Возможности текстурного анализа ком-
пьютерных томограмм в диагностике хронической об-

пользующего пороговую обработку. Как и алгоритм, структивной болезни / А.В. Гайдель, П.М. Зельтер, 
использующий метод Оцу, данный способ требует А.В. Капишников, А.Г. Храмов // Компьютерная опти-
дополнительной обработки. ка. – 2014. – Т. 38, № 4. – С. 843-850. 

Результаты, полученные с помощью свёрточной 10. Грузман, И.С. Цифровая обработка изображений в ин-
нейронной сети U-Net, показывают, что для сегмен- формационных системах: Учебное пособие / 

тации высокого качества крайне редко требуется И.С. Грузман, В.С. Киричук, В.П. Косых. – Новосиби-
срк: Изд-во НГТУ, 2002. – 352 c. 

прибегать к дополнительной обработке изображений, 11. Otsu, N. A threshold selection method from gray-level his-
так как при использовании выделения контуров для tograms / N. Otsu // IEEE Transactions on Systems, Man, 
создания связности фона и лёгкого полученные ре- and Cybernetics. – 1979. – Vol. 9, Issue 1. – P. 62-66. 
зультаты остались практически неизменными. Досто- 12. Mortazi, A. Automatically designing CNN architectures for 
верность сегментации составила – 96,4%, чувстви- medical image segmentation // International Workshop on 
тельность 99,6%, а специфичность – 92,9%, следова- Machine Learning in Medical Imaging. – 2018. – P. 98-106. 

13. Ronneberger, O. U-Net: Convolutional networks for bio-
тельно, можно отметить, что U-Net выделяет область, medical image segmentation / O. Ronneberger, P. Fischer, 
относящуюся к лёгкому, лучше, чем два других спо- T. Brox. – In: Medical image computing and computer-
соба, однако на практике зачастую достаточно ис- assisted intervention – MICCAI 2015 / ed. by N. Navab, 
пользовать подход, основанный на пороговой обра- J. Hornegger, W.M. Wells, A.F. Frangi. – Part III. – 2015. – 
ботке методом Оцу. P. 234-241. 

14. Kreyszig, E. Advanced engineering mathematics / E. Kre-
Благодарности yszig, H. Kreyszig. – 10th ed. – New York: John Wiley & 

Sons, Ltd, 2011. – 880 p. 
Разработка методов и алгоритмов выполнена при 15. Митрюшина, Н.Н. Компьютерная диагностика рака 

поддержке грантов РФФИ № 18-07-01390, легкого: обзор методов сегментации лёгких на изобра-
№ 19-29-01235 мк и № 19-29-01135 мк, эксперимен- жении / Н.Н. Митрюшина, Ю.С. Белов // Электронный 
тальные исследования – в рамках госзадания ИСОИ Журнал: Наука, Техника и Образование. – 2015. – 
РАН – филиала ФНИЦ «Кристаллография и Фотони- Т. 5(1). – С. 1-9. 

ка» РАН (соглашение № 007-ГЗ/Ч3363/26). 16. Serra, J. Image analysis and mathematical morphology / 
J. Serra. – Orlando: Academic Press, 1983. – 610 p. 

Литература 17. Suzuki, S. Topological structural analysis of digitized bina-
ry images by border following / S. Suzuki, K. be // Comput-

1. Тюрин, И.Е. Компьютерная томография органов груд- er Vision, Graphics, and Image Processing. – 1985. – 
ной клетки / И.Е. Тюрин. – С.-Пб.: ООО «Элби-СПб», Vol. 30, Issue 1. – P. 32-46. 
2003. – 371 с.  18. Альбом, А. Введение в современную эпидемиологию: 

2. Gaidel, A. Method of automatic ROI selection on lung CT учебное пособие / А. Альбом, С. Норрел; пер. с англ. И. 
images / A. Gaidel // Procedia Engineering. – 2017. – Боня. – Таллин: Институт экспериментальной и клини-
Vol. 201. – P. 258-264. ческой медицины (Эстония), 1996. – 122 с. 

 
 

80 Computer Optics, 2020, Vol. 44(1) DOI: 10.18287/2412-6179-CO- 659 



Сравнение алгоритмов выделения области интереса на компьютерных томограммах легких Пашина Т.А. и др. 

Сведения об авторах 

Пашина Татьяна Андреевна, 1997 года рождения, студентка Самарского национального исследователь-
ского университета имени академика С.П. Королёва. В 2019 году защитила выпускную квалификационную ра-
боту бакалавра по направлению «Прикладная математика и информатика». E-mail: pashinatania@mail.ru . 

 
Гайдель Андрей Викторович, 1989 года рождения, кандидат технических наук, в 2012 году окончил Са-

марский государственный аэрокосмический университет имени академика С.П. Королёва по направлению 
«Прикладная математика и информатика», в 2015 году защитил кандидатскую диссертацию. Работает доцентом 
кафедры технической кибернетики Самарского университета и научным сотрудником в Институте систем об-
работки изображений РАН – филиале ФНИЦ «Кристаллография и фотоника» РАН. Область научных интере-
сов: компьютерная обработка изображений, теория распознавания образов, интеллектуальный анализ данных, 
теория алгоритмов. E-mail: andrey.gaidel@gmail.com . 

 
Зельтер Павел Михайлович, 1986 года рождения, в 2010 году с отличием окончил Самарский государ-

ственный медицинский университет, в 2012 году ординатуру по специальности «Рентгенология», работает ас-
систентом кафедры лучевой диагностики и лучевой терапии с курсом медицинской информатики СамГМУ. 
Область научных интересов: компьютерная томография, ХОБЛ, компьютерный анализ медицинских изображе-
ний. E-mail: pzelter@mail.ru . 

 
Капишников Александр Викторович, 1955 года рождения. В 1972 году окончил лечебный факультет 

Куйбышевского медицинского института. Докторскую диссертацию защитил в 2004 году. Заведует кафедрой 
лучевой диагностики и лучевой терапии с курсом медицинской информатики СамГМУ Минздрава России. Об-
ласть научных интересов: лучевая диагностика и ядерная медицина в пульмонологии, остеологии, нефрологии 
и онкологии, информационные технологии медицинской радиологии, CADe и CADx — системы для компью-
терной поддержки диагностики. 

 
Никоноров Артем Владимирович, родился в 1979 году. В 2005 году окончил Самарский государственный 

аэрокосмический университет. Доктор технических наук (2016), профессор кафедры суперкомпьютеров и об-
щей информатики Самарского университета, заведующий лабораторией интеллектуального анализа видеодан-
ных ИСОИ РАН – филиала ФНИЦ «Кристаллография и фотоника» РАН. Опубликовал более 80 работ, две мо-
нографии. Область научных интересов: распознавание образов и анализ изображений, идентификация систем, 
параллельные и распределённые вычисления, вычисления с использованием графических процессоров.   
E-mail: artniko@gmail.com . 
 

 

ГРНТИ: 28.23.15 
Поступила в редакцию 21 октября 2019 г. Окончательный вариант – 21 ноября 2019 г. 

 
 

Компьютерная оптика, 2020, том 44, №1 DOI: 10.18287/2412-6179-CO-659 81 



 

Automatic highlighting of the region of interest  
in computed tomography images of the lungs 

T.A. Pashina 1, A.V. Gaidel 1,2, P.M. Zelter 3, A.V. Kapishnikov 3, A.V. Nikonorov 1,2 

1 Samara National Research University, Moskovskoye Shosse 34, 443086, Samara, Russia, 
2 IPSI RAS – Branch of the FSRC “Crystallography and Photonics” RAS,  

Molodogvardeyskaya 151, 443001, Samara, Russia, 
3 Samara State Medical University, Samara, Russia 

Abstract 

This article discusses the creation of masks for highlighting the lungs in computed tomography 
images using three methods - the Otsu method, a simple convolutional neural network consisting 
of 10 identical layers, and the convolutional neural network U-Net. We perform a study and com-
parison of methods used for automatically highlighting the region of interest (ROI) in computed 
tomography images of the lungs, which were provided as a courtesy from the Clinics of Samara 
State Medical University. The solution to this problem is relevant, because medical workers have 
to manually select the ROI as the first step of the automated processing of lung CT images. An al-
gorithm for post-processing images based on the search for contours, which allows one to improve 
the quality of segmentation, is proposed. It is concluded that the U-Net highlights the ROI relating 
to the lung better than the other two methods. At the same time, the simple convolutional neural 
network highlights the ROI with an accuracy of 97.5%, which is better than the accuracy of  
96.7% of the Otsu method and 96.4% of the U-Net. 

Keywords: image processing, computed tomography of the lungs, convolutional neural net-
works, U-Net. 

Acknowledgements: The work was partially funded by the Russian Foundation for Basic Re-
search under  grants No. 18-07-01390, 19-29-01235 and 19-29-01135 (theoretical results)  and  the  
RF Ministry  of  Science  and  Higher Education within the government project of the FSRC “Crys-
tallography and Photonics” RAS under grant No. 007-GZ/Ch3363/26 (numerical  calculations). 

Citation: Pashina TA, Gaidel AV, Zelter PM, Kapishnikov AV, Nikonorov AV. Automatic 
highlighting of the region of interest in computed tomography images of the lungs. Computer Op-
tics 2020; 44(1): 74-81. DOI: 10.18287/2412-6179-CO-659. 

References [9] Gaidel AV, Zelter PM, Kapishnikov AV, Khramov AG. 
Computed tomography texture analysis capabilities in di-

[1] Tyurin IE. Computed tomography of the chest cavity [In agnosing a chronic obstructive pulmonary disease. Com-
Russian]. Saint-Petersburg: "ELBI-SPb" Publisher; 2003. puter Optics 2014; 38(4): 843-850. 

[2] Gaidel AV. Method of automatic ROI selection on lung [10] Gruzman IS, Kirichuk VS, Skew VP. Digital image pro-
CT images. Procedia Engineering 2017; 201: 258-264. cessing in information systems [In Russian]. Novosibisrk: 

[3] Lassen B, van Rikxoort EM, Schmidt M, Kerkstra S, van Publishing house of NSTU; 2002. 
Ginneken B, Kuhnigk J-M. Automatic segmentation of the [11] Otsu N. A threshold selection method from gray-level 
pulmonary lobes from chest CT scans based on fissures, histograms. IEEE Transactions on Systems, Man, and 
vessels, and bronchi. IEEE Trans Med Imaging 2013; Cybernetics 1979; 9(1): 62-66. 
32(2): 210-222. [12] Mortazi A. Automatically designing CNN architectures 

[4] van Rikxoort EM, de Hoop B, van de Vorst S, Prokop M, for medical image segmentation. International Workshop 
van Ginneken B. Automatic segmentation of pulmonary on Machine Learning in Medical Imaging 2018; 98-106. 
segments from volumetric chest CT scans. IEEE Trans Med [13] Ronneberger O, Fischer P, Brox T. U-Net: Convolutional 
Imaging 2009; 28: 621-630. networks for biomedical image segmentation. In Book: 

Navab N, Hornegger J, Wells WM, Frangi AF, eds. Medi-
[5] Memon NA, Mirza A, Gilani A. Segmentation of lungs cal image computing and computer-assisted intervention – 

from CT scan images for early diagnosis of lung cancer. MICCAI 2015; III: 234-241. 
Proceedings of World Academy of Science, Engineering [14] Kreyszig E, Kreyszig H. Advanced engineering mathematics. 
and Technology 2006; 14: 228-233. 10th ed. New York: John Wiley & Sons, Ltd; 2011. 

[6] Skourt BA, Hassani AE, Majda A. Lung CT image seg- [15] Mitryushina NN, Belov YuS. Computer diagnostics of 
mentation using deep neural networks. Procedia Computer lung cancer: a review of lung segmentation methods in 
Science 2018; 127: 109-13. the image. Electronic Journal: Science, Technology and 

[7] Nithila EE, Kumar SS. Segmentation of lung from CT us- Education 2015; 5(1): 1-9. 
ing various active contour models. Biomed Signal Process [16] Serra J. Image analysis and mathematical morphology. Or-
Control 2019; 47: 57-62. lando: Academic Press; 1983. 

[8] Armato SG III, McLennan G, Bidaut L, et al. The Lung Image [17] Suzuki S, be K. Topological structural analysis of digitized 
Database Consortium (LIDC) and Image Database Resource binary images by border following. Computer Vision, 
Initiative (IDRI): A completed reference database of lung Graphics, and Image Processing 1985; 30(1): 32-46. 
nodules on CT scans. Med Phys 2011; 38: 915-931. [18] Ahlbom A, Norrell S. Introduction to modern epidemiolo-

gy. 2nd ed. Epidemiology Resources Inc, 1990.  

 



 

 
 

Author’s information 

Tatiana Andreevna Pashina (b. 1997) is a student of the Samara National Research University, majoring in Ap-
plied Mathematics and Informatics. In 2019, she defended the final qualifying work of the bachelor degree in the direc-
tion of “Applied Mathematics and Informatics”. E-mail: pashinatania@mail.ru . 

 
Andrey Viktorovich Gaidel (b. 1989) graduated from Samara State Aerospace University in 2012, majoring in 

Applied Mathematics and Informatics. He received his Candidate of Science degree in Physics and Math in 2015 from 
the SSAU. Currently he is a teaching assistant of the Technical Cybernetics sub-department and Engineer at SSAU's la-
boratory SRL-35 of Samara State Aerospace University, also working as an intern researcher of the Image Processing 
Systems Institute of the Russian Academy of Sciences, – Branch of the FSRC “Crystallography and Photonics” RAS, 
Samara, Russia. His research interests currently focus on computer image processing, pattern recognition, data mining 
and theory of computation. E-mail: andrey.gaidel@gmail.com . 

 
Pavel Mikhailovich Zelter (b. 1986) graduated with honors from Samara State Medical University in 2010, resi-

dency in Radiology in 2012. Assistant lecturer of Radiology department with course of Medical Informatics of Samara 
State Medical University. Research interests are currently focused on computered tomography, COPD, digital analysis 
of medical images. E-mail: pzelter@mail.ru . 

 
Aleksandr Viktorovich Kapishnikov (b.1955). In 1972 he graduated from the Medical faculty of the Kuibyshev 

Medical Institute. Doctor of Science in Medicine (2004). Head of Diagnostic Radiology and Medical Informatics de-
partment of Samara State Medical University. Research interests: diagnostic radiology and nuclear medicine in pulmo-
nology, osteology, nephrology and oncology, information technology in medical imaging, computer-based diagnostic 
support system (CADe and CADx). 

 
Artem Vladimirovich Nikonorov (b. 1979). He graduated from SSAU in 2002. He received his PhD degree in 

2016. Now he works as a professor at Supercomputing and Computer Science sub-department of Samara University and 
as a head of laboratory of video mining in IPSI RAS. He has more than 70 publications, two monographs. Field of sci-
entific interest: pattern recognition and image analysis, system identification, parallel and distributed programming, 
GPGPU programming. E-mail: artniko@gmail.com . 
 
 

Received October 21, 2019. The final version – November 21, 2019.