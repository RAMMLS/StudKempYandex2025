КОМПЛЕКСНЫЙ ПОДХОД К ОБЕСПЕЧЕНИЮ 
БЕЗОПАСНОСТИ КИБЕРФИЗИЧЕСКИХ СИСТЕМ НА 
ОСНОВЕ МИКРОКОНТРОЛЛЕРОВ

Котенко И.В.1, Левшун Д.С.2, Чечулин А.А.3, Ушаков И.А.4, Красов А.В.5

Цель статьи  заключается в разработке комплексного подхода к обеспечению безопасности киберфизиче-
ских систем на основе микроконтроллеров. 

Метод исследования: системный анализ современных атак на киберфизические системы на основе микро-
контроллеров и подходов к обеспечению их безопасности, разработка собственного подхода и его эксперимен-
тальная проверка.

Полученный результат: предложена обобщенная архитектура системы для  управления инцидентами и 
противодействия целевым атакам в распределенных крупномасштабных критически важных системах, реали-
зующая комплексный подход. Рассмотрена реализация данной архитектуры в рамках системы управления инци-
дентами безопасности для комплексной защиты элементов Умного дома, в том числе реализация надежной и 
доверенной шины данных, компонента обработки и корреляции событий безопасности, гибридного хранилища 
данных, компонента интеллектуального анализа событий безопасности, а также компонента расчета ме-
трик безопасности.

Область применения предложенного комплексного подхода – формирование функциональных и нефункцио-
нальных требований к киберфизическим системам на основе микроконтроллеров, которые могут быть исполь-
зованы в качестве входных данных для методик проектирования подобных систем, например DLSEDS (Design 
Lifecycle of Secure Embedded Devices System).

Ключевые слова: проектирование защищенных систем, целевые атаки, корреляция событий безопасности, 
интеллектуальный анализ событий безопасности, шина данных, гибридное хранилище, метрики безопасности, 
контрмеры, Интернет вещей, Умное здание.

DOI: 10.21681/2311-3456-2018-3-29-38

Введение нию киберфизической безопасности. С одной стороны, 
комплексность подхода заключается в совместном сбо-

Современные атаки на киберфизические системы ре, анализе и  обработке событий систем физической и 
для управления производственным процессом проис- кибернетической безопасности в рамках единой систе-
ходят одновременно на нескольких уровнях – от неза- мы. С другой стороны, не менее важным является учет 
конного проникновения на территорию предприятия, необходимости обеспечения защищенности такой си-
до эксплуатации уязвимостей на уровне компьютерной стемы к атакам на неё ещё на этапе проектирования [3]. 
сети. При этом сами атаки являются сложными, много- Отметим, что данная задача сама по себе является 
шаговыми и растянутыми во времени, а также учитыва- комплексной. Так, одной из ключевых особенностей 
ют особенности целевой системы и её инфраструктуру. микроконтроллеров является тот факт, что их функци-
Для своевременного обнаружения таких атак, систе- ональность определяется не только программной, но 
мам защиты необходимо анализировать совместно ин- и аппаратной составляющей. При этом связи между 
формацию, поступающую от множества гетерогенных программной частью устройства, с одной стороны, и 
источников как  физического, так и кибернетического аппаратной, с другой, обуславливают наличие допол-
уровня [1]. При этом в большинстве существующих си- нительных ограничений, влияющих существенным 
стем защиты, системы физической и кибернетической образом на процесс проектирования таких устройств. 
безопасности работают независимо друг от друга [2]. Это означает, что применение существующих решений 

Поэтому, для соответствия современным вызовам, для разработки безопасного программного обеспече-
требуется реализовать комплексный подход к обеспече- ния при создании защищенных систем на основе ми-

1  Котенко  Игорь  Витальевич,  доктор  технических,  профессор,  заведующий  лабораторией  проблем  компьютерной 
безопасности, ФГБУН Санкт-Петербургский институт информатики и автоматизации Российской академии наук, г. Санкт-
Петербург, Россия. E-mail: ivkote@comsec.spb.ru 

2  Левшун  Дмитрий  Сергеевич,  младший  научный  сотрудник,  ФГБУН  Санкт-Петербургский  институт  информатики 
и автоматизации Российской академии наук, г. Санкт-Петербург, Россия. E-mail: levshun@comsec.spb.ru 

3  Чечулин Андрей Алексеевич, кандидат технических наук, ведущий научный сотрудник, ФГБУН Санкт-Петербургский институт 
информатики и автоматизации Российской академии наук, г. Санкт-Петербург, Россия. E-mail: chechulin@comsec.spb.ru

4  Ушаков  Игорь  Александрович,  старший    преподаватель  ФГБОУ  ВО  Санкт-Петербургский  государственный  университет 
телекоммуникаций им. проф. М.А.Бонч-Бруевича, г. Санкт-Петербург, Россия. E-mail: ushakovia@gmail.com

5  Красов  Андрей  Владимирович,  кандидат  технических  наук,  доцент,  заведующий  кафедрой  Защищенных  систем  связи, 
ФГБОУ  ВО  Санкт-Петербургский  государственный  университет  телекоммуникаций  им.  проф.  М.А.  Бонч-Бруевича, 
Санкт-Петербург, Россия. E-mail: krasov@inbox.ru

Вопросы кибербезопасности  №3(27) - 2018 29



Безопасность в сетях общего доступа УДК 004.056.53
кроконтроллеров не позволит обеспечить их безопас- ративной сети, при необходимости включая филиалы. 
ность в полной мере. Агенты осуществляют сбор данных об инцидентах без-

Кроме того, существуют методики проектирова- опасности, выполняют их первоначальную обработку 
ния защищенных устройств на основе микрокон- и фильтрацию, после чего передают на анализ серверу 
троллеров, применимые при компонентном подходе приложений, который является основой системы. Сер-
(например, в рамках платформ Arduino, Raspberry Pi, вер приложений анализирует собранную с  помощью 
Beaglebone и Intel Galileo). Основная цель данных ме- агентов информацию и преобразует ее в более высоко-
тодик – выявление перечня возможных атак, которым уровневое и удобное для анализа представление. Вся 
может быть подвержено устройство, в соответствии с информация, собранная агентами, а также результаты 
выбранной моделью нарушителя, а также используе- анализа ее сервером приложений сохраняются в хра-
мыми программно-аппаратными компонентами ещё нилище (базе данных, хранилище).
на этапе проектирования  [4]. Ключевым недостатком На основе данных архитектурных уровней и осо-
компонентного подхода с точки зрения безопасности бенностей перспективных систем управления инци-
является его предопределенность, позволяющая зло- дентами безопасности критически важных объектов, 
умышленнику учитывать его при проведении атаки. представляется целесообразным выделить в архитек-
Кроме того, применение подобных методик и дальней- туре следующие компоненты:
шее объединение в рамках единой системы множества 
защищенных устройств не позволит разработать за-  внешние источники данных (сенсоры);
щищенную систему, т.к. не были учтены эмерджентные  надежная и доверенная шина данных;
свойства полученной системы.  компонент обработки и корреляции событий без-

Одним из возможных решений проблемы учета опасности;
эмерджентных свойств являются методики разработки  гибридное хранилище данных;
и верификации сетевых систем на основе микрокон-  компонент интеллектуального анализа событий без-
троллеров, исследования которых получили широкое опасности;
распространение в последнее время. Основной целью  компонент расчета метрик безопасности;
данных методик является предоставление разработ-  компонент выбора контрмер;
чикам информации о применимости отдельных интер-  внешние системы, реализующие выбранные кон-
фейсов и протоколов передачи данных для обеспече- трмеры.
ния соответствующего уровня надежности итоговой Рассмотрим цикл обработки данных в перспектив-
системы  [5]. При этом безопасность системы не  явля- ной системе управления инцидентами безопасности 
ется непосредственной целью данных методик, одна- критически важных объектов, включающих все выше-
ко отдельные аспекты безопасности учитываются при перечисленные компоненты (рис. 1).
выборе интерфейсов и протоколов передачи данных. Поток данных начинается с внешних сенсоров, 
Однако, методики данного типа позволяют обеспе- предоставляющих события безопасности от физиче-
чить надежность систем, состоящих только из микро- ских и кибернетических систем безопасности в разных 
контроллеров, не рассматривая их взаимодействие с форматах. Затем через внешние компоненты системы 
удаленными серверами, рабочими станциями и веб- события безопасности поступают на надежную и до-
сервисами. веренную шину данных. Далее через шину данных 

Подытоживая вышесказанное, отметим, что на дан- события безопасности поступают в компонент обра-
ный момент не существует единого комплексного под- ботки и корреляции событий безопасности  [6], а за-
хода к обеспечению безопасности киберфизических тем в гибридное хранилище информации и событий 
систем на основе микроконтроллеров, а существую- безопасности  [7]. После этого данные обрабатывают-
щие решения не  лишены недостатков и нуждаются в ся в компоненте интеллектуального анализа событий 
доработке. В рамках данной статьи рассматривается безопасности. В указанном компоненте производится 
реализация комплексного подхода к обеспечению обнаружение в реальном времени сложных многоша-
безопасности на начальном этапе – этапе формирова- говых целевых атак на основе технологий интеллекту-
ния требований к системе. Предлагается обобщенная ального анализа информации и событий безопасно-
архитектура системы для управления инцидентами сти, а также, анализ истории событий безопасности и 
и противодействия целевым атакам в распределенных прогнозирование действий нарушителей и их послед-
крупномасштабных критически важных системах, по- ствий  [8,9]. Данные, получаемые от  компонентов кор-
зволяющая обеспечить необходимый функционал и реляции событий, интеллектуального анализа событий 
взаимодействие с внешними системами. Кроме того, и  гибридного хранилища отправляются в компонент 
представляется реализация данной архитектуры в расчета метрик безопасности для расчета первичных 
рамках прототипа системы управления инцидентами и интегрированных метрик безопасности  [10]. Обна-
безопасности для комплексной защиты элементов Ум- руженные атаки, рассчитанные метрики и результаты 
ного дома. анализа истории и  прогнозирования действий нару-

шителей поступают в компонент выбора контрмер, где 
Обобщенная архитектура системы осуществляется автоматизированный выбор наиболее 

эффективных контрмер для противодействия целевым 
Существующие системы управления инцидентами информационно-программным и  физическим воздей-

безопасности преимущественно имеют трехуровне- ствиям. Далее, выбранные контрмеры отправляются 
вую архитектуру «агент» – «сервер» – «база (хранили- внешним системам безопасности, реализующим вы-
ще) данных», которая разворачивается поверх корпо- бранные контрмеры.

30 Вопросы кибербезопасности  №3(27) - 2018



Комплексный подход к обеспечению безопасности...

Рис. 1. Обобщенная архитектура перспективной системы управления инцидентами безопасности 
критически важных объектов

Комплексный  В соответствии с обобщенной архитектурой пер-
подход спективной системы управления инцидентами без-

опасности, компоненты сбора данных должны поддер-
Реализация предложенной архитектуры в рамках живать следующие операции:

системы управления инцидентами безопасности для 1. автоматическая коррекция погрешности;
комплексной защиты элементов Умного дома, состоит 2. самовосстановление при возникновении единич-
из нескольких основных частей (рис. 2): ного дефекта;

1. аппаратных источников информации (АИ); 3. автоматическая оптимизация параметров и алго-
2. программных источников информации (ПИ); ритмов работы.
3. концентраторов (HUB):; Реализация данных компонентов в рамках системы 
4. центрального сервера Умного дома; управления инцидентами безопасности для комплекс-
5. модуля аналитической обработки данных и ной защиты элементов Умного дома представлена 

визуализации (АОДВ); в виде аппаратных и программных источников инфор-
6. модуля интеграции с системами управления мации. Их задача – сбор данных от  гетерогенных ис-

информацией и событиями безопасности (СУИСБ). точников и их последующая передача на центральный 
При этом на уровне сбора данных расположены сервер. Примеры событий: срабатывание извещателя 

аппаратные и программные источники информации; в определенном режиме работы системы; выход пока-
на уровне управления данными — концентраторы; заний датчика за допустимые пределы; нелегитимный 
а  на  уровне анализа данных — сервер Умного дома, переход между состояниями пользователя в системе; 
модуль АОДВ и модуль интеграции с СУИСБ. потеря связи с устройством; и т.д. 

Рис. 2. Взаимодействие элементов системы управления инцидентами безопасности для комплексной 
защиты элементов Умного дома

Вопросы кибербезопасности  №3(27) - 2018 31



Безопасность в сетях общего доступа УДК 004.056.53
Аппаратные источники, представляющие собой избыточности сообщений, в рамках разработанного 

микроконтроллеры платформы Arduino6, подключа- протокола, производится предобработка каждого 
ются к системам Умного дома на уровне извещателей, сообщения методом прямой коррекции ошибок, 
оповещателей, датчиков и внешних электронных присваивающей номера пакетам. А переотправка 
компонентов посредством специальных адаптеров, пакетов осуществляется только тогда, когда данные 
позволяя собирать показания системы контроля можно восстановить только из  потерянного 
и управления доступом и системы отопления, подмножества переданных пакетов.
вентиляции и  кондиционирования. При этом каждый 
адаптер соответствует стандартному проводному 
или беспроводному интерфейсу передачи данных, 
используемому в рамках концепции Интернета вещей.

Программные источники информации 
подключаются к системам дома посредством 
специальных драйверов, позволяя собирать показания 
агентов рабочих станций, а также события серверов баз 
данных, серверов приложений и  web-сервисов. При 
этом драйверы могут использовать как уже существую-
щие интерфейсы программирования приложений, так и Рис. 3. Надежная, доверенная шина данных на 
специально разработанные агенты для сбора необходи- основе протокола I2C
мых данных. Надежность и достоверность соединения 
между программными источниками информации и Потоковая обработка данных осуществляется в рам-
сервером Умного дома обеспечивается за счет VPN- ках технологии Complex Event Processing [11]: данные, 
соединения на основе технологии OpenVPN7. собранные аппаратными источниками информации, 

Для обеспечения надежного и доверенного сбора передаются по защищенному каналу на концентрато-
данных от внешних сенсоров предлагается использо- ры, задача которых снизить нагрузку на сервер Умного 
вать шину данных. При этом в соответствии с обобщен- дома за счет предварительной обработки, обобщения 
ной архитектурой, доверенность шины данных обеспе- и нормализации. Предварительная обработка и обоб-
чивается за счет применения следующих решений: щение данных, в соответствии с обобщенной архитек-

1. взаимной аутентификации устройств на основе турой, заключаются в применении следующих опера-
MAC; ций:

2. надежного шифрования передаваемых данных на 1. операция добавления метки времени и иденти-
основе открытых и закрытых ключей. фикатора источника к  показаниям извещателей, опо-

Надежность шины данных, в соответствии с вещателей и считывателей систем;
обобщенной архитектурой, достигается за счет 2. операция добавления метки времени и иденти-
применения следующих решений: фикатора источника к  показаниям агентов рабочих 

1. динамической адресации подключенных станций системы; 
устройств; 3. операция добавления метки времени и иденти-

2. мониторинга состояния подключенных устройств; фикатора источника к событиям серверов баз данных, 
3. отсутствия неконтролируемых потерь показаний серверов приложений и web-сервисов системы. 

датчиков, извещателей, оповещателей и считывателей; В рамках процесса нормализации данных, в соот-
4. проверки целостности передаваемых данных. ветствии с обобщенной архитектурой, применяются 
В рамках разработанного прототипа системы следующие методы:

управления инцидентами безопасности для 1. метод приведения показаний датчиков, 
комплексной защиты элементов Умного дома, ап- извещателей, оповещателей и  считывателей систем к 
паратные источники информации и концентраторы общесистемному формату; 
объединены надежной, доверенной шиной данных на 2. метод приведения показаний агентов рабочих 
основе протокола  I2C8. При таком соединении, один станций системы к общесистемному формату; 
из  аппаратных интерфейсов выступает в  качестве 3. метод приведения событий серверов баз данных, 
главного микроконтроллера последовательной шины серверов приложений и web-сервисов к общесистем-
данных, а соединенные с ним микроконтроллеры ному формату.
в  качестве подчиненных. При этом допустимый Сервер Умного дома подвергает процессу филь-
диапазон адресов подчиненных микроконтроллеров трации данные, собранные посредством аппаратных 
лежит в диапазоне от 8 до 127 (рис. 3). Для минимизации и программных источников информации, перед их 

непосредственной записью в гибридное хранилище. 
6  Официальный  сайт  сообщества  разработчиков  решений  Фильтрация данных основывается на операции удале-

на основе микроконтроллеров платформы Arduino. – URL:  ния нерелевантных данных в соответствии с  заранее 
https://www.arduino.cc. (дата обращения: 28.05.2018). заданными правилами.

7  Официальный сайт проекта OpenVPN. – URL: https://open- В соответствии с обобщенной архитектурой, ги-
vpn.net/. (дата обращения: 28.12.2017). бридное хранилище должно быть разработано по ме-

8  Официальная документация по библиотеке Wire.h,  тодике построения, ориентированной на концепцию 
реализующей взаимодействие по протоколу I2C между  сервис-ориентированной архитектуры. Данная кон-
микроконтроллерами платформы Arduino. – URL: https:// цепция выделяет в архитектуре гибридного хранили-
www.arduino.cc/en/Reference/Wire. (дата обращения: 
28.05.2018). ща следующие уровни: уровень хранения и уровень 

32 Вопросы кибербезопасности  №3(27) - 2018



Комплексный подход к обеспечению безопасности...
реализации веб-сервисов. Уровень хранения включает знаков. При этом связывающие их направленные дуги 
в себя реляционную базу данных, базу XML-данных и представляют собой отношение условной независимо-
базу RDF-данных. Уровень реализации веб-сервисов сти одного признака от  другого. В основе нейронной 
содержит компоненты доступа к данным, реализации сети лежит математическая модель, также состоящая 
веб-сервисов и  представления данных. В рамках раз- из признаков, имеющих собственное состояние, и 
работанного прототипа системы управления инциден- линий связи, определяющих зависимость одних при-
тами безопасности для комплексной защиты элемен- знаков от других. При реализации данных методов в 
тов Умного дома, гибридное хранилище основано на рамках системы управления инцидентами безопасно-
технологии OpenLink Virtuoso9. При этом реляционная сти для комплексной защиты элементов Умного дома, 
база данных отвечает за хранение показаний датчиков, в качестве переменных или  искусственных нейронов 
извещателей, оповещателей, считывателей и агентов используются как отдельные события или атаки, харак-
рабочих станций; хранение событий серверов баз дан- терные для модуля обработки центрального сервера, 
ных, серверов приложений и web-сервисов системы; так и обобщенные характеристики множества событий 
хранение событий и инцидентов полученных на осно- и атак. Рассмотрим несколько примеров.
ве процесса корреляции событий безопасности. База Пример 1. В соответствии с политикой безопасно-
XML-данных отвечает за хранение правил процесса сти, сотрудник предприятия может находиться в одном 
корреляции событий безопасности, а также за хране- из четырех состояний (рис. 4):  – сотрудник вошел в зда-
ние шаблонов многошаговых атак. База RDF-данных ние;  – сотрудник начал сеанс работы с операционной 
отвечает за хранение знаний о взаимосвязи элементов системой;  – сотрудник завершил сеанс работы с опе-
системы с объектом защиты, а также за хранение зна- рационной системой;  – сотрудник вышел из дома.
ний о возможных конфликтах между элементами си-
стемы. Применение гибридного хранилища позволяет 
методам, моделям, методикам и алгоритмам анализа 
истории событий безопасности, прогнозирования дей-
ствий нарушителей и их последствий иметь релевант-
ный источник данных, позволяющий повысить опера-
тивность анализа и выявлять в режиме реального вре-
мени наиболее вероятный следующий шаг атаки, изъя-
ны системы защиты, а также точки входа нарушителей.

В соответствии с предложенной архитектурой 
перспективной системы управления инцидентами 
безопасности критически важных объектов, данные, Рис. 4. Конечный автомат
записанные в гибридное хранилище, подвергаются 
процессу корреляции событий безопасности для В течение рабочего дня, модуль обработки событий с по-
выявления инцидентов безопасности, сценариев атак мощью методов на основе правил и машины конечных 
и аномальной активности. При этом к использованию состояний выявил подозрительную активность: от опе-
рекомендуются следующие методы [12-15]: рационной системы пришло событие об авторизации 

1. методы на основе машины конечных состояний; учетной записи секретаря, притом, что события о входе 
2. методы на основе правил; секретаря в здание от системы контроля и управления 
3. методы на основе Байесовской и нейронной сети. доступом не приходило. Это означает, что переход в со-
Существо метода на основе правил заключается стояние  был осуществлен некорректным образом, т.е. 

в преобразовании политики безопасности организа- была нарушена политика безопасности. На основе этих 
ции в правила, понятные модулю обработки событий. фактов система управления инцидентами безопасности 
Эти  правила позволяют, например, формировать ко- для комплексной защиты элементов Умного дома созда-
нечные состояния сотрудников или  гостей объекта ет инцидент безопасности и формирует рекомендацию 
защиты в рамках системы. При этом возможные пере- о необходимости анализа записей, поступивших от си-
ходы между полученными конечными состояниями стемы видеонаблюдения за данный период времени.
задаются с помощью методов на  основе конечных Пример  2. В течение рабочего дня сотрудник во-
автоматов. Конечные состояния, а также возможные шел в здание (состояние S1) и авторизовался на рабо-
переходы между ними, позволяют в режиме реального чем месте (состояние S2). При этом модуль обработки 
времени выявлять нарушения политики безопасности событий с помощью методов на основе Байесовской 
объекта защиты. и нейронной сетей обнаружил аномальную сетевую ак-

Методы на основе Байесовской или нейронной тивность: трафик от компьютера сотрудника к базе дан-
сети могут использоваться для выявления аномальной ных, хранящей персональные данные сотрудников ор-
активности в рамках Умного дома. Предполагается, ганизации. Такой трафик является аномальным, так как 
что  обнаружение аномалий позволит выявлять ата- при нормальном функционировании системы доступ к 
ки, использующие недостатки политики безопасности базе данных осуществляется через специальное кли-
объекта защиты. В основе Байесовской сети лежит мо- ентское приложение. На основе этих фактов система 
дель направленного ациклического графа. Суть метода управления инцидентами безопасности для комплекс-
заключается в расположении в  вершинах графа при- ной защиты элементов Умного дома создает инцидент 

безопасности и формирует вывод о необходимости 
блокировки учетной записи данного сотрудника до вы-

9   Официальный сайт проекта OpenLink Virtuoso. – URL: https://
virtuoso.openlinksw.com. (дата обращения: 28.12.2017). яснения причин.

Вопросы кибербезопасности  №3(27) - 2018 33



Безопасность в сетях общего доступа УДК 004.056.53
Также, в рамках процесса корреляции событий без- соответствии с обобщенной архитектурой, использу-

опасности, в соответствии с обобщенной архитекту- ются элементы аналитического моделирования. Так, 
рой, применяются следующие правила для выявления посредством методики обнаружения в реальном вре-
ложных срабатываний датчиков или их подмены: мени сложных многошаговых целевых атак на основе 

1. правила сопоставления показаний одинаковых технологий интеллектуального анализа информации 
датчиков; и событий безопасности осуществляется сравнение 

2. правила сопоставления изменений показаний од- цепочки обнаруженных событий с хранимыми в ги-
них датчиков с данными от датчиков, показания кото- бридном хранилище шаблонами многошаговых атак 
рых также должны были измениться. с целью ещё на ранних этапах выявить наиболее ве-

Рассмотрим несколько примеров. роятный следующий шаг атаки. Рассмотрим пример 
Пример  3. Система управления инцидентами без- многошаговой атаки.

опасности для комплексной защиты элементов Умного Пример 5. От системы контроля и управления до-
дома получает информацию от системы пожарной сиг- ступом на сервер Умного дома поступило уведомление 
нализации о наличии пожара в одном из помещений. о подозрительной, но легитимной активности:
При этом на основании данных от системы отопления, 1. на объект защиты осуществлен вход в нерабочее 
вентиляции и кондиционирования известно, что в мо- время по карте сотрудника с правами администратора;
мент поступления сигнала о пожаре в помещении тем- В дальнейшем, на сервер Умного дома от системы 
пература и влажность оставались в пределах нормы. контроля и управления доступом поступило ещё 
На основе этих фактов система управления инцидента- одно уведомление о подозрительной, но легитимной 
ми безопасности для комплексной защиты элементов активности:
Умного дома создает инцидент безопасности и фор- 2. в  серверное помещение объекта защиты в 
мирует вывод о необходимости проверки пожарного нерабочее время был осуществлен вход по карте 
извещателя на предмет ложных срабатываний, а также сотрудника с правами администратора, при  этом 
формирует рекомендацию о необходимости анализа данные карты совпадают с данными, предоставленными 
записей, поступивших от системы видеонаблюдения за при входе на объект защиты; 
данный период времени. Далее на сервер Умного дома от системы отопле-

Пример 4. Нарушитель с целью формирования от- ния, вентиляции и кондиционирования серверной по-
каза в обслуживании на стороне чувствительного сер- ступило уведомление о подозрительной, но  легитим-
верного оборудования подменил информацию от дат- ной активности: 
чиков температуры системы отопления, вентиляции и 3. режим работы кондиционеров был изменен на 
кондиционирования, установленных на объекте за- «обогрев»;
щиты. Система управления инцидентами безопасно- Спустя некоторое время на сервере Умного дома 
сти для комплексной защиты элементов Умного дома на основе данных от системы отопления, вентиляции и 
получает информацию от системы отопления, венти- кондиционирования серверной был сформирован ин-
ляции и кондиционирования о достижении оптималь- цидент безопасности: 
ного диапазона температур в серверном помещении. 4. температура в серверном помещении вышла за 
С целью повышения энергоэффективности, кондици- пределы допустимого диапазона;
онирование помещения было временно приостанов- Ещё некоторое время спустя на сервер Умного дома 
лено. При этом на основании данных от операцион- от подсистемы мониторинга сетевого оборудования 
ных систем источников бесперебойного питания и начинают приходить уведомления:
серверов известно, что температура в помещении по- 5. отказ в обслуживании со  стороны сетевого обо-
степенно увеличивается, что не соотносится с данны- рудования.
ми от системы отопления, вентиляции и кондициони- Подозрительная, но легитимная активность ша-
рования. На основе этих фактов система управления гов 1-3 многошаговой атаки, при использовании толь-
инцидентами безопасности для комплексной защиты ко стандартных средств защиты, позволит системе 
элементов Умного дома создает инцидент безопас- управления инцидентами безопасности для комплекс-
ности и формирует вывод о необходимости проверки ной защиты элементов Умного дома выявить вредо-
датчиков температуры системы отопления, вентиля- носную активность только после наступления 4  шага, 
ции и кондиционирования в серверном помещении а сценарий атаки  после наступления 5  шага. Однако 
на предмет ложных срабатываний, а также формирует благодаря методике обнаружения в реальном времени 
рекомендацию о необходимости анализа записей, по- сложных многошаговых целевых атак, при осуществле-
ступивших от системы видеонаблюдения за данный нии сравнения цепочки подозрительной активности на 
период времени. шагах 1-3 с хранимым в гибридном хранилище шабло-

Однако как уже было упомянуто ранее, на дан- ном соответствующей многошаговой атаки, атака будет 
ный момент широкое распространение получили обнаружена на более ранней стадии. Это позволит уве-
комплексные атаки, одновременно происходящие домить отдел защиты и избежать отказа в обслужива-
на разных уровнях – от незаконного проникновения нии со стороны сетевого оборудования. 
в помещение до эксплуатации уязвимостей на уров- Методика обнаружения в реальном времени слож-
не компьютерной сети. При этом при построении ных многошаговых целевых атак, в соответствии с 
перспективных систем управления инцидентами без- обобщенной архитектурой, опирается на следующие 
опасности критически важных объектов необходимо модели, методики и алгоритмы: 
также учитывать многошаговость таких атак. С  этой 1. модели для прогнозирования действий 
целью в модуле обработки на сервере Умного дома, в нарушителя; 

34 Вопросы кибербезопасности  №3(27) - 2018



Комплексный подход к обеспечению безопасности...
2. методы, методики и алгоритмы анализа истории В соответствии с обобщенной архитектурой, в про-

событий безопасности для формирования профиля на- цессе автоматизированного реагирования на целевые 
рушителя; информационно-программные и  физические воздей-

3. методики определения наиболее вероятных пре- ствия в модуле аналитической обработки и визуализа-
дыдущих и последующих действий нарушителя; ции данных системы будут осуществляться следующие 

4. методы, методики и алгоритмы определения по- операции: 
следствий возможных действий нарушителя; 1. уведомление оператора об обнаруженных инци-

5. методы, методики и алгоритмы анализа истории дентах, сценариях атак и аномальной активности;
событий безопасности для связи событий безопасно- 2. уведомление о необходимости усиления физи-
сти с одним или разными нарушителями. ческого контроля инфраструктуры системы или её от-

На основе полученных результатов, в модуле ана- дельных элементов;
литической обработки данных и визуализации генери- 3. уведомление о необходимости изменения пра-
руются отчеты, вырабатываются контрмеры и осущест- вил доступа к сервисам системы.
вляется оценка защищенности охраняемого объекта. 

При этом в качестве первичных метрик безопасно- Выводы
сти используются следующие метрики:

1. метрика нахождения показаний температуры Методы, модели, методики, алгоритмы и архитекту-
воздуха в пределах заданного интервала; ры, выбранные в соответствии с обобщенной архитек-

2. метрика нахождения показаний влажности возду- турой перспективной системы управления инцидента-
ха в пределах заданного интервала; ми безопасности критически важных объектов, могут 

3. метрика нахождения концентрации определен- быть успешно реализованы для управления инциден-
ных газов в пределах заданного интервала; тами безопасности в рамках комплексной защиты эле-

4. метрика успешной или неуспешной попытки на- ментов Умного дома. При этом комплексность защиты 
чала сеанса с операционной системой; достигается за счет: 

5. метрика успешной или неуспешной попытки про- 1. анализа событий в режиме реального времени 
хода в помещение; для обнаружения сложных многошаговых атак на ран-

6. метрика отсутствия срабатываний датчика движе- них этапах развития (проактивность);
ния в пределах заданного временного интервала. 2. адаптивности мер защиты к состоянию объекта 

В качестве интегрированных метрик безопасности, в защиты (динамичность);
соответствии с обобщенной архитектурой, используются 3. совместного анализа событий физического и ки-
следующие метрики: бернетического уровня (многоаспектность).

1. метрика отсутствия нелегитимных переходов поль- Динамический подход в управлении инцидентами 
зователей системы между допустимыми состояниями; реализован за счет применения облачных сервисов, 

2. метрика наличия или отсутствия противоречий которые позволяют поддерживать в актуальном 
между показаниями источников данных; состоянии следующие базы знаний: 

3. метрика общего числа зафиксированных инци-  базы знаний правил процесса корреляции собы-
дентов безопасности определенной критичности; тий безопасности; 

4. метрика среднего числа зафиксированных инци-  базы знаний шаблонов многошаговых атак; 
дентов безопасности определенной критичности;  базы знаний возможных конфликтов между эле-

5. метрика процентного отношения числа зафик- ментами системы. 
сированных инцидентов безопасности определенной В качестве основы для проектирования прототипа 
критичности на отдельном устройстве к  числу зафик- Умного дома, как объекта управления инцидентами 
сированных инцидентов безопасности определенной безопасности, были выбраны встроенные устройства 
критичности в системе или подсистеме в целом. на  основе микроконтроллеров платформы Arduino 

При этом методики вычисления интегрированных в качестве аппаратных источников информации и 
метрик безопасности будут основаны на методиках встроенные устройства на основе одноплатного ком-
вычисления первичных метрик и общем подходе, объ- пьютера платформы Raspberry Pi в качестве концен-
единяющим метрики, вычисленные в соответствии с траторов и серверов. Выбранные встроенные устрой-
имеющимися в конкретный момент времени данными. ства позволяют организовать коммуникации в рамках 

Такой подход позволит иметь адекватную имею- структурированной кабельной системы по протоколу 
щимся данным интегрированную оценку защищенно- I2C, программно-аппаратная реализация которого на 
сти в  заданный момент времени за счет применения физических устройствах обеспечивает возможность 
следующих методов: подключения до 128 микроконтроллеров платформы 

1. анализа статистических данных для выявления Arduino к  одному одноплатному компьютеру плат-
текущих показаний и динамики их изменения; формы Raspberry  Pi. Целевая система представляет 

2. анализа произошедших инцидентов для выявле- собой совокупность систем управления зданием, со-
ния изъянов системы защиты и точек входа нарушителя; держащую большое количество разнородных контро-

3. анализа ущерба в результате воздействий на ин- лирующих, считывающих и управляющих устройств. В 
фраструктуру системы; основе данной системы лежит трехуровневая модель, 

4. анализа ущерба в результате воздействий на эле- представленная в рамках обобщенной архитектуры. 
менты инфраструктуры системы; Нижний уровень данной системы представлен про-

5. анализа ущерба в результате воздействий на сер- граммными и аппаратными источниками информа-
висы системы. ции, предназначенными для подключения к различ-

Вопросы кибербезопасности  №3(27) - 2018 35



Безопасность в сетях общего доступа УДК 004.056.53
ным система Умного дома. На промежуточном уровне Кроме того, полученные результаты могут быть 
реализована сетевая инфраструктура, объединяющая интересны компаниям, а  также физическим лицам, 
отдельные программные и аппаратные источники ин- которые занимаются разработкой и внедрением 
формации в единую систему сбора, хранения и предо- систем Умного дома. Внедрение данных результа-
бработки информации и событий безопасности. Верх- тов позволит повысить защищенность охраняемого 
ний уровень представляет собой сервер Умного дома, объекта, объединить разнородные физические и ки-
позволяя реализовать процесс управления инциден- бернетические источники данных в единую систему 
тами безопасности. комплексной защиты, а также упростить управление 

Предложенный комплексный подход позволяет информацией, касающейся событий и инцидентов 
сформировать функциональные и нефункциональные безопасности за счет интеллектуальных методов их 
требования к подобным системам. Данные требования обработки. 
могут быть направлены на вход методикам проекти- Кроме того, подход к разработке системы управ-
рования защищенных систем на основе встроенных ления инцидентами безопасности для комплексной 
устройств, например DLSEDS [16]. Подход DLSEDS пред- защиты элементов Умного дома также можно исполь-
ставляет собой объединение подхода к разработке без- зовать в обучающих и исследовательских целях в обла-
опасного программного обеспечения, методики проек- сти информационной безопасности, Интернета вещей 
тирования защищенных встроенных устройств, а также и встроенных устройств. 
разработанной авторами методики проектирования Также, результаты работы прототипа системы управ-
защищенной системы на основе встроенных устройств. ления инцидентами безопасности для  комплексной за-
При этом последняя методика выступает связующим зве- щиты элементов Умного дома могут быть использованы 
ном, формулирующим требования как к  методике про- в  качестве входных данных для систем управления ин-
ектирования защищенных встроенных устройств, так и формацией и событиями безопасности. Интеграция с си-
к подходу к разработке безопасного программного обе- стемами такого типа необходима для более детальной и 
спечения, а также обеспечивает защищенность среды высокоуровневой обработки обнаруженных инцидентов 
передачи данных между элементами системы. безопасности, сценариев атак и аномальной активности.

Рецензент: Молдовян Александр Андреевич, доктор технических наук, профессор, заведующий отделом 
проблем информационной безопасности ФГБУН Санкт-Петербургский институт информатики и 
автоматизации Российской академии наук, Санкт-Петербург, Россия. E-mail: maal305@yandex.ru 

Работа выполнена при частичной финансовой поддержке РФФИ (проекты 16-29-09482 и 18-07-01488) и бюджетной темы 
АААА-А16-116033110102-5.

Литература
1. Kotenko I.V., Levshun D.S., Chechulin A.A. Event correlation in the integrated cyber-physical security system // Soft Computing and 

Measurements (SCM), 2016 XIX IEEE International Conference on. – IEEE, 2016. – С. 484-486.
2. Desnitsky V.A., Levshun D.S., Chechulin A.A., Kotenko I.V. Design Technique for Secure Embedded Devices: Application for Creation of 

Integrated Cyber-Physical Security System // JoWUA. – 2016. – Т. 7. – №. 2. – С. 60-80.
3. Десницкий В.А., Чечулин А.А., Котенко И.В., Левшун Д.C., Коломеец М.В. Комбинированная методика проектирования защищенных 

встроенных устройств на примере системы охраны периметра // Труды СПИИРАН. – 2016. – Т. 5. – №. 48. – С. 5-31.
4. Ruiz J.F., Desnitsky V.A., Harjani R., Manna A., Kotenko I.V., Chechulin A.A. A methodology for the analysis and modeling of security threats 

and attacks for systems of embedded components // Parallel, Distributed and Network-Based Processing (PDP), 2012 20th Euromicro 
International Conference on. – IEEE, 2012. – С. 261-268.

5. Stefanni F. A Design & Verification Methology for Networked Embedded Systems. Ph.D. Thesis. University of Verona, Department of 
Computer Science, Italy. – April 7, 2011. –143 с.

6. Kruegel C., Valeur F., Vigna G. Intrusion detection and correlation: challenges and solutions. – Springer Science & Business Media, 2004. – Т. 
14.

7. Fedorchenko A.V., Kotenko I.V., Doynikova E.V., Chechulin A.A. The ontological approach application for construction of the hybrid security 
repository // Soft Computing and Measurements (SCM), 2017 XX IEEE International Conference on. – IEEE, 2017. – С. 525-528.

8. Kotenko I.V., Doynikova E.V., Chechulin A.A. Security metrics based on attack graphs for the Olympic Games scenario //Parallel, Distributed 
and Network-Based Processing (PDP), 2014 22nd Euromicro International Conference on. – IEEE, 2014. – С. 561-568.

9. Kotenko I.V., Chechulin A.A. Attack modeling and security evaluation in SIEM systems //International Transactions on Systems Science and 
Applications. – 2012. – Т. 8. – С. 129-147.

10. Kotenko I.V., Doynikova E.V. Selection of countermeasures against network attacks based on dynamical calculation of security metrics // 
The Journal of Defense Modeling and Simulation. – 2017. – С. 1-23. DOI: 10.1177/1548512917690278.

11. Buchmann A., Koldehofe B. Complex event processing // IT-Information Technology Methoden und innovative Anwendungen der 
Informatik und Informationstechnik. – 2009. – Т. 51. – №. 5. – С. 241-242.

12. Sadoddin R., Ghorbani A. Alert correlation survey: framework and techniques // Proceedings of the 2006 international conference on 
privacy, security and trust: bridge the gap between PST technologies and business services. Article No. 37.  – ACM, 2006. – 15 с.

13. Müller A. Event correlation engine // Department of Information Technology and Electrical Engineering-Master’s Thesis, Eidgenössische 
Technische Hochschule Zürich. – 2009. 

14. Tiffany M. A survey of event correlation techniques and related topics // Research paper, Georgia Institute of Technology. – 2002.
15. Denise W. Guerer, Khan I., Ogler R., Keffer R. An artificial intelligence approach to network fault management // Sri international. – 1996. – Т. 

86.
16. Levshun D.S., Chechulin A.A., Kotenko I.V. Design lifecycle for secure cyber-physical systems based on embedded devices //Intelligent 

Data Acquisition and Advanced Computing Systems: Technology and Applications (IDAACS), 2017 9th IEEE International Conference 
on. – IEEE, 2017. – Т. 1. – С. 277-282.

36 Вопросы кибербезопасности  №3(27) - 2018



Комплексный подход к обеспечению безопасности...

INTEGRATED APPROACH TO PROVIDE 
SECURITY OF CYBER-PHYSICAL SYSTEMS BASED 

ON MICROCONTROLLERS 
Kotenko I.V.10, Levshun D.S.11, Chechulin A.A.12, Ushakov I.A.13, Krasov A.V.14

The purpose of the paper consists in development of the integrated approach to provide security of cyber-physical sys-
tems based on microcontrollers.

Research method: systems analysis of modern attacks against cyber-physical systems based on microcontrollers and ap-
proaches to provide their security, development of the new approach and its experimental validation.

The result obtained: the paper considers an integrated approach for ensuring the security of cyber-physical systems 
based on microcontrollers. It proposes a generalized architecture of  the system for managing incidents and counteracting 
targeted attacks in distributed large-scale critical systems. This architecture realizes the proposed approach. The implementa-
tion of this architecture is considered in the framework of the security incidents management system for complex protection 
of Smart Home elements, including the implementation of a reliable and trusted data bus, a security event processing and 
correlation, a hybrid data store, an intelligent security event analysis, and a security metrics calculation.

The area of use of the proposed integrated approach is the formation of functional and non-functional requirements for 
cyber-physical systems based on microcontrollers, which can be directed as an input data of the design techniques for such 
systems development, for example, DLSEDS (Design Lifecycle of Secure Embedded Devices System).

Keywords: the design of secure systems, advanced persistent threats, alert correlation, intelligent alert analysis, data bus, 
hybrid storage, security metrics, countermeasures, Internet of things, smart home.

References
1. Kotenko I.V., Levshun D.S., Chechulin A.A. Event correlation in the integrated cyber-physical security system // Soft Computing and 

Measurements (SCM), 2016 XIX IEEE International Conference on. – IEEE, 2016. – P. 484-486.
2. Desnitsky V.A., Levshun D.S., Chechulin A.A., Kotenko I.V. Design Technique for Secure Embedded Devices: Application for Creation of 

Integrated Cyber-Physical Security System // JoWUA. – 2016. – Т. 7. – №. 2. – P. 60-80.
3. Desnitsky V.A., Chechulin A.A., Kotenko I.V., Levshun D.S., Kolomeec M.V. Kombinirovannaya metodika proektirovaniya zashchishchennyh 

vstroennyh ustrojstv na primere sistemy ohrany perimetra // Trudy SPIIRAN. – 2016. – Т. 5. – №. 48. – P. 5-31.
4. Ruiz J.F., Desnitsky V.A., Harjani R., Manna A., Kotenko I.V., Chechulin A.A. A methodology for the analysis and modeling of security threats 

and attacks for systems of embedded components // Parallel, Distributed and Network-Based Processing (PDP), 2012 20th Euromicro 
International Conference on. – IEEE, 2012. – P. 261-268.

5. Stefanni F. A Design & Verification Methology for Networked Embedded Systems. Ph.D. Thesis. University of Verona, Department of Computer 
Science, Italy. – April 7, 2011. – 143 p.

6. Kruegel C., Valeur F., Vigna G. Intrusion detection and correlation: challenges and solutions. – Springer Science & Business Media, 2004. – Т. 
14.

7. Fedorchenko A.V., Kotenko I.V., Doynikova E.V., Chechulin A.A. The ontological approach application for construction of the hybrid security 
repository // Soft Computing and Measurements (SCM), 2017 XX IEEE International Conference on. – IEEE, 2017. – P. 525-528.

8. Kotenko I.V., Doynikova E.V., Chechulin A.A. Security metrics based on attack graphs for the Olympic Games scenario //Parallel, Distributed 
and Network-Based Processing (PDP), 2014 22nd Euromicro International Conference on. – IEEE, 2014. – P. 561-568.

9. Kotenko I.V., Chechulin A.A. Attack modeling and security evaluation in SIEM systems //International Transactions on Systems Science and 
Applications. – 2012. – Т. 8. – P. 129-147.

10. Kotenko I.V., Doynikova E.V. Selection of countermeasures against network attacks based on dynamical calculation of security metrics // 
The Journal of Defense Modeling and Simulation. – 2017. – P. 1-23. DOI: 10.1177/1548512917690278.

11. Buchmann A., Koldehofe B. Complex event processing // IT-Information Technology Methoden und innovative Anwendungen der 
Informatik und Informationstechnik. – 2009. – Т. 51. – No. 5. – P.241-242.

12. Sadoddin R., Ghorbani A. Alert correlation survey: framework and techniques // Proceedings of the 2006 international conference on 
privacy, security and trust: bridge the gap between PST technologies and business services. Article No. 37.  – ACM, 2006. – 15 p.

10   Igor Kotenko, Dr.Sc., Professor, Head of Laboratory of Computer Security Problems at St. Petersburg Institute for Informatics and Automation of 
Russian Academy of Science, St. Petersburg, Russia. E-mail: ivkote@comsec.spb.ru 

11   Dmitry Levshun, Junior Research fellow at St. Petersburg Institute for Informatics and Automation of Russian Academy of Science, E-mail: levs-
hun@comsec.spb.ru 

12   Andrey Chechulin, Ph.D, Leading Research fellow at St. Petersburg Institute for Informatics and Automation of Russian Academy of Science, St. 
Petersburg, Russia. E-mail: chechulin@comsec.spb.ru

13   Igor Ushakov, Senior Lecturer at Bonch-Bruevich Saint-Petersburg State University of Telecommunications, St. Petersburg, Russia. E-mail:, usha-
kovia@gmail.com

14   Andrey Krasov, Ph.D, Associate Professor, Head of Secure Communication Systems department, Bonch-Bruevich Saint-Petersburg State University 
of Telecommunications, St. Petersburg, Russia. E-mail: krasov@inbox.ru

Вопросы кибербезопасности  №3(27) - 2018 37



Безопасность в сетях общего доступа УДК 004.056.53
13. Müller A. Event correlation engine // Department of Information Technology and Electrical Engineering-Master’s Thesis, Eidgenössische 

Technische Hochschule Zürich. – 2009. 
14. Tiffany M. A survey of event correlation techniques and related topics // Research paper, Georgia Institute of Technology. – 2002.
15. Denise W. Guerer, Khan I., Ogler R., Keffer R. An artificial intelligence approach to network fault management. Sri international. – 1996. – 

Vol. 86.
16. Levshun D.S., Chechulin A.A., Kotenko I.V. Design lifecycle for secure cyber-physical systems based on embedded devices //Intelligent 

Data Acquisition and Advanced Computing Systems: Technology and Applications (IDAACS), 2017 9th IEEE International Conference 
on. – IEEE, 2017. – Vol. 1. – P. 277-282.

38 Вопросы кибербезопасности  №3(27) - 2018