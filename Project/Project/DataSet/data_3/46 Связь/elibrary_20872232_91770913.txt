Вестник СибГУТИ. 2012. № 4 31 

УДК 621.391.26 
 
 

Исследование пространственно-временно́й 
 корреляционной модели 

 для радиосистем с разносом передачи 
 
 

Р.С. Тимощук, В.И. Носов  
 

Исследование помехоустойчивости MISO-систем различных порядков, представленное 
в данной статье, использует в качестве математической основы теорию разнесённого 
приёма сигналов по коррелированным каналам связи. В ходе исследования выводится 
обобщённый коэффициент пространственной корреляции. На основе теории квазиорто-
гонального пространственно-временно́го кодирования выводится коэффициент взаимной 
корреляции векторов передаваемых сигналов. Используя коэффициент множественной 
корреляции, учитывающий влияние двух указанных выше факторов, строится матрица 
коэффициентов передачи канала. Оценка помехоустойчивости MISO-систем N-порядка 
выполнена на основе функции вероятности ошибки, вычисленной при помощи собствен-
ных чисел матрицы коэффициентов передачи канала. Приведены графики зависимости 
коэффициента битовых ошибок от отношения сигнал/шум, рассчитанные теоретически 
для нескольких частных случаев. Для подтверждения полученных теоретических резуль-
татов    приводятся   характеристики   помехоустойчивости   различных  MISO-систем   
N-порядка, полученные с помощью компьютерного моделирования в среде MATLAB. 
 
Ключевые слова: пространственно-временно́е кодирование, код Аламоути, разнос переда-
чи, борьба с замираниями, беспроводная радиосвязь, пространственная корреляция. 

 
 

1. Введение 
 
В современных беспроводных телекоммуникациях техника MISO (Multiple Input Single 

Output) является многообещающим подходом, с помощью которого можно достичь хорошей 
помехоустойчивости системы радиосвязи за счёт повышения спектральной эффективности. 
Спектральная эффективность, которую удаётся достичь в системах MISO, зависит от ряда 
факторов, таких как средняя мощность принимаемого сигнала, тепловой шум приёмника, 
а также межканальная интерференция. Более того, в многоразмерных статистических средах 
эффект замираний играет ключевую роль в производительности системы MISO. Таким обра-
зом, для расчёта помехоустойчивости системы MISO необходимо учитывать модель про-
странственной корреляции, которая влияет на основные характеристики передаваемого 
сигнала. 

Корреляционная пространственно-временна́я модель передачи канала связи представляет 
собой математическую модель, позволяющую описать характеристики распространения сиг-
налов в пространстве с учётом эффекта пространственной корреляции и взаимной корреля-
ции сигналов, кодированных с помощью пространственно-временны́х кодов. С помощью 
корреляционной модели передачи канала возможно оценить коэффициент вероятности 
ошибки для цифровой системы связи, с характеристиками, максимально приближёнными 
к характеристикам реальных систем радиосвязи. 



32  Р.С. Тимощук, В.И. Носов 

Корреляция в MISO-системах в последнее время вызывает большой интерес и часто ис-
следуется в литературе [1 – 6], при этом предлагаются различные модели, описывающие её 
характеристики. В данной статье описывается корреляционная модель для  MISO-системы  
N-порядка, учитывающая пространственную корреляцию сигналов и взаимную корреляцию 
сигналов, кодированных квазиортогональным кодом, передаваемых одновременно с не-
скольких антенн. 

В современной литературе достаточно широко освещён вопрос создания новых помехо-
устойчивых ортогональных STBC кодов, поскольку они обеспечивают лучшую помехо-
устойчивость по сравнению с другими видами пространственно-временно́го кодирования. 
При этом данные коды не могут теоретически обеспечить полную скорость кода, а также 
сложны в декодировании. Квазиортогональные пространственно-временны́е коды способны 
обеспечить полную скорость кодирования и при этом имеют достаточно низкую сложность 
декодирования, т.к. основываются на простейшей схеме Аламоути. Поэтому их использова-
ние может быть оптимальным при разработке новых систем радиосвязи. 

В научных исследованиях [2, 7 – 11], посвящённых классической теории разнесённого 
приёма, подробно изучается эффект корреляции между приёмными антеннами, а также его 
влияние на помехоустойчивость приёма. В настоящее время, с появлением STBC кодов, ис-
пользующих множественные передающие антенны, большой интерес представляет исследо-
вание не только пространственной корреляции сигналов между передающими антеннами, 
но и корреляция векторов излучаемых сигналов при пространственно-временно́м кодирова-
нии. Влияние этих двух факторов корреляции должно учитываться при оценке помехоустой-
чивости современных MISO-систем радиосвязи. 

В целях оценки потенциальной помехоустойчивости в современной и классической ли-
тературе приводится множество формул функций вероятности ошибки, выведенных в анали-
тическом виде, для частных случаев систем или моделей радиоканалов, например, для случая 
с 2-мя передающими антеннами и отсутствием корреляции [3], или для случая множествен-
ного приёма без использования кодов STBC (Space Time Block Code) [9], или для случая иде-
ального ортогонального STBC-кода [4]. Указанные частные случаи не отражают 
характеристики реальных систем радиосвязи. Поэтому разработка универсальной методики 
оценки помехоустойчивости, учитывающей все факторы, необходима для достоверного про-
гнозирования полной вероятности ошибки для проектируемых устройств. 

Основной целью проводимых исследований является создание математической модели 
для расчёта характеристик систем радиосвязи и оценки эффекта увеличения помехоустойчи-
вости при увеличении числа передающих антенн, с учётом корреляции между разнесёнными 
антеннами и корреляции между символами квазортогональных кодов. 

 
2. Модель пространственной корреляции 

 
Модель корреляции рассматривается исходя из предположения, что корреляция между 

приёмными антеннами независима от корреляции между передающими антеннами. Другими 
словами, предполагаем, что только близкорасположенные антенны оказывают влияние друг 
на друга и не оказывают никакого влияния на корреляцию между антеннами, находящимися 
на другом конце радиолинии. Это допущение учитывает разные условия распространения 
сигнала, например, условия плотной застройки [5]. 

Пространственная корреляция, согласно [14], для MIMO-канала с плоскими замираниями 
определяется выражением 

RH  E[vec(H)vec(H)H ], (1)
     

где vec(H) обозначает вектор   размера Nr×Nt,   составленный из столбцов матрицы    H;     
Nr – количество приёмных антенн; Nt – количество передающих антенн; H – матрица отно-
шений энергии сигнала к спектральной плотности мощности шума размера Nr×Nt. 



Исследование пространственно-временной корреляционной модели для радиосистем с разносом передачи      33 
 

Согласно [15], матрица пространственной корреляции для системы MIMO определяется 
формулой: 

R  RT
H TX RRX ,      (2) 

где  - оператор Кронекера; ( )Т – транспонирование матрицы. 
Матрицы RTX и RRX определяются следующими ковариационными матрицами: 

R  E[(hq )H
T hq

X ] , для всех q = 1, 2, … , Nr , 

RRX  E[hp (hp )H ] , для всех p = 1, 2, … , Nt ,     (3) 

где hq – это q-ая строка матрицы H; hp – p-й столбец матрицы H. 
В случае, когда коэффициент корреляции сигналов в соседних антеннах на передающем 

конце равен rTX и на приёмном конце равен rRX, для определения матрицы коэффициента 
корреляции используются следующие выражения [9, 14]: 

 1 r r 2 ... r Nt 1
TX TX TX   1 r r 2 ... r Nr 1

RX RX RX 
 r 1 ... ...   
 TX rTX   rRX 1 rRX ... ... 

RTX   r 2
TX r 2 

 TX 1 ... r , R 2
RX   r r 1 ... r 2 

TX   RX RX RX   .  (4) 
 ... ... ... ... rTX   ... ... ... ... rTX 
 N 1 2
r t

TX ... r 
TX rTX 1 r Nr 1 r 2

  RX ... RX r 1 
RX 

В случае системы типа MISO (множественная передача, одиночный приём) результиру-
ющая матрица равна RTX. 

 
2.1. Коэффициент корреляции сигналов в двух соседних антеннах 

 
В случае типовых условий распространения сигнала, радиоволны приходят на приёмник 

с определённой азимутальной расходимостью. Это рассеивание мощности при многолучевом 
приёме описывается функцией p(θ), где θ – азимутальный угол. Угловое рассеивание Λ – 
очень важный параметр распространения сигнала, который определяет коэффициент рассеи-
вания, и выражается формулой [7]: 


F 2 2

  1 1
2 ,   Fn   p( )exp( jn )d ,  (5) 

F0 0
где Fn – n-й комплексный коэффициент Фурье функции p(θ).  

Угловое рассеивание Λ принимает значения от 0 до 1, где 0 обозначает один луч, прини-
маемый с одного направления, а 1 означает одинаковую рассеянную мощность по всем 
направлениям приёма. 

Определение углового рассеивания Λ имеет большое практическое значение, поскольку 
оно напрямую связано с замираниями сигнала в локальной зоне [2]. Среднеквадратическая 
скорость изменения замираний R в канале Релея связана с угловым рассеиванием по формуле 

 dR 2
  k 2

E 
    ER2,      (6) 
 dd   4

где k – волновое число; k 2
 ; d – расстояние; ER2 – среднеквадратическая скорость за-


мираний в локальной зоне. 



34  Р.С. Тимощук, В.И. Носов 

Приведённая формула позволяет сделать вывод, что скорость замираний уменьшается, 
когда сигнал концентрируется по одному направлению приёма. 

В качестве примера рассмотрим ситуацию, когда рассеянная энергия поступает на вход 
приёмника с непрерывного диапазона азимутальных углов (рис. 1). Тогда функция p(θ) будет 
иметь вид 

P :    
p( )  T 0 0

    (7) 
0 : в любом другом случае

 
Рис. 1 – Угловое рассеивание мощности p(θ) 

 
 
Угол α – обозначает ширину сектора принимаемого рассеянного сигнала (в радианах), 

а угол θ0 – начальный угол сдвига. Исходя из формулы (5) среднее угловое рассеивание для 
такого случая равно 

 2  2  2cos
  .     (8) 

2
Частные случаи выражения (8) дают лучшее понимание определения углового рассеива-

ния. Приём сигнала с одного направления соответствует α=0, что приводит к результату Λ=0. 
Если сигнал принимается со всех сторон, то тогда α = 2π, что даёт результат Λ = 1. 

Пространственная взаимная корреляция сигналов на выходах передающих антенн явля-
ется важным параметром для разработчиков передающих устройств, использующих про-
странственный разнос. Пространственная взаимно-корреляционная функция p(d) определяет, 
насколько далеко должны отстоять антенны друг от друга для того, чтобы замирания сигна-
лов в них были декоррелированы. Точное вычисление p(d) для реального углового рассеива-
ния очень затруднительно и во многих случаях неоднозначно, зависит от направления 
движения z. 

В связи с этим, функцию p(d), с учётом усреднения по всем возможным азимутальным 
направлениям, можно вычислять приближённо 

 2

p(d )  exp 23 2  d 
  

  
  .    (9) 
    

Данное выражение верно для относительно малых d, однако большинство практических 
применений пространственного разноса используют именно такие расстояния между антен-
нами. 

Замирания считаются достаточно декоррелированными, если p(d) = 0.37, что определяет 
статистическую длину корреляции [1]. Длина корреляции lc взаимно-корреляционной функ-
ции – это значение, которое удовлетворяет следующему критерию: 

p(lc) = exp(− 1).     (10) 
Применяя это определение к (9), получим, что усреднённая длина корреляции определя-

ется выражением 



Исследование пространственно-временной корреляционной модели для радиосистем с разносом передачи      35 
 

l 
c  .     (11) 

 23
Данное выражение аналитически демонстрирует, как длина корреляции возрастает при 

уменьшении углового рассеивания Λ. В случае всенаправленного рассеивания мощности при 
приёме (Λ = 1) длина корреляции lc = 0.21λ, что подтверждается классической теорией разне-
сения [1]. Из этого следует, что для получения величины коэффициента корреляции сигналов 
на выходах соседних антенн p(d) = 0.37 необходимо их разнести на lc = 0.21λ. 

На рис. 2 показаны зависимость коэффициента корреляции p(d) от расстояния между ан-
теннами d при угловом рассеивании Λ =0.2475[7]. 

 
Рис. 2 – Зависимость коэффициента корреляции p(d) от расстояния  

между антеннами d при угловом рассеивании Λ = 0.2475 
 
 

3. Корреляция квазиортогонального пространственно-временно́го кода 
 
Степень корреляции между передаваемыми сигналами зависит от степени разноса 

между передаваемыми кодовыми словами (векторами сигналов). Наименьшая корреляция 
сигналов достигается при использовании ортогональных способов передачи. Согласно опре-
делению, ортогональными называются сигналы, которые изменяются независимо и имеют 
нулевую корреляцию.  

Ортогональность кода достигается при использовании техники кодирования Аламоути, 
которая применяет 2 передающие антенны. При большем количестве передающих антенн 
используются другие ортогональные коды, в т.ч. и с задержкой по времени. Ортогональность 
обеспечивается за счёт снижения скорости кода. 

Хорошим примером ортогональных кодов могут служить коды Тароха: 



36  Р.С. Тимощук, В.И. Носов 

 s1 s2 s3 s4 
 s s  s s
 2 s1  4 s 

3  1 s2 3 0 
 s  

3 s4 s1  s  s2 s1 0 s 
2

 3 
 s  s  ,   C4,3/4  

 .   (12) 
C   4 3 s2 s1   s

4,1/2  3 0 s1  s2
s 

 1 s2 s3 s4 
s 0 s s s 


 s2 1 s4 s    3 2 1 

3
 s
 3 s4 s1  s 

2 
 s4  s3 s2 s1 

Данные коды достигают скоростей rc=1/2 и rc=3/4 соответственно. 
Снижения скорости кода можно избежать, используя рекурсивное правило построения 

комплексного кода Уолша – Адамара для кодов высоких порядков. Полученный код даёт ча-
стичную ортогональность, т.е. не все векторы передаваемых сигналов между собой ортого-
нальны (квазиортогональные коды, Q-STBC), и обеспечивает неполный разнос, как 
например, код Джафархани 

 s1 s2 s3 s4 
 s 

C  2 s1  s
 4 s3 

4,1  .    (13) 
 s3  s4 s1 s2 
 s 
 4  s3  s2 s1 

В случае использования Q-STBC кодов скорость кода остаётся полной, равной единице, 
но при этом кодовые слова (векторы сигналов) становятся коррелированными. Например, 
критерий ортогональности для кода Джафархани соблюдается только для столбцов (1 и 2),  
(1 и 3), (2 и 4) и (3 и 4). Степень корреляции, а значит ортогональности, определяется коэф-
фициентом rSTBC. 

В общем случае 0 ≤ rSTBC ≤ 1, а в случае ортогонального кодирования сигнала rSTBC = 0. 
В функциональном пространстве сигналов эта степень связи может выражаться в нормиро-
ванных единицах коэффициента корреляции. 

Коэффициент взаимной корреляции дискретных сигналов определяется через свёртку 
векторов по формуле [11]: 


( f  g)[n]  f [m]g[nm],     (14) 

m
где f и g –  векторы дискретных   сигналов; n – задержка между двумя  функциями;  * – знак 
свёртки. 

Поскольку коэффициент корреляции принимает значения [−1; +1], то необходимо ис-
пользовать нормированную свёртку векторов: 

r ( f  g)
STBC  .      (15) 

f  g
Для того чтобы проиллюстрировать использование формулы (15), применим её для рас-

чёта коэффициента корреляции в схеме Аламоути 
A  A

rSTBC2 = 1 2 ,      (16) 
A1  A2

где A1 = S1,S2  и A2 = S2 ,S1   – векторы передаваемых сигналов с первой и со второй ан-
тенны соответственно. 

Вычислим комплексную свёртку двух векторов: 
A1  A2   = S1  S2  S2   S1  S1  S2  S2  S1  0 . (17) 

Таким образом, коэффициент корреляции для схемы Аламоути  rSTBC2 = 0. 
 



Исследование пространственно-временной корреляционной модели для радиосистем с разносом передачи      37 
 

В случае если сигнал передается по более, чем 2-м антеннам, для кодирования сигналов 
применяются методы квазиортогонального пространственно-временно́го блочного кодиро-
вания. В данном случае не все коэффициенты корреляции между передаваемыми сигналами 
будут равны нулю (табл. 1). 

Таблица 1. Кодирующая и передаваемая последовательности 
                   для схемы с  четырёхканальной разнесённой передачей 

 Антенна 1 Антенна 2 Антенна 3 Антенна 4 
T S1 S2  S3  S4 

t + T S2   S1  S 4   S3  
t + 2T  S3  S 4   S1   S 2  
t + 3T S4 -S3 -S2 S1 

 
Докажем ортогональность векторов сигнала (1, 2) , (1, 3), (2, 4), (3, 4): 

A1  A2 S1 S2 S2 S1  S3 S4 S4 S3  0,    

A1  A3 S1 S3  S2 S4 S3 S1 S4 S2  0,    

A2  A4 S2 S4  S1 S3 S4 S2 S3 S1  0,    

A3  A4 S3 S4 S4 S3  S1 S2 S2 S1  0.    (18) 
Принимая во внимание, что мощности, излучаемые со всех четырёх антенн, одинаковы, 

коэффициент корреляции между другими векторами (2, 3) и (1, 4) обозначим как rSTBC4 (кор-
реляция между двумя неортогональными векторами сигнала, кодированного квазиортого-
нальным кодом). 

Тогда матрица корреляции RSTBC4 для кода 44 выглядит следующим образом: 
 1 0 0 rSTBC 4 
 0 1 r 0 

R   STBC 4 
STBC4 .    (19) 

 0 rSTBC 4 1 0 
 
rSTBC 4 0 0 1 

 
В случае передачи сигнала по 8-ми передающим антеннам, матрица комплексных значе-

ний сигнала будет выглядеть следующим образом (табл. 2): 
Таблица 2. Кодирующая и передаваемая последовательности  

  для схемы восьмиканальной разнесённой передачи 
 А1 А2 А3 А4 А5 А6 А7 А8 

T S1 S2 S3 S4 S5 S6 S7 S8 
t + T S2   S1  S 4   S3  S6   S5  S8   S7  
t + 2T S3  S 4   S1   S 2  S7  S8   S5   S6  
t + 3T S4 -S3 -S2 S1 S8 -S7 -S6 S5 
t + 4T S5  S6  S7  S8   S1   S 2   S3   S 4  
t + 5T S6 -S5 S8 -S7 -S2 S1 -S4 S3 
t + 6T S7 S8 -S5 -S6 -S3 -S4 S1 S2 
t + 7T S8   S7   S6  S5   S 4  S3  S2   S1  

 
Векторы (A1,A2), (A1,A3), (A1,A5), (A1,A8), (A2,A4), (A2,A6), (A2,A7), (A3,A4), (A3,A6), (A3,A7), 

(A4,A5), (A4,A8), (A5,A6), (A5,A7), (A6,A8), (A7,A8) попарно ортогональны, т.к. их скалярное про-
изведение равно нулю. 



38  Р.С. Тимощук, В.И. Носов 

Векторы (A1,A4), (A1,A6), (A1,A7), (A2,A3), (A2,A5), (A2,A8), (A3,A5), (A3,A8), (A4,A6), (A4,A7), 
(A5,A8), (A6,A7) попарно не ортогональны, следовательно, коэффициент их корреляции не ра-
вен нулю. 

Обозначим коэффициент корреляции между неортогональными  векторами rSTBC8.  Тогда 
матрица корреляции RSTBC8 для кода 88 выглядит следующим образом: 

 1 0 0 rSTBC8 0 rSTBC8 rSTBC8 0 

 0 1 rSTBC8 0 rSTBC8 0 0 r 

STBC8 
 0 rSTBC8 1 0 rSTBC8 0 0 rSTBC8 
r TBC8 0 0 1 0 rSTBC8 rSTBC8 0 

R S 
STBC8    . (20) 

0 r r BC8 0 1 0 0 rSTBC8  STBC8 ST 
rSTBC8 0 0 rSTBC8 0 1 rSTBC8 0 
r C8 0 0 rSTBC8 0 rSTBC8 1 0 
 STB 
 0 rSTBC8 rSTBC8 0 rSTBC8 0 0 1 

По горизонтали и вертикали столбцы и строки матрицы соответствуют номерам переда-
ющих антенн, соответственно. В случае если вектора излучаемых сигналов  ортогональны, 
значение коэффициента корреляции равно нулю; если нет, то значение равно rSTBC8.  

 
 

3.1.  Коэффициент корреляции для кода N-антенных систем 
 
В общем виде матрица корреляции квазиортогонального кода STBC может быть записа-

на следующим образом: 
RSTBC = rSTBC∙ISTBC ,                 (21) 

где rSTBC – коэффициент взаимной корреляции двух неортогональных векторов в квазиорто-
гональном коде STBC; ISTBC – единичная матрица, получаемая по рекурсивному правилу по-
строения комплексного кода Уолша – Адамара 

 ISTBC ISTBC
I   N/2 N/2 

STBC                (22) 
N ISTBC I ,  

STBC
 N/2 N/2 

где N = 2n – количество передающих антенн (n – целое положительное число),   – матема-
тический оператор отрицания (not) в двоичной системе. 

Для нахождения матрицы корреляции RSTBC4  кода 44 по формуле (21) необходимо вы-
числить значение ISTBC  

4

 ISTBC ISTBC 
I   2 2 

STBC  ) 
4 ISTBC I .    (23

STBC 
 2 2 

Известно, что единичная матрица размера 22 равна 

I 1 0
STBC    .     (24) 
2 0 1

Следовательно, 
1 0 0 1


I 0 1 1 0
STBC    .     (25) 
4 0 1 1 0

1 0 0 1



Исследование пространственно-временной корреляционной модели для радиосистем с разносом передачи      39 
 
По формуле (21) имеем: 
 

RSTBC4 = rSTBC4∙ISTBC4 , 
1 0 0 1


R STBC 0 1 1 0
STBC4  r 4  , 

0 1 1 0
 
1 0 0 1

 1 0 0 rSTBC4 


STB
S B  0 1 r C4 0 

R T C4   ,    (26) 
 0 rSTBC4 1 0 

rSTBC4 0 0 1 


где rSTBC4 – коэффициент корреляции векторов сигналов для случая с 4-мя передающими ан-
теннами. 

Выражение (26), полученное аналитическим путём, совпадает с ранее приведённым вы-
ражением (19), полученным с помощью вычисления ортогональности векторов сигналов, из-
лучаемых с разных антенн.  

Следует отметить, что диагональ матрицы RSTBC всегда равна 1, поскольку корреляция 
вектора с собой всегда равна 1. 
 

4. Помехоустойчивость приёма в каналах с корреляцией 
 
Вероятность ошибки при когерентном приёме с выхода n статистически неоднородных 

независимых релеевских каналов при любом виде манипуляции, при произвольной структу-
ре двоичных сигналов в каждом канале, определяется формулой [9]: 

 
 

1 
 n n1 

pош  1  
 k k 

2 n  ,         (27) 
 k1
 (k   

p ) 1 k 
 p1 
 pk 

где λk – собственные числа матрицы отношений энергии сигнала к спектральной плотности 
мощности шума KMISOQMISO, которая рассчитывается из общей матрицы KQ, но учитывает 
пространственную и кодовую корреляцию (матрица R). 

Матрица K коэффициентов передачи канала записывается в общем виде [9]: 
2

1 
 0  0 
 2 
 2 
 0 2 ,     (28) 

 0 
K   2 

     
 
 2 
 0 0  NTX 
 2 

 
матрица Q отношений сигнал/шум записывается в общем виде [9]: 



40  Р.С. Тимощук, В.И. Носов 

q2
1 0  0 

 
 0 q2 

Q   2 0 
 ,     (29) 

     
 0 0 q2 
 
 NTX 

 
где μk – коэффициент передачи канала k [9]; k = 1, 2, … , NTX; NTX – количество передающих 
антенн в системе MISO. 

В случае если средние мощности сигналов, передаваемых с каждой антенны, равны, ве-
личина q 2

k  определяется следующим образом [9]: 
q2 PcT

k  2 .      (30) 


Произведение матриц K∙Q имеет вид: 
2

1 PcT 
 2 0  0 
 21 
 2 
 0 2 PcT

 2  0  .
K Q        (31) 

 2 2 
     
 
 2

N PcT 
 0 0  TX 
 2 2

TX 
Известно [9], что отношение энергии сигнала к спектральной плотности мощности шума 

hk  определяется выражением 
2

h2 k PcT
k  2 ,      (32) 

 k
где Pc – средняя мощность сигнала, излучаемого с одной антенны; T – временной интервал 
передачи сигнала; ν2 – спектральная плотность мощности шума. 

Тогда 
h2 
 1 0  0 
 2 
 
 h2 
 0 2  0 

K Q  2   H,     (33) 
 
     
 
 h2 
 0 0  NTX 
 2 

где H – матрица отношений энергии сигнала к спектральной плотности мощности шума. 
 

4.1.  Влияние пространственной и кодовой корреляции 
 

Поскольку в системах MISO в рассматриваемом случае используется квазиортогональное 
STBC-кодирование, то на искажение сигнала влияет не только пространственный разнос ан-
тенн (коэффициент корреляции rTX), но и неортогональность кода (коэффициент корреляции 
rSTBC). Поэтому для учёта влияния двух факторов используется коэффициент множественной 
корреляции R. Таким образом, матрица KMISOQMISO имеет следующий вид: 

KMISOQMISO = KQ∙R = H∙R,             (34) 



Исследование пространственно-временной корреляционной модели для радиосистем с разносом передачи      41 
 

R – матрица множественной корреляции с элементами Rx, которые рассчитываются по 
формуле [10]: 

R  CTR 1
x xxC ,      (35) 

где С – матрица коэффициентов корреляции различных влияющих факторов; Rxx – матрица  
коэффициентов взаимной корреляции между этими факторами. Значения C и Rxx определя-
ются по формулам: 

 1 r
 TX r

i STBC 
C  rTX r i

STBC  , Rxx    ,   (36) 
rTX r

i STBC 1
i 

где rTXi – элемент матрицы пространственной корреляции, рассчитанной по формуле (9); 
rSTBCi – элемент матрицы корреляции передаваемых сигналов, рассчитанной по формуле (15). 

Подставляя (36) в (35), получим коэффициент множественной корреляции Rx: 
 1 r r


TX STBC 
 r 2 2 2 2

TX rTXrSTBC 1 rTXrSTBC 1 


Rx    
  r r
r   r r 1   TX ; STBC  .   (37) 

STBC  TX STBC  
 r2 2 2 2

TXrSTBC 1 rTXrSTBC 1
Из выражения (37) следует, что коэффициент множественной корреляции при ненулевой 

корреляции между антеннами и ненулевой корреляции между кодовыми словами определя-
ется выражением 

r2  r2  2r2 r2
R TX STBC TX STBC

x  2 2 .    (38) 
1 rTXrSTBC

Заметим, что при любых C  rTX rSTBC результирующий коэффициент корреляции 
всегда больше или равен наибольшему коэффициенту корреляции. 

Подставляя (38) и (35) в (33), получим матрицу отношений энергии сигнала к спектраль-
ной плотности мощности шума  
KMISOQMISO 


h2 r2  r2 2r2 r2 1 2 2 1 2 2

TX STBC TX STBC 2
2 1 h r N   r  2r N  

 r
h i i 1 TX STBCi TX STBCi 

 1 2 1 r2 R2  2 1 2 2
2 TX STBC 1 rN   

 TX r
i STBCi 

 
 


h2 r2  r2  r2 r2
T 2 r N22 2 2 2 2

2 X STBC 2 h  r  2r N  
 r 
 i TX STBCi h2 2 TX STBCi TX STBCi

2 1 2 2 2
  rTXr  2

STBC 2 1 rN 22 2 
 TX r

i STBC 
 i 
 
 
   

 
 
 
 2 rN 12  r2 2rN 12r2

h2 rN 22  r2 2rN 22
h r2

N TX STBCi TX STBCi N TX STBCi TX STBCi h2 
  N 
 2 1 rN12r2 2 1 rN22r2

TX 2 
 STBCi TX STBCi 

(39) 
где h 2

i  – отношение энергии сигнала к спектральной плотности мощности шума i-го канала; 
rstbci – элемент матрицы Rstbc коэффициентов корреляции кода STBC; N – количество пере-



42  Р.С. Тимощук, В.И. Носов 

дающих антенн; rTX – коэффициент пространственной корреляции между антеннами, рассчи-
танный по формуле (9). 

Полученная формула (39) является корреляционной моделью канала для системы MISO 
с N передающими антеннами, для любых каналов передачи с релеевскими замираниями h 2

i , 
рассчитанными для каждой антенны, с учётом пространственной корреляции между антен-
нами rTX, а также с учётом неортогональности (rSTBC) любого пространственно-временно́го 
кода STBC. 

 
4.2.  Оценка вероятности ошибки для частных случаев 

 
Вычисление собственных чисел λk матрицы (39) является непростой задачей, т.к. для это-

го необходимо найти корни уравнения: 
|KMISOQMISO - λI| = 0,     (40) 

где | | – детерминант матрицы; I – единичная матрица. 
Для нахождения собственных чисел некоторых матриц воспользуемся программным 

средством математических вычислений MathCad. 
Рассмотрим наиболее простые результаты аналитических расчётов в общем (аналитиче-

ском виде) для случаев с 2-я, 4-я и 8-ю передающими антеннами. 
 

2-х антенная система 
 
Пусть коэффициенты корреляции неизвестны и обозначены соответственно: rTX – корре-

ляция между соседними передающими антеннами; rSTBC – корреляция между 2-мя векторами 
сигналов, разнесённых (кодированных) с помощью произвольного STBC-кода.  

Матрица отношений энергии сигнала к спектральной плотности мощности шума равна 

h2  1 rTX K   
MISOQMISO 2  .  ( 1  

r    4 )
TX 1 

Тогда собственные числа матрицы KMISOQMISO для 2-х антенн равны: 

h2 h2
1  (1 rTX )  ,  (1 )

2 2   r
2 TX .   (42) 

Поскольку любой STBC-код размера 2×2 является ортогональным, то rSTBC = 0 для двух 
любых сигналов. 

Вероятность ошибки, вычисленная для данного случая, равна 

1  1 r (1 r )h2 1 r (1 r )h2 
p  1 TX TX TX TX 

ош2 2    .  (43)
2 2

 2rTX (1 rTX )h  2 2rTX (1 rTX )h  2 
 


Полученный результат для системы MISO полностью совпадает с классической теорией 

помехоустойчивости разнесённого приёма, где используется система SIMO [9]. 
Данный результат получен исходя из предположения, что мощность сигнала, излучаемо-

го с каждой антенны в системе MISO равна мощности, излучаемой одной антенной при раз-
несённом приёме. Но в реальных системах MISO полная мощность, как правило, делится 
поровну между всеми передающими антеннами. При этом помехоустойчивость системы 
ухудшается, поскольку отношение полной энергии сигнала к спектральной плотности мощ-
ности шума h 2

i  для каждого канала равно 
2

h2 hS
i  ,      (44) 

Nt
где hS – отношение полной энергии сигнала к спектральной плотности мощности шума. 



Исследование пространственно-временной корреляционной модели для радиосистем с разносом передачи      43 
 

В этом случае, при Nt = 2, формула (43) примет вид 
1  2 2
 1 rTX (1 rTX )hS 1 rTX (1 rTX )h 

p    S 
ош2 1 . (4

2 2 2
 2rTX (1 rTX )hS  4 2rTX (1 rTX )hS  4 

5) 


Графики функций, построенных по формуле (45) (обозначены пунктирной линией) на 
рис. 3, показывают, что при росте пространственной корреляции наблюдается значительное 
ухудшение помехоустойчивости для системы MISO с двумя передающими антеннами. Так, 
при вероятности ошибки 10-2 наблюдается проигрыш по отношению сигнал/шум на 2 дБ си-
стемы с коэффициентом пространственной корреляции rTX = 1 по сравнению с системой с 
коэффициентом пространственной корреляции rTX = 0.5. При той же вероятности ошибки 
уменьшение коэффициента пространственной корреляции с rTX = 0.5 до rTX = 0 наблюдается 
проигрыш по отношению сигнал/шум всего на 0.1 дБ. 

 

Рис. 3 – Зависимость вероятности ошибки от Eb N0  для 2-х антенной системы MISO 
с кодом Аламоути при модуляции BPSK, для коэффициентов пространственной корреляции 

rTX = 1 (кривые 1); 0.5 (кривые 2); 0 (кривые 3) 

Компьютерное моделирование систем с различными коэффициентами пространственной 
корреляции подтверждает теоретическое исследование помехоустойчивости по разработан-
ной методике, по формуле (39). Моделирование проводилось с помощью специального ин-
струмента анализа BERTool, входящего в программный пакет MATLAB. При моделировании 
использовалась модуляция BPSK. Графики зависимости вероятности ошибки от отношения 
Eb N0 (показаны сплошной линией) отличаются от теоретических зависимостей на 0.2 дБ 
для случая с rTX = 1 и менее 0.1 дБ для случая с rTX = 0, что остается в рамках допустимой 
погрешности вычислений. 

 
4-х антенная система 
 
Матрица отношений энергии сигнала к спектральной плотности мощности шума для 

данного случая определяется выражением: 



44  Р.С. Тимощук, В.И. Носов 

 1 rTX 0 r 
 STBC 


r 1 r 2 2 2 2
 TX  rSTBC  2rTXr 

STBC 0 
h2  TX

K  1 r 2 2
S TXr 

 . (46) 
MISOQMISO  STBC

 
8 

0 r 2 2 2 2
 TX  rSTBC  2rTXr 

STBC 
 1 r
 1 r 2 r 2 TX 

TX STBC 
 
rSTBC 0 rTX 1 

Собственные числа матрицы KMISOQMISO для 4-х передающих антенн и квазиортого-
нального STBC-кода равны: 

h2  r r R2 2
x  2R 2

xr


S 1 STBC TX STBC  4r  r
 TX STBC

1 
 
     ,     

8  2 2 2 
h2 

 r r R2  2R r  4r 2  r 2 
  S

1
STBC  TX  x x STBC TX STBC 

2  ,     
8  2 2 2 
h2  2   2  2 

  S  rST r R 2 STBC 4
1 BC TX x Rxr rTX rSTB
    C 

3  ,     
8  2 2 2 

h2  r r R2  2
1 x Rxr

2 2
S STBC TX STBC  4r  r 

 TX STBC
4 

  
    .    (47) 

8  2 2 2 
Вероятность ошибки определяется в общем виде по формуле  

h2R 2 2 2
S x rSTBC  Rx 2RxrSTBC 4rTX rSTBC 2 3

R 2 2 2
x rST Rx 2Rxr 4r r 2

1 Rxh
2 h2r 2h2 h2 R2 2 2 BC   STBC  TX  STBC 
S  S STBC  S  S x 2RxrSTBC 4rTX rSTBC 16

pош4   
2 16R  2 2 2 2 2

x rSTBC Rx rSTBC  Rx 2RxrSTBC 4rTX rSTBC  Rx 2RxrSTBC 4rTX r2
STBC

h2R 2 2 2
S x rSTBC  Rx 2RxrSTBC 4rTX rSTBC 2 3

R  2 2 2
x r Rx 2Rxr 4r 2

2 2 2 2 2 2 2 STBC   STBC  TX rSTBC 
RxhS hSrSTBC 2hS hS Rx 2RxrSTBC 4rTX rSTBC 16

 
16R  2 2 2 2 2

x rSTBC Rx rSTBC  Rx 2RxrSTBC 4rTX rSTBC  Rx 2RxrSTBC 4r r2
TX STBC

h2 2 2 2
S Rx rSTBC  Rx 2RxrSTBC 4rTX rSTBC 2 3

Rx r 2 2 2 
2 2 2 2 2 2 2 STBC  Rx 2RxrSTBC 4rTX rSTBC 2

Rxh h r 2h h Rx 2Rxr 4r r 16
 S S STBC S S STBC TX STBC 

16Rx r  2 2 2 2 2 2
STBC Rx rSTBC  Rx 2RxrSTBC 4rTX rSTBC  Rx 2RxrSTBC 4rTX rSTBC

 
h2 2 2 2

S Rx rSTBC  Rx 2RxrSTBC 4rTX rSTBC 2 3

Rx r 2 2 2 
2 2 2 2 2 2 2 STBC  Rx 2RxrSTBC 4rTX rSTBC 2

Rxh h r 2hS h Rx 2Rxr 4r r 16 , (48)
S S STBC S STBC TX STBC


16Rx r  2 2 2 2 2 2

STBC Rx rSTBC  Rx 2RxrSTBC 4rTX rSTBC  Rx 2RxrSTBC 4rTX rSTBC



Исследование пространственно-временной корреляционной модели для радиосистем с разносом передачи      45 
 
где Rx – коэффициент множественной корреляции, вычисленный по формуле (38). 

 
На рис. 4 показана помехоустойчивость данной системы при разных коэффициентах кор-

реляции. 

 

Рис. 4 – Зависимость вероятности ошибки от Eb N0  для 4-х антенной системы MISO 
с квазиортогональным кодом, для коэффициентов пространственной корреляции rTX = 1 
(кривые 1); 0.5 (кривые 2); 0 (кривые 3) и коэффициента кодовой корреляции rSTBC = 0.5 
 
В отличие от системы MISO с двумя передающими антеннами, в данном случае про-

странственная корреляция оказывает значительное влияние только для соседних антенн. При 
этом пространственно-временно́е кодирование, за счёт более эффективного разнесения век-
торов сигнала между антеннами, который детектируется и обрабатывается на приёме, 
уменьшает проигрыш по отношению сигнал/шум системы с rTX = 1 по сравнению с системой 
с rTX = 0.5 с 2 дБ при двухантенной системе до 0.5 дБ при четырёхантенной системе, при ве-
роятности ошибки 10-2. 

 
8-ми и более антенные системы 

 
Очевидно, что для 8-ми и более антенных систем нет смысла приводить формулу поме-

хоустойчивости в аналитическом виде, поскольку она довольно громоздкая. Достаточно рас-
смотреть несколько примеров зависимостей помехоустойчивости для конкретных значений 
rTX и rSTBC (рис. 5). 



46  Р.С. Тимощук, В.И. Носов 

 

Рис. 5 – Зависимость вероятности ошибки от Eb N0  для 8-ми антенной системы MISO 
с квазиортогональным кодом, для коэффициентов пространственной корреляции rTX = 1 
(кривые 1); 0.5 (кривые 2); 0 (кривые 3) и коэффициента кодовой корреляции rSTBC = 0.5 

 
В случае с 8-ю передающими антеннами влияние пространственной корреляции удаётся 

ещё более уменьшить (по сравнению с 2- и 4- антенными системами) за счёт большого коли-
чества антенн и, соответственно, за счёт более эффективного разнесения векторов сигнала 
между антеннами, который детектируется и обрабатывается на приёме. Таким образом, гра-
фики помехоустойчивости системы при коэффициенте rTX = 1 и коэффициенте rTX = 0.5 от-
личаются на 0.1 дБ при вероятности ошибки 10-2. Данный результат говорит о том, что 
увеличение количества антенн MISO-системы, использующей квазиортогональное кодиро-
вание, является эффективным методом борьбы с пространственной корреляцией. 

Однако с ростом числа антенн возрастает корреляция между векторами передаваемых 
сигналов, вследствие их неортогональности.  

На рис. 6 показаны графики помехоустойчивости различных систем MISO, использую-
щих 2, 4 и 8 передающих антенн, при фиксированных коэффициентах пространственной 
корреляции rTX = 0.3 и кодовой корреляции rSTBC = 0.5. 



Исследование пространственно-временной корреляционной модели для радиосистем с разносом передачи      47 
 

 

Рис. 6 – Зависимость вероятности ошибки от Eb N0  для 2-х (кривые 1), 4-х (кривые 2) 
и 8-ми (кривые 3) антенной системы MISO при фиксированных коэффициентах простран-

ственной корреляции rTX = 0.3, и кодовой корреляции rSTBC = 0.5 
 
На рис. 6 показано, что в случае, когда коэффициент пространственной корреляции за-

фиксирован на уровне rTX = 0.3 для систем MISO с различным числом передающих антенн 
(2, 4, 8), помехоустойчивость системы не растёт пропорционально с ростом количества ан-
тенн, а замедляется. Это объясняется тем, что при небольшом количестве передающих ан-
тенн (2 и 4) пространственная корреляция между антеннами оказывает сильное влияние, что 
сопровождается ухудшением помехоустойчивости системы. Например, при изменении ко-
эффициента пространственной корреляции rTX на 0.5 (с 0.5 до 1) помехоустойчивость систе-
мы ухудшается на 2 дБ в случае 2-х передающих антенн и на 0.5 дБ в случае 4-х антенн. 
С ростом количества антенн пространственно-временно́е кодирование позволяет преодолеть 
негативное влияние пространственной корреляции за счёт пространственного разноса излу-
чаемых векторов сигналов, таким образом обеспечивая избыточность в пространстве и во 
времени. Система MISO с 4-мя антеннами проигрывает по помехоустойчивости системе  
MISO с 8-ю антеннами 1.5 дБ при вероятности ошибки 10-3. При этом 4-антенная система 
лучше по помехоустойчивости, чем 2-антенная система на 2 дБ при том же коэффициенте 
ошибки 10-3. Этот эффект объясняется тем, что пространственная корреляция оказывает зна-
чимое влияние только между соседними антеннами, в то время как пространственно-
временно́е кодирование распределяет вектора сигналов равномерно по всем антеннам. Сле-
довательно, увеличение числа передающих антенн способствует росту помехоустойчивости 
системы радиосвязи. Однако, как видно из рис. 6, с ростом числа антенн улучшение помехо-
устойчивости системы MISO замедляется (2 дБ при переходе от 2-х антенн к 4-м и 1.5 дБ при 
переходе от 4-х антенн к 8-ми при BER 10-3), поскольку взаимная корреляция сигналов меж-
ду антеннами в случае квазиортогонального кодирования возрастает. 

 
 
 
 



48  Р.С. Тимощук, В.И. Носов 

5.  Заключение 
 
В отличие от существующих исследований по классической теории разнесённого приё-

ма, а также современных исследований ортогонального пространственно-временно́го коди-
рования, исследование, приведённое в данной статье, позволяет применять полученные 
методики для расчёта характеристик помехоустойчивости MISO-систем, использующих ква-
зиортогональное кодирование сигнала, c произвольным числом передающих антенн, с учё-
том влияния пространственной и кодовой корреляции сигналов. 

В статье получена универсальная корреляционная модель канала для системы MISO 
с N передающими антеннами, для любых каналов передачи с релеевскими замираниями h 2

i , 
рассчитанными для каждой антенны, с учётом пространственной корреляции между антен-
нами rTX, а также с учётом неортогональности (rSTBC) любого пространственно-временно́го 
кода STBC. На основе полученной матрицы аналитически определены выражения для веро-
ятности ошибки для 2-, 4- и 8-антенных систем.  

Актуальной задачей для современных исследований является разработка квазиортого-
нальных пространственно-временны́х кодов с коэффициентом корреляции менее 0.5. Это 
позволит значительно улучшить характеристики помехоустойчивости систем с бо́льшим ко-
личеством антенн (более 32-х). 

Формула оценки вероятности ошибки, с учётом матрицы коэффициентов корреляции, 
может быть использована для построения характеристик помехоустойчивости систем, моде-
лирование которых может быть затруднительно в среде MATLAB (из-за большой вычисли-
тельной сложности), таких как системы с 32-мя или 64-мя передающими антеннами. 

Сравнительный анализ кривых зависимости вероятности ошибки от отношения Eb N0 , 
построенных с помощью компьютерного моделирования в среде MATLAB на основе скон-
струированных моделей систем радиосвязи, и построенных по полученным аналитическим 
выражениям, показывает, что разница между экспериментальными и теоретическими резуль-
татами не превышает 0.5 дБ при вероятности ошибки 10-3 для всех исследуемых вариантов 
систем MISO: с 2-мя, 4-мя и 8-ю передающими антеннами. 
 
Литература 
 
1. D.O. Reudink. Properties of mobile radio propagation above 400 MHz//IEEE Transactions on 

Vehicular Technology, Nov 1974., vol.23, no 1, p.143-160. 
2. W.C. Jakes. A Comparison of specific space diversity techniques for reduction of fast fading 

in UHF mobile radio systems//IEEE Transactions on Vehicular Technology, vol. VT-20, no. 
4, p.81-91. 

3. Alamouti S.М. Space-time block coding: A simple transmitter diversity technique for wireless 
communications. – IEEE Journal on Selected Areas in Communications, Oct. 1998, vol. 16, 
p.1451–1458. 

4. V.Tarokh, H.Jafarkhanit, A.R.Calderbank. The application of orthogonal designs to wireless 
communications//Killarney Ireland., 1998, June 22-26, p.703-709. 

5. S.O. Rice. Mathematical analysis of random noise//Bell System Technical Journal, vol. 23, 
p.282-332, July 1944. 

6. H. Stark and J.W. Woods. Probability, random processes, and estimation theory for engineers, 
Pren Prentice Hall, New Jersey, 2nd edition, 1994, p.32-48. 

7. G.D. Durgin and T.S. Rappaport. A basic relationship between multipath angular spread and 
narrowband fading in a wireless channel//IEEE Electronics Letters, vol. 34, no. 25, p.2431-
2432. 

8. A.M.D. Turkmani, A.A. Arowojolu, P.A. Jefford, and C.J. Kellett. An experimental evaluation 
of the performance of two-branch space and polarization diversity schemes at 1800 
MHz//IEEE Transactions on Vehicular Technology, vol. 44, no. 2, p.318-326. 



Исследование пространственно-временной корреляционной модели для радиосистем с разносом передачи      49 
 
9. Андронов И.С., Финк Л.М. Передача дискретных сообщений по параллельным каналам. 

– М.: Советское радио, 1971. – 408с. 
10. Mahwah N.J. Applied multiple regression. Correlation analysis for the behavioral scienc-

es//Erlbarum Associates. MBSFaculty. 2003, Vol 1., p.43-57. 
11. Б.Скляр. Цифровая связь: Теоретические основы и практическое применение. – 

М.:Вильямс, 2007г. -1104с. 
12. W.C. Jakes. Microwave Mobile Communications//IEEE Press, New York, 1974. p.39-45. 
13. M.J. Gans. A power-spectral theory of propagation in the mobile radio environment//IEEE 

Transactions on Vehicular Technology. vol. VT-21, no. 1, p.27-38. 
14. A. van Zelst. A compact representation of spatial correlation in MIMO radio channels//Proc. 

of the 10th Mediterranean Electrotechnical Conf. (MELECON) 2000, vol. 3, May 2000, 
p.1218-1221. 

15. D. Shiu, G.J. Foschini, M.J. Gans, J.M. Kahn. Fading correlation and its effect on the capaci-
ty of multielement antenna systems//IEEE Transaction On Communications, Vol. 48, No. 3, 
2000., p.502-513. 

 
Статья поступила в редакцию 14.02.2012; 

переработанный вариант — 02.10.2012 
Тимощук Роман Сергеевич 
Аспирант СибГУТИ, руководитель направления телекоммуникации «УтилексАйТи 2000» 
тел. 333-99-04, e-mail: romantimo@mail.ru 
 
Носов Владимир Иванович 
Доктор технических наук, профессор, заведующий кафедрой систем радиосвязи СибГУТИ 
Тел. 269-82-54, e-mail: nvi@sibsutis.ru 
 
 

Research of Space-Time Correlation Model for Radio Systems with Diversity Transmis-
sion  

 
Timoshchuk R.S., Nosov V.I. 

 
The research on MISO-systems noise-immunity of multiple diversity based on mathematical 
theory of diversity reception for correlated channels  is presented in the article. As a result of the 
research, general spatial correlation coefficient is developed. Transmit signal cross-correlation 
coefficient based on the theory of quasiorthogonal space-time coding is developed. Channel co-
efficient matrix is developed using multiple-correlation coefficient that involves influence of 
two correlation factors. Bit error rate (BER) for MISO-system with M-diversity is estimated by 
error probability function based on eigenvalues of channel coefficient matrix. BER curves are 
calculated theoretically for several cases of MISO. MATLAB computer simulation results of 
BER are shown for several MISO-systems of M-diversity in order to support theoretical results. 

 
Keywords: Space-time coding, Alamouti code, transmit diversity, fading mitigation, wireless 
communications, spatial correlation, smart-antenna.