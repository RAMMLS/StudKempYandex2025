Вестник СибГУТИ.  2011.  № 2 53 

УДК 621.396 
 
 

Спектральные способы  
оценки направления источников сигналов  

в адаптивных антенных решѐтках 
 
 

В. П. Петров, А. К. Шауэрман 
 

В данной статье рассматриваются алгоритмы определения параметров принимаемых сиг-
налов в адаптивных цифровых антенных решѐтках, в частности, количества источников 
и их направления. Рассмотрены алгоритмы Бартлетта, Кэйпона и алгоритмы MUSIC и 

льшую, чем раз-
решающую способность по апертуре антенны. 
 
Ключевые слова: пространственное разделение, MUSIC, ESPRIT, направление источника 
сигнала. 

 
 
1.  Введение 
 

В обычной сотовой системе связь между базовой станцией (БС) и находящимися в соте 
подвижными станциями (ПС) устанавливается при помощи ненаправленной или секторной 

льшая часть энергии, излучаемой антенной БС, тратится впустую, поскольку 
в данный момент времени ПС находятся в строго определѐнных местах. Если бы сигнал, 
предназначенный конкретной ПС, посылался только в еѐ направлении, а угол излучения 
уточнялся и изменялся бы в соответствии с перемещением ПС, то это позволило бы сэконо-
мить много энергии. Это можно было бы реализовать с помощью формирования в направле-
нии нужной ПС направленного луча диаграммы направленности антенны (ДНА) БС, исполь-
зуя пространственные свойства радиообмена. Очевидно, что отдельные сигналы в опреде-
лѐнный момент времени можно идентифицировать не только по частоте и коду, но и по 
направлению. Адаптивные цифровые антенные решетки (АЦАР) являются техническим ре-
шением этого вопроса. 

Используя АЦАР, можно увеличить отношение сигнал/шум при передаче данных между 
ПС и БС или увеличить зону радиопокрытия БС. Также можно ограничивать эффект много-
лучевого распространения исключением ненужных путей распространения сигнала, полу-
чаемых при отражении его от препятствия, формированием минимумов в ДНА в направле-
нии помех. 

Обработка принятых сигналов в адаптивных цифровых антенных решетках делится 
на два этапа: вхождение в связь и приѐм данных. В каждом из указанных режимов должны 
применяться свои алгоритмы обработки. В режиме вхождения в связь вначале анализируется 
окружающая обстановка. Антенна получает данные, обрабатывает их и выдаѐт решение 
об источниках помех и желаемых сигналов, которых может быть несколько. В режиме приѐ-
ма данных система вычисляет весовые коэффициенты, которые формируют желаемую ДНА 
с максимумами лучей в направлении требуемых источников и минимумами в направлении 
помех. Цикл периодически повторяется с целью слежения за подвижными объектами. По-
этому алгоритмы определения количества желаемых сигналов и помех, и направления на их 
источники являются важной частью работы АЦАР. 

 



54  В. П. Петров, А. К. Шауэрман 

2.  Теория 
 
2.1. Спектральные методы оценки параметров сигналов 
 

Для оценки применимости алгоритмов можно смоделировать взаимодействие источни-
ков сигналов и данных, принимаемых антенной решѐткой. Элемент антенной решѐтки пред-
ставляется как точечный приѐмник, расположенный в пространстве. Сигнал, генерируемый 
на l-ом элементе из L датчиков, можно описать как [1] 

,      (1) 

где  – сигнал от i-го источника из всего множества M источников,  – шум на l-ом 
элементе,  – задержка сигнала i-го источника на l-ом элементе относительно опор-
ного (первого) элемента.  

Для простоты будем рассматривать линейную эквидистантную антенную решѐтку из L 
элементов. Такая антенна может наблюдать сигнал либо в азимутальной, либо в вертикаль-
ной плоскости. Таким образом,  задержка i-го сигнала на l-ом элементе представляется в ви-
де . Тогда уравнение (1) в матричном виде для всего массива датчиков примет вид: 

,                 (2) 

где A [a 1 , , a M ], (L M )  – матрица направления всех M источников,  

  – вектор направления i-го источника, оператор  – транспони-
рование матрицы,  – вектор сигналов,  – вектор аддитивного 
шума размерности L. 

Для реализации алгоритмов определения количества и направлений источников сигна-
лов необходимо найти функцию ковариации входных сигналов [3]: 

 , (3) 

где оператор  – комплексно-сопряжѐнное транспонирование матрицы,  – оператор 
математического ожидания между различными элементами, т.е. . 

Метод оценки параметров приходящих сигналов делится на две категории [3]: 
 спектральный подход; 
 параметрический подход. 

В спектральном подходе оценивается спектр сигнала, затем по количеству и расположе-
нию максимумов находят направления источников сигналов. Параметрический подход тре-
бует синхронного поиска всех интересующих параметров – количества и направлений ис-
точников сигналов. Спектральный метод оценки параметров сигналов подразделяется на лу-
чеобразующий и подпространственный методы.  

Несмотря на то что параметрические методы дают лучшую разрешающую способность, 
для их реализации требую льшие вычислительные ресурсы, что усложняет 
работу алгоритмов в реальном масштабе времени. Поэтому в ближайшей перспективе ис-
пользование спектральных методов является предпочтительным. 

Первые оценки направления источника желаемого сигнала с помощью антенных решѐ-
ток проводились лучеобразующими способами. Идея заключается в том, что оценивается 
пространственная мощность  по всем направлениям  в горизонтальной плоскости (т.е. 
при ненаправленной ДНА), и направлением источника сигнала является направление с мак-
симальной мощностью [3]. Количество источников сигналов будет соответствовать количе-
ству максимумов в пространственном спектре. После построения и нахождения максимумов 
определяются направления (углы ), соответствующие этим максимумам. 

Выразим ответный отклик на выходе линейных датчиков: 



  Спектральные способы оценки направления источников сигналов в адаптивных антенных решетках  55 

 , (4) 

где  – весовые коэффициенты, формирующие диаграмму направленности 
антенны. 

Выходная мощность 

 . (5) 

Традиционный лучеформирователь (или формирователь Бартлетта) работает на базе 
расширения спектрального анализа, с помощью преобразования Фурье для решетки датчи-
ков. Для решѐтки произвольной формы этот алгоритм выделяет максимум мощности на вы-
ходе формирователя с заданными входными данными. Допустим, мы желаем определить 
максимум выходной мощности в нескольких направлениях , где выходные данные искажа-
ются аддитивным шумом. При поиске наибольшего значения мощности для того, чтобы ре-
шение оказалось ненулевым, воспользуемся нормированием . Решение будет такое [3]: 

 . (6) 

Весовой вектор может быть интерпретирован как вектор коэффициентов пространствен-
ного фильтра. Весовое умножение элементов решѐтки выравнивает задержки (и возможно, 
затухания) сигнала на отдельных датчиках, чтобы максимально комбинировать их относи-
тельный сдвиг по фазе. 

Подставляя уравнение (6) в формулу (5), получим пространственный спектр по методу 
Бартлетта: 

 . (7) 

Для линейной эквидистантой антенной решѐтки (ЛАР) с изотропными элементами век-
тор направления имеет вид 

 , (8) 

где   – электрический угол,  – расстояние между элементами 

антенны,  – скорость распространения сигналов,  – несущая частота сигнала. 
К сожалению, пространственный спектр такого метода имеет те же ограничения по раз-

х рядов [3]. Из-
вестно, что стандартная ширина луча для линейной антенной решѐтки вычисляется по фор-

муле , где L – количество элементов в решѐтке. Поэтому сигналы, которые отстоят 

друг от друга на угол  или меньший, не будут распознаны как отдельные, независимо от 
качества сигнала. Так, линейная антенная решѐтка с количеством элементов L=8 с расстоя-
нием между элементами, равным половине длины несущей волны, имеет ширину главного 
лепестка, равную , что значит, что два источника должны быть разне-
сены друг от друга хотя бы на 22,5˚. 

В попытках расширить ограничения, указанные выше, такие как различение двух источ-
ников, находящихся ближе разрешающей способности ЛАР, был разработан ряд методов. 
Хорошо известный метод, предложенный Кэйпоном [1], был сформулирован как оптимиза-
ция по условию: 

 , (9) 

где  определяется, как и в формуле (5). Отсюда видно, что формирователь Кэйпона пы-
тается свести к минимуму мощность, наведѐнную шумом и любым другим сигналом с не-
нужной стороны, одновременно удерживая постоянной отношение сигнал/шум в нужном на-
правлении . Весовые коэффициенты находятся по формуле 



56  В. П. Петров, А. К. Шауэрман 

 . (10) 

Подставляя формулу (10) в уравнение (5), получим следующий пространственный 
спектр: 

 . (11) 

Таким образом, алгоритм работы лучеобразующих методов будет следующий: 
1. Находим оценку ковариационной матрицы входных значений: 

. 

2. Вычисляем пространственную мощность . 
3. По максимумам находим направления источников сигналов . 

Использование технологии разрежѐнных матриц позволяет выйти за ограничения разре-
шающей способности, обусловленной апертурой антенны [2]. Такие матрицы были исполь-
зованы для оценки параметров наблюдаемых процессов. Этот подход включает в себя прин-

х рядов. 
 

2.2. Определение количества источников сигналов 
 

Параметры сигналов, снимаемых с элементов антенны, не зависят от конструкции ан-
тенной решѐтки и взаимного расположения элементов в пространстве. Это влияет лишь на 
значения  из уравнения (1), т.е. на матрицу направления, но алгоритмы будут рабо-
тать так же. Используя метод Грэмма – Шмидта, преобразуем ковариационную матрицу 
входных значений из уравнения (3) к виду [3]: 

 , (12) 

где  – ковариационная матрица сигнала источника,  – 
ковариационная матрица шума, отображающая шум с дисперсией  на всех элементах ан-
тенной решѐтки. Такой шум обычно называется пространственным белым шумом [3]. Одна-
ко некоторые шумы могут быть не пространственными и не белыми. Такие шумы нужно 
предварительно привести к белому шуму, чтобы можно было применить для них соответст-
вующие алгоритмы. 

Если матрица источника  вырожденная, то сигналы от разных источников не могут 
быть разделены и антенная система не способна реализовать эффективную работу в системе 
пространственного разделения каналов. В этом случае производится новый набор данных от 
сигналов. Когда же матрица ковариации Р невырожденная, допустимо применение алгорит-
мов цифровой обработки. 

Для нахождения собственных значений матрицы  выражение (3) перепишем следую-
щим образом: 

  , (13) 

где U – единичная матрица и  – диагональная матрица с положитель-
ными собственными значениями матрицы , определенными как . За-
метим, что любой вектор, ортогональный , является собственным вектором  с собствен-
ным значением  Так как остальные собственные значения больше чем , мы можем от-
делить собственные вектора сигналов и шума:  – собственные значения 
вектора шума и  – собственные значения вектора сигнала. Таким об-
разом, определяя количество собственных значений , больших значения , можно узнать 
количество источников. На практике мы имеем лишь оценки входных данных и условие 

 выполняется не точно, т.е. некоторые значения могут быть с отклоне-
ниями. Поэтому требуется порог принятия решения. Этот порог зависит от конструкции ан-



  Спектральные способы оценки направления источников сигналов в адаптивных антенных решетках  57 

тенны и максимального количества источников, которое может обслуживать данная система. 
Таким образом, алгоритм выглядит следующим образом: 

1. Находим оценку ковариационной матрицы входных данных: 

. 

2. Вычисляем собственные значения оценки . 
3. Считаем количество собственных значений, превышающих значение  (или зна-

чение установленного порога), это и будет количество источников сигналов. 
Этот алгоритм определения количества источников является общим для всех подпро-

странственных методов определения направлений источников этих сигналов. 
 

3.  Алгоритм MUSIC 
 

Наиболее интересным подпространственным методом определения направления источ-
ника сигнала является алгоритм MUSIC (Multiple SIgnal Classification – многофакторный 
анализ сигнала) [3]. Следует отметить, что алгоритм MUSIC сразу разрабатывался как алго-
ритм для оценки направления прихода сигнала для решѐток датчиков. 

Разделяя матрицу  из уравнения (13) на подматрицы с собственными значениями сиг-
налов и шума, получим: 

 , (14) 

где , а диагональная матрица  содержит М наибольших собственных значений 
матрицы R. Так как все собственные вектора шума ортогональны к A, столбцы  должны 
охватывать диапазон пространства , тогда как  охватывает его ортогональное допол-
нение (нулевое пространство ). Операторы проекции на эти подпространства сигнала и 
шума определяются следующим образом [3]:  

 , (15) 

 ,  

при условии, что инверсия  в выражении (15) существует,  содержит информацию 
о возможных направлениях источников сигналов, тогда как  – информацию о направлени-
ях, где нет источников сигналов. 

Выразим это в уравнении: 

 . (16) 

Чтобы получить оценки направления прихода сигнала, любое собрание M векторов, со-
ответствующих отдельным направлениям прихода сигналов , формирует линейно незави-
симый набор. Если  удовлетворяет этому условию и  имеет полный ранг, то  

также имеет полный ранг. Из этого следует, что  являются единственными реше-
ниями уравнения (16). 

На практике есть оценка ковариационной матрицы  и еѐ собственные векторы разделя-
ются на шум и полезный сигнал, как в уравнении (14). Ортогональная проекция в подпро-
странство шума оценивается как  

 . (17) 

Пространственный спектр алгоритма MUSIC затем определяется как [1]  

 . (18) 

Хотя  является не настоящим спектром в любом случае (это просто расстояние 
между двумя подпространствами), он показывает максимумы около расположения настоя-
щего направления прихода сигнала.  



58  В. П. Петров, А. К. Шауэрман 

В отличие от оценивателя Бартлетта, алгоритм MUSIC имеет более высокую разрешаю-
щую способность и точность определения направления источника сигнала. Это будет пока-
зано при моделировании. 

 
4.  Алгоритм ESPRIT 
 

Алгоритм ESPRIT был предложен в 1989 [5]. ESPRIT является вычислительно эффек-
тивным и надежным методом оценки направления прихода сигнала.  

При выполнении алгоритма ESPRIT возможно разделить матрицу антенных элементов 
на две подматрицы. Эти подматрицы должны быть друг от друга на том же расстоянии, что 
и элементы антенной решѐтки. 

Например, линейную антенную решетку из четырѐх одинаковых элементов с интервалом 
 между элементами можно рассматривать как два массива из трѐх элементов: одна матрица 

состоит из первых трѐх элементов и другая – из трѐх последних элементов. Две матрицы по-
лучаются на расстоянии . Эти две матрицы идентичны во всех отношениях несмотря на то, 
что они физически смещены друг от друга на известный вектор :  

 , (19) 

 , (20) 

где матрицы ,  должны удовлетворять условию (19), матрица  является диагональной 
матрицей фазовых сдвигов размерностью  между элементами:  

 , (21) 

где . Задача сводится к тому, чтобы найти , т.е. все , находящиеся 
в его элементах. 

Учитывая уравнения (14) и (15), должна существовать единственно возможная невырож-
денная матрица , размерностью  такая что 

  (22) 

Учитывая (19) и (22), получим: 

  (23) 

 .  

Тогда . 
Необходимо это уравнение привести к виду: 

 , (24) 

где оператор  – псевдоинверсия, т.е. . 
Собственные значения  будут значениями матрицы , в элементах которой есть 

информация о направлениях источников сигналов. Таким образом, алгоритмы высокого раз-
решения имеют следующие последовательные операции: 

1. Вычисляем оценку ковариационной матрицы входных значений: 

.  

2. Выполняем разложение по собственным значения матрицы . 
3. Основываясь на собственных значениях , определяем количество источников 

сообщений. 
4. Используем понравившийся алгоритм оценки направления источника сигнала: 

a. MUSIC: 
 Находим максимумы в . 



  Спектральные способы оценки направления источников сигналов в адаптивных антенных решетках  59 

 Определяем , соответствующие максимумам . 

b. ESPRIT: 

 Вычисляем собственные значения выражения  

. 

Алгоритмы с высокой разрешающей способностью заранее определяют количество ис-
точников сигналов в отличие от лучеобразующих методов. Это позволяет избежать неопре-
деленности в определении направления источников сигналов в пространственном спектре, 
ведь количество максимумов в спектре может быть больше, чем количество реальных источ-
ников. А более высокая разрешающая способность по различению близко находящихся ис-
точников позволяет в десятки раз точнее определить местонахождение источника сигнала. 

 
 

5.  Результаты моделирования 
 

Рассмотрим моделирование некоторых алгоритмов оценки направлении прихода сигна-
лов. Начнѐм с самого простого метода – метода Бартлетта, описанного выше для линейной 
антенной решѐтки с количеством элементов L = 8 с расстоянием между элементами, равным 
половине длине несущей волны. 

На рис. 1 приведены графики для антенной решѐтки, описанной выше, в случае одного 
источника сигнала. Максимум значения спектра определяет направление источника. Как 
видно, максимумы спектра совпадают с заданными источниками. На рис. 2 приведѐн случай 
с двумя источниками. Как видно, в случае trace 2 источники разнесены всего на , в спек-
тре они разнесены, но определяются с ошибкой, т.е. вместо  мы получим , абсолют-
ная ошибка   , а вместо получим , абсолютная ошибка 

  . 
Ширина главного максимума по уровню 0.7 для метода Бартлетта, по результатам моде-

лирования, равна около . 
 

 
Рис. 1 – Нормированный спектр для оценки направления источника сигнала от одного источника  

по методу Бартлетта, где trace 1 (сплошной линией) соответствует моделированному направлению 
источника 45˚, trace 2 (точечной линией) – 10˚ и trace 3 (штриховой линией) – 70˚ 



60  В. П. Петров, А. К. Шауэрман 

 
Рис. 2 – Нормированный спектр для оценки направления источника сигнала от двух источников  

по методу Бартлетта, где trace 1 (сплошной линией) соответствует моделированному направлению 
прихода (20˚ - 20˚), trace 2 (точечной линией) – (30˚, 43˚) и trace 3 (штриховой линией) – (35˚, 67˚) 

 
На рис. 3 и 4 представлено моделирование по алгоритму MUSIC. Из рисунка видно, что 

разрешающая способность по определению направлений источников этого алгоритма лучше 
лучеобразующих методов. Моделирование по алгоритму MUSIC проводилось для такой же 
антенной решѐтки, что и в методе Бартлетта. Ширина главного максимума по уровню 0.7 при 
двух источниках сообщений равна примерно 2˚. 

Таким образом, для двух источников пространственная разрешающая способность алго-
ритма MUSIC в 7 раз больше, чем у метода Бартлетта. 

 
Рис. 3 – Нормированный спектр для оценки направления источника сигнала от одного источника  

по алгоритму MUSIC, где trace 1 (сплошной линией) соответствует моделированному направлению 
источника 25˚, trace 2 (точечной линией) – 60˚ и trace 3 (штриховой линией) – 77˚ 



  Спектральные способы оценки направления источников сигналов в адаптивных антенных решетках  61 

 
Рис. 4 – Нормированный спектр для оценки направления источника сигнала от двух источников  

по алгоритму MUSIC, где trace 1 (сплошной линией) соответствует моделированному направлению 
прихода (25˚ - 60˚), trace 2 (точечной линией) – (20˚, 43˚) и trace 3 (штриховой линией) – (14˚, 50˚) 

 
На рис.4 можно наблюдать три ярко выраженных максимума в пространственном спек-

тре trace 3. Но мы заранее определили по собственным значениям ковариационной матрицы 
входных сигналов, что количество источников сигналов равно двум, соответственно, алго-
ритм определяет лишь первые два максимума, игнорируя остальные локальные максимумы. 
Если бы такой спектр был при лучеобразующих методах, третий локальный максимум был 
бы принят как одна из оценок направления источника сигнала, который затем идентифици-
ровался бы как помеха. Далее ДНА антенны сформировалась бы с минимумов в этом на-
правлении, что добавило бы лишние вычисления. Поэтому подпространственные методы 
предпочтительнее лучеобразующих методов. 

 
6.  Заключение 
 

Существующие алгоритмы и их моделирование в данной статье показывают, что алго-
ритмы работают даже при малом количестве антенных элементов и несложной геометрии 
антенн, что весьма важно при применении указанных алгоритмов на практике. Современные 
технические возможности позволяют производить необходимые вычисления матриц в циф-
ровых сигнальных процессорах или программируемых логических интегральных схемах. 

 
Литература 
 
1. Andre GM Lima, Leonardo Menezes. Smart аntennas as an approach to instantaneous air inter-

face with software-defined radios. IEEE antennas & propagation magazine vol. 49, No. 3, June 
2007. 

2. Писсанецки С. Технология разреженных матриц: пер. с англ. – М.: Мир, 1988. – 410 с. 
3. Hamid Krim, Mats Viberg. Two decades of array signal processing research. The parametric 

approach.// IEEE signal processing magazine. July 1996. 
4. Godara C. Application of antenna arrays to mobile communications, part II: beamforming and 

direction-of-arrival consideration.1997. 



62  В. П. Петров, А. К. Шауэрман 

5. R. Roy and T. Kailath, ―ESPRIT—Estimation of signal parameters via rotational invariance 
techniques,‖ IEEE Trans. Acoust., Speech, Signal Processing, vol. ASSP-37, pp. 984–995, 
1989. 

 
Статья поступила в редакцию 01.04.2011. 

 
Петров Виктор Петрович 
д.т.н., профессор кафедры беспроводных информационных систем и сетей (БИСС) Сиб-

ГУТИ, (630102, Новосибирск, ул. Кирова, 86)  
тел. (383) 2-698-351, e-mail: petrov@mbit.ru. 
 
Шауэрман Айнур Куанышбек кызы 
аспирант кафедры БИСС СибГУТИ, e-mail: aykuli@ya.ru. 
 
 
 

 
Spectral Method to Estimate Signal Source Direction in Adaptive Arrays 
 
V. P. Petrov, A. K. Shauerman 
 
Spectral-based algorithms of estimating receiving signal parameters in adaptive arrays, particu-
larly the number of sources and direction-of-arrival (DOA) are described in this paper. This pa-
per provides Bartlett and Capon algorithms that are directly dependent upon  physical size of the 
array, MUSIC and ESPRIT algorithms with the resolution capability not limited by the array 
aperture. 
 
Keywords: Adaptive antenna array, MUSIC, ESPRIT, direction-of-arrival.